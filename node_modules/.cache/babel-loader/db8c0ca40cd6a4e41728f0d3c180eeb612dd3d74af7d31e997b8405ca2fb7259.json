{"ast":null,"code":"function e(e, t) {\n  var n = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var r = Object.getOwnPropertySymbols(e);\n    t && (r = r.filter(function (t) {\n      return Object.getOwnPropertyDescriptor(e, t).enumerable;\n    })), n.push.apply(n, r);\n  }\n  return n;\n}\nfunction t(t) {\n  for (var n = 1; n < arguments.length; n++) {\n    var r = null != arguments[n] ? arguments[n] : {};\n    n % 2 ? e(Object(r), !0).forEach(function (e) {\n      s(t, e, r[e]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(r)) : e(Object(r)).forEach(function (e) {\n      Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(r, e));\n    });\n  }\n  return t;\n}\nfunction n(e) {\n  return n = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n    return typeof e;\n  } : function (e) {\n    return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n  }, n(e);\n}\nfunction r(e, t) {\n  if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n}\nfunction i(e, t) {\n  for (var n = 0; n < t.length; n++) {\n    var r = t[n];\n    r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n  }\n}\nfunction o(e, t, n) {\n  return t && i(e.prototype, t), n && i(e, n), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nfunction s(e, t, n) {\n  return t in e ? Object.defineProperty(e, t, {\n    value: n,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[t] = n, e;\n}\nfunction a(e, t) {\n  if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n  e.prototype = Object.create(t && t.prototype, {\n    constructor: {\n      value: e,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), t && u(e, t);\n}\nfunction c(e) {\n  return c = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (e) {\n    return e.__proto__ || Object.getPrototypeOf(e);\n  }, c(e);\n}\nfunction u(e, t) {\n  return u = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (e, t) {\n    return e.__proto__ = t, e;\n  }, u(e, t);\n}\nfunction l(e, t) {\n  if (null == e) return {};\n  var n,\n    r,\n    i = function (e, t) {\n      if (null == e) return {};\n      var n,\n        r,\n        i = {},\n        o = Object.keys(e);\n      for (r = 0; r < o.length; r++) n = o[r], t.indexOf(n) >= 0 || (i[n] = e[n]);\n      return i;\n    }(e, t);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    for (r = 0; r < o.length; r++) n = o[r], t.indexOf(n) >= 0 || Object.prototype.propertyIsEnumerable.call(e, n) && (i[n] = e[n]);\n  }\n  return i;\n}\nfunction d(e, t) {\n  if (t && (\"object\" == typeof t || \"function\" == typeof t)) return t;\n  if (void 0 !== t) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return function (e) {\n    if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    return e;\n  }(e);\n}\nfunction p(e) {\n  var t = function () {\n    if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n    if (Reflect.construct.sham) return !1;\n    if (\"function\" == typeof Proxy) return !0;\n    try {\n      return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;\n    } catch (e) {\n      return !1;\n    }\n  }();\n  return function () {\n    var n,\n      r = c(e);\n    if (t) {\n      var i = c(this).constructor;\n      n = Reflect.construct(r, arguments, i);\n    } else n = r.apply(this, arguments);\n    return d(this, n);\n  };\n}\nfunction f(e, t) {\n  return function (e) {\n    if (Array.isArray(e)) return e;\n  }(e) || function (e, t) {\n    var n = null == e ? null : \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n    if (null == n) return;\n    var r,\n      i,\n      o = [],\n      s = !0,\n      a = !1;\n    try {\n      for (n = n.call(e); !(s = (r = n.next()).done) && (o.push(r.value), !t || o.length !== t); s = !0);\n    } catch (e) {\n      a = !0, i = e;\n    } finally {\n      try {\n        s || null == n.return || n.return();\n      } finally {\n        if (a) throw i;\n      }\n    }\n    return o;\n  }(e, t) || _(e, t) || function () {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }();\n}\nfunction h(e) {\n  return function (e) {\n    if (Array.isArray(e)) return g(e);\n  }(e) || function (e) {\n    if (\"undefined\" != typeof Symbol && null != e[Symbol.iterator] || null != e[\"@@iterator\"]) return Array.from(e);\n  }(e) || _(e) || function () {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }();\n}\nfunction _(e, t) {\n  if (e) {\n    if (\"string\" == typeof e) return g(e, t);\n    var n = Object.prototype.toString.call(e).slice(8, -1);\n    return \"Object\" === n && e.constructor && (n = e.constructor.name), \"Map\" === n || \"Set\" === n ? Array.from(e) : \"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? g(e, t) : void 0;\n  }\n}\nfunction g(e, t) {\n  (null == t || t > e.length) && (t = e.length);\n  for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];\n  return r;\n}\nfunction v(e, t) {\n  var n = \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n  if (!n) {\n    if (Array.isArray(e) || (n = _(e)) || t && e && \"number\" == typeof e.length) {\n      n && (e = n);\n      var r = 0,\n        i = function () {};\n      return {\n        s: i,\n        n: function () {\n          return r >= e.length ? {\n            done: !0\n          } : {\n            done: !1,\n            value: e[r++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: i\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var o,\n    s = !0,\n    a = !1;\n  return {\n    s: function () {\n      n = n.call(e);\n    },\n    n: function () {\n      var e = n.next();\n      return s = e.done, e;\n    },\n    e: function (e) {\n      a = !0, o = e;\n    },\n    f: function () {\n      try {\n        s || null == n.return || n.return();\n      } finally {\n        if (a) throw o;\n      }\n    }\n  };\n}\nvar y = {\n  DEBUG: !1,\n  LIB_VERSION: \"1.68.1\"\n};\n/**\n * uuidv7: An experimental implementation of the proposed UUID Version 7\n *\n * @license Apache-2.0\n * @copyright 2021-2023 LiosK\n * @packageDocumentation\n *\n * from https://github.com/LiosK/uuidv7/blob/e501462ea3d23241de13192ceae726956f9b3b7d/src/index.ts\n */\nMath.trunc || (Math.trunc = function (e) {\n  return e < 0 ? Math.ceil(e) : Math.floor(e);\n}), Number.isInteger || (Number.isInteger = function (e) {\n  return \"number\" == typeof e && isFinite(e) && Math.floor(e) === e;\n});\nvar m = \"0123456789abcdef\",\n  b = function () {\n    function e(t) {\n      if (r(this, e), this.bytes = t, 16 !== t.length) throw new TypeError(\"not 128-bit length\");\n    }\n    return o(e, [{\n      key: \"toString\",\n      value: function () {\n        for (var e = \"\", t = 0; t < this.bytes.length; t++) e += m.charAt(this.bytes[t] >>> 4), e += m.charAt(15 & this.bytes[t]), 3 !== t && 5 !== t && 7 !== t && 9 !== t || (e += \"-\");\n        return e;\n      }\n    }, {\n      key: \"clone\",\n      value: function () {\n        return new e(this.bytes.slice(0));\n      }\n    }, {\n      key: \"equals\",\n      value: function (e) {\n        return 0 === this.compareTo(e);\n      }\n    }, {\n      key: \"compareTo\",\n      value: function (e) {\n        for (var t = 0; t < 16; t++) {\n          var n = this.bytes[t] - e.bytes[t];\n          if (0 !== n) return Math.sign(n);\n        }\n        return 0;\n      }\n    }], [{\n      key: \"fromFieldsV7\",\n      value: function (t, n, r, i) {\n        if (!Number.isInteger(t) || !Number.isInteger(n) || !Number.isInteger(r) || !Number.isInteger(i) || t < 0 || n < 0 || r < 0 || i < 0 || t > 0xffffffffffff || n > 4095 || r > 1073741823 || i > 4294967295) throw new RangeError(\"invalid field value\");\n        var o = new Uint8Array(16);\n        return o[0] = t / Math.pow(2, 40), o[1] = t / Math.pow(2, 32), o[2] = t / Math.pow(2, 24), o[3] = t / Math.pow(2, 16), o[4] = t / Math.pow(2, 8), o[5] = t, o[6] = 112 | n >>> 8, o[7] = n, o[8] = 128 | r >>> 24, o[9] = r >>> 16, o[10] = r >>> 8, o[11] = r, o[12] = i >>> 24, o[13] = i >>> 16, o[14] = i >>> 8, o[15] = i, new e(o);\n      }\n    }]), e;\n  }(),\n  w = function () {\n    function e() {\n      r(this, e), s(this, \"timestamp\", 0), s(this, \"counter\", 0), s(this, \"random\", new E());\n    }\n    return o(e, [{\n      key: \"generate\",\n      value: function () {\n        var e = this.generateOrAbort();\n        if (void 0 !== e) return e;\n        this.timestamp = 0;\n        var t = this.generateOrAbort();\n        if (void 0 === t) throw new Error(\"Could not generate UUID after timestamp reset\");\n        return t;\n      }\n    }, {\n      key: \"generateOrAbort\",\n      value: function () {\n        var e = Date.now();\n        if (e > this.timestamp) this.timestamp = e, this.resetCounter();else {\n          if (!(e + 1e4 > this.timestamp)) return;\n          this.counter++, this.counter > 4398046511103 && (this.timestamp++, this.resetCounter());\n        }\n        return b.fromFieldsV7(this.timestamp, Math.trunc(this.counter / Math.pow(2, 30)), this.counter & Math.pow(2, 30) - 1, this.random.nextUint32());\n      }\n    }, {\n      key: \"resetCounter\",\n      value: function () {\n        this.counter = 1024 * this.random.nextUint32() + (1023 & this.random.nextUint32());\n      }\n    }]), e;\n  }(),\n  k = function (e) {\n    if (\"undefined\" != typeof UUIDV7_DENY_WEAK_RNG && UUIDV7_DENY_WEAK_RNG) throw new Error(\"no cryptographically strong RNG available\");\n    for (var t = 0; t < e.length; t++) e[t] = 65536 * Math.trunc(65536 * Math.random()) + Math.trunc(65536 * Math.random());\n    return e;\n  };\n\"undefined\" != typeof crypto && crypto.getRandomValues && (k = function (e) {\n  return crypto.getRandomValues(e);\n});\nvar S,\n  E = function () {\n    function e() {\n      r(this, e), s(this, \"buffer\", new Uint32Array(8)), s(this, \"cursor\", 1 / 0);\n    }\n    return o(e, [{\n      key: \"nextUint32\",\n      value: function () {\n        return this.cursor >= this.buffer.length && (k(this.buffer), this.cursor = 0), this.buffer[this.cursor++];\n      }\n    }]), e;\n  }(),\n  F = function () {\n    return (S || (S = new w())).generate();\n  },\n  x = Array.prototype,\n  P = Object.prototype,\n  O = P.toString,\n  I = P.hasOwnProperty,\n  $ = \"undefined\" != typeof window ? window : {},\n  T = $.navigator || {\n    userAgent: \"\"\n  },\n  M = $.document || {},\n  A = T.userAgent,\n  R = [\"localhost\", \"127.0.0.1\"],\n  C = x.forEach,\n  j = x.indexOf,\n  D = Array.isArray,\n  N = {},\n  q = {\n    log: function () {\n      if (y.DEBUG && !Q(window.console) && window.console) {\n        for (var e = (\"__rrweb_original__\" in window.console.log) ? window.console.log.__rrweb_original__ : window.console.log, t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n        try {\n          e.apply(window.console, n);\n        } catch (t) {\n          L(n, function (t) {\n            e(t);\n          });\n        }\n      }\n    },\n    error: function () {\n      if (y.DEBUG && !Q(window.console) && window.console) {\n        for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++) t[n] = arguments[n];\n        var r = [\"PostHog error:\"].concat(t),\n          i = \"__rrweb_original__\" in window.console.error ? window.console.error.__rrweb_original__ : window.console.error;\n        try {\n          i.apply(window.console, r);\n        } catch (e) {\n          L(r, function (e) {\n            i(e);\n          });\n        }\n      }\n    },\n    critical: function () {\n      if (!Q(window.console) && window.console) {\n        for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++) t[n] = arguments[n];\n        var r = [\"PostHog error:\"].concat(t),\n          i = \"__rrweb_original__\" in window.console.error ? window.console.error.__rrweb_original__ : window.console.error;\n        try {\n          i.apply(window.console, r);\n        } catch (e) {\n          L(r, function (e) {\n            i(e);\n          });\n        }\n      }\n    }\n  },\n  H = function (e) {\n    return e.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, \"\");\n  };\nfunction L(e, t, n) {\n  if (Array.isArray(e)) if (C && e.forEach === C) e.forEach(t, n);else if (\"length\" in e && e.length === +e.length) for (var r = 0, i = e.length; r < i; r++) if (r in e && t.call(n, e[r], r) === N) return;\n}\nfunction U(e, t, n) {\n  if (null != e) {\n    if (Array.isArray(e)) return L(e, t, n);\n    for (var r in e) if (I.call(e, r) && t.call(n, e[r], r) === N) return;\n  }\n}\nvar B = function (e) {\n    for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++) n[r - 1] = arguments[r];\n    return L(n, function (t) {\n      for (var n in t) void 0 !== t[n] && (e[n] = t[n]);\n    }), e;\n  },\n  V = D || function (e) {\n    return \"[object Array]\" === O.call(e);\n  },\n  G = function (e) {\n    try {\n      return /^\\s*\\bfunction\\b/.test(e);\n    } catch (e) {\n      return !1;\n    }\n  };\nfunction W(e, t) {\n  return -1 !== e.indexOf(t);\n}\nvar z = function (e) {\n    return e === Object(e) && !V(e);\n  },\n  Q = function (e) {\n    return void 0 === e;\n  },\n  J = function (e) {\n    return \"[object String]\" == O.call(e);\n  },\n  X = function (e) {\n    return \"[object Number]\" == O.call(e);\n  },\n  Y = function e(t) {\n    return U(t, function (n, r) {\n      !function (e) {\n        return \"[object Date]\" == O.call(e);\n      }(n) ? z(n) && (t[r] = e(n)) : t[r] = Z(n);\n    }), t;\n  },\n  Z = function (e) {\n    function t(e) {\n      return e < 10 ? \"0\" + e : e;\n    }\n    return e.getUTCFullYear() + \"-\" + t(e.getUTCMonth() + 1) + \"-\" + t(e.getUTCDate()) + \"T\" + t(e.getUTCHours()) + \":\" + t(e.getUTCMinutes()) + \":\" + t(e.getUTCSeconds());\n  },\n  K = function (e) {\n    return function () {\n      try {\n        for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n        return e.apply(this, n);\n      } catch (e) {\n        q.critical(\"Implementation error. Please turn on debug and contact support@posthog.com.\"), q.critical(e);\n      }\n    };\n  },\n  ee = function (e) {\n    var t = {};\n    return U(e, function (e, n) {\n      J(e) && e.length > 0 && (t[n] = e);\n    }), t;\n  };\nvar te = [\"$performance_raw\"];\nfunction ne(e, t) {\n  return n = e, r = function (e, n) {\n    return n && te.indexOf(n) > -1 ? e : \"string\" == typeof e && null !== t ? e.slice(0, t) : e;\n  }, i = new Set(), function e(t, n) {\n    return t !== Object(t) ? r ? r(t, n) : t : i.has(t) ? void 0 : (i.add(t), V(t) ? (o = [], L(t, function (t) {\n      o.push(e(t));\n    })) : (o = {}, U(t, function (t, n) {\n      i.has(t) || (o[n] = e(t, n));\n    })), o);\n    var o;\n  }(n);\n  var n, r, i;\n}\nfunction re(e) {\n  var t,\n    n,\n    r,\n    i,\n    o,\n    s = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n    a = 0,\n    c = 0,\n    u = \"\",\n    l = [];\n  if (!e) return e;\n  e = oe(e);\n  do {\n    t = (o = e.charCodeAt(a++) << 16 | e.charCodeAt(a++) << 8 | e.charCodeAt(a++)) >> 18 & 63, n = o >> 12 & 63, r = o >> 6 & 63, i = 63 & o, l[c++] = s.charAt(t) + s.charAt(n) + s.charAt(r) + s.charAt(i);\n  } while (a < e.length);\n  switch (u = l.join(\"\"), e.length % 3) {\n    case 1:\n      u = u.slice(0, -2) + \"==\";\n      break;\n    case 2:\n      u = u.slice(0, -1) + \"=\";\n  }\n  return u;\n}\nvar ie,\n  oe = function (e) {\n    var t,\n      n,\n      r,\n      i,\n      o = \"\";\n    for (t = n = 0, r = (e = (e + \"\").replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\")).length, i = 0; i < r; i++) {\n      var s = e.charCodeAt(i),\n        a = null;\n      s < 128 ? n++ : a = s > 127 && s < 2048 ? String.fromCharCode(s >> 6 | 192, 63 & s | 128) : String.fromCharCode(s >> 12 | 224, s >> 6 & 63 | 128, 63 & s | 128), null !== a && (n > t && (o += e.substring(t, n)), o += a, t = n = i + 1);\n    }\n    return n > t && (o += e.substring(t, e.length)), o;\n  },\n  se = (ie = function () {\n    for (var e = new Date().valueOf(), t = 0; e == new Date().valueOf();) t++;\n    return e.toString(16) + t.toString(16);\n  }, function (e) {\n    if (\"v7\" === e) return F().toString();\n    var t = \"undefined\" != typeof window ? (window.screen.height * window.screen.width).toString(16) : \"0\";\n    return ie() + \"-\" + Math.random().toString(16).replace(\".\", \"\") + \"-\" + function () {\n      var e,\n        t,\n        n = A,\n        r = 0,\n        i = [];\n      function o(e, t) {\n        var n,\n          r = 0;\n        for (n = 0; n < t.length; n++) r |= i[n] << 8 * n;\n        return e ^ r;\n      }\n      for (e = 0; e < n.length; e++) t = n.charCodeAt(e), i.unshift(255 & t), i.length >= 4 && (r = o(r, i), i = []);\n      return i.length > 0 && (r = o(r, i)), r.toString(16);\n    }() + \"-\" + t + \"-\" + ie();\n  }),\n  ae = function (e) {\n    return !!/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp|ahrefsbot|facebookexternalhit|facebookcatalog|applebot|semrushbot|duckduckbot|twitterbot|rogerbot|linkedinbot|mj12bot|sitebulb|bot.htm|bot.php|hubspot|crawler|prerender)/i.test(e);\n  },\n  ce = function (e, t) {\n    var n = t.replace(/[[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\"),\n      r = new RegExp(\"[\\\\?&]\" + n + \"=([^&#]*)\").exec(e);\n    if (null === r || r && \"string\" != typeof r[1] && r[1].length) return \"\";\n    var i = r[1];\n    try {\n      i = decodeURIComponent(i);\n    } catch (e) {\n      q.error(\"Skipping decoding for malformed query param: \" + i);\n    }\n    return i.replace(/\\+/g, \" \");\n  },\n  ue = function (e, t) {\n    var n = e.match(new RegExp(t + \"=([^&]*)\"));\n    return n ? n[1] : null;\n  },\n  le = function () {\n    function e(t) {\n      return t && (t.preventDefault = e.preventDefault, t.stopPropagation = e.stopPropagation), t;\n    }\n    return e.preventDefault = function () {\n      this.returnValue = !1;\n    }, e.stopPropagation = function () {\n      this.cancelBubble = !0;\n    }, function (t, n, r, i, o) {\n      if (t) {\n        if (t.addEventListener && !i) t.addEventListener(n, r, !!o);else {\n          var s = \"on\" + n,\n            a = t[s];\n          t[s] = function (t, n, r) {\n            return function (i) {\n              if (i = i || e(window.event)) {\n                var o,\n                  s = !0;\n                G(r) && (o = r(i));\n                var a = n.call(t, i);\n                return !1 !== o && !1 !== a || (s = !1), s;\n              }\n            };\n          }(t, r, a);\n        }\n      } else q.error(\"No valid element provided to register_event\");\n    };\n  }();\nfunction de(e, t) {\n  var n = function () {\n    var n = M.createElement(\"script\");\n    n.type = \"text/javascript\", n.src = e, n.onload = function (e) {\n      return t(void 0, e);\n    }, n.onerror = function (e) {\n      return t(e);\n    };\n    var r,\n      i = M.querySelectorAll(\"body > script\");\n    i.length > 0 ? null === (r = i[0].parentNode) || void 0 === r || r.insertBefore(n, i[0]) : M.body.appendChild(n);\n  };\n  M.body ? n() : M.addEventListener(\"DOMContentLoaded\", n);\n}\nvar pe = {\n  campaignParams: function (e) {\n    var t = [\"utm_source\", \"utm_medium\", \"utm_campaign\", \"utm_content\", \"utm_term\", \"gclid\", \"fbclid\", \"msclkid\"].concat(e || []),\n      n = {};\n    return U(t, function (e) {\n      var t = ce(M.URL, e);\n      t.length && (n[e] = t);\n    }), n;\n  },\n  searchEngine: function () {\n    var e = M.referrer;\n    return e ? 0 === e.search(\"https?://(.*)google.([^/?]*)\") ? \"google\" : 0 === e.search(\"https?://(.*)bing.com\") ? \"bing\" : 0 === e.search(\"https?://(.*)yahoo.com\") ? \"yahoo\" : 0 === e.search(\"https?://(.*)duckduckgo.com\") ? \"duckduckgo\" : null : null;\n  },\n  searchInfo: function () {\n    var e = pe.searchEngine(),\n      t = \"yahoo\" != e ? \"q\" : \"p\",\n      n = {};\n    if (null !== e) {\n      n.$search_engine = e;\n      var r = ce(M.referrer, t);\n      r.length && (n.ph_keyword = r);\n    }\n    return n;\n  },\n  browser: function (e, t, n) {\n    return t = t || \"\", n || W(e, \" OPR/\") ? W(e, \"Mini\") ? \"Opera Mini\" : \"Opera\" : /(BlackBerry|PlayBook|BB10)/i.test(e) ? \"BlackBerry\" : W(e, \"IEMobile\") || W(e, \"WPDesktop\") ? \"Internet Explorer Mobile\" : W(e, \"SamsungBrowser/\") ? \"Samsung Internet\" : W(e, \"Edge\") || W(e, \"Edg/\") ? \"Microsoft Edge\" : W(e, \"FBIOS\") ? \"Facebook Mobile\" : W(e, \"Chrome\") ? \"Chrome\" : W(e, \"CriOS\") ? \"Chrome iOS\" : W(e, \"UCWEB\") || W(e, \"UCBrowser\") ? \"UC Browser\" : W(e, \"FxiOS\") ? \"Firefox iOS\" : W(t, \"Apple\") ? W(e, \"Mobile\") ? \"Mobile Safari\" : \"Safari\" : W(e, \"Android\") ? \"Android Mobile\" : W(e, \"Konqueror\") ? \"Konqueror\" : W(e, \"Firefox\") ? \"Firefox\" : W(e, \"MSIE\") || W(e, \"Trident/\") ? \"Internet Explorer\" : W(e, \"Gecko\") ? \"Mozilla\" : \"\";\n  },\n  browserVersion: function (e, t, n) {\n    var r = {\n      \"Internet Explorer Mobile\": /rv:(\\d+(\\.\\d+)?)/,\n      \"Microsoft Edge\": /Edge?\\/(\\d+(\\.\\d+)?)/,\n      Chrome: /Chrome\\/(\\d+(\\.\\d+)?)/,\n      \"Chrome iOS\": /CriOS\\/(\\d+(\\.\\d+)?)/,\n      \"UC Browser\": /(UCBrowser|UCWEB)\\/(\\d+(\\.\\d+)?)/,\n      Safari: /Version\\/(\\d+(\\.\\d+)?)/,\n      \"Mobile Safari\": /Version\\/(\\d+(\\.\\d+)?)/,\n      Opera: /(Opera|OPR)\\/(\\d+(\\.\\d+)?)/,\n      Firefox: /Firefox\\/(\\d+(\\.\\d+)?)/,\n      \"Firefox iOS\": /FxiOS\\/(\\d+(\\.\\d+)?)/,\n      Konqueror: /Konqueror:(\\d+(\\.\\d+)?)/,\n      BlackBerry: /BlackBerry (\\d+(\\.\\d+)?)/,\n      \"Android Mobile\": /android\\s(\\d+(\\.\\d+)?)/,\n      \"Samsung Internet\": /SamsungBrowser\\/(\\d+(\\.\\d+)?)/,\n      \"Internet Explorer\": /(rv:|MSIE )(\\d+(\\.\\d+)?)/,\n      Mozilla: /rv:(\\d+(\\.\\d+)?)/\n    }[pe.browser(e, t, n)];\n    if (void 0 === r) return null;\n    var i = e.match(r);\n    return i ? parseFloat(i[i.length - 2]) : null;\n  },\n  browserLanguage: function () {\n    return T.language || T.userLanguage;\n  },\n  os: function (e) {\n    if (/Windows/i.test(e)) {\n      if (/Phone/.test(e) || /WPDesktop/.test(e)) return {\n        os_name: \"Windows Phone\",\n        os_version: \"\"\n      };\n      var t = /Windows NT ([0-9.]+)/i.exec(e);\n      return t && t[1] ? {\n        os_name: \"Windows\",\n        os_version: t[1]\n      } : {\n        os_name: \"Windows\",\n        os_version: \"\"\n      };\n    }\n    if (/(iPhone|iPad|iPod)/.test(e)) {\n      var n = /OS (\\d+)_(\\d+)_?(\\d+)?/i.exec(e);\n      return n && n[1] ? {\n        os_name: \"iOS\",\n        os_version: [n[1], n[2], n[3] || \"0\"].join(\".\")\n      } : {\n        os_name: \"iOS\",\n        os_version: \"\"\n      };\n    }\n    if (/Android/.test(e)) {\n      var r = /Android (\\d+)\\.(\\d+)\\.?(\\d+)?/i.exec(e);\n      return r && r[1] ? {\n        os_name: \"Android\",\n        os_version: [r[1], r[2], r[3] || \"0\"].join(\".\")\n      } : {\n        os_name: \"Android\",\n        os_version: \"\"\n      };\n    }\n    if (/(BlackBerry|PlayBook|BB10)/i.test(e)) return {\n      os_name: \"BlackBerry\",\n      os_version: \"\"\n    };\n    if (/Mac/i.test(e)) {\n      var i = /Mac OS X (\\d+)[_.](\\d+)[_.]?(\\d+)?/i.exec(e);\n      return i && i[1] ? {\n        os_name: \"Mac OS X\",\n        os_version: [i[1], i[2], i[3] || \"0\"].join(\".\")\n      } : {\n        os_name: \"Mac OS X\",\n        os_version: \"\"\n      };\n    }\n    return /Linux/.test(e) ? {\n      os_name: \"Linux\",\n      os_version: \"\"\n    } : /CrOS/.test(e) ? {\n      os_name: \"Chrome OS\",\n      os_version: \"\"\n    } : {\n      os_name: \"\",\n      os_version: \"\"\n    };\n  },\n  device: function (e) {\n    return /Windows Phone/i.test(e) || /WPDesktop/.test(e) ? \"Windows Phone\" : /iPad/.test(e) ? \"iPad\" : /iPod/.test(e) ? \"iPod Touch\" : /iPhone/.test(e) ? \"iPhone\" : /(BlackBerry|PlayBook|BB10)/i.test(e) ? \"BlackBerry\" : /Android/.test(e) && !/Mobile/.test(e) ? \"Android Tablet\" : /Android/.test(e) ? \"Android\" : \"\";\n  },\n  deviceType: function (e) {\n    var t = this.device(e);\n    return \"iPad\" === t || \"Android Tablet\" === t ? \"Tablet\" : t ? \"Mobile\" : \"Desktop\";\n  },\n  referrer: function () {\n    return M.referrer || \"$direct\";\n  },\n  referringDomain: function () {\n    if (!M.referrer) return \"$direct\";\n    var e = M.createElement(\"a\");\n    return e.href = M.referrer, e.host;\n  },\n  properties: function () {\n    var e = pe.os(A),\n      t = e.os_name,\n      n = e.os_version;\n    return B(ee({\n      $os: t,\n      $os_version: n,\n      $browser: pe.browser(A, T.vendor, $.opera),\n      $device: pe.device(A),\n      $device_type: pe.deviceType(A)\n    }), {\n      $current_url: null == $ ? void 0 : $.location.href,\n      $host: null == $ ? void 0 : $.location.host,\n      $pathname: null == $ ? void 0 : $.location.pathname,\n      $browser_version: pe.browserVersion(A, T.vendor, $.opera),\n      $browser_language: pe.browserLanguage(),\n      $screen_height: null == $ ? void 0 : $.screen.height,\n      $screen_width: null == $ ? void 0 : $.screen.width,\n      $viewport_height: null == $ ? void 0 : $.innerHeight,\n      $viewport_width: null == $ ? void 0 : $.innerWidth,\n      $lib: \"web\",\n      $lib_version: y.LIB_VERSION,\n      $insert_id: Math.random().toString(36).substring(2, 10) + Math.random().toString(36).substring(2, 10),\n      $time: (Date.now = Date.now || function () {\n        return +new Date();\n      }, Date.now() / 1e3)\n    });\n  },\n  people_properties: function () {\n    var e = pe.os(A),\n      t = e.os_name,\n      n = e.os_version;\n    return B(ee({\n      $os: t,\n      $os_version: n,\n      $browser: pe.browser(A, T.vendor, $.opera)\n    }), {\n      $browser_version: pe.browserVersion(A, T.vendor, $.opera)\n    });\n  }\n};\nfunction fe(e) {\n  switch (n(e.className)) {\n    case \"string\":\n      return e.className;\n    case \"object\":\n      return (\"baseVal\" in e.className ? e.className.baseVal : null) || e.getAttribute(\"class\") || \"\";\n    default:\n      return \"\";\n  }\n}\nfunction he(e) {\n  var t = \"\";\n  return be(e) && !we(e) && e.childNodes && e.childNodes.length && U(e.childNodes, function (e) {\n    ve(e) && e.textContent && (t += H(e.textContent).split(/(\\s+)/).filter(ke).join(\"\").replace(/[\\r\\n]/g, \" \").replace(/[ ]+/g, \" \").substring(0, 255));\n  }), H(t);\n}\nfunction _e(e) {\n  return !!e && 1 === e.nodeType;\n}\nfunction ge(e, t) {\n  return !!e && !!e.tagName && e.tagName.toLowerCase() === t.toLowerCase();\n}\nfunction ve(e) {\n  return !!e && 3 === e.nodeType;\n}\nfunction ye(e) {\n  return !!e && 11 === e.nodeType;\n}\nvar me = [\"a\", \"button\", \"form\", \"input\", \"select\", \"textarea\", \"label\"];\nfunction be(e) {\n  for (var t = e; t.parentNode && !ge(t, \"body\"); t = t.parentNode) {\n    var n = fe(t).split(\" \");\n    if (W(n, \"ph-sensitive\") || W(n, \"ph-no-capture\")) return !1;\n  }\n  if (W(fe(e).split(\" \"), \"ph-include\")) return !0;\n  var r = e.type || \"\";\n  if (\"string\" == typeof r) switch (r.toLowerCase()) {\n    case \"hidden\":\n    case \"password\":\n      return !1;\n  }\n  var i = e.name || e.id || \"\";\n  if (\"string\" == typeof i) {\n    if (/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(i.replace(/[^a-zA-Z0-9]/g, \"\"))) return !1;\n  }\n  return !0;\n}\nfunction we(e) {\n  return !!(ge(e, \"input\") && ![\"button\", \"checkbox\", \"submit\", \"reset\"].includes(e.type) || ge(e, \"select\") || ge(e, \"textarea\") || \"true\" === e.getAttribute(\"contenteditable\"));\n}\nfunction ke(e) {\n  if (null === e || Q(e)) return !1;\n  if (\"string\" == typeof e) {\n    e = H(e);\n    if (/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((e || \"\").replace(/[- ]/g, \"\"))) return !1;\n    if (/(^\\d{3}-?\\d{2}-?\\d{4}$)/.test(e)) return !1;\n  }\n  return !0;\n}\nfunction Se(e) {\n  var t = he(e);\n  return ke(t = \"\".concat(t, \" \").concat(Ee(e)).trim()) ? t : \"\";\n}\nfunction Ee(e) {\n  var t = \"\";\n  return e && e.childNodes && e.childNodes.length && U(e.childNodes, function (e) {\n    var n;\n    if (e && \"span\" === (null === (n = e.tagName) || void 0 === n ? void 0 : n.toLowerCase())) try {\n      var r = he(e);\n      t = \"\".concat(t, \" \").concat(r).trim(), e.childNodes && e.childNodes.length && (t = \"\".concat(t, \" \").concat(Ee(e)).trim());\n    } catch (e) {\n      console.error(e);\n    }\n  }), t;\n}\nvar Fe = function () {\n    function e(t) {\n      r(this, e), this.clicks = [], this.enabled = t;\n    }\n    return o(e, [{\n      key: \"isRageClick\",\n      value: function (e, t, n) {\n        if (!this.enabled) return !1;\n        var r = this.clicks[this.clicks.length - 1];\n        if (r && Math.abs(e - r.x) + Math.abs(t - r.y) < 30 && n - r.timestamp < 1e3) {\n          if (this.clicks.push({\n            x: e,\n            y: t,\n            timestamp: n\n          }), 3 === this.clicks.length) return !0;\n        } else this.clicks = [{\n          x: e,\n          y: t,\n          timestamp: n\n        }];\n        return !1;\n      }\n    }]), e;\n  }(),\n  xe = /[a-z0-9][a-z0-9-]+\\.[a-z.]{2,6}$/i,\n  Pe = {\n    is_supported: function () {\n      return !0;\n    },\n    error: function (e) {\n      q.error(\"cookieStore error: \" + e);\n    },\n    get: function (e) {\n      try {\n        for (var t = e + \"=\", n = document.cookie.split(\";\"), r = 0; r < n.length; r++) {\n          for (var i = n[r]; \" \" == i.charAt(0);) i = i.substring(1, i.length);\n          if (0 === i.indexOf(t)) return decodeURIComponent(i.substring(t.length, i.length));\n        }\n      } catch (e) {}\n      return null;\n    },\n    parse: function (e) {\n      var t;\n      try {\n        t = JSON.parse(Pe.get(e)) || {};\n      } catch (e) {}\n      return t;\n    },\n    set: function (e, t, n, r, i) {\n      try {\n        var o = \"\",\n          s = \"\",\n          a = \"\";\n        if (r) {\n          var c = document.location.hostname.match(xe),\n            u = c ? c[0] : \"\";\n          o = u ? \"; domain=.\" + u : \"\";\n        }\n        if (n) {\n          var l = new Date();\n          l.setTime(l.getTime() + 24 * n * 60 * 60 * 1e3), s = \"; expires=\" + l.toUTCString();\n        }\n        i && (a = \"; secure\");\n        var d = e + \"=\" + encodeURIComponent(JSON.stringify(t)) + s + \"; SameSite=Lax; path=/\" + o + a;\n        return document.cookie = d, d;\n      } catch (e) {\n        return;\n      }\n    },\n    remove: function (e, t) {\n      try {\n        Pe.set(e, \"\", -1, t);\n      } catch (e) {\n        return;\n      }\n    }\n  },\n  Oe = null,\n  Ie = {\n    is_supported: function () {\n      if (null !== Oe) return Oe;\n      var e = !0;\n      if (\"undefined\" != typeof window) try {\n        var t = \"__mplssupport__\";\n        Ie.set(t, \"xyz\"), '\"xyz\"' !== Ie.get(t) && (e = !1), Ie.remove(t);\n      } catch (t) {\n        e = !1;\n      } else e = !1;\n      return e || q.error(\"localStorage unsupported; falling back to cookie store\"), Oe = e, e;\n    },\n    error: function (e) {\n      q.error(\"localStorage error: \" + e);\n    },\n    get: function (e) {\n      try {\n        return window.localStorage.getItem(e);\n      } catch (e) {\n        Ie.error(e);\n      }\n      return null;\n    },\n    parse: function (e) {\n      try {\n        return JSON.parse(Ie.get(e)) || {};\n      } catch (e) {}\n      return null;\n    },\n    set: function (e, t) {\n      try {\n        window.localStorage.setItem(e, JSON.stringify(t));\n      } catch (e) {\n        Ie.error(e);\n      }\n    },\n    remove: function (e) {\n      try {\n        window.localStorage.removeItem(e);\n      } catch (e) {\n        Ie.error(e);\n      }\n    }\n  },\n  $e = t(t({}, Ie), {}, {\n    parse: function (e) {\n      try {\n        var t = {};\n        try {\n          (t = Pe.parse(e) || {}).distinct_id && Pe.set(e, {\n            distinct_id: t.distinct_id\n          });\n        } catch (e) {}\n        var n = B(t, JSON.parse(Ie.get(e) || \"{}\"));\n        return Ie.set(e, n), n;\n      } catch (e) {}\n      return null;\n    },\n    set: function (e, t, n, r, i) {\n      try {\n        Ie.set(e, t), t.distinct_id && Pe.set(e, {\n          distinct_id: t.distinct_id\n        }, n, r, i);\n      } catch (e) {\n        Ie.error(e);\n      }\n    },\n    remove: function (e, t) {\n      try {\n        window.localStorage.removeItem(e), Pe.remove(e, t);\n      } catch (e) {\n        Ie.error(e);\n      }\n    }\n  }),\n  Te = {},\n  Me = {\n    is_supported: function () {\n      return !0;\n    },\n    error: function (e) {\n      q.error(\"memoryStorage error: \" + e);\n    },\n    get: function (e) {\n      return Te[e] || null;\n    },\n    parse: function (e) {\n      return Te[e] || null;\n    },\n    set: function (e, t) {\n      Te[e] = t;\n    },\n    remove: function (e) {\n      delete Te[e];\n    }\n  },\n  Ae = null,\n  Re = {\n    is_supported: function () {\n      if (null !== Ae) return Ae;\n      if (Ae = !0, \"undefined\" != typeof window) try {\n        var e = \"__support__\";\n        Re.set(e, \"xyz\"), '\"xyz\"' !== Re.get(e) && (Ae = !1), Re.remove(e);\n      } catch (e) {\n        Ae = !1;\n      } else Ae = !1;\n      return Ae;\n    },\n    error: function (e) {\n      y.DEBUG && q.error(\"sessionStorage error: \", e);\n    },\n    get: function (e) {\n      try {\n        return window.sessionStorage.getItem(e);\n      } catch (e) {\n        Re.error(e);\n      }\n      return null;\n    },\n    parse: function (e) {\n      try {\n        return JSON.parse(Re.get(e)) || null;\n      } catch (e) {}\n      return null;\n    },\n    set: function (e, t) {\n      try {\n        window.sessionStorage.setItem(e, JSON.stringify(t));\n      } catch (e) {\n        Re.error(e);\n      }\n    },\n    remove: function (e) {\n      try {\n        window.sessionStorage.removeItem(e);\n      } catch (e) {\n        Re.error(e);\n      }\n    }\n  },\n  Ce = \"$people_distinct_id\",\n  je = \"__alias\",\n  De = \"__timers\",\n  Ne = \"$autocapture_disabled_server_side\",\n  qe = \"$session_recording_enabled_server_side\",\n  He = \"$console_log_recording_enabled_server_side\",\n  Le = \"$session_recording_recorder_version_server_side\",\n  Ue = \"$sesid\",\n  Be = \"$enabled_feature_flags\",\n  Ve = \"$early_access_features\",\n  Ge = \"$stored_person_properties\",\n  We = \"$stored_group_properties\",\n  ze = \"$surveys\",\n  Qe = \"$flag_call_reported\",\n  Je = \"$user_state\",\n  Xe = [Ce, je, \"__cmpns\", De, qe, Ue, Be, Je, Ve, We, Ge, ze, Qe],\n  Ye = [\"cookie\", \"localstorage\", \"localstorage+cookie\", \"sessionstorage\", \"memory\"],\n  Ze = function () {\n    function e(t) {\n      r(this, e);\n      var n = \"\";\n      t.token && (n = t.token.replace(/\\+/g, \"PL\").replace(/\\//g, \"SL\").replace(/=/g, \"EQ\")), this.props = {}, this.campaign_params_saved = !1, this.custom_campaign_params = t.custom_campaign_params || [], t.persistence_name ? this.name = \"ph_\" + t.persistence_name : this.name = \"ph_\" + n + \"_posthog\", -1 === Ye.indexOf(t.persistence.toLowerCase()) && (q.critical(\"Unknown persistence type \" + t.persistence + \"; falling back to cookie\"), t.persistence = \"cookie\");\n      var i = t.persistence.toLowerCase();\n      \"localstorage\" === i && Ie.is_supported() ? this.storage = Ie : \"localstorage+cookie\" === i && $e.is_supported() ? this.storage = $e : \"sessionstorage\" === i && Re.is_supported() ? this.storage = Re : this.storage = \"memory\" === i ? Me : Pe, this.user_state = \"anonymous\", this.load(), this.update_config(t), this.save();\n    }\n    return o(e, [{\n      key: \"properties\",\n      value: function () {\n        var e = {};\n        return U(this.props, function (t, r) {\n          if (r === Be && \"object\" === n(t)) for (var i = Object.keys(t), o = 0; o < i.length; o++) e[\"$feature/\".concat(i[o])] = t[i[o]];else a = r, c = !1, (null === (s = Xe) ? c : j && s.indexOf === j ? -1 != s.indexOf(a) : (U(s, function (e) {\n            if (c || (c = e === a)) return N;\n          }), c)) || (e[r] = t);\n          var s, a, c;\n        }), e;\n      }\n    }, {\n      key: \"load\",\n      value: function () {\n        if (!this.disabled) {\n          var e = this.storage.parse(this.name);\n          e && (this.props = B({}, e));\n        }\n      }\n    }, {\n      key: \"save\",\n      value: function () {\n        this.disabled || this.storage.set(this.name, this.props, this.expire_days, this.cross_subdomain, this.secure);\n      }\n    }, {\n      key: \"remove\",\n      value: function () {\n        this.storage.remove(this.name, !1), this.storage.remove(this.name, !0);\n      }\n    }, {\n      key: \"clear\",\n      value: function () {\n        this.remove(), this.props = {};\n      }\n    }, {\n      key: \"register_once\",\n      value: function (e, t, n) {\n        var r = this;\n        if (z(e)) {\n          void 0 === t && (t = \"None\"), this.expire_days = void 0 === n ? this.default_expiry : n;\n          var i = !1;\n          if (U(e, function (e, n) {\n            r.props.hasOwnProperty(n) && r.props[n] !== t || (r.props[n] = e, i = !0);\n          }), i) return this.save(), !0;\n        }\n        return !1;\n      }\n    }, {\n      key: \"register\",\n      value: function (e, t) {\n        var n = this;\n        if (z(e)) {\n          this.expire_days = void 0 === t ? this.default_expiry : t;\n          var r = !1;\n          if (U(e, function (t, i) {\n            e.hasOwnProperty(i) && n.props[i] !== t && (n.props[i] = t, r = !0);\n          }), r) return this.save(), !0;\n        }\n        return !1;\n      }\n    }, {\n      key: \"unregister\",\n      value: function (e) {\n        e in this.props && (delete this.props[e], this.save());\n      }\n    }, {\n      key: \"update_campaign_params\",\n      value: function () {\n        this.campaign_params_saved || (this.register(pe.campaignParams(this.custom_campaign_params)), this.campaign_params_saved = !0);\n      }\n    }, {\n      key: \"update_search_keyword\",\n      value: function () {\n        this.register(pe.searchInfo());\n      }\n    }, {\n      key: \"update_referrer_info\",\n      value: function () {\n        this.register({\n          $referrer: this.props.$referrer || pe.referrer(),\n          $referring_domain: this.props.$referring_domain || pe.referringDomain()\n        });\n      }\n    }, {\n      key: \"get_referrer_info\",\n      value: function () {\n        return ee({\n          $referrer: this.props.$referrer,\n          $referring_domain: this.props.$referring_domain\n        });\n      }\n    }, {\n      key: \"safe_merge\",\n      value: function (e) {\n        return U(this.props, function (t, n) {\n          n in e || (e[n] = t);\n        }), e;\n      }\n    }, {\n      key: \"update_config\",\n      value: function (e) {\n        this.default_expiry = this.expire_days = e.cookie_expiration, this.set_disabled(e.disable_persistence), this.set_cross_subdomain(e.cross_subdomain_cookie), this.set_secure(e.secure_cookie);\n      }\n    }, {\n      key: \"set_disabled\",\n      value: function (e) {\n        this.disabled = e, this.disabled ? this.remove() : this.save();\n      }\n    }, {\n      key: \"set_cross_subdomain\",\n      value: function (e) {\n        e !== this.cross_subdomain && (this.cross_subdomain = e, this.remove(), this.save());\n      }\n    }, {\n      key: \"get_cross_subdomain\",\n      value: function () {\n        return !!this.cross_subdomain;\n      }\n    }, {\n      key: \"set_secure\",\n      value: function (e) {\n        e !== this.secure && (this.secure = e, this.remove(), this.save());\n      }\n    }, {\n      key: \"set_event_timer\",\n      value: function (e, t) {\n        var n = this.props[De] || {};\n        n[e] = t, this.props[De] = n, this.save();\n      }\n    }, {\n      key: \"remove_event_timer\",\n      value: function (e) {\n        var t = (this.props[De] || {})[e];\n        return Q(t) || (delete this.props[De][e], this.save()), t;\n      }\n    }, {\n      key: \"get_user_state\",\n      value: function () {\n        return this.props[Je] || \"anonymous\";\n      }\n    }, {\n      key: \"set_user_state\",\n      value: function (e) {\n        this.props[Je] = e, this.save();\n      }\n    }]), e;\n  }(),\n  Ke = {\n    _initializedTokens: [],\n    _isAutocaptureEnabled: !1,\n    _setIsAutocaptureEnabled: function (e) {\n      var t = !!e.get_property(Ne),\n        n = !!e.get_config(\"autocapture\");\n      this._isAutocaptureEnabled = n && !t;\n    },\n    _previousElementSibling: function (e) {\n      if (e.previousElementSibling) return e.previousElementSibling;\n      var t = e;\n      do {\n        t = t.previousSibling;\n      } while (t && !_e(t));\n      return t;\n    },\n    _getAugmentPropertiesFromElement: function (e) {\n      if (!be(e)) return {};\n      var t = {};\n      return U(e.attributes, function (e) {\n        if (0 === e.name.indexOf(\"data-ph-capture-attribute\")) {\n          var n = e.name.replace(\"data-ph-capture-attribute-\", \"\"),\n            r = e.value;\n          n && r && ke(r) && (t[n] = r);\n        }\n      }), t;\n    },\n    _getPropertiesFromElement: function (e, t, n) {\n      var r = e.tagName.toLowerCase(),\n        i = {\n          tag_name: r\n        };\n      me.indexOf(r) > -1 && !n && (\"a\" === r.toLowerCase() || \"button\" === r.toLowerCase() ? i.$el_text = Se(e) : i.$el_text = he(e));\n      var o = fe(e);\n      o.length > 0 && (i.classes = o.split(\" \").filter(function (e) {\n        return \"\" !== e;\n      })), U(e.attributes, function (n) {\n        var r;\n        we(e) && -1 === [\"name\", \"id\", \"class\"].indexOf(n.name) || !t && ke(n.value) && (\"string\" != typeof (r = n.name) || \"_ngcontent\" !== r.substring(0, 10) && \"_nghost\" !== r.substring(0, 7)) && (i[\"attr__\" + n.name] = n.value);\n      });\n      for (var s = 1, a = 1, c = e; c = this._previousElementSibling(c);) s++, c.tagName === e.tagName && a++;\n      return i.nth_child = s, i.nth_of_type = a, i;\n    },\n    _getDefaultProperties: function (e) {\n      return {\n        $event_type: e,\n        $ce_version: 1\n      };\n    },\n    _extractCustomPropertyValue: function (e) {\n      var t = [];\n      return U(document.querySelectorAll(e.css_selector), function (e) {\n        var n;\n        [\"input\", \"select\"].indexOf(e.tagName.toLowerCase()) > -1 ? n = e.value : e.textContent && (n = e.textContent), ke(n) && t.push(n);\n      }), t.join(\", \");\n    },\n    _getCustomProperties: function (e) {\n      var t = this,\n        n = {};\n      return U(this._customProperties, function (r) {\n        U(r.event_selectors, function (i) {\n          U(document.querySelectorAll(i), function (i) {\n            W(e, i) && be(i) && (n[r.name] = t._extractCustomPropertyValue(r));\n          });\n        });\n      }), n;\n    },\n    _getEventTarget: function (e) {\n      return void 0 === e.target ? e.srcElement || null : null !== (t = e.target) && void 0 !== t && t.shadowRoot ? e.composedPath()[0] || null : e.target || null;\n      var t;\n    },\n    _captureEvent: function (e, t) {\n      var n,\n        r = this,\n        i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : \"$autocapture\",\n        o = this._getEventTarget(e);\n      (ve(o) && (o = o.parentNode || null), \"$autocapture\" === i && \"click\" === e.type && e instanceof MouseEvent) && null !== (n = this.rageclicks) && void 0 !== n && n.isRageClick(e.clientX, e.clientY, new Date().getTime()) && this._captureEvent(e, t, \"$rageclick\");\n      if (o && function (e, t) {\n        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : void 0;\n        if (!e || ge(e, \"html\") || !_e(e)) return !1;\n        if (null != n && n.url_allowlist) {\n          var r = window.location.href,\n            i = n.url_allowlist;\n          if (i && !i.some(function (e) {\n            return r.match(e);\n          })) return !1;\n        }\n        if (null != n && n.dom_event_allowlist) {\n          var o = n.dom_event_allowlist;\n          if (o && !o.some(function (e) {\n            return t.type === e;\n          })) return !1;\n        }\n        if (null != n && n.element_allowlist) {\n          var s = n.element_allowlist;\n          if (s && !s.some(function (t) {\n            return e.tagName.toLowerCase() === t;\n          })) return !1;\n        }\n        if (null != n && n.css_selector_allowlist) {\n          var a = n.css_selector_allowlist;\n          if (a && !a.some(function (t) {\n            return e.matches(t);\n          })) return !1;\n        }\n        for (var c = !1, u = [e], l = !0, d = e; d.parentNode && !ge(d, \"body\");) if (ye(d.parentNode)) u.push(d.parentNode.host), d = d.parentNode.host;else {\n          if (!(l = d.parentNode || !1)) break;\n          if (me.indexOf(l.tagName.toLowerCase()) > -1) c = !0;else {\n            var p = window.getComputedStyle(l);\n            p && \"pointer\" === p.getPropertyValue(\"cursor\") && (c = !0);\n          }\n          u.push(l), d = l;\n        }\n        var f = window.getComputedStyle(e);\n        if (f && \"pointer\" === f.getPropertyValue(\"cursor\") && \"click\" === t.type) return !0;\n        var h = e.tagName.toLowerCase();\n        switch (h) {\n          case \"html\":\n            return !1;\n          case \"form\":\n            return \"submit\" === t.type;\n          case \"input\":\n          case \"select\":\n          case \"textarea\":\n            return \"change\" === t.type || \"click\" === t.type;\n          default:\n            return c ? \"click\" === t.type : \"click\" === t.type && (me.indexOf(h) > -1 || \"true\" === e.getAttribute(\"contenteditable\"));\n        }\n      }(o, e, this.config)) {\n        for (var s = [o], a = o; a.parentNode && !ge(a, \"body\");) ye(a.parentNode) ? (s.push(a.parentNode.host), a = a.parentNode.host) : (s.push(a.parentNode), a = a.parentNode);\n        var c,\n          u = [],\n          l = {},\n          d = !1;\n        if (U(s, function (e) {\n          var n = be(e);\n          \"a\" === e.tagName.toLowerCase() && (c = e.getAttribute(\"href\"), c = n && ke(c) && c), W(fe(e).split(\" \"), \"ph-no-capture\") && (d = !0), u.push(r._getPropertiesFromElement(e, t.get_config(\"mask_all_element_attributes\"), t.get_config(\"mask_all_text\")));\n          var i = r._getAugmentPropertiesFromElement(e);\n          B(l, i);\n        }), t.get_config(\"mask_all_text\") || (\"a\" === o.tagName.toLowerCase() || \"button\" === o.tagName.toLowerCase() ? u[0].$el_text = Se(o) : u[0].$el_text = he(o)), c && (u[0].attr__href = c), d) return !1;\n        var p = B(this._getDefaultProperties(e.type), {\n          $elements: u\n        }, this._getCustomProperties(s), l);\n        return t.capture(i, p), !0;\n      }\n    },\n    _navigate: function (e) {\n      window.location.href = e;\n    },\n    _addDomEventHandlers: function (e) {\n      var t = this,\n        n = function (n) {\n          n = n || window.event, t._captureEvent(n, e);\n        };\n      le(document, \"submit\", n, !1, !0), le(document, \"change\", n, !1, !0), le(document, \"click\", n, !1, !0);\n    },\n    _customProperties: [],\n    rageclicks: null,\n    config: void 0,\n    init: function (e) {\n      var t;\n      \"boolean\" != typeof e.__autocapture && (this.config = e.__autocapture), null !== (t = this.config) && void 0 !== t && t.url_allowlist && (this.config.url_allowlist = this.config.url_allowlist.map(function (e) {\n        return new RegExp(e);\n      })), this.rageclicks = new Fe(e.get_config(\"rageclick\"));\n    },\n    afterDecideResponse: function (e, t) {\n      this._setIsAutocaptureEnabled(t);\n      var n = t.get_config(\"token\");\n      this._initializedTokens.indexOf(n) > -1 ? q.log('autocapture already initialized for token \"' + n + '\"') : (t.persistence && t.persistence.register(s({}, Ne, !!e.autocapture_opt_out)), this._initializedTokens.push(n), e && e.config && e.config.enable_collect_everything && this._isAutocaptureEnabled ? (e.custom_properties && (this._customProperties = e.custom_properties), this._addDomEventHandlers(t)) : t.__autocapture = !1);\n    },\n    enabledForProject: function (e, t, n) {\n      if (!e) return !0;\n      t = Q(t) ? 10 : t, n = Q(n) ? 10 : n;\n      for (var r = 0, i = 0; i < e.length; i++) r += e.charCodeAt(i);\n      return r % t < n;\n    },\n    isBrowserSupported: function () {\n      return G(document.querySelectorAll);\n    }\n  };\n!function (e) {\n  for (var t in e) \"function\" == typeof e[t] && (e[t] = e[t].bind(e));\n}(Ke), function (e) {\n  for (var t in e) \"function\" == typeof e[t] && (e[t] = K(e[t]));\n}(Ke);\nvar et = \"__ph_opt_in_out_\";\nfunction tt(e, t) {\n  ut(!0, e, t);\n}\nfunction nt(e, t) {\n  ut(!1, e, t);\n}\nfunction rt(e, t) {\n  return \"1\" === ct(e, t);\n}\nfunction it(e, t) {\n  return !!function (e) {\n    if (e && e.respectDnt) {\n      var t = e && e.window || $,\n        n = t.navigator || {},\n        r = !1;\n      return U([n.doNotTrack, n.msDoNotTrack, t.doNotTrack], function (e) {\n        W([!0, 1, \"1\", \"yes\"], e) && (r = !0);\n      }), r;\n    }\n    return !1;\n  }(t) || \"0\" === ct(e, t);\n}\nfunction ot(e, t) {\n  st(t = t || {}).remove(at(e, t), !!t.crossSubdomainCookie);\n}\nfunction st(e) {\n  return \"localStorage\" === (e = e || {}).persistenceType ? Ie : \"localStorage+cookie\" === e.persistenceType ? $e : Pe;\n}\nfunction at(e, t) {\n  return ((t = t || {}).persistencePrefix || et) + e;\n}\nfunction ct(e, t) {\n  return st(t).get(at(e, t));\n}\nfunction ut(e, t, n) {\n  J(t) && t.length ? (st(n = n || {}).set(at(t, n), e ? 1 : 0, X(n.cookieExpiration) ? n.cookieExpiration : null, n.crossSubdomainCookie, n.secureCookie), n.capture && e && n.capture(n.captureEventName || \"$opt_in\", n.captureProperties || {}, {\n    send_instantly: !0\n  })) : console.error(\"gdpr.\" + (e ? \"optIn\" : \"optOut\") + \" called with an invalid token\");\n}\nfunction lt(e, t) {\n  var n = !1;\n  try {\n    var r = e.get_config(\"token\"),\n      i = e.get_config(\"respect_dnt\"),\n      o = e.get_config(\"opt_out_capturing_persistence_type\"),\n      s = e.get_config(\"opt_out_capturing_cookie_prefix\") || void 0,\n      a = e.get_config(\"window\");\n    r && (n = it(r, {\n      respectDnt: i,\n      persistenceType: o,\n      persistencePrefix: s,\n      window: a\n    }));\n  } catch (e) {\n    t || console.error(\"Unexpected error when checking capturing opt-out status: \" + e);\n  }\n  return n;\n}\nfunction dt(e, t, n) {\n  return function () {\n    for (var r = lt(e, n), i = arguments.length, o = new Array(i), s = 0; s < i; s++) o[s] = arguments[s];\n    if (!r) return t.apply(this, o);\n    var a = o[o.length - 1];\n    \"function\" == typeof a && a(0);\n  };\n}\nvar pt = \"$set\",\n  ft = function () {\n    function e(t) {\n      var n = this;\n      r(this, e), this._posthog = t, this.set = dt(t, function (e, t, r) {\n        var i = n.set_action(e, t);\n        return n._posthog.setPersonPropertiesForFlags(i.$set || {}), z(e) && (r = t), n._get_config(\"save_referrer\") && n._posthog.sessionPersistence.update_referrer_info(), i[pt] = B({}, pe.people_properties(), n._posthog.sessionPersistence.get_referrer_info(), i[pt]), n._send_request(i, r);\n      }), this.set_once = dt(t, function (e, t, r) {\n        var i = n.set_once_action(e, t);\n        return z(e) && (r = t), n._send_request(i, r);\n      });\n    }\n    return o(e, [{\n      key: \"toString\",\n      value: function () {\n        return this._posthog.toString() + \".people\";\n      }\n    }, {\n      key: \"_send_request\",\n      value: function (e, t) {\n        e.$token = this._get_config(\"token\"), e.$distinct_id = this._posthog.get_distinct_id();\n        var n = this._posthog.get_property(\"$device_id\"),\n          r = this._posthog.get_property(\"$user_id\"),\n          i = this._posthog.get_property(\"$had_persisted_distinct_id\");\n        n && (e.$device_id = n), r && (e.$user_id = r), i && (e.$had_persisted_distinct_id = i);\n        var o = Y(e),\n          s = ne(o, this._get_config(\"properties_string_max_length\")),\n          a = re(JSON.stringify(o));\n        return this._posthog._send_request(this._get_config(\"api_host\") + \"/engage/\", {\n          data: a\n        }, {}, this._posthog._prepare_callback(t, s)), s;\n      }\n    }, {\n      key: \"_get_config\",\n      value: function (e) {\n        return this._posthog.get_config(e);\n      }\n    }, {\n      key: \"_is_reserved_property\",\n      value: function (e) {\n        return \"$distinct_id\" === e || \"$token\" === e || \"$device_id\" === e || \"$user_id\" === e || \"$had_persisted_distinct_id\" === e;\n      }\n    }, {\n      key: \"set_action\",\n      value: function (e, t) {\n        return this.apiActionParser(pt, e, t);\n      }\n    }, {\n      key: \"set_once_action\",\n      value: function (e, t) {\n        return this.apiActionParser(\"$set_once\", e, t);\n      }\n    }, {\n      key: \"apiActionParser\",\n      value: function (e, t, n) {\n        var r = this,\n          i = {},\n          o = {};\n        return z(t) ? U(t, function (e, t) {\n          r._is_reserved_property(t) || (o[t] = e);\n        }) : o[t] = n, i[e] = o, i;\n      }\n    }]), e;\n  }(),\n  ht = \"$active_feature_flags\",\n  _t = \"$override_feature_flags\",\n  gt = \"$feature_flag_payloads\",\n  vt = function (e) {\n    var t,\n      n = {},\n      r = v(function (e) {\n        for (var t = Object.keys(e), n = t.length, r = new Array(n); n--;) r[n] = [t[n], e[t[n]]];\n        return r;\n      }(e || {}));\n    try {\n      for (r.s(); !(t = r.n()).done;) {\n        var i = f(t.value, 2),\n          o = i[0],\n          s = i[1];\n        s && (n[o] = s);\n      }\n    } catch (e) {\n      r.e(e);\n    } finally {\n      r.f();\n    }\n    return n;\n  },\n  yt = function () {\n    function e(t) {\n      r(this, e), this.instance = t, this._override_warning = !1, this.featureFlagEventHandlers = [], this.reloadFeatureFlagsQueued = !1, this.reloadFeatureFlagsInAction = !1;\n    }\n    return o(e, [{\n      key: \"getFlags\",\n      value: function () {\n        return Object.keys(this.getFlagVariants());\n      }\n    }, {\n      key: \"getFlagVariants\",\n      value: function () {\n        var e = this.instance.get_property(Be),\n          t = this.instance.get_property(_t);\n        if (!t) return e || {};\n        for (var n = B({}, e), r = Object.keys(t), i = 0; i < r.length; i++) !1 === t[r[i]] ? delete n[r[i]] : n[r[i]] = t[r[i]];\n        return this._override_warning || (console.warn(\"[PostHog] Overriding feature flags!\", {\n          enabledFlags: e,\n          overriddenFlags: t,\n          finalFlags: n\n        }), this._override_warning = !0), n;\n      }\n    }, {\n      key: \"getFlagPayloads\",\n      value: function () {\n        return this.instance.get_property(gt) || {};\n      }\n    }, {\n      key: \"reloadFeatureFlags\",\n      value: function () {\n        this.reloadFeatureFlagsQueued || (this.reloadFeatureFlagsQueued = !0, this._startReloadTimer());\n      }\n    }, {\n      key: \"setAnonymousDistinctId\",\n      value: function (e) {\n        this.$anon_distinct_id = e;\n      }\n    }, {\n      key: \"setReloadingPaused\",\n      value: function (e) {\n        this.reloadFeatureFlagsInAction = e;\n      }\n    }, {\n      key: \"resetRequestQueue\",\n      value: function () {\n        this.reloadFeatureFlagsQueued = !1;\n      }\n    }, {\n      key: \"_startReloadTimer\",\n      value: function () {\n        var e = this;\n        this.reloadFeatureFlagsQueued && !this.reloadFeatureFlagsInAction && setTimeout(function () {\n          !e.reloadFeatureFlagsInAction && e.reloadFeatureFlagsQueued && (e.reloadFeatureFlagsQueued = !1, e._reloadFeatureFlagsRequest());\n        }, 5);\n      }\n    }, {\n      key: \"_reloadFeatureFlagsRequest\",\n      value: function () {\n        var e = this;\n        this.setReloadingPaused(!0);\n        var t = this.instance.get_config(\"token\"),\n          n = this.instance.get_property(Ge),\n          r = this.instance.get_property(We),\n          i = re(JSON.stringify({\n            token: t,\n            distinct_id: this.instance.get_distinct_id(),\n            groups: this.instance.getGroups(),\n            $anon_distinct_id: this.$anon_distinct_id,\n            person_properties: n,\n            group_properties: r\n          }));\n        this.instance._send_request(this.instance.get_config(\"api_host\") + \"/decide/?v=3\", {\n          data: i\n        }, {\n          method: \"POST\"\n        }, this.instance._prepare_callback(function (t) {\n          e.$anon_distinct_id = void 0, e.receivedFeatureFlags(t), e.setReloadingPaused(!1), e._startReloadTimer();\n        }));\n      }\n    }, {\n      key: \"getFeatureFlag\",\n      value: function (e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n        if (this.getFlags() && 0 !== this.getFlags().length) {\n          var n = this.getFlagVariants()[e],\n            r = \"\".concat(n),\n            i = this.instance.get_property(Qe) || {};\n          return !t.send_event && \"send_event\" in t || e in i && i[e].includes(r) || (Array.isArray(i[e]) ? i[e].push(r) : i[e] = [r], this.instance.persistence.register(s({}, Qe, i)), this.instance.capture(\"$feature_flag_called\", {\n            $feature_flag: e,\n            $feature_flag_response: n\n          })), n;\n        }\n        console.warn('getFeatureFlag for key \"' + e + \"\\\" failed. Feature flags didn't load in time.\");\n      }\n    }, {\n      key: \"getFeatureFlagPayload\",\n      value: function (e) {\n        return this.getFlagPayloads()[e];\n      }\n    }, {\n      key: \"isFeatureEnabled\",\n      value: function (e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n        if (this.getFlags() && 0 !== this.getFlags().length) return !!this.getFeatureFlag(e, t);\n        console.warn('isFeatureEnabled for key \"' + e + \"\\\" failed. Feature flags didn't load in time.\");\n      }\n    }, {\n      key: \"addFeatureFlagsHandler\",\n      value: function (e) {\n        this.featureFlagEventHandlers.push(e);\n      }\n    }, {\n      key: \"removeFeatureFlagsHandler\",\n      value: function (e) {\n        this.featureFlagEventHandlers = this.featureFlagEventHandlers.filter(function (t) {\n          return t !== e;\n        });\n      }\n    }, {\n      key: \"receivedFeatureFlags\",\n      value: function (e) {\n        this.instance.decideEndpointWasHit = !0;\n        var n = this.getFlagVariants(),\n          r = this.getFlagPayloads();\n        !function (e, n) {\n          var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {},\n            i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : {},\n            o = e.featureFlags,\n            a = e.featureFlagPayloads;\n          if (o) if (Array.isArray(o)) {\n            var c,\n              u = {};\n            if (o) for (var l = 0; l < o.length; l++) u[o[l]] = !0;\n            n && n.register((s(c = {}, ht, o), s(c, Be, u), c));\n          } else {\n            var d,\n              p = o,\n              f = a;\n            e.errorsWhileComputingFlags && (p = t(t({}, r), p), f = t(t({}, i), f)), n && n.register((s(d = {}, ht, Object.keys(vt(p))), s(d, Be, p || {}), s(d, gt, f || {}), d));\n          }\n        }(e, this.instance.persistence, n, r), this._fireFeatureFlagsCallbacks();\n      }\n    }, {\n      key: \"override\",\n      value: function (e) {\n        if (this._override_warning = !1, !1 === e) this.instance.persistence.unregister(_t);else if (Array.isArray(e)) {\n          for (var t = {}, n = 0; n < e.length; n++) t[e[n]] = !0;\n          this.instance.persistence.register(s({}, _t, t));\n        } else this.instance.persistence.register(s({}, _t, e));\n      }\n    }, {\n      key: \"onFeatureFlags\",\n      value: function (e) {\n        var t = this;\n        if (this.addFeatureFlagsHandler(e), this.instance.decideEndpointWasHit) {\n          var n = this._prepareFeatureFlagsForCallbacks(),\n            r = n.flags,\n            i = n.flagVariants;\n          e(r, i);\n        }\n        return function () {\n          return t.removeFeatureFlagsHandler(e);\n        };\n      }\n    }, {\n      key: \"updateEarlyAccessFeatureEnrollment\",\n      value: function (e, n) {\n        var r,\n          i = s({}, \"$feature_enrollment/\".concat(e), n);\n        this.instance.capture(\"$feature_enrollment_update\", {\n          $feature_flag: e,\n          $feature_enrollment: n,\n          $set: i\n        }), this.setPersonPropertiesForFlags(i, !1);\n        var o = t(t({}, this.getFlagVariants()), {}, s({}, e, n));\n        this.instance.persistence.register((s(r = {}, ht, Object.keys(vt(o))), s(r, Be, o), r)), this._fireFeatureFlagsCallbacks();\n      }\n    }, {\n      key: \"getEarlyAccessFeatures\",\n      value: function (e) {\n        var t = this,\n          n = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],\n          r = this.instance.get_property(Ve);\n        if (r && !n) return e(r);\n        this.instance._send_request(\"\".concat(this.instance.get_config(\"api_host\"), \"/api/early_access_features/?token=\").concat(this.instance.get_config(\"token\")), {}, {\n          method: \"GET\"\n        }, function (n) {\n          var r = n.earlyAccessFeatures;\n          return t.instance.persistence.register(s({}, Ve, r)), e(r);\n        });\n      }\n    }, {\n      key: \"_prepareFeatureFlagsForCallbacks\",\n      value: function () {\n        var e = this.getFlags(),\n          t = this.getFlagVariants();\n        return {\n          flags: e.filter(function (e) {\n            return t[e];\n          }),\n          flagVariants: Object.keys(t).filter(function (e) {\n            return t[e];\n          }).reduce(function (e, n) {\n            return e[n] = t[n], e;\n          }, {})\n        };\n      }\n    }, {\n      key: \"_fireFeatureFlagsCallbacks\",\n      value: function () {\n        var e = this._prepareFeatureFlagsForCallbacks(),\n          t = e.flags,\n          n = e.flagVariants;\n        this.featureFlagEventHandlers.forEach(function (e) {\n          return e(t, n);\n        });\n      }\n    }, {\n      key: \"setPersonPropertiesForFlags\",\n      value: function (e) {\n        var n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],\n          r = this.instance.get_property(Ge) || {};\n        this.instance.register(s({}, Ge, t(t({}, r), e))), n && this.instance.reloadFeatureFlags();\n      }\n    }, {\n      key: \"resetPersonPropertiesForFlags\",\n      value: function () {\n        this.instance.unregister(Ge);\n      }\n    }, {\n      key: \"setGroupPropertiesForFlags\",\n      value: function (e) {\n        var n = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1],\n          r = this.instance.get_property(We) || {};\n        0 !== Object.keys(r).length && Object.keys(r).forEach(function (n) {\n          r[n] = t(t({}, r[n]), e[n]), delete e[n];\n        }), this.instance.register(s({}, We, t(t({}, r), e))), n && this.instance.reloadFeatureFlags();\n      }\n    }, {\n      key: \"resetGroupPropertiesForFlags\",\n      value: function (e) {\n        if (e) {\n          var n = this.instance.get_property(We) || {};\n          this.instance.register(s({}, We, t(t({}, n), {}, s({}, e, {}))));\n        } else this.instance.unregister(We);\n      }\n    }]), e;\n  }(),\n  mt = \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNOCAwSDE2TDAgMTZWOEw4IDBaIiBmaWxsPSIjMkQyRDJEIi8+CjxwYXRoIGQ9Ik0xNiA4VjE2SDhMMTYgOFoiIGZpbGw9IiMyRDJEMkQiLz4KPC9zdmc+Cg==\",\n  bt = 2,\n  wt = 4,\n  kt = 6;\nvar St = \"rrweb/console@1\";\nvar Et,\n  Ft = \"/s/\";\n!function (e) {\n  e[e.Mutation = 0] = \"Mutation\", e[e.MouseMove = 1] = \"MouseMove\", e[e.MouseInteraction = 2] = \"MouseInteraction\", e[e.Scroll = 3] = \"Scroll\", e[e.ViewportResize = 4] = \"ViewportResize\", e[e.Input = 5] = \"Input\", e[e.TouchMove = 6] = \"TouchMove\", e[e.MediaInteraction = 7] = \"MediaInteraction\", e[e.StyleSheetRule = 8] = \"StyleSheetRule\", e[e.CanvasMutation = 9] = \"CanvasMutation\", e[e.Font = 10] = \"Font\", e[e.Log = 11] = \"Log\", e[e.Drag = 12] = \"Drag\", e[e.StyleDeclaration = 13] = \"StyleDeclaration\", e[e.Selection = 14] = \"Selection\", e[e.AdoptedStyleSheet = 15] = \"AdoptedStyleSheet\";\n}(Et || (Et = {}));\nvar xt = [Et.MouseMove, Et.MouseInteraction, Et.Scroll, Et.ViewportResize, Et.Input, Et.TouchMove, Et.MediaInteraction, Et.Drag],\n  Pt = function () {\n    function e(t) {\n      r(this, e), s(this, \"lastActivityTimestamp\", Date.now()), s(this, \"isIdle\", !1), this.instance = t, this.captureStarted = !1, this.snapshots = [], this.emit = !1, this.endpoint = Ft, this.stopRrweb = void 0, this.windowId = null, this.sessionId = null, this.receivedDecide = !1;\n    }\n    return o(e, [{\n      key: \"startRecordingIfEnabled\",\n      value: function () {\n        this.isRecordingEnabled() ? this.startCaptureAndTrySendingQueuedSnapshots() : this.stopRecording();\n      }\n    }, {\n      key: \"started\",\n      value: function () {\n        return this.captureStarted;\n      }\n    }, {\n      key: \"stopRecording\",\n      value: function () {\n        this.captureStarted && this.stopRrweb && (this.stopRrweb(), this.stopRrweb = void 0, this.captureStarted = !1);\n      }\n    }, {\n      key: \"isRecordingEnabled\",\n      value: function () {\n        var e = !!this.instance.get_property(qe),\n          t = !this.instance.get_config(\"disable_session_recording\");\n        return e && t;\n      }\n    }, {\n      key: \"isConsoleLogCaptureEnabled\",\n      value: function () {\n        var e = !!this.instance.get_property(He),\n          t = this.instance.get_config(\"enable_recording_console_log\");\n        return null != t ? t : e;\n      }\n    }, {\n      key: \"getRecordingVersion\",\n      value: function () {\n        var e,\n          t = this.instance.get_property(Le);\n        return (null === (e = this.instance.get_config(\"session_recording\")) || void 0 === e ? void 0 : e.recorderVersion) || t || \"v1\";\n      }\n    }, {\n      key: \"afterDecideResponse\",\n      value: function (e) {\n        var t, n, r, i, o, a;\n        (this.receivedDecide = !0, this.instance.persistence) && this.instance.persistence.register((s(o = {}, qe, !!e.sessionRecording), s(o, He, null === (r = e.sessionRecording) || void 0 === r ? void 0 : r.consoleLogRecordingEnabled), s(o, Le, null === (i = e.sessionRecording) || void 0 === i ? void 0 : i.recorderVersion), o));\n        null !== (t = e.sessionRecording) && void 0 !== t && t.endpoint && (this.endpoint = null === (a = e.sessionRecording) || void 0 === a ? void 0 : a.endpoint);\n        null !== (n = e.sessionRecording) && void 0 !== n && n.recorderVersion && (this.recorderVersion = e.sessionRecording.recorderVersion), this.startRecordingIfEnabled();\n      }\n    }, {\n      key: \"startCaptureAndTrySendingQueuedSnapshots\",\n      value: function () {\n        var e = this;\n        this.receivedDecide && (this.emit = !0, this.snapshots.forEach(function (t) {\n          return e._captureSnapshot(t);\n        })), this._startCapture();\n      }\n    }, {\n      key: \"_startCapture\",\n      value: function () {\n        var e = this;\n        if (void 0 !== Object.assign && !this.captureStarted && !this.instance.get_config(\"disable_session_recording\")) {\n          this.captureStarted = !0, this.instance.sessionManager.checkAndGetSessionAndWindowId();\n          var t = \"v2\" === this.getRecordingVersion() ? \"recorder-v2.js\" : \"recorder.js\";\n          this.instance.__loaded_recorder_version !== this.getRecordingVersion() ? de(this.instance.get_config(\"api_host\") + \"/static/\".concat(t, \"?v=\").concat(y.LIB_VERSION), function (n) {\n            if (n) return q.error(\"Could not load \".concat(t), n);\n            e._onScriptLoaded();\n          }) : this._onScriptLoaded();\n        }\n      }\n    }, {\n      key: \"_isInteractiveEvent\",\n      value: function (e) {\n        var t;\n        return 3 === e.type && -1 !== xt.indexOf(null === (t = e.data) || void 0 === t ? void 0 : t.source);\n      }\n    }, {\n      key: \"_updateWindowAndSessionIds\",\n      value: function (e) {\n        var t = this._isInteractiveEvent(e);\n        if (t || this.isIdle || e.timestamp - this.lastActivityTimestamp > 3e5 && (this.isIdle = !0), t && (this.lastActivityTimestamp = e.timestamp, this.isIdle && (this.isIdle = !1, this._tryTakeFullSnapshot())), !this.isIdle) {\n          var n = this.instance.sessionManager.checkAndGetSessionAndWindowId(!t, e.timestamp),\n            r = n.windowId,\n            i = n.sessionId;\n          -1 !== [bt, wt].indexOf(e.type) || this.windowId === r && this.sessionId === i || this._tryTakeFullSnapshot(), this.windowId = r, this.sessionId = i;\n        }\n      }\n    }, {\n      key: \"_tryTakeFullSnapshot\",\n      value: function () {\n        if (!this.captureStarted) return !1;\n        try {\n          var e;\n          return null === (e = this.rrwebRecord) || void 0 === e || e.takeFullSnapshot(), !0;\n        } catch (e) {\n          return q.error(\"Error taking full snapshot.\", e), !1;\n        }\n      }\n    }, {\n      key: \"_onScriptLoaded\",\n      value: function () {\n        var e = this,\n          n = {\n            blockClass: \"ph-no-capture\",\n            blockSelector: void 0,\n            ignoreClass: \"ph-ignore-input\",\n            maskTextClass: \"ph-mask\",\n            maskTextSelector: void 0,\n            maskTextFn: void 0,\n            maskAllInputs: !0,\n            maskInputOptions: {},\n            maskInputFn: void 0,\n            slimDOMOptions: {},\n            collectFonts: !1,\n            inlineStylesheet: !0,\n            recordCrossOriginIframes: !1\n          };\n        this.rrwebRecord = window.rrweb ? window.rrweb.record : window.rrwebRecord;\n        for (var r = this.instance.get_config(\"session_recording\"), i = 0, o = Object.entries(r || {}); i < o.length; i++) {\n          var s = f(o[i], 2),\n            a = s[0],\n            c = s[1];\n          a in n && (n[a] = c);\n        }\n        this.rrwebRecord ? (this.stopRrweb = this.rrwebRecord(t({\n          emit: function (t) {\n            e.onRRwebEmit(t);\n          },\n          plugins: window.rrwebConsoleRecord && this.isConsoleLogCaptureEnabled() ? [window.rrwebConsoleRecord.getRecordConsolePlugin()] : []\n        }, n)), this.instance._addCaptureHook(function (t) {\n          try {\n            var n;\n            if (\"$pageview\" === t) null === (n = e.rrwebRecord) || void 0 === n || n.addCustomEvent(\"$pageview\", {\n              href: window.location.href\n            });\n          } catch (e) {\n            q.error(\"Could not add $pageview to rrweb session\", e);\n          }\n        }), this.lastActivityTimestamp = Date.now(), this.isIdle = !1) : q.error(\"onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.\");\n      }\n    }, {\n      key: \"onRRwebEmit\",\n      value: function (e) {\n        if (e = function (e) {\n          if (e && \"object\" === n(e) && e.type === kt && \"object\" === n(e.data) && e.data.plugin === St) {\n            e.data.payload.payload.length > 10 && (e.data.payload.payload = e.data.payload.payload.slice(0, 10), e.data.payload.payload.push(\"...[truncated]\"));\n            for (var t = [], r = 0; r < e.data.payload.payload.length; r++) e.data.payload.payload[r] && e.data.payload.payload[r].length > 2e3 ? t.push(e.data.payload.payload[r].slice(0, 2e3) + \"...[truncated]\") : t.push(e.data.payload.payload[r]);\n            return e.data.payload.payload = t, e;\n          }\n          return e;\n        }(function (e) {\n          if (e && \"object\" === n(e)) {\n            var t = JSON.stringify(e);\n            if (t.length > 5e6) {\n              var r,\n                i = v(t.matchAll(/data:([\\w\\/\\-\\.]+);(\\w+),([^)\"]*)/gim));\n              try {\n                for (i.s(); !(r = i.n()).done;) {\n                  var o = r.value;\n                  t = \"image/\" === o[1].toLocaleLowerCase().slice(0, 6) ? t.replace(o[0], mt) : t.replace(o[0], \"\");\n                }\n              } catch (e) {\n                i.e(e);\n              } finally {\n                i.f();\n              }\n            }\n            return JSON.parse(t);\n          }\n          return e;\n        }(e)), this._updateWindowAndSessionIds(e), !this.isIdle) {\n          var t = {\n            $snapshot_data: e,\n            $session_id: this.sessionId,\n            $window_id: this.windowId\n          };\n          this.instance._captureMetrics.incr(\"rrweb-record\"), this.instance._captureMetrics.incr(\"rrweb-record-\".concat(e.type)), this.emit ? this._captureSnapshot(t) : this.snapshots.push(t);\n        }\n      }\n    }, {\n      key: \"_captureSnapshot\",\n      value: function (e) {\n        this.instance.capture(\"$snapshot\", e, {\n          transport: \"XHR\",\n          method: \"POST\",\n          endpoint: this.endpoint,\n          _noTruncate: !0,\n          _batchKey: \"sessionRecording\",\n          _metrics: {\n            rrweb_full_snapshot: e.$snapshot_data.type === bt\n          }\n        });\n      }\n    }]), e;\n  }(),\n  Ot = {\n    entryType: 0,\n    timeOrigin: 1,\n    name: 2,\n    startTime: 3,\n    redirectStart: 4,\n    redirectEnd: 5,\n    workerStart: 6,\n    fetchStart: 7,\n    domainLookupStart: 8,\n    domainLookupEnd: 9,\n    connectStart: 10,\n    secureConnectionStart: 11,\n    connectEnd: 12,\n    requestStart: 13,\n    responseStart: 14,\n    responseEnd: 15,\n    decodedBodySize: 16,\n    encodedBodySize: 17,\n    initiatorType: 18,\n    nextHopProtocol: 19,\n    renderBlockingStatus: 20,\n    responseStatus: 21,\n    transferSize: 22,\n    element: 23,\n    renderTime: 24,\n    loadTime: 25,\n    size: 26,\n    id: 27,\n    url: 28,\n    domComplete: 29,\n    domContentLoadedEvent: 30,\n    domInteractive: 31,\n    loadEventEnd: 32,\n    loadEventStart: 33,\n    redirectCount: 34,\n    navigationType: 35,\n    unloadEventEnd: 36,\n    unloadEventStart: 37,\n    duration: 39,\n    timestamp: 40\n  },\n  It = [\"first-input\", \"navigation\", \"paint\", \"resource\"],\n  $t = [\"/s/\", \"/e/\"],\n  Tt = function () {\n    function e(t) {\n      r(this, e), s(this, \"_forceAllowLocalhost\", !1), this.instance = t;\n    }\n    return o(e, [{\n      key: \"startObservingIfEnabled\",\n      value: function () {\n        this.isEnabled() ? this.startObserving() : this.stopObserving();\n      }\n    }, {\n      key: \"startObserving\",\n      value: function () {\n        var e,\n          t,\n          n = this;\n        if (!this.observer) if (void 0 !== (null === (e = window) || void 0 === e || null === (t = e.PerformanceObserver) || void 0 === t ? void 0 : t.supportedEntryTypes)) {\n          if (!R.includes(location.hostname) || this._forceAllowLocalhost) try {\n            this.observer = new PerformanceObserver(function (e) {\n              e.getEntries().forEach(function (e) {\n                n._capturePerformanceEvent(e);\n              });\n            });\n            var r = PerformanceObserver.supportedEntryTypes.filter(function (e) {\n              return It.includes(e);\n            });\n            r.forEach(function (e) {\n              var t;\n              null === (t = n.observer) || void 0 === t || t.observe({\n                type: e,\n                buffered: !0\n              });\n            });\n          } catch (e) {\n            console.error(\"PostHog failed to start performance observer\", e), this.stopObserving();\n          } else q.log(\"PostHog Peformance observer not started because we are on localhost.\");\n        } else q.log(\"PostHog Performance observer not started because PerformanceObserver is not supported by this browser.\");\n      }\n    }, {\n      key: \"stopObserving\",\n      value: function () {\n        this.observer && (this.observer.disconnect(), this.observer = void 0);\n      }\n    }, {\n      key: \"isObserving\",\n      value: function () {\n        return !!this.observer;\n      }\n    }, {\n      key: \"isEnabled\",\n      value: function () {\n        var e, t;\n        return null !== (e = null !== (t = this.instance.get_config(\"capture_performance\")) && void 0 !== t ? t : this.remoteEnabled) && void 0 !== e && e;\n      }\n    }, {\n      key: \"afterDecideResponse\",\n      value: function (e) {\n        this.remoteEnabled = e.capturePerformance || !1, this.isEnabled() && this.startObserving();\n      }\n    }, {\n      key: \"_capturePerformanceEvent\",\n      value: function (e) {\n        if (0 === e.name.indexOf(this.instance.get_config(\"api_host\"))) {\n          var t = e.name.replace(this.instance.get_config(\"api_host\"), \"\");\n          if ($t.find(function (e) {\n            return 0 === t.indexOf(e);\n          })) return;\n        }\n        var n = {\n            url: e.name\n          },\n          r = this.instance.get_config(\"session_recording\");\n        if (r.maskNetworkRequestFn && (n = r.maskNetworkRequestFn(n)), n) {\n          var i = e.toJSON();\n          i.name = n.url;\n          var o = {},\n            a = Math.floor(Date.now() - performance.now());\n          for (var c in o[Ot.timeOrigin] = a, o[Ot.timestamp] = Math.floor(a + e.startTime), Ot) void 0 !== i[c] && (o[Ot[c]] = i[c]);\n          if (this.capturePerformanceEvent(o), Mt(e)) {\n            var u,\n              l = v(e.serverTiming || []);\n            try {\n              for (l.s(); !(u = l.n()).done;) {\n                var d,\n                  p = u.value;\n                this.capturePerformanceEvent((s(d = {}, Ot.timeOrigin, a), s(d, Ot.timestamp, Math.floor(a + e.startTime)), s(d, Ot.name, p.name), s(d, Ot.duration, p.duration), s(d, Ot.entryType, \"serverTiming\"), d));\n              }\n            } catch (e) {\n              l.e(e);\n            } finally {\n              l.f();\n            }\n          }\n        }\n      }\n    }, {\n      key: \"capturePerformanceEvent\",\n      value: function (e) {\n        var t,\n          n = e[Ot.timestamp];\n        null === (t = this.instance.sessionRecording) || void 0 === t || t.onRRwebEmit({\n          type: 6,\n          data: {\n            plugin: \"posthog/network@1\",\n            payload: e\n          },\n          timestamp: n\n        });\n      }\n    }]), e;\n  }(),\n  Mt = function (e) {\n    return \"navigation\" === e.entryType || \"resource\" === e.entryType;\n  },\n  At = function () {\n    function e(t) {\n      r(this, e), this.instance = t, this.instance.decideEndpointWasHit = this.instance._hasBootstrappedFeatureFlags();\n    }\n    return o(e, [{\n      key: \"call\",\n      value: function () {\n        var e = this,\n          t = re(JSON.stringify({\n            token: this.instance.get_config(\"token\"),\n            distinct_id: this.instance.get_distinct_id(),\n            groups: this.instance.getGroups(),\n            person_properties: this.instance.get_property(Ge),\n            group_properties: this.instance.get_property(We)\n          }));\n        this.instance._send_request(\"\".concat(this.instance.get_config(\"api_host\"), \"/decide/?v=3\"), {\n          data: t,\n          verbose: !0\n        }, {\n          method: \"POST\"\n        }, function (t) {\n          return e.parseDecideResponse(t);\n        });\n      }\n    }, {\n      key: \"parseDecideResponse\",\n      value: function (e) {\n        var t,\n          n,\n          r,\n          i = this;\n        if (0 !== (null == e ? void 0 : e.status)) {\n          if (this.instance.decideEndpointWasHit = !0, !document || !document.body) return console.log(\"document not ready yet, trying again in 500 milliseconds...\"), void setTimeout(function () {\n            i.parseDecideResponse(e);\n          }, 500);\n          if (this.instance.toolbar.afterDecideResponse(e), null === (t = this.instance.sessionRecording) || void 0 === t || t.afterDecideResponse(e), Ke.afterDecideResponse(e, this.instance), null === (n = this.instance.webPerformance) || void 0 === n || n.afterDecideResponse(e), null === (r = this.instance.exceptionAutocapture) || void 0 === r || r.afterDecideResponse(e), this.instance.featureFlags.receivedFeatureFlags(e), this.instance.compression = {}, e.supportedCompression && !this.instance.get_config(\"disable_compression\")) {\n            var o,\n              s = {},\n              a = v(e.supportedCompression);\n            try {\n              for (a.s(); !(o = a.n()).done;) {\n                s[o.value] = !0;\n              }\n            } catch (e) {\n              a.e(e);\n            } finally {\n              a.f();\n            }\n            this.instance.compression = s;\n          }\n          if (e.siteApps) if (this.instance.get_config(\"opt_in_site_apps\")) {\n            var c,\n              u = this.instance.get_config(\"api_host\"),\n              l = v(e.siteApps);\n            try {\n              var d = function () {\n                var e = c.value,\n                  t = e.id,\n                  n = e.url,\n                  r = [u, \"/\" === u[u.length - 1] && \"/\" === n[0] ? n.substring(1) : n].join(\"\");\n                window[\"__$$ph_site_app_\".concat(t)] = i.instance, de(r, function (e) {\n                  e && console.error(\"Error while initializing PostHog app with config id \".concat(t), e);\n                });\n              };\n              for (l.s(); !(c = l.n()).done;) d();\n            } catch (e) {\n              l.e(e);\n            } finally {\n              l.f();\n            }\n          } else e.siteApps.length > 0 && console.error('PostHog site apps are disabled. Enable the \"opt_in_site_apps\" config to proceed.');\n        } else console.error(\"Failed to fetch feature flags from PostHog.\");\n      }\n    }]), e;\n  }(),\n  Rt = [\"https://app.posthog.com\", \"https://eu.posthog.com\"],\n  Ct = [\"source\"],\n  jt = function () {\n    function e(t) {\n      r(this, e), this.instance = t;\n    }\n    return o(e, [{\n      key: \"afterDecideResponse\",\n      value: function (e) {\n        var n = e.toolbarParams || e.editorParams || (e.toolbarVersion ? {\n          toolbarVersion: e.toolbarVersion\n        } : {});\n        e.isAuthenticated && n.toolbarVersion && 0 === n.toolbarVersion.indexOf(\"toolbar\") && this.loadToolbar(t({}, n));\n      }\n    }, {\n      key: \"maybeLoadToolbar\",\n      value: function () {\n        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : window.location,\n          t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0,\n          n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : window.history;\n        try {\n          if (!t) {\n            try {\n              window.localStorage.setItem(\"test\", \"test\"), window.localStorage.removeItem(\"test\");\n            } catch (e) {\n              return !1;\n            }\n            t = window.localStorage;\n          }\n          var r,\n            i = ue(e.hash, \"__posthog\") || ue(e.hash, \"state\"),\n            o = i ? JSON.parse(decodeURIComponent(i)) : null;\n          return o && \"ph_authorize\" === o.action ? ((r = o).source = \"url\", r && Object.keys(r).length > 0 && (o.desiredHash ? e.hash = o.desiredHash : n ? n.replaceState(\"\", document.title, e.pathname + e.search) : e.hash = \"\")) : ((r = JSON.parse(t.getItem(\"_postHogToolbarParams\") || \"{}\")).source = \"localstorage\", delete r.userIntent), !(!r.token || this.instance.get_config(\"token\") !== r.token) && (this.loadToolbar(r), !0);\n        } catch (e) {\n          return !1;\n        }\n      }\n    }, {\n      key: \"loadToolbar\",\n      value: function (e) {\n        var n = this;\n        if (window._postHogToolbarLoaded) return !1;\n        window._postHogToolbarLoaded = !0;\n        var r = this.instance.get_config(\"api_host\"),\n          i = 3e4 * Math.floor(Date.now() / 3e4),\n          o = \"\".concat(r).concat(r.endsWith(\"/\") ? \"\" : \"/\", \"static/toolbar.js?_ts=\").concat(i),\n          s = !Rt.includes(this.instance.get_config(\"api_host\")) && this.instance.get_config(\"advanced_disable_toolbar_metrics\"),\n          a = t(t({\n            token: this.instance.get_config(\"token\")\n          }, e), {}, {\n            apiURL: r\n          }, s ? {\n            instrument: !1\n          } : {});\n        a.source;\n        var c = l(a, Ct);\n        return window.localStorage.setItem(\"_postHogToolbarParams\", JSON.stringify(c)), de(o, function (e) {\n          e ? q.error(\"Failed to load toolbar\", e) : (window.ph_load_toolbar || window.ph_load_editor)(a, n.instance);\n        }), le(window, \"turbolinks:load\", function () {\n          window._postHogToolbarLoaded = !1, n.loadToolbar(a);\n        }), !0;\n      }\n    }, {\n      key: \"_loadEditor\",\n      value: function (e) {\n        return this.loadToolbar(e);\n      }\n    }, {\n      key: \"maybeLoadEditor\",\n      value: function () {\n        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : window.location,\n          t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : void 0,\n          n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : window.history;\n        return this.maybeLoadToolbar(e, t, n);\n      }\n    }]), e;\n  }(),\n  Dt = function () {\n    function e() {\n      var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 3e3;\n      r(this, e), this.isPolling = !0, this._event_queue = [], this._empty_queue_count = 0, this._poller = void 0, this._pollInterval = t;\n    }\n    return o(e, [{\n      key: \"setPollInterval\",\n      value: function (e) {\n        this._pollInterval = e, this.isPolling && this.poll();\n      }\n    }, {\n      key: \"poll\",\n      value: function () {}\n    }, {\n      key: \"unload\",\n      value: function () {}\n    }, {\n      key: \"getTime\",\n      value: function () {\n        return new Date().getTime();\n      }\n    }]), e;\n  }(),\n  Nt = function (e) {\n    a(i, Dt);\n    var n = p(i);\n    function i(e, t) {\n      var o,\n        s = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 3e3;\n      return r(this, i), (o = n.call(this, s)).handlePollRequest = t, o.captureMetrics = e, o;\n    }\n    return o(i, [{\n      key: \"enqueue\",\n      value: function (e, t, n) {\n        this.captureMetrics.incr(\"batch-enqueue\"), this._event_queue.push({\n          url: e,\n          data: t,\n          options: n\n        }), this.isPolling || (this.isPolling = !0, this.poll());\n      }\n    }, {\n      key: \"poll\",\n      value: function () {\n        var e = this;\n        clearTimeout(this._poller), this._poller = setTimeout(function () {\n          if (e._event_queue.length > 0) {\n            var t = e.formatQueue(),\n              n = function (n) {\n                var r = t[n],\n                  i = r.url,\n                  o = r.data,\n                  s = r.options;\n                U(o, function (t, n) {\n                  o[n].offset = Math.abs(o[n].timestamp - e.getTime()), delete o[n].timestamp;\n                }), e.handlePollRequest(i, o, s), e.captureMetrics.incr(\"batch-requests\"), e.captureMetrics.incr(\"batch-requests-\".concat(i.slice(i.length - 2))), e.captureMetrics.incr(\"batch-handle\", o.length), e.captureMetrics.incr(\"batch-handle-\".concat(i.slice(i.length - 2)), o.length);\n              };\n            for (var r in t) n(r);\n            e._event_queue.length = 0, e._empty_queue_count = 0;\n          } else e._empty_queue_count++;\n          e._empty_queue_count > 4 && (e.isPolling = !1, e._empty_queue_count = 0), e.isPolling && e.poll();\n        }, this._pollInterval);\n      }\n    }, {\n      key: \"updateUnloadMetrics\",\n      value: function () {\n        var e = this.formatQueue();\n        for (var t in e) {\n          var n = e[t],\n            r = n.url,\n            i = n.data;\n          this.captureMetrics.incr(\"batch-unload-requests\"), this.captureMetrics.incr(\"batch-unload-requests-\".concat(r.slice(r.length - 2))), this.captureMetrics.incr(\"batch-unload\", i.length), this.captureMetrics.incr(\"batch-unload-\".concat(r.slice(r.length - 2)), i.length);\n        }\n      }\n    }, {\n      key: \"unload\",\n      value: function () {\n        var e = this;\n        clearTimeout(this._poller);\n        var n = this._event_queue.length > 0 ? this.formatQueue() : {};\n        this._event_queue.length = 0;\n        var r = Object.values(n);\n        [].concat(h(r.filter(function (e) {\n          return 0 === e.url.indexOf(\"/e\");\n        })), h(r.filter(function (e) {\n          return 0 !== e.url.indexOf(\"/e\");\n        }))).map(function (n) {\n          var r = n.url,\n            i = n.data,\n            o = n.options;\n          e.handlePollRequest(r, i, t(t({}, o), {}, {\n            transport: \"sendBeacon\"\n          }));\n        });\n      }\n    }, {\n      key: \"formatQueue\",\n      value: function () {\n        var e = {};\n        return U(this._event_queue, function (t) {\n          var n = t.url,\n            r = t.data,\n            i = t.options,\n            o = (i ? i._batchKey : null) || n;\n          void 0 === e[o] && (e[o] = {\n            data: [],\n            url: n,\n            options: i\n          }), i && e[o].options && e[o].options._metrics && !e[o].options._metrics.rrweb_full_snapshot && (e[o].options._metrics.rrweb_full_snapshot = i._metrics.rrweb_full_snapshot), e[o].data.push(r);\n        }), e;\n      }\n    }]), i;\n  }(),\n  qt = function () {\n    function e(t) {\n      r(this, e), this.enabled = t, this.metrics = {};\n    }\n    return o(e, [{\n      key: \"incr\",\n      value: function (e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1;\n        this.enabled && (e = \"phjs-\".concat(e), this.metrics[e] = (this.metrics[e] || 0) + t);\n      }\n    }, {\n      key: \"decr\",\n      value: function (e) {\n        this.enabled && (e = \"phjs-\".concat(e), this.metrics[e] = (this.metrics[e] || 0) - 1);\n      }\n    }]), e;\n  }(),\n  Ht = Uint8Array,\n  Lt = Uint16Array,\n  Ut = Uint32Array,\n  Bt = new Ht([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0]),\n  Vt = new Ht([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0]),\n  Gt = new Ht([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]),\n  Wt = function (e, t) {\n    for (var n = new Lt(31), r = 0; r < 31; ++r) n[r] = t += 1 << e[r - 1];\n    var i = new Ut(n[30]);\n    for (r = 1; r < 30; ++r) for (var o = n[r]; o < n[r + 1]; ++o) i[o] = o - n[r] << 5 | r;\n    return [n, i];\n  },\n  zt = Wt(Bt, 2),\n  Qt = zt[0],\n  Jt = zt[1];\nQt[28] = 258, Jt[258] = 28;\nfor (var Xt = Wt(Vt, 0)[1], Yt = new Lt(32768), Zt = 0; Zt < 32768; ++Zt) {\n  var Kt = (43690 & Zt) >>> 1 | (21845 & Zt) << 1;\n  Kt = (61680 & (Kt = (52428 & Kt) >>> 2 | (13107 & Kt) << 2)) >>> 4 | (3855 & Kt) << 4, Yt[Zt] = ((65280 & Kt) >>> 8 | (255 & Kt) << 8) >>> 1;\n}\nvar en = function (e, t, n) {\n    for (var r = e.length, i = 0, o = new Lt(t); i < r; ++i) ++o[e[i] - 1];\n    var s,\n      a = new Lt(t);\n    for (i = 0; i < t; ++i) a[i] = a[i - 1] + o[i - 1] << 1;\n    if (n) {\n      s = new Lt(1 << t);\n      var c = 15 - t;\n      for (i = 0; i < r; ++i) if (e[i]) for (var u = i << 4 | e[i], l = t - e[i], d = a[e[i] - 1]++ << l, p = d | (1 << l) - 1; d <= p; ++d) s[Yt[d] >>> c] = u;\n    } else for (s = new Lt(r), i = 0; i < r; ++i) s[i] = Yt[a[e[i] - 1]++] >>> 15 - e[i];\n    return s;\n  },\n  tn = new Ht(288);\nfor (Zt = 0; Zt < 144; ++Zt) tn[Zt] = 8;\nfor (Zt = 144; Zt < 256; ++Zt) tn[Zt] = 9;\nfor (Zt = 256; Zt < 280; ++Zt) tn[Zt] = 7;\nfor (Zt = 280; Zt < 288; ++Zt) tn[Zt] = 8;\nvar nn = new Ht(32);\nfor (Zt = 0; Zt < 32; ++Zt) nn[Zt] = 5;\nvar rn,\n  on,\n  sn,\n  an = en(tn, 9, 0),\n  cn = en(nn, 5, 0),\n  un = function (e) {\n    return (e / 8 >> 0) + (7 & e && 1);\n  },\n  ln = function (e, t, n) {\n    (null == t || t < 0) && (t = 0), (null == n || n > e.length) && (n = e.length);\n    var r = new (e instanceof Lt ? Lt : e instanceof Ut ? Ut : Ht)(n - t);\n    return r.set(e.subarray(t, n)), r;\n  },\n  dn = function (e, t, n) {\n    n <<= 7 & t;\n    var r = t / 8 >> 0;\n    e[r] |= n, e[r + 1] |= n >>> 8;\n  },\n  pn = function (e, t, n) {\n    n <<= 7 & t;\n    var r = t / 8 >> 0;\n    e[r] |= n, e[r + 1] |= n >>> 8, e[r + 2] |= n >>> 16;\n  },\n  fn = function (e, t) {\n    for (var n = [], r = 0; r < e.length; ++r) e[r] && n.push({\n      s: r,\n      f: e[r]\n    });\n    var i = n.length,\n      o = n.slice();\n    if (!i) return [new Ht(0), 0];\n    if (1 == i) {\n      var s = new Ht(n[0].s + 1);\n      return s[n[0].s] = 1, [s, 1];\n    }\n    n.sort(function (e, t) {\n      return e.f - t.f;\n    }), n.push({\n      s: -1,\n      f: 25001\n    });\n    var a = n[0],\n      c = n[1],\n      u = 0,\n      l = 1,\n      d = 2;\n    for (n[0] = {\n      s: -1,\n      f: a.f + c.f,\n      l: a,\n      r: c\n    }; l != i - 1;) a = n[n[u].f < n[d].f ? u++ : d++], c = n[u != l && n[u].f < n[d].f ? u++ : d++], n[l++] = {\n      s: -1,\n      f: a.f + c.f,\n      l: a,\n      r: c\n    };\n    var p = o[0].s;\n    for (r = 1; r < i; ++r) o[r].s > p && (p = o[r].s);\n    var f = new Lt(p + 1),\n      h = hn(n[l - 1], f, 0);\n    if (h > t) {\n      r = 0;\n      var _ = 0,\n        g = h - t,\n        v = 1 << g;\n      for (o.sort(function (e, t) {\n        return f[t.s] - f[e.s] || e.f - t.f;\n      }); r < i; ++r) {\n        var y = o[r].s;\n        if (!(f[y] > t)) break;\n        _ += v - (1 << h - f[y]), f[y] = t;\n      }\n      for (_ >>>= g; _ > 0;) {\n        var m = o[r].s;\n        f[m] < t ? _ -= 1 << t - f[m]++ - 1 : ++r;\n      }\n      for (; r >= 0 && _; --r) {\n        var b = o[r].s;\n        f[b] == t && (--f[b], ++_);\n      }\n      h = t;\n    }\n    return [new Ht(f), h];\n  },\n  hn = function e(t, n, r) {\n    return -1 == t.s ? Math.max(e(t.l, n, r + 1), e(t.r, n, r + 1)) : n[t.s] = r;\n  },\n  _n = function (e) {\n    for (var t = e.length; t && !e[--t];);\n    for (var n = new Lt(++t), r = 0, i = e[0], o = 1, s = function (e) {\n        n[r++] = e;\n      }, a = 1; a <= t; ++a) if (e[a] == i && a != t) ++o;else {\n      if (!i && o > 2) {\n        for (; o > 138; o -= 138) s(32754);\n        o > 2 && (s(o > 10 ? o - 11 << 5 | 28690 : o - 3 << 5 | 12305), o = 0);\n      } else if (o > 3) {\n        for (s(i), --o; o > 6; o -= 6) s(8304);\n        o > 2 && (s(o - 3 << 5 | 8208), o = 0);\n      }\n      for (; o--;) s(i);\n      o = 1, i = e[a];\n    }\n    return [n.subarray(0, r), t];\n  },\n  gn = function (e, t) {\n    for (var n = 0, r = 0; r < t.length; ++r) n += e[r] * t[r];\n    return n;\n  },\n  vn = function (e, t, n) {\n    var r = n.length,\n      i = un(t + 2);\n    e[i] = 255 & r, e[i + 1] = r >>> 8, e[i + 2] = 255 ^ e[i], e[i + 3] = 255 ^ e[i + 1];\n    for (var o = 0; o < r; ++o) e[i + o + 4] = n[o];\n    return 8 * (i + 4 + r);\n  },\n  yn = function (e, t, n, r, i, o, s, a, c, u, l) {\n    dn(t, l++, n), ++i[256];\n    for (var d = fn(i, 15), p = d[0], f = d[1], h = fn(o, 15), _ = h[0], g = h[1], v = _n(p), y = v[0], m = v[1], b = _n(_), w = b[0], k = b[1], S = new Lt(19), E = 0; E < y.length; ++E) S[31 & y[E]]++;\n    for (E = 0; E < w.length; ++E) S[31 & w[E]]++;\n    for (var F = fn(S, 7), x = F[0], P = F[1], O = 19; O > 4 && !x[Gt[O - 1]]; --O);\n    var I,\n      $,\n      T,\n      M,\n      A = u + 5 << 3,\n      R = gn(i, tn) + gn(o, nn) + s,\n      C = gn(i, p) + gn(o, _) + s + 14 + 3 * O + gn(S, x) + (2 * S[16] + 3 * S[17] + 7 * S[18]);\n    if (A <= R && A <= C) return vn(t, l, e.subarray(c, c + u));\n    if (dn(t, l, 1 + (C < R)), l += 2, C < R) {\n      I = en(p, f, 0), $ = p, T = en(_, g, 0), M = _;\n      var j = en(x, P, 0);\n      dn(t, l, m - 257), dn(t, l + 5, k - 1), dn(t, l + 10, O - 4), l += 14;\n      for (E = 0; E < O; ++E) dn(t, l + 3 * E, x[Gt[E]]);\n      l += 3 * O;\n      for (var D = [y, w], N = 0; N < 2; ++N) {\n        var q = D[N];\n        for (E = 0; E < q.length; ++E) {\n          var H = 31 & q[E];\n          dn(t, l, j[H]), l += x[H], H > 15 && (dn(t, l, q[E] >>> 5 & 127), l += q[E] >>> 12);\n        }\n      }\n    } else I = an, $ = tn, T = cn, M = nn;\n    for (E = 0; E < a; ++E) if (r[E] > 255) {\n      H = r[E] >>> 18 & 31;\n      pn(t, l, I[H + 257]), l += $[H + 257], H > 7 && (dn(t, l, r[E] >>> 23 & 31), l += Bt[H]);\n      var L = 31 & r[E];\n      pn(t, l, T[L]), l += M[L], L > 3 && (pn(t, l, r[E] >>> 5 & 8191), l += Vt[L]);\n    } else pn(t, l, I[r[E]]), l += $[r[E]];\n    return pn(t, l, I[256]), l + $[256];\n  },\n  mn = new Ut([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]),\n  bn = new Ht(0),\n  wn = function () {\n    for (var e = new Ut(256), t = 0; t < 256; ++t) {\n      for (var n = t, r = 9; --r;) n = (1 & n && 3988292384) ^ n >>> 1;\n      e[t] = n;\n    }\n    return e;\n  }(),\n  kn = function () {\n    var e = 4294967295;\n    return {\n      p: function (t) {\n        for (var n = e, r = 0; r < t.length; ++r) n = wn[255 & n ^ t[r]] ^ n >>> 8;\n        e = n;\n      },\n      d: function () {\n        return 4294967295 ^ e;\n      }\n    };\n  },\n  Sn = function (e, t, n, r, i) {\n    return function (e, t, n, r, i, o) {\n      var s = e.length,\n        a = new Ht(r + s + 5 * (1 + Math.floor(s / 7e3)) + i),\n        c = a.subarray(r, a.length - i),\n        u = 0;\n      if (!t || s < 8) for (var l = 0; l <= s; l += 65535) {\n        var d = l + 65535;\n        d < s ? u = vn(c, u, e.subarray(l, d)) : (c[l] = o, u = vn(c, u, e.subarray(l, s)));\n      } else {\n        for (var p = mn[t - 1], f = p >>> 13, h = 8191 & p, _ = (1 << n) - 1, g = new Lt(32768), v = new Lt(_ + 1), y = Math.ceil(n / 3), m = 2 * y, b = function (t) {\n            return (e[t] ^ e[t + 1] << y ^ e[t + 2] << m) & _;\n          }, w = new Ut(25e3), k = new Lt(288), S = new Lt(32), E = 0, F = 0, x = (l = 0, 0), P = 0, O = 0; l < s; ++l) {\n          var I = b(l),\n            $ = 32767 & l,\n            T = v[I];\n          if (g[$] = T, v[I] = $, P <= l) {\n            var M = s - l;\n            if ((E > 7e3 || x > 24576) && M > 423) {\n              u = yn(e, c, 0, w, k, S, F, x, O, l - O, u), x = E = F = 0, O = l;\n              for (var A = 0; A < 286; ++A) k[A] = 0;\n              for (A = 0; A < 30; ++A) S[A] = 0;\n            }\n            var R = 2,\n              C = 0,\n              j = h,\n              D = $ - T & 32767;\n            if (M > 2 && I == b(l - D)) for (var N = Math.min(f, M) - 1, q = Math.min(32767, l), H = Math.min(258, M); D <= q && --j && $ != T;) {\n              if (e[l + R] == e[l + R - D]) {\n                for (var L = 0; L < H && e[l + L] == e[l + L - D]; ++L);\n                if (L > R) {\n                  if (R = L, C = D, L > N) break;\n                  var U = Math.min(D, L - 2),\n                    B = 0;\n                  for (A = 0; A < U; ++A) {\n                    var V = l - D + A + 32768 & 32767,\n                      G = V - g[V] + 32768 & 32767;\n                    G > B && (B = G, T = V);\n                  }\n                }\n              }\n              D += ($ = T) - (T = g[$]) + 32768 & 32767;\n            }\n            if (C) {\n              w[x++] = 268435456 | Jt[R] << 18 | Xt[C];\n              var W = 31 & Jt[R],\n                z = 31 & Xt[C];\n              F += Bt[W] + Vt[z], ++k[257 + W], ++S[z], P = l + R, ++E;\n            } else w[x++] = e[l], ++k[e[l]];\n          }\n        }\n        u = yn(e, c, o, w, k, S, F, x, O, l - O, u), o || (u = vn(c, u, bn));\n      }\n      return ln(a, 0, r + un(u) + i);\n    }(e, null == t.level ? 6 : t.level, null == t.mem ? Math.ceil(1.5 * Math.max(8, Math.min(13, Math.log(e.length)))) : 12 + t.mem, n, r, !i);\n  },\n  En = function (e, t, n) {\n    for (; n; ++t) e[t] = n, n >>>= 8;\n  },\n  Fn = function (e, t) {\n    var n = t.filename;\n    if (e[0] = 31, e[1] = 139, e[2] = 8, e[8] = t.level < 2 ? 4 : 9 == t.level ? 2 : 0, e[9] = 3, 0 != t.mtime && En(e, 4, Math.floor(new Date(t.mtime || Date.now()) / 1e3)), n) {\n      e[3] = 8;\n      for (var r = 0; r <= n.length; ++r) e[r + 10] = n.charCodeAt(r);\n    }\n  },\n  xn = function (e) {\n    return 10 + (e.filename && e.filename.length + 1 || 0);\n  };\nfunction Pn(e, t) {\n  void 0 === t && (t = {});\n  var n = kn(),\n    r = e.length;\n  n.p(e);\n  var i = Sn(e, t, xn(t), 8),\n    o = i.length;\n  return Fn(i, t), En(i, o - 8, n.d()), En(i, o - 4, r), i;\n}\nfunction On(e, t) {\n  var n = e.length;\n  if (!t && \"undefined\" != typeof TextEncoder) return new TextEncoder().encode(e);\n  for (var r = new Ht(e.length + (e.length >>> 1)), i = 0, o = function (e) {\n      r[i++] = e;\n    }, s = 0; s < n; ++s) {\n    if (i + 5 > r.length) {\n      var a = new Ht(i + 8 + (n - s << 1));\n      a.set(r), r = a;\n    }\n    var c = e.charCodeAt(s);\n    c < 128 || t ? o(c) : c < 2048 ? (o(192 | c >>> 6), o(128 | 63 & c)) : c > 55295 && c < 57344 ? (o(240 | (c = 65536 + (1047552 & c) | 1023 & e.charCodeAt(++s)) >>> 18), o(128 | c >>> 12 & 63), o(128 | c >>> 6 & 63), o(128 | 63 & c)) : (o(224 | c >>> 12), o(128 | c >>> 6 & 63), o(128 | 63 & c));\n  }\n  return ln(r, 0, i);\n}\n!function (e) {\n  e.GZipJS = \"gzip-js\", e.Base64 = \"base64\";\n}(rn || (rn = {})), function (e) {\n  e.Popover = \"Popover\", e.Button = \"Button\", e.Email = \"Email\", e.FullScreen = \"Fullscreen\";\n}(on || (on = {})), function (e) {\n  e.Open = \"open\", e.MultipleChoiceSingle = \"multiple_single\", e.MultipleChoiceMulti = \"multiple_multi\", e.NPS = \"nps\", e.Rating = \"rating\", e.Link = \"link\";\n}(sn || (sn = {}));\nvar In = function (e, t, n) {\n    var r = t || {};\n    r.ip = n.ip ? 1 : 0, r._ = new Date().getTime().toString(), r.ver = y.LIB_VERSION;\n    var i = e.split(\"?\");\n    if (i.length > 1) {\n      var o,\n        s = v(i[1].split(\"&\"));\n      try {\n        for (s.s(); !(o = s.n()).done;) {\n          var a = o.value.split(\"=\")[0];\n          r[a] && delete r[a];\n        }\n      } catch (e) {\n        s.e(e);\n      } finally {\n        s.f();\n      }\n    }\n    var c = e.indexOf(\"?\") > -1 ? \"&\" : \"?\";\n    return e + c + function (e) {\n      var t,\n        n,\n        r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : \"&\",\n        i = [];\n      return U(e, function (e, r) {\n        t = encodeURIComponent(e.toString()), n = encodeURIComponent(r), i[i.length] = n + \"=\" + t;\n      }), i.join(r);\n    }(r);\n  },\n  $n = function e(t, n) {\n    if (n.blob && t.buffer) return new Blob([t.buffer], {\n      type: \"text/plain\"\n    });\n    if (n.sendBeacon || n.blob) {\n      var r = e(t, {\n        method: \"POST\"\n      });\n      return new Blob([r], {\n        type: \"application/x-www-form-urlencoded\"\n      });\n    }\n    if (\"POST\" !== n.method) return null;\n    var i, o;\n    return i = Array.isArray(t) || (o = t, \"[object Uint8Array]\" === Object.prototype.toString.call(o)) ? \"data=\" + encodeURIComponent(t) : \"data=\" + encodeURIComponent(t.data), \"compression\" in t && t.compression && (i += \"&compression=\" + t.compression), i;\n  },\n  Tn = function (e) {\n    var t = e.url,\n      n = e.data,\n      r = e.headers,\n      i = e.options,\n      o = e.captureMetrics,\n      s = e.callback,\n      a = e.retriesPerformedSoFar,\n      c = e.retryQueue,\n      u = e.onXHRError,\n      l = e.timeout,\n      d = void 0 === l ? 1e4 : l,\n      p = new XMLHttpRequest();\n    p.open(i.method || \"GET\", t, !0);\n    var f = $n(n, i);\n    o.incr(\"_send_request\"), o.incr(\"_send_request_inflight\"), U(r, function (e, t) {\n      p.setRequestHeader(t, e);\n    }), \"POST\" !== i.method || i.blob || p.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\"), p.timeout = d, p.withCredentials = !0, p.onreadystatechange = function () {\n      if (4 === p.readyState) if (o.incr(\"xhr-response\"), o.incr(\"xhr-response-\".concat(p.status)), o.decr(\"_send_request_inflight\"), 200 === p.status) {\n        if (s) {\n          var e;\n          try {\n            e = JSON.parse(p.responseText);\n          } catch (e) {\n            return void q.error(e);\n          }\n          s(e);\n        }\n      } else \"function\" == typeof u && u(p), [401, 403, 404, 500].indexOf(p.status) < 0 && c.enqueue({\n        url: t,\n        data: n,\n        options: i,\n        headers: r,\n        retriesPerformedSoFar: (a || 0) + 1,\n        callback: s\n      }), s && s({\n        status: 0\n      });\n    }, p.send(f);\n  },\n  Mn = 18e5;\nvar An = function (e) {\n    a(i, Dt);\n    var n = p(i);\n    function i(e, t) {\n      var o;\n      return r(this, i), (o = n.call(this)).captureMetrics = e, o.isPolling = !1, o.queue = [], o.areWeOnline = !0, o.onXHRError = t, \"undefined\" != typeof window && \"onLine\" in window.navigator && (o.areWeOnline = window.navigator.onLine, window.addEventListener(\"online\", function () {\n        o._handleWeAreNowOnline();\n      }), window.addEventListener(\"offline\", function () {\n        o.areWeOnline = !1;\n      })), o;\n    }\n    return o(i, [{\n      key: \"enqueue\",\n      value: function (e) {\n        var t = e.retriesPerformedSoFar || 0;\n        if (!(t >= 10)) {\n          var n = function (e) {\n              var t = 3e3 * Math.pow(2, e),\n                n = t / 2,\n                r = Math.min(Mn, t),\n                i = (Math.random() - .5) * (r - n);\n              return Math.ceil(r + i);\n            }(t),\n            r = new Date(Date.now() + n);\n          this.queue.push({\n            retryAt: r,\n            requestData: e\n          }), console.warn(\"Enqueued failed request for retry in \".concat(n)), this.isPolling || (this.isPolling = !0, this.poll());\n        }\n      }\n    }, {\n      key: \"poll\",\n      value: function () {\n        var e = this;\n        this._poller && clearTimeout(this._poller), this._poller = setTimeout(function () {\n          e.areWeOnline && e.queue.length > 0 && e.flush(), e.poll();\n        }, this._pollInterval);\n      }\n    }, {\n      key: \"flush\",\n      value: function () {\n        var e = new Date(Date.now()),\n          t = this.queue.filter(function (t) {\n            return t.retryAt < e;\n          });\n        if (t.length > 0) {\n          this.queue = this.queue.filter(function (t) {\n            return t.retryAt >= e;\n          });\n          var n,\n            r = v(t);\n          try {\n            for (r.s(); !(n = r.n()).done;) {\n              var i = n.value.requestData;\n              this._executeXhrRequest(i);\n            }\n          } catch (e) {\n            r.e(e);\n          } finally {\n            r.f();\n          }\n        }\n      }\n    }, {\n      key: \"unload\",\n      value: function () {\n        this._poller && (clearTimeout(this._poller), this._poller = void 0);\n        var e,\n          n = v(this.queue);\n        try {\n          for (n.s(); !(e = n.n()).done;) {\n            var r = e.value.requestData,\n              i = r.url,\n              o = r.data,\n              s = r.options;\n            try {\n              window.navigator.sendBeacon(i, $n(o, t(t({}, s), {}, {\n                sendBeacon: !0\n              })));\n            } catch (e) {\n              y.DEBUG && console.error(e);\n            }\n          }\n        } catch (e) {\n          n.e(e);\n        } finally {\n          n.f();\n        }\n        this.queue = [];\n      }\n    }, {\n      key: \"_executeXhrRequest\",\n      value: function (e) {\n        var t = e.url,\n          n = e.data,\n          r = e.options,\n          i = e.headers,\n          o = e.callback,\n          s = e.retriesPerformedSoFar;\n        Tn({\n          url: t,\n          data: n || {},\n          options: r || {},\n          headers: i || {},\n          retriesPerformedSoFar: s || 0,\n          callback: o,\n          captureMetrics: this.captureMetrics,\n          retryQueue: this,\n          onXHRError: this.onXHRError\n        });\n      }\n    }, {\n      key: \"_handleWeAreNowOnline\",\n      value: function () {\n        this.areWeOnline = !0, this.flush();\n      }\n    }]), i;\n  }(),\n  Rn = 1800,\n  Cn = 60,\n  jn = 864e5,\n  Dn = function () {\n    function e(t, n) {\n      r(this, e), this.config = t, this.persistence = n, this._windowId = void 0, this._sessionId = void 0, this._sessionStartTimestamp = null, this._sessionActivityTimestamp = null;\n      var i = t.persistence_name || t.token,\n        o = t.session_idle_timeout_seconds || Rn;\n      if (\"number\" != typeof o ? (console.warn(\"[PostHog] session_idle_timeout_seconds must be a number. Defaulting to 30 minutes.\"), o = Rn) : o > Rn ? console.warn(\"[PostHog] session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead.\") : o < Cn && console.warn(\"[PostHog] session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead.\"), this._sessionTimeoutMs = 1e3 * Math.min(Math.max(o, Cn), Rn), this._window_id_storage_key = \"ph_\" + i + \"_window_id\", this._primary_window_exists_storage_key = \"ph_\" + i + \"_primary_window_exists\", this._canUseSessionStorage()) {\n        var s = Re.parse(this._window_id_storage_key),\n          a = Re.parse(this._primary_window_exists_storage_key);\n        s && !a ? this._windowId = s : Re.remove(this._window_id_storage_key), Re.set(this._primary_window_exists_storage_key, !0);\n      }\n      this._listenToReloadWindow();\n    }\n    return o(e, [{\n      key: \"_canUseSessionStorage\",\n      value: function () {\n        return \"memory\" !== this.config.persistence && !this.persistence.disabled && Re.is_supported();\n      }\n    }, {\n      key: \"_setWindowId\",\n      value: function (e) {\n        e !== this._windowId && (this._windowId = e, this._canUseSessionStorage() && Re.set(this._window_id_storage_key, e));\n      }\n    }, {\n      key: \"_getWindowId\",\n      value: function () {\n        return this._windowId ? this._windowId : this._canUseSessionStorage() ? Re.parse(this._window_id_storage_key) : null;\n      }\n    }, {\n      key: \"_setSessionId\",\n      value: function (e, t, n) {\n        e === this._sessionId && t === this._sessionActivityTimestamp && n === this._sessionStartTimestamp || (this._sessionStartTimestamp = n, this._sessionActivityTimestamp = t, this._sessionId = e, this.persistence.register(s({}, Ue, [t, e, n])));\n      }\n    }, {\n      key: \"_getSessionId\",\n      value: function () {\n        if (this._sessionId && this._sessionActivityTimestamp && this._sessionStartTimestamp) return [this._sessionActivityTimestamp, this._sessionId, this._sessionStartTimestamp];\n        var e = this.persistence.props[Ue];\n        return Array.isArray(e) && 2 === e.length && e.push(e[0]), e || [0, null, 0];\n      }\n    }, {\n      key: \"resetSessionId\",\n      value: function () {\n        this._setSessionId(null, null, null);\n      }\n    }, {\n      key: \"_listenToReloadWindow\",\n      value: function () {\n        var e = this;\n        window.addEventListener(\"beforeunload\", function () {\n          e._canUseSessionStorage() && Re.remove(e._primary_window_exists_storage_key);\n        });\n      }\n    }, {\n      key: \"checkAndGetSessionAndWindowId\",\n      value: function () {\n        var e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0],\n          t = (arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null) || new Date().getTime(),\n          n = f(this._getSessionId(), 3),\n          r = n[0],\n          i = n[1],\n          o = n[2],\n          s = this._getWindowId(),\n          a = o && o > 0 && Math.abs(t - o) > jn;\n        !i || !e && Math.abs(t - r) > this._sessionTimeoutMs || a ? (i = se(), s = se(), o = t) : s || (s = se());\n        var c = 0 === r || !e || a ? t : r,\n          u = 0 === o ? new Date().getTime() : o;\n        return this._setWindowId(s), this._setSessionId(i, c, u), {\n          sessionId: i,\n          windowId: s,\n          sessionStartTimestamp: u\n        };\n      }\n    }]), e;\n  }(),\n  Nn = o(function e(t, n, i, o) {\n    r(this, e), this.name = \"posthog-js\", this.setupOnce = function (e) {\n      e(function (e) {\n        var r, s, a, c, u;\n        if (\"error\" !== e.level || !t.__loaded) return e;\n        e.tags || (e.tags = {});\n        var l = t.config.ui_host || t.config.api_host;\n        e.tags[\"PostHog Person URL\"] = l + \"/person/\" + t.get_distinct_id(), t.sessionRecordingStarted() && (e.tags[\"PostHog Recording URL\"] = t.get_session_replay_url({\n          withTimestamp: !0\n        }));\n        var d = (null === (r = e.exception) || void 0 === r ? void 0 : r.values) || [],\n          p = {\n            $exception_message: null === (s = d[0]) || void 0 === s ? void 0 : s.value,\n            $exception_type: null === (a = d[0]) || void 0 === a ? void 0 : a.type,\n            $exception_personURL: l + \"/person/\" + t.get_distinct_id(),\n            $sentry_event_id: e.event_id,\n            $sentry_exception: e.exception,\n            $sentry_exception_message: null === (c = d[0]) || void 0 === c ? void 0 : c.value,\n            $sentry_exception_type: null === (u = d[0]) || void 0 === u ? void 0 : u.type,\n            $sentry_tags: e.tags\n          };\n        return n && i && (p.$sentry_url = (o || \"https://sentry.io/organizations/\") + n + \"/issues/?project=\" + i + \"&query=\" + e.event_id), t.capture(\"$exception\", p), e;\n      });\n    };\n  }),\n  qn = function (e) {\n    Promise && Promise.resolve || console.warn(\"This browser does not have Promise support, and can not use the segment integration\");\n    var t = function (t, n) {\n      t.event.userId || t.event.anonymousId === e.get_distinct_id() || e.reset(), t.event.userId && t.event.userId !== e.get_distinct_id() && (e.register({\n        distinct_id: t.event.userId\n      }), e.reloadFeatureFlags());\n      var r = e._calculate_event_properties(n, t.event.properties);\n      return t.event.properties = Object.assign({}, r, t.event.properties), t;\n    };\n    return {\n      name: \"PostHog JS\",\n      type: \"enrichment\",\n      version: \"1.0.0\",\n      isLoaded: function () {\n        return !0;\n      },\n      load: function () {\n        return Promise.resolve();\n      },\n      track: function (e) {\n        return t(e, e.event.event);\n      },\n      page: function (e) {\n        return t(e, \"$pageview\");\n      },\n      identify: function (e) {\n        return t(e, \"$identify\");\n      },\n      screen: function (e) {\n        return t(e, \"$screen\");\n      }\n    };\n  },\n  Hn = function () {\n    function e() {\n      r(this, e), s(this, \"_seenFirstPageView\", !1);\n    }\n    return o(e, [{\n      key: \"onPageview\",\n      value: function () {\n        this._seenFirstPageView && (this._pageViewId = se()), this._seenFirstPageView = !0;\n      }\n    }, {\n      key: \"getPageViewId\",\n      value: function () {\n        return this._pageViewId || (this._pageViewId = se()), this._pageViewId;\n      }\n    }]), e;\n  }();\nfunction Ln(e) {\n  return \"undefined\" != typeof Event && Un(e, Event);\n}\nfunction Un(e, t) {\n  try {\n    return e instanceof t;\n  } catch (e) {\n    return !1;\n  }\n}\nfunction Bn(e) {\n  return null === e || \"object\" !== n(e) && \"function\" != typeof e;\n}\nfunction Vn(e, t) {\n  return Object.prototype.toString.call(e) === \"[object \".concat(t, \"]\");\n}\nfunction Gn(e) {\n  return Vn(e, \"DOMError\");\n}\nvar Wn = /\\(error: (.*)\\)/,\n  zn = 50,\n  Qn = \"?\";\nfunction Jn(e, t, n, r) {\n  var i = {\n    filename: e,\n    function: t,\n    in_app: !0\n  };\n  return void 0 !== n && (i.lineno = n), void 0 !== r && (i.colno = r), i;\n}\nvar Xn = /^\\s*at (?:(.+?\\)(?: \\[.+\\])?|.*?) ?\\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\\/)?.*?)(?::(\\d+))?(?::(\\d+))?\\)?\\s*$/i,\n  Yn = /\\((\\S*)(?::(\\d+))(?::(\\d+))\\)/,\n  Zn = /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)?((?:[-a-z]+)?:\\/.*?|\\[native code\\]|[^@]*(?:bundle|\\d+\\.js)|\\/[\\w\\-. /=]+)(?::(\\d+))?(?::(\\d+))?\\s*$/i,\n  Kn = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i,\n  er = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:[-a-z]+):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i;\nvar tr = function () {\n    for (var e = arguments.length, n = new Array(e), r = 0; r < e; r++) n[r] = arguments[r];\n    var i = n.sort(function (e, t) {\n      return e[0] - t[0];\n    }).map(function (e) {\n      return e[1];\n    });\n    return function (e) {\n      for (var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, r = [], o = e.split(\"\\n\"), s = n; s < o.length; s++) {\n        var a = o[s];\n        if (!(a.length > 1024)) {\n          var c = Wn.test(a) ? a.replace(Wn, \"$1\") : a;\n          if (!c.match(/\\S*Error: /)) {\n            var u,\n              l = v(i);\n            try {\n              for (l.s(); !(u = l.n()).done;) {\n                var d = (0, u.value)(c);\n                if (d) {\n                  r.push(d);\n                  break;\n                }\n              }\n            } catch (e) {\n              l.e(e);\n            } finally {\n              l.f();\n            }\n            if (r.length >= zn) break;\n          }\n        }\n      }\n      return function (e) {\n        if (!e.length) return [];\n        var n = e.slice(0, zn);\n        return n.reverse(), n.map(function (e) {\n          return t(t({}, e), {}, {\n            filename: e.filename || n[n.length - 1].filename,\n            function: e.function || \"?\"\n          });\n        });\n      }(r);\n    };\n  }.apply(void 0, [[30, function (e) {\n    var t = Xn.exec(e);\n    if (t) {\n      if (t[2] && 0 === t[2].indexOf(\"eval\")) {\n        var n = Yn.exec(t[2]);\n        n && (t[2] = n[1], t[3] = n[2], t[4] = n[3]);\n      }\n      var r = f(nr(t[1] || Qn, t[2]), 2),\n        i = r[0];\n      return Jn(r[1], i, t[3] ? +t[3] : void 0, t[4] ? +t[4] : void 0);\n    }\n  }], [50, function (e) {\n    var t = Zn.exec(e);\n    if (t) {\n      if (t[3] && t[3].indexOf(\" > eval\") > -1) {\n        var n = Kn.exec(t[3]);\n        n && (t[1] = t[1] || \"eval\", t[3] = n[1], t[4] = n[2], t[5] = \"\");\n      }\n      var r = t[3],\n        i = t[1] || Qn,\n        o = f(nr(i, r), 2);\n      return i = o[0], Jn(r = o[1], i, t[4] ? +t[4] : void 0, t[5] ? +t[5] : void 0);\n    }\n  }], [40, function (e) {\n    var t = er.exec(e);\n    return t ? Jn(t[2], t[1] || Qn, +t[3], t[4] ? +t[4] : void 0) : void 0;\n  }]]),\n  nr = function (e, t) {\n    var n = -1 !== e.indexOf(\"safari-extension\"),\n      r = -1 !== e.indexOf(\"safari-web-extension\");\n    return n || r ? [-1 !== e.indexOf(\"@\") ? e.split(\"@\")[0] : Qn, n ? \"safari-extension:\".concat(t) : \"safari-web-extension:\".concat(t)] : [e, t];\n  },\n  rr = /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,\n  ir = /Minified React error #\\d+;/i;\nfunction or(e) {\n  var t = e.stacktrace || e.stack || \"\",\n    n = function (e) {\n      if (e) {\n        if (\"number\" == typeof e.framesToPop) return e.framesToPop;\n        if (ir.test(e.message)) return 1;\n      }\n      return 0;\n    }(e);\n  try {\n    return tr(t, n);\n  } catch (e) {}\n  return [];\n}\nfunction sr(e) {\n  var t = or(e);\n  return {\n    $exception_type: e.name,\n    $exception_message: e.message,\n    $exception_stack_trace_raw: JSON.stringify(t)\n  };\n}\nfunction ar(e) {\n  var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 40,\n    n = Object.keys(e);\n  if (n.sort(), !n.length) return \"[object has no keys]\";\n  for (var r = n.length; r > 0; r--) {\n    var i = n.slice(0, r).join(\", \");\n    if (!(i.length > t)) return r === n.length || i.length <= t ? i : \"\".concat(i.slice(0, t), \"...\");\n  }\n  return \"\";\n}\nfunction cr(e) {\n  var n = f(e, 5),\n    r = n[0],\n    i = n[1],\n    o = n[2],\n    s = n[3],\n    a = n[4],\n    c = {};\n  if (void 0 === a && \"string\" == typeof r) {\n    var u = \"Error\",\n      l = r,\n      d = r.match(rr);\n    d && (u = d[1], l = d[2]), c = {\n      $exception_type: u,\n      $exception_message: l\n    };\n  }\n  var p = a || r;\n  if (Gn(p) || function (e) {\n    return Vn(e, \"DOMException\");\n  }(p)) {\n    var h = p;\n    if (function (e) {\n      return \"stack\" in e;\n    }(p)) c = sr(p);else {\n      var _ = h.name || (Gn(h) ? \"DOMError\" : \"DOMException\"),\n        g = h.message ? \"\".concat(_, \": \").concat(h.message) : _;\n      c = function (e) {\n        return {\n          $exception_type: \"Error\",\n          $exception_message: e\n        };\n      }(g), c.$exception_type = Gn(h) ? \"DOMError\" : \"DOMException\", c.$exception_message = c.$exception_message || g;\n    }\n    \"code\" in h && (c.$exception_DOMException_code = \"\".concat(h.code));\n  } else if (function (e) {\n    return Vn(e, \"ErrorEvent\");\n  }(p) && p.error) c = sr(p.error);else if (function (e) {\n    switch (Object.prototype.toString.call(e)) {\n      case \"[object Error]\":\n      case \"[object Exception]\":\n      case \"[object DOMException]\":\n        return !0;\n      default:\n        return Un(e, Error);\n    }\n  }(p)) c = sr(p);else if (function (e) {\n    return Vn(e, \"Object\");\n  }(p) || Ln(p)) {\n    c = function (e) {\n      return {\n        $exception_type: Ln(e) ? e.constructor.name : \"Error\",\n        $exception_message: \"Non-Error \".concat(\"exception\", \" captured with keys: \", ar(e))\n      };\n    }(p), c.$exception_is_synthetic = !0;\n  } else c.$exception_type = c.$exception_type || \"Error\", c.$exception_message = c.$exception_message || p, c.$exception_is_synthetic = !0;\n  return t(t(t(t({}, c), {}, {\n    $exception_type: c.$exception_type || \"UnknownErrorType\",\n    $exception_message: c.$exception_message || \"\"\n  }, i ? {\n    $exception_source: i\n  } : {}), o ? {\n    $exception_lineno: o\n  } : {}), s ? {\n    $exception_colno: s\n  } : {});\n}\nvar ur,\n  lr,\n  dr,\n  pr = function () {\n    function e(t) {\n      r(this, e), s(this, \"originalOnErrorHandler\", void 0), s(this, \"originalOnUnhandledRejectionHandler\", void 0), s(this, \"errorsToIgnore\", []), this.instance = t;\n    }\n    return o(e, [{\n      key: \"debugLog\",\n      value: function () {\n        if (this.instance.get_config(\"debug\")) {\n          for (var e, t = arguments.length, n = new Array(t), r = 0; r < t; r++) n[r] = arguments[r];\n          (e = console).log.apply(e, [\"PostHog.js [PostHog.ExceptionObserver]\"].concat(n));\n        }\n      }\n    }, {\n      key: \"startCapturing\",\n      value: function () {\n        var e;\n        if (this.isEnabled() && (null === (e = $.onerror) || void 0 === e || !e.__POSTHOG_INSTRUMENTED__)) try {\n          this.originalOnErrorHandler = $.onerror, $.onerror = function () {\n            for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++) t[n] = arguments[n];\n            return this.captureException(t), !!this.originalOnErrorHandler && this.originalOnErrorHandler.apply(this, t);\n          }.bind(this), $.onerror.__POSTHOG_INSTRUMENTED__ = !0, this.originalOnUnhandledRejectionHandler = $.onunhandledrejection, $.onunhandledrejection = function () {\n            for (var e = arguments.length, n = new Array(e), r = 0; r < e; r++) n[r] = arguments[r];\n            var i = function (e) {\n              var n = f(e, 1)[0],\n                r = n;\n              try {\n                \"reason\" in n ? r = n.reason : \"detail\" in n && \"reason\" in n.detail && (r = n.detail.reason);\n              } catch (e) {}\n              var i = {};\n              return (i = Bn(r) ? {\n                $exception_message: \"Non-Error promise rejection captured with value: \".concat(String(r))\n              } : cr([r])).$exception_handled = !1, t(t({}, i), {}, {\n                $exception_type: i.$exception_type = \"UnhandledRejection\",\n                $exception_message: i.$exception_message = i.$exception_message || n.reason || String(r)\n              });\n            }(n);\n            return this.sendExceptionEvent(i), !this.originalOnUnhandledRejectionHandler || this.originalOnUnhandledRejectionHandler.apply($, n);\n          }.bind(this), $.onunhandledrejection.__POSTHOG_INSTRUMENTED__ = !0;\n        } catch (e) {\n          console.error(\"PostHog failed to start exception autocapture\", e), this.stopCapturing();\n        }\n      }\n    }, {\n      key: \"stopCapturing\",\n      value: function () {\n        var e, t;\n        void 0 !== this.originalOnErrorHandler && ($.onerror = this.originalOnErrorHandler, this.originalOnErrorHandler = null), null === (e = $.onerror) || void 0 === e || delete e.__POSTHOG_INSTRUMENTED__, void 0 !== this.originalOnUnhandledRejectionHandler && ($.onunhandledrejection = this.originalOnUnhandledRejectionHandler, this.originalOnUnhandledRejectionHandler = null), null === (t = $.onunhandledrejection) || void 0 === t || delete t.__POSTHOG_INSTRUMENTED__;\n      }\n    }, {\n      key: \"isCapturing\",\n      value: function () {\n        var e;\n        return !(null === (e = $.onerror) || void 0 === e || !e.__POSTHOG_INSTRUMENTED__);\n      }\n    }, {\n      key: \"isEnabled\",\n      value: function () {\n        var e;\n        return null !== (e = this.remoteEnabled) && void 0 !== e && e;\n      }\n    }, {\n      key: \"afterDecideResponse\",\n      value: function (e) {\n        var t = e.autocaptureExceptions;\n        if (this.remoteEnabled = !!t || !1, !Bn(t) && \"errors_to_ignore\" in t && Array.isArray(t.errors_to_ignore)) {\n          var n = t.errors_to_ignore;\n          this.errorsToIgnore = n.map(function (e) {\n            return new RegExp(e);\n          });\n        }\n        this.isEnabled() ? (this.startCapturing(), this.debugLog(\"Remote config for exception autocapture is enabled, starting\", t)) : this.debugLog(\"Remote config for exception autocapture is disabled, not starting\", t);\n      }\n    }, {\n      key: \"captureException\",\n      value: function (e, n) {\n        var r = cr(e);\n        if (this.errorsToIgnore.some(function (e) {\n          return e.test(r.$exception_message || \"\");\n        })) this.debugLog(\"Ignoring exception based on remote config\", r);else {\n          var i = t(t({}, n), r),\n            o = this.instance.get_config(\"ui_host\") || this.instance.get_config(\"api_host\");\n          r.$exception_personURL = o + \"/person/\" + this.instance.get_distinct_id(), this.sendExceptionEvent(i);\n        }\n      }\n    }, {\n      key: \"sendExceptionEvent\",\n      value: function (e) {\n        this.instance.capture(\"$exception\", e, {\n          transport: \"XHR\",\n          method: \"POST\",\n          endpoint: \"/e/\",\n          _noTruncate: !0,\n          _batchKey: \"exceptionEvent\"\n        });\n      }\n    }]), e;\n  }(),\n  fr = function () {\n    function e(t) {\n      r(this, e), this.instance = t;\n    }\n    return o(e, [{\n      key: \"getSurveys\",\n      value: function (e) {\n        var t = this,\n          n = arguments.length > 1 && void 0 !== arguments[1] && arguments[1],\n          r = this.instance.get_property(ze);\n        if (r && !n) return e(r);\n        this.instance._send_request(\"\".concat(this.instance.get_config(\"api_host\"), \"/api/surveys/?token=\").concat(this.instance.get_config(\"token\")), {}, {\n          method: \"GET\"\n        }, function (n) {\n          var r = n.surveys;\n          return t.instance.persistence.register(s({}, ze, r)), e(r);\n        });\n      }\n    }, {\n      key: \"getActiveMatchingSurveys\",\n      value: function (e) {\n        var t = this,\n          n = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];\n        this.getSurveys(function (n) {\n          var r = n.filter(function (e) {\n            return !(!e.start_date || e.end_date);\n          }).filter(function (e) {\n            var t, n;\n            if (!e.conditions) return !0;\n            var r = null === (t = e.conditions) || void 0 === t || !t.url || window.location.href.indexOf(e.conditions.url) > -1,\n              i = null === (n = e.conditions) || void 0 === n || !n.selector || document.querySelector(e.conditions.selector);\n            return r && i;\n          }).filter(function (e) {\n            if (!e.linked_flag_key && !e.targeting_flag_key) return !0;\n            var n = !e.linked_flag_key || t.instance.featureFlags.isFeatureEnabled(e.linked_flag_key),\n              r = !e.targeting_flag_key || t.instance.featureFlags.isFeatureEnabled(e.targeting_flag_key);\n            return n && r;\n          });\n          return e(r);\n        }, n);\n      }\n    }]), e;\n  }();\n!function (e) {\n  e[e.INIT_MODULE = 0] = \"INIT_MODULE\", e[e.INIT_SNIPPET = 1] = \"INIT_SNIPPET\";\n}(ur || (ur = {}));\nvar hr = function () {},\n  _r = {},\n  gr = \"posthog\",\n  vr = $.XMLHttpRequest && \"withCredentials\" in new XMLHttpRequest(),\n  yr = !vr && -1 === A.indexOf(\"MSIE\") && -1 === A.indexOf(\"Mozilla\"),\n  mr = function () {\n    var e, t, n;\n    return {\n      api_host: \"https://app.posthog.com\",\n      api_method: \"POST\",\n      api_transport: \"XHR\",\n      ui_host: null,\n      token: \"\",\n      autocapture: !0,\n      rageclick: !0,\n      cross_subdomain_cookie: -1 === (null == M || null === (e = M.location) || void 0 === e || null === (t = e.hostname) || void 0 === t ? void 0 : t.indexOf(\"herokuapp.com\")),\n      persistence: \"cookie\",\n      persistence_name: \"\",\n      cookie_name: \"\",\n      loaded: hr,\n      store_google: !0,\n      custom_campaign_params: [],\n      save_referrer: !0,\n      test: !1,\n      verbose: !1,\n      capture_pageview: !0,\n      capture_pageleave: !0,\n      debug: !1,\n      cookie_expiration: 365,\n      upgrade: !1,\n      disable_session_recording: !1,\n      disable_persistence: !1,\n      disable_cookie: !1,\n      enable_recording_console_log: void 0,\n      secure_cookie: \"https:\" === (null == $ || null === (n = $.location) || void 0 === n ? void 0 : n.protocol),\n      ip: !0,\n      opt_out_capturing_by_default: !1,\n      opt_out_persistence_by_default: !1,\n      opt_out_capturing_persistence_type: \"localStorage\",\n      opt_out_capturing_cookie_prefix: null,\n      opt_in_site_apps: !1,\n      property_blacklist: [],\n      respect_dnt: !1,\n      sanitize_properties: null,\n      xhr_headers: {},\n      inapp_protocol: \"//\",\n      inapp_link_new_window: !1,\n      request_batching: !0,\n      properties_string_max_length: 65535,\n      session_recording: {},\n      mask_all_element_attributes: !1,\n      mask_all_text: !1,\n      advanced_disable_decide: !1,\n      advanced_disable_toolbar_metrics: !1,\n      on_xhr_error: function (e) {\n        var t = \"Bad HTTP status: \" + e.status + \" \" + e.statusText;\n        console.error(t);\n      },\n      get_device_id: function (e) {\n        return e;\n      },\n      _onCapture: hr,\n      _capture_metrics: !1,\n      capture_performance: void 0,\n      name: \"posthog\",\n      callback_fn: \"posthog._jsc\",\n      bootstrap: {},\n      disable_compression: !1,\n      session_idle_timeout_seconds: 1800\n    };\n  },\n  br = function (e, t, n, r) {\n    var i,\n      o = n !== gr && dr ? n ? dr[n] : void 0 : dr,\n      s = {\n        initComplete: !1,\n        syncCode: !1\n      },\n      a = function (e) {\n        return function (t) {\n          s[e] || (s[e] = !0, s.initComplete && s.syncCode && (null == r || r(t)));\n        };\n      };\n    if (o && lr === ur.INIT_MODULE) i = o;else {\n      if (o && !V(o)) return void console.error(\"You have already initialized \" + n);\n      i = new wr();\n    }\n    if (i._init(e, t, n, a(\"initComplete\")), i.toolbar.maybeLoadToolbar(), i.sessionRecording = new Pt(i), i.sessionRecording.startRecordingIfEnabled(), i.webPerformance = new Tt(i), i.webPerformance.startObservingIfEnabled(), i.exceptionAutocapture = new pr(i), i.__autocapture = i.get_config(\"autocapture\"), Ke._setIsAutocaptureEnabled(i), Ke._isAutocaptureEnabled) {\n      i.__autocapture = i.get_config(\"autocapture\");\n      Ke.enabledForProject(i.get_config(\"token\"), 100, 100) ? Ke.isBrowserSupported() ? Ke.init(i) : (i.__autocapture = !1, q.log(\"Disabling Automatic Event Collection because this browser is not supported\")) : (i.__autocapture = !1, q.log(\"Not in active bucket: disabling Automatic Event Collection.\"));\n    }\n    return y.DEBUG = y.DEBUG || i.get_config(\"debug\"), void 0 !== o && V(o) && (i._execute_array.call(i.people, o.people), i._execute_array(o)), a(\"syncCode\")(i), i;\n  },\n  wr = function () {\n    function e() {\n      var t = this;\n      r(this, e), this.config = mr(), this.compression = {}, this.decideEndpointWasHit = !1, this.SentryIntegration = Nn, this.segmentIntegration = function () {\n        return qn(t);\n      }, this.__captureHooks = [], this.__request_queue = [], this.__loaded = !1, this.__loaded_recorder_version = void 0, this.__autocapture = void 0, this._jsc = function () {}, this.people = new ft(this), this.featureFlags = new yt(this), this.toolbar = new jt(this), this.pageViewIdManager = new Hn(), this.surveys = new fr(this), this._captureMetrics = void 0, this._requestQueue = void 0, this._retryQueue = void 0, this.persistence = void 0, this.sessionPersistence = void 0, this.sessionManager = void 0;\n    }\n    return o(e, [{\n      key: \"init\",\n      value: function (e, t, n) {\n        if (Q(n)) console.error(\"You must name your new library: init(token, config, name)\");else {\n          if (n !== gr) {\n            var r = br(e, t, n, function (e) {\n              dr[n] = e, e._loaded();\n            });\n            return dr[n] = r, r;\n          }\n          console.error(\"You must initialize the main posthog object right after you include the PostHog js snippet\");\n        }\n      }\n    }, {\n      key: \"_init\",\n      value: function (e) {\n        var n,\n          r,\n          i = this,\n          o = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},\n          s = arguments.length > 2 ? arguments[2] : void 0,\n          a = arguments.length > 3 ? arguments[3] : void 0;\n        this.__loaded = !0, this.config = {}, this._triggered_notifs = [];\n        var c,\n          u = {\n            segmentRegister: !1,\n            syncCode: !1\n          },\n          l = function (e) {\n            return function () {\n              u[e] || (u[e] = !0, u.segmentRegister && u.syncCode && (null == a || a(i)));\n            };\n          };\n        (this.set_config(B({}, mr(), o, {\n          name: s,\n          token: e,\n          callback_fn: (s === gr ? s : gr + \".\" + s) + \"._jsc\"\n        })), this._jsc = function () {}, null != $ && null !== (n = $.rrweb) && void 0 !== n && n.record || null != $ && $.rrwebRecord) && (this.__loaded_recorder_version = null == $ || null === (c = $.rrweb) || void 0 === c ? void 0 : c.version);\n        if (this._captureMetrics = new qt(this.get_config(\"_capture_metrics\")), this._requestQueue = new Nt(this._captureMetrics, this._handle_queued_event.bind(this)), this._retryQueue = new An(this._captureMetrics, this.get_config(\"on_xhr_error\")), this.__captureHooks = [], this.__request_queue = [], this.persistence = new Ze(this.config), this.sessionManager = new Dn(this.config, this.persistence), this.sessionPersistence = \"sessionStorage\" === this.config.persistence ? this.persistence : new Ze(t(t({}, this.config), {}, {\n          persistence: \"sessionStorage\"\n        })), this._gdpr_init(), o.segment ? (this.config.get_device_id = function () {\n          return o.segment.user().anonymousId();\n        }, o.segment.user().id() && (this.register({\n          distinct_id: o.segment.user().id()\n        }), this.persistence.set_user_state(\"identified\")), o.segment.register(this.segmentIntegration()).then(l(\"segmentRegister\"))) : l(\"segmentRegister\")(), void 0 !== (null === (r = o.bootstrap) || void 0 === r ? void 0 : r.distinctID)) {\n          var d,\n            p,\n            f = this.get_config(\"get_device_id\")(se()),\n            h = null !== (d = o.bootstrap) && void 0 !== d && d.isIdentifiedID ? f : o.bootstrap.distinctID;\n          this.persistence.set_user_state(null !== (p = o.bootstrap) && void 0 !== p && p.isIdentifiedID ? \"identified\" : \"anonymous\"), this.register({\n            distinct_id: o.bootstrap.distinctID,\n            $device_id: h\n          });\n        }\n        if (this._hasBootstrappedFeatureFlags()) {\n          var _,\n            g,\n            v = Object.keys((null === (_ = o.bootstrap) || void 0 === _ ? void 0 : _.featureFlags) || {}).filter(function (e) {\n              var t, n;\n              return !(null === (t = o.bootstrap) || void 0 === t || null === (n = t.featureFlags) || void 0 === n || !n[e]);\n            }).reduce(function (e, t) {\n              var n, r;\n              return e[t] = (null === (n = o.bootstrap) || void 0 === n || null === (r = n.featureFlags) || void 0 === r ? void 0 : r[t]) || !1, e;\n            }, {}),\n            y = Object.keys((null === (g = o.bootstrap) || void 0 === g ? void 0 : g.featureFlagPayloads) || {}).filter(function (e) {\n              return v[e];\n            }).reduce(function (e, t) {\n              var n, r, i, s;\n              null !== (n = o.bootstrap) && void 0 !== n && null !== (r = n.featureFlagPayloads) && void 0 !== r && r[t] && (e[t] = null === (i = o.bootstrap) || void 0 === i || null === (s = i.featureFlagPayloads) || void 0 === s ? void 0 : s[t]);\n              return e;\n            }, {});\n          this.featureFlags.receivedFeatureFlags({\n            featureFlags: v,\n            featureFlagPayloads: y\n          });\n        }\n        if (!this.get_distinct_id()) {\n          var m = this.get_config(\"get_device_id\")(se());\n          this.register_once({\n            distinct_id: m,\n            $device_id: m\n          }, \"\"), this.persistence.set_user_state(\"anonymous\");\n        }\n        $.addEventListener && $.addEventListener(\"onpagehide\" in self ? \"pagehide\" : \"unload\", this._handle_unload.bind(this)), l(\"syncCode\")();\n      }\n    }, {\n      key: \"_loaded\",\n      value: function () {\n        this.featureFlags.setReloadingPaused(!0);\n        try {\n          this.get_config(\"loaded\")(this);\n        } catch (e) {\n          console.error(\"`loaded` function failed\", e);\n        }\n        this._start_queue_if_opted_in(), this.get_config(\"capture_pageview\") && this.capture(\"$pageview\", {}, {\n          send_instantly: !0\n        }), this.get_config(\"advanced_disable_decide\") || new At(this).call(), this.featureFlags.resetRequestQueue(), this.featureFlags.setReloadingPaused(!1);\n      }\n    }, {\n      key: \"_start_queue_if_opted_in\",\n      value: function () {\n        this.has_opted_out_capturing() || this.get_config(\"request_batching\") && this._requestQueue.poll();\n      }\n    }, {\n      key: \"_dom_loaded\",\n      value: function () {\n        var e = this;\n        this.has_opted_out_capturing() || L(this.__request_queue, function (t) {\n          e._send_request.apply(e, h(t));\n        }), this.__request_queue = [], this._start_queue_if_opted_in();\n      }\n    }, {\n      key: \"_prepare_callback\",\n      value: function (e, t) {\n        if (Q(e)) return null;\n        if (vr) return function (n) {\n          e(n, t);\n        };\n        var n = this._jsc,\n          r = \"\" + Math.floor(1e8 * Math.random()),\n          i = this.get_config(\"callback_fn\") + \"[\" + r + \"]\";\n        return n[r] = function (i) {\n          delete n[r], e(i, t);\n        }, i;\n      }\n    }, {\n      key: \"_handle_unload\",\n      value: function () {\n        this.get_config(\"request_batching\") ? (this.get_config(\"capture_pageview\") && this.get_config(\"capture_pageleave\") && this.capture(\"$pageleave\"), this.get_config(\"_capture_metrics\") && (this._requestQueue.updateUnloadMetrics(), this.capture(\"$capture_metrics\", this._captureMetrics.metrics)), this._requestQueue.unload(), this._retryQueue.unload()) : this.get_config(\"capture_pageview\") && this.get_config(\"capture_pageleave\") && this.capture(\"$pageleave\", null, {\n          transport: \"sendBeacon\"\n        });\n      }\n    }, {\n      key: \"_handle_queued_event\",\n      value: function (e, t, n) {\n        var r = JSON.stringify(t);\n        this.__compress_and_send_json_request(e, r, n || _r, hr);\n      }\n    }, {\n      key: \"__compress_and_send_json_request\",\n      value: function (e, n, r, i) {\n        var o = function (e, n, r) {\n            return e === rn.GZipJS ? [Pn(On(n), {\n              mtime: 0\n            }), t(t({}, r), {}, {\n              blob: !0,\n              urlQueryArgs: {\n                compression: rn.GZipJS\n              }\n            })] : [{\n              data: re(n)\n            }, r];\n          }(this.compression[rn.GZipJS] ? rn.GZipJS : rn.Base64, n, r),\n          s = f(o, 2),\n          a = s[0],\n          c = s[1];\n        this._send_request(e, a, c, i);\n      }\n    }, {\n      key: \"_send_request\",\n      value: function (e, n, r, i) {\n        if (yr) this.__request_queue.push([e, n, r, i]);else {\n          var o = {\n            method: this.get_config(\"api_method\"),\n            transport: this.get_config(\"api_transport\"),\n            verbose: this.get_config(\"verbose\")\n          };\n          r = B(o, r || {}), vr || (r.method = \"GET\");\n          var s = \"sendBeacon\" in $.navigator && \"sendBeacon\" === r.transport;\n          if (e = In(e, r.urlQueryArgs || {}, {\n            ip: this.get_config(\"ip\")\n          }), s) try {\n            $.navigator.sendBeacon(e, $n(n, t(t({}, r), {}, {\n              sendBeacon: !0\n            })));\n          } catch (e) {\n            this.get_config(\"debug\") && console.error(e);\n          } else if (vr) try {\n            Tn({\n              url: e,\n              data: n,\n              headers: this.get_config(\"xhr_headers\"),\n              options: r,\n              captureMetrics: this._captureMetrics,\n              callback: i,\n              retriesPerformedSoFar: 0,\n              retryQueue: this._retryQueue,\n              onXHRError: this.get_config(\"on_xhr_error\")\n            });\n          } catch (e) {\n            console.error(e);\n          } else {\n            var a,\n              c = M.createElement(\"script\");\n            c.type = \"text/javascript\", c.async = !0, c.defer = !0, c.src = e;\n            var u = M.getElementsByTagName(\"script\")[0];\n            null === (a = u.parentNode) || void 0 === a || a.insertBefore(c, u);\n          }\n        }\n      }\n    }, {\n      key: \"_execute_array\",\n      value: function (e) {\n        var t,\n          n = this,\n          r = [],\n          i = [],\n          o = [];\n        L(e, function (e) {\n          e && (t = e[0], V(t) ? o.push(e) : \"function\" == typeof e ? e.call(n) : V(e) && \"alias\" === t ? r.push(e) : V(e) && -1 !== t.indexOf(\"capture\") && \"function\" == typeof n[t] ? o.push(e) : i.push(e));\n        });\n        var s = function (e, t) {\n          L(e, function (e) {\n            if (V(e[0])) {\n              var n = t;\n              U(e, function (e) {\n                n = n[e[0]].apply(n, e.slice(1));\n              });\n            } else this[e[0]].apply(this, e.slice(1));\n          }, t);\n        };\n        s(r, this), s(i, this), s(o, this);\n      }\n    }, {\n      key: \"_hasBootstrappedFeatureFlags\",\n      value: function () {\n        var e, t;\n        return (null === (e = this.config.bootstrap) || void 0 === e ? void 0 : e.featureFlags) && Object.keys(null === (t = this.config.bootstrap) || void 0 === t ? void 0 : t.featureFlags).length > 0 || !1;\n      }\n    }, {\n      key: \"push\",\n      value: function (e) {\n        this._execute_array([e]);\n      }\n    }, {\n      key: \"captureException\",\n      value: function (e, t) {\n        var n;\n        null === (n = this.exceptionAutocapture) || void 0 === n || n.captureException([e.name, void 0, void 0, void 0, e], t);\n      }\n    }, {\n      key: \"capture\",\n      value: function (e, t) {\n        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : _r;\n        if (this.__loaded && !lt(this, !1)) {\n          this._captureMetrics.incr(\"capture\"), \"$snapshot\" === e && this._captureMetrics.incr(\"snapshot\");\n          var r = (n = n || _r).transport;\n          if (r && (n.transport = r), Q(e) || \"string\" != typeof e) console.error(\"No event name provided to posthog.capture\");else if (!ae(A)) {\n            this.sessionPersistence.update_search_keyword(), this.get_config(\"store_google\") && this.sessionPersistence.update_campaign_params(), this.get_config(\"save_referrer\") && this.sessionPersistence.update_referrer_info();\n            var i = {\n              uuid: se(\"v7\"),\n              event: e,\n              properties: this._calculate_event_properties(e, t || {})\n            };\n            \"$identify\" === e && (i.$set = n.$set, i.$set_once = n.$set_once), (i = ne(i, n._noTruncate ? null : this.get_config(\"properties_string_max_length\"))).timestamp = n.timestamp || new Date(), this.get_config(\"debug\") && q.log(\"PostHog.js send\", i);\n            var o = JSON.stringify(i),\n              s = this.get_config(\"api_host\") + (n.endpoint || \"/e/\"),\n              a = n !== _r;\n            return !this.get_config(\"request_batching\") || a && !n._batchKey || n.send_instantly ? this.__compress_and_send_json_request(s, o, n) : this._requestQueue.enqueue(s, i, n), this._invokeCaptureHooks(e, i), i;\n          }\n        }\n      }\n    }, {\n      key: \"_addCaptureHook\",\n      value: function (e) {\n        this.__captureHooks.push(e);\n      }\n    }, {\n      key: \"_invokeCaptureHooks\",\n      value: function (e, t) {\n        this.config._onCapture(e, t), U(this.__captureHooks, function (t) {\n          return t(e);\n        });\n      }\n    }, {\n      key: \"_calculate_event_properties\",\n      value: function (e, n) {\n        var r,\n          i = this.persistence.remove_event_timer(e),\n          o = t({}, n);\n        if (o.token = this.get_config(\"token\"), \"$snapshot\" === e) {\n          var s = t(t({}, this.persistence.properties()), this.sessionPersistence.properties());\n          return o.distinct_id = s.distinct_id, o;\n        }\n        var a = pe.properties();\n        if (this.sessionManager) {\n          var c = this.sessionManager.checkAndGetSessionAndWindowId(),\n            u = c.sessionId,\n            l = c.windowId;\n          o.$session_id = u, o.$window_id = l;\n        }\n        if (null !== (r = this.webPerformance) && void 0 !== r && r.isEnabled && (\"$pageview\" === e && this.pageViewIdManager.onPageview(), o = B(o, {\n          $pageview_id: this.pageViewIdManager.getPageViewId()\n        })), \"$performance_event\" === e) {\n          var d = this.persistence.properties();\n          return o.distinct_id = d.distinct_id, o.$current_url = a.$current_url, o;\n        }\n        if (void 0 !== i) {\n          var p = new Date().getTime() - i;\n          o.$duration = parseFloat((p / 1e3).toFixed(3));\n        }\n        o = B({}, pe.properties(), this.persistence.properties(), this.sessionPersistence.properties(), o);\n        var f = this.get_config(\"property_blacklist\");\n        V(f) ? U(f, function (e) {\n          delete o[e];\n        }) : console.error(\"Invalid value for property_blacklist config: \" + f);\n        var h = this.get_config(\"sanitize_properties\");\n        return h && (o = h(o, e)), o;\n      }\n    }, {\n      key: \"register\",\n      value: function (e, t) {\n        this.persistence.register(e, t);\n      }\n    }, {\n      key: \"register_once\",\n      value: function (e, t, n) {\n        this.persistence.register_once(e, t, n);\n      }\n    }, {\n      key: \"register_for_session\",\n      value: function (e) {\n        this.sessionPersistence.register(e);\n      }\n    }, {\n      key: \"unregister\",\n      value: function (e) {\n        this.persistence.unregister(e);\n      }\n    }, {\n      key: \"unregister_for_session\",\n      value: function (e) {\n        this.sessionPersistence.unregister(e);\n      }\n    }, {\n      key: \"_register_single\",\n      value: function (e, t) {\n        this.register(s({}, e, t));\n      }\n    }, {\n      key: \"getFeatureFlag\",\n      value: function (e, t) {\n        return this.featureFlags.getFeatureFlag(e, t);\n      }\n    }, {\n      key: \"getFeatureFlagPayload\",\n      value: function (e) {\n        var t = this.featureFlags.getFeatureFlagPayload(e);\n        try {\n          return JSON.parse(t);\n        } catch (e) {\n          return t;\n        }\n      }\n    }, {\n      key: \"isFeatureEnabled\",\n      value: function (e, t) {\n        return this.featureFlags.isFeatureEnabled(e, t);\n      }\n    }, {\n      key: \"reloadFeatureFlags\",\n      value: function () {\n        this.featureFlags.reloadFeatureFlags();\n      }\n    }, {\n      key: \"updateEarlyAccessFeatureEnrollment\",\n      value: function (e, t) {\n        this.featureFlags.updateEarlyAccessFeatureEnrollment(e, t);\n      }\n    }, {\n      key: \"getEarlyAccessFeatures\",\n      value: function (e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];\n        return this.featureFlags.getEarlyAccessFeatures(e, t);\n      }\n    }, {\n      key: \"onFeatureFlags\",\n      value: function (e) {\n        return this.featureFlags.onFeatureFlags(e);\n      }\n    }, {\n      key: \"getSurveys\",\n      value: function (e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];\n        this.surveys.getSurveys(e, t);\n      }\n    }, {\n      key: \"getActiveMatchingSurveys\",\n      value: function (e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];\n        this.surveys.getActiveMatchingSurveys(e, t);\n      }\n    }, {\n      key: \"identify\",\n      value: function (e, t, n) {\n        if (e) {\n          this._captureMetrics.incr(\"identify\");\n          var r = this.get_distinct_id();\n          if (this.register({\n            $user_id: e\n          }), !this.get_property(\"$device_id\")) {\n            var i = r;\n            this.register_once({\n              $had_persisted_distinct_id: !0,\n              $device_id: i\n            }, \"\");\n          }\n          e !== r && e !== this.get_property(je) && (this.unregister(je), this.register({\n            distinct_id: e\n          }));\n          var o = \"anonymous\" === this.persistence.get_user_state();\n          e !== r && o ? (this.persistence.set_user_state(\"identified\"), this.capture(\"$identify\", {\n            distinct_id: e,\n            $anon_distinct_id: r\n          }, {\n            $set: t || {},\n            $set_once: n || {}\n          }), this.featureFlags.setAnonymousDistinctId(r)) : (t && this.people.set(t), n && this.people.set_once(n)), e !== r && (this.reloadFeatureFlags(), this.unregister(Qe));\n        } else console.error(\"Unique user id has not been set in posthog.identify\");\n      }\n    }, {\n      key: \"group\",\n      value: function (e, n, r) {\n        if (e && n) {\n          this._captureMetrics.incr(\"group\");\n          var i = this.getGroups();\n          i[e] !== n && this.resetGroupPropertiesForFlags(e), this.register({\n            $groups: t(t({}, i), {}, s({}, e, n))\n          }), r && (this.capture(\"$groupidentify\", {\n            $group_type: e,\n            $group_key: n,\n            $group_set: r\n          }), this.setGroupPropertiesForFlags(s({}, e, r))), i[e] === n || r || this.reloadFeatureFlags();\n        } else console.error(\"posthog.group requires a group type and group key\");\n      }\n    }, {\n      key: \"resetGroups\",\n      value: function () {\n        this.register({\n          $groups: {}\n        }), this.resetGroupPropertiesForFlags(), this.reloadFeatureFlags();\n      }\n    }, {\n      key: \"setPersonPropertiesForFlags\",\n      value: function (e) {\n        var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];\n        this.featureFlags.setPersonPropertiesForFlags(e, t);\n      }\n    }, {\n      key: \"resetPersonPropertiesForFlags\",\n      value: function () {\n        this.featureFlags.resetPersonPropertiesForFlags();\n      }\n    }, {\n      key: \"setGroupPropertiesForFlags\",\n      value: function (e) {\n        var t = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];\n        this.featureFlags.setGroupPropertiesForFlags(e, t);\n      }\n    }, {\n      key: \"resetGroupPropertiesForFlags\",\n      value: function (e) {\n        this.featureFlags.resetGroupPropertiesForFlags(e);\n      }\n    }, {\n      key: \"reset\",\n      value: function (e) {\n        var t = this.get_property(\"$device_id\");\n        this.persistence.clear(), this.sessionPersistence.clear(), this.persistence.set_user_state(\"anonymous\"), this.sessionManager.resetSessionId();\n        var n = this.get_config(\"get_device_id\")(se());\n        this.register_once({\n          distinct_id: n,\n          $device_id: e ? n : t\n        }, \"\");\n      }\n    }, {\n      key: \"get_distinct_id\",\n      value: function () {\n        return this.get_property(\"distinct_id\");\n      }\n    }, {\n      key: \"getGroups\",\n      value: function () {\n        return this.get_property(\"$groups\") || {};\n      }\n    }, {\n      key: \"get_session_id\",\n      value: function () {\n        return this.sessionManager.checkAndGetSessionAndWindowId(!0).sessionId;\n      }\n    }, {\n      key: \"get_session_replay_url\",\n      value: function (e) {\n        var t = this.config.ui_host || this.config.api_host,\n          n = this.sessionManager.checkAndGetSessionAndWindowId(!0),\n          r = n.sessionId,\n          i = n.sessionStartTimestamp,\n          o = t + \"/replay/\" + r;\n        if (null != e && e.withTimestamp && i) {\n          var s,\n            a = null !== (s = e.timestampLookBack) && void 0 !== s ? s : 10;\n          if (!i) return o;\n          var c = Math.max(Math.floor((new Date().getTime() - i) / 1e3) - a, 0);\n          o += \"?t=\".concat(c);\n        }\n        return o;\n      }\n    }, {\n      key: \"alias\",\n      value: function (e, t) {\n        return e === this.get_property(Ce) ? (q.critical(\"Attempting to create alias for existing People user - aborting.\"), -2) : (Q(t) && (t = this.get_distinct_id()), e !== t ? (this._register_single(je, e), this.capture(\"$create_alias\", {\n          alias: e,\n          distinct_id: t\n        })) : (console.error(\"alias matches current distinct_id - skipping api call.\"), this.identify(e), -1));\n      }\n    }, {\n      key: \"set_config\",\n      value: function (e) {\n        var n = t({}, this.config);\n        z(e) && (B(this.config, e), this.get_config(\"persistence_name\") || (this.config.persistence_name = this.config.cookie_name), this.get_config(\"disable_persistence\") || (this.config.disable_persistence = this.config.disable_cookie), this.persistence && this.persistence.update_config(this.config), this.sessionPersistence && this.sessionPersistence.update_config(this.config), Ie.is_supported() && \"true\" === Ie.get(\"ph_debug\") && (this.config.debug = !0), this.get_config(\"debug\") && (y.DEBUG = !0), this.sessionRecording && void 0 !== e.disable_session_recording && n.disable_session_recording !== e.disable_session_recording && (e.disable_session_recording ? this.sessionRecording.stopRecording() : this.sessionRecording.startRecordingIfEnabled()));\n      }\n    }, {\n      key: \"startSessionRecording\",\n      value: function () {\n        this.set_config({\n          disable_session_recording: !1\n        });\n      }\n    }, {\n      key: \"stopSessionRecording\",\n      value: function () {\n        this.set_config({\n          disable_session_recording: !0\n        });\n      }\n    }, {\n      key: \"sessionRecordingStarted\",\n      value: function () {\n        var e;\n        return !(null === (e = this.sessionRecording) || void 0 === e || !e.started());\n      }\n    }, {\n      key: \"loadToolbar\",\n      value: function (e) {\n        return this.toolbar.loadToolbar(e);\n      }\n    }, {\n      key: \"get_config\",\n      value: function (e) {\n        var t;\n        return null === (t = this.config) || void 0 === t ? void 0 : t[e];\n      }\n    }, {\n      key: \"get_property\",\n      value: function (e) {\n        return this.persistence.props[e];\n      }\n    }, {\n      key: \"getSessionProperty\",\n      value: function (e) {\n        return this.sessionPersistence.props[e];\n      }\n    }, {\n      key: \"toString\",\n      value: function () {\n        var e,\n          t = null !== (e = this.get_config(\"name\")) && void 0 !== e ? e : gr;\n        return t !== gr && (t = gr + \".\" + t), t;\n      }\n    }, {\n      key: \"_gdpr_init\",\n      value: function () {\n        \"localStorage\" === this.get_config(\"opt_out_capturing_persistence_type\") && Ie.is_supported() && (!this.has_opted_in_capturing() && this.has_opted_in_capturing({\n          persistence_type: \"cookie\"\n        }) && this.opt_in_capturing({\n          enable_persistence: !1\n        }), !this.has_opted_out_capturing() && this.has_opted_out_capturing({\n          persistence_type: \"cookie\"\n        }) && this.opt_out_capturing({\n          clear_persistence: !1\n        }), this.clear_opt_in_out_capturing({\n          persistence_type: \"cookie\",\n          enable_persistence: !1\n        })), this.has_opted_out_capturing() ? this._gdpr_update_persistence({\n          clear_persistence: !0\n        }) : this.has_opted_in_capturing() || !this.get_config(\"opt_out_capturing_by_default\") && !Pe.get(\"ph_optout\") || (Pe.remove(\"ph_optout\"), this.opt_out_capturing({\n          clear_persistence: this.get_config(\"opt_out_persistence_by_default\")\n        }));\n      }\n    }, {\n      key: \"_gdpr_update_persistence\",\n      value: function (e) {\n        var t;\n        if (e && e.clear_persistence) t = !0;else {\n          if (!e || !e.enable_persistence) return;\n          t = !1;\n        }\n        this.get_config(\"disable_persistence\") || this.persistence.disabled === t || this.persistence.set_disabled(t), this.get_config(\"disable_persistence\") || this.sessionPersistence.disabled === t || this.sessionPersistence.set_disabled(t);\n      }\n    }, {\n      key: \"_gdpr_call_func\",\n      value: function (e, t) {\n        return t = B({\n          capture: this.capture.bind(this),\n          persistence_type: this.get_config(\"opt_out_capturing_persistence_type\"),\n          cookie_prefix: this.get_config(\"opt_out_capturing_cookie_prefix\"),\n          cookie_expiration: this.get_config(\"cookie_expiration\"),\n          cross_subdomain_cookie: this.get_config(\"cross_subdomain_cookie\"),\n          secure_cookie: this.get_config(\"secure_cookie\")\n        }, t || {}), Ie.is_supported() || \"localStorage\" !== t.persistence_type || (t.persistence_type = \"cookie\"), e(this.get_config(\"token\"), {\n          capture: t.capture,\n          captureEventName: t.capture_event_name,\n          captureProperties: t.capture_properties,\n          persistenceType: t.persistence_type,\n          persistencePrefix: t.cookie_prefix,\n          cookieExpiration: t.cookie_expiration,\n          crossSubdomainCookie: t.cross_subdomain_cookie,\n          secureCookie: t.secure_cookie\n        });\n      }\n    }, {\n      key: \"opt_in_capturing\",\n      value: function (e) {\n        e = B({\n          enable_persistence: !0\n        }, e || {}), this._gdpr_call_func(tt, e), this._gdpr_update_persistence(e);\n      }\n    }, {\n      key: \"opt_out_capturing\",\n      value: function (e) {\n        var t = B({\n          clear_persistence: !0\n        }, e || {});\n        this._gdpr_call_func(nt, t), this._gdpr_update_persistence(t);\n      }\n    }, {\n      key: \"has_opted_in_capturing\",\n      value: function (e) {\n        return this._gdpr_call_func(rt, e);\n      }\n    }, {\n      key: \"has_opted_out_capturing\",\n      value: function (e) {\n        return this._gdpr_call_func(it, e);\n      }\n    }, {\n      key: \"clear_opt_in_out_capturing\",\n      value: function (e) {\n        var t = B({\n          enable_persistence: !0\n        }, null != e ? e : {});\n        this._gdpr_call_func(ot, t), this._gdpr_update_persistence(t);\n      }\n    }, {\n      key: \"debug\",\n      value: function (e) {\n        !1 === e ? ($.console.log(\"You've disabled debug mode.\"), localStorage && localStorage.removeItem(\"ph_debug\"), this.set_config({\n          debug: !1\n        })) : ($.console.log(\"You're now in debug mode. All calls to PostHog will be logged in your console.\\nYou can disable this with `posthog.debug(false)`.\"), localStorage && localStorage.setItem(\"ph_debug\", \"true\"), this.set_config({\n          debug: !0\n        }));\n      }\n    }]), e;\n  }();\n!function (e, t) {\n  for (var n = 0; n < t.length; n++) e.prototype[t[n]] = K(e.prototype[t[n]]);\n}(wr, [\"identify\"]);\nvar kr = {},\n  Sr = function () {\n    dr.init = function (e, t, n) {\n      if (n) return dr[n] || (dr[n] = kr[n] = br(e || \"\", t || {}, n, function (e) {\n        dr[n] = kr[n] = e, e._loaded();\n      })), dr[n];\n      var r = dr;\n      return kr[gr] ? r = kr[gr] : e && (r = br(e, t || {}, gr, function (e) {\n        kr[gr] = e, e._loaded();\n      }), kr[gr] = r), dr = r, lr === ur.INIT_SNIPPET && ($[gr] = dr), U(kr, function (e, t) {\n        t !== gr && (dr[t] = e);\n      }), r;\n    };\n  },\n  Er = function () {\n    function e() {\n      e.done || (e.done = !0, yr = !1, U(kr, function (e) {\n        e._dom_loaded();\n      }));\n    }\n    M.addEventListener && (\"complete\" === M.readyState ? e() : M.addEventListener(\"DOMContentLoaded\", e, !1)), le($, \"load\", e, !0);\n  };\nvar Fr = (lr = ur.INIT_MODULE, dr = new wr(), Sr(), dr.init(), Er(), dr);\nexport { rn as Compression, wr as PostHog, sn as SurveyQuestionType, on as SurveyType, Fr as default, Fr as posthog };","map":{"version":3,"names":["y","DEBUG","LIB_VERSION","Math","trunc","e","ceil","floor","Number","isInteger","isFinite","m","b","t","r","bytes","length","TypeError","o","key","value","charAt","slice","compareTo","n","sign","i","RangeError","Uint8Array","pow","w","s","E","DefaultRandom","generateOrAbort","timestamp","Error","Date","now","resetCounter","counter","fromFieldsV7","random","nextUint32","k","getRandomValues","UUIDV7_DENY_WEAK_RNG","crypto","S","Uint32Array","Infinity","cursor","buffer","F","uuidv7obj","generate","x","Array","prototype","P","Object","O","toString","I","hasOwnProperty","$","window","T","navigator","userAgent","M","document","A","R","C","forEach","j","indexOf","D","isArray","N","q","log","Q","console","__rrweb_original__","arguments","apply","L","error","concat","critical","H","_trim","replace","call","U","B","_extend","V","G","_isFunction","test","W","z","_isObject","_isUndefined","J","_isString","X","_isNumber","Y","Z","_formatDate","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","K","_safewrap","ee","_strip_empty_properties","te","ne","customizer","Set","has","add","push","re","a","c","u","l","oe","charCodeAt","join","ie","_utf8Encode","String","fromCharCode","substring","se","valueOf","screen","height","width","unshift","ae","_isBlockedUA","ce","_getQueryParam","RegExp","exec","decodeURIComponent","ue","_getHashParam","match","le","preventDefault","stopPropagation","returnValue","cancelBubble","addEventListener","event","de","addScript","createElement","type","src","onload","onerror","querySelectorAll","parentNode","insertBefore","body","appendChild","pe","campaignParams","URL","searchEngine","referrer","search","searchInfo","$search_engine","ph_keyword","browser","browserVersion","Chrome","Safari","Opera","Firefox","Konqueror","BlackBerry","Mozilla","parseFloat","browserLanguage","language","userLanguage","os","os_name","os_version","device","deviceType","referringDomain","href","host","properties","$os","$os_version","$browser","vendor","opera","$device","$device_type","$current_url","location","$host","$pathname","pathname","$browser_version","$browser_language","$screen_height","$screen_width","$viewport_height","innerHeight","$viewport_width","innerWidth","$lib","$lib_version","$insert_id","$time","people_properties","fe","className","baseVal","getAttribute","he","be","we","childNodes","ve","textContent","split","filter","ke","_e","nodeType","ge","tagName","toLowerCase","ye","me","name","id","includes","Se","Ee","trim","Fe","clicks","enabled","abs","xe","Pe","is_supported","get","cookie","parse","JSON","set","hostname","setTime","getTime","toUTCString","d","encodeURIComponent","stringify","remove","Oe","Ie","localStorage","getItem","setItem","removeItem","$e","distinct_id","Te","Me","Ae","Re","sessionStorage","Ce","je","De","Ne","qe","He","Le","Ue","Be","Ve","Ge","We","ze","Qe","Je","Xe","Ye","Ze","token","props","campaign_params_saved","custom_campaign_params","persistence_name","persistence","storage","user_state","load","update_config","save","keys","disabled","expire_days","cross_subdomain","secure","default_expiry","register","$referrer","$referring_domain","cookie_expiration","set_disabled","disable_persistence","set_cross_subdomain","cross_subdomain_cookie","set_secure","secure_cookie","Ke","_initializedTokens","_isAutocaptureEnabled","_setIsAutocaptureEnabled","get_property","get_config","_previousElementSibling","previousElementSibling","previousSibling","_getAugmentPropertiesFromElement","attributes","_getPropertiesFromElement","tag_name","$el_text","classes","nth_child","nth_of_type","_getDefaultProperties","$event_type","$ce_version","_extractCustomPropertyValue","css_selector","_getCustomProperties","_customProperties","event_selectors","_getEventTarget","target","srcElement","shadowRoot","composedPath","_captureEvent","MouseEvent","rageclicks","isRageClick","clientX","clientY","url_allowlist","some","dom_event_allowlist","element_allowlist","css_selector_allowlist","matches","p","getComputedStyle","getPropertyValue","f","h","config","attr__href","$elements","capture","_navigate","_addDomEventHandlers","handler","init","__autocapture","map","afterDecideResponse","autocapture_opt_out","enable_collect_everything","custom_properties","enabledForProject","isBrowserSupported","bind","et","tt","ut","nt","rt","ct","it","respectDnt","doNotTrack","msDoNotTrack","ot","st","at","crossSubdomainCookie","persistenceType","persistencePrefix","cookieExpiration","secureCookie","captureEventName","captureProperties","send_instantly","lt","dt","pt","ft","_posthog","set_action","setPersonPropertiesForFlags","$set","_get_config","sessionPersistence","update_referrer_info","get_referrer_info","_send_request","set_once","set_once_action","$token","$distinct_id","get_distinct_id","$device_id","$user_id","$had_persisted_distinct_id","data","_prepare_callback","prop","apiActionParser","_is_reserved_property","ht","_t","gt","vt","filterActiveFeatureFlags","v","done","yt","instance","_override_warning","featureFlagEventHandlers","reloadFeatureFlagsQueued","reloadFeatureFlagsInAction","getFlagVariants","warn","enabledFlags","overriddenFlags","finalFlags","_startReloadTimer","$anon_distinct_id","setTimeout","_reloadFeatureFlagsRequest","setReloadingPaused","groups","getGroups","person_properties","group_properties","method","receivedFeatureFlags","getFlags","send_event","$feature_flag","$feature_flag_response","getFlagPayloads","getFeatureFlag","decideEndpointWasHit","featureFlags","featureFlagPayloads","errorsWhileComputingFlags","_fireFeatureFlagsCallbacks","unregister","addFeatureFlagsHandler","_prepareFeatureFlagsForCallbacks","flags","flagVariants","removeFeatureFlagsHandler","$feature_enrollment","earlyAccessFeatures","reduce","reloadFeatureFlags","mt","bt","wt","kt","St","Et","Ft","Mutation","MouseMove","MouseInteraction","Scroll","ViewportResize","Input","TouchMove","MediaInteraction","StyleSheetRule","CanvasMutation","Font","Log","Drag","StyleDeclaration","Selection","AdoptedStyleSheet","xt","Pt","captureStarted","snapshots","emit","endpoint","stopRrweb","windowId","sessionId","receivedDecide","isRecordingEnabled","startCaptureAndTrySendingQueuedSnapshots","stopRecording","recorderVersion","sessionRecording","consoleLogRecordingEnabled","startRecordingIfEnabled","_captureSnapshot","_startCapture","assign","sessionManager","checkAndGetSessionAndWindowId","getRecordingVersion","__loaded_recorder_version","_onScriptLoaded","source","_isInteractiveEvent","isIdle","lastActivityTimestamp","_tryTakeFullSnapshot","rrwebRecord","takeFullSnapshot","blockClass","blockSelector","ignoreClass","maskTextClass","maskTextSelector","maskTextFn","maskAllInputs","maskInputOptions","maskInputFn","slimDOMOptions","collectFonts","inlineStylesheet","recordCrossOriginIframes","rrweb","record","entries","onRRwebEmit","plugins","rrwebConsoleRecord","isConsoleLogCaptureEnabled","getRecordConsolePlugin","_addCaptureHook","addCustomEvent","plugin","payload","matchAll","toLocaleLowerCase","_updateWindowAndSessionIds","$snapshot_data","$session_id","$window_id","_captureMetrics","incr","transport","_noTruncate","_batchKey","_metrics","rrweb_full_snapshot","Ot","entryType","timeOrigin","startTime","redirectStart","redirectEnd","workerStart","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","decodedBodySize","encodedBodySize","initiatorType","nextHopProtocol","renderBlockingStatus","responseStatus","transferSize","element","renderTime","loadTime","size","url","domComplete","domContentLoadedEvent","domInteractive","loadEventEnd","loadEventStart","redirectCount","navigationType","unloadEventEnd","unloadEventStart","duration","It","$t","Tt","isEnabled","startObserving","stopObserving","observer","PerformanceObserver","supportedEntryTypes","_forceAllowLocalhost","getEntries","_capturePerformanceEvent","observe","buffered","disconnect","remoteEnabled","capturePerformance","find","maskNetworkRequestFn","toJSON","performance","capturePerformanceEvent","Mt","serverTiming","exposesServerTiming","At","_hasBootstrappedFeatureFlags","verbose","parseDecideResponse","status","toolbar","webPerformance","exceptionAutocapture","compression","supportedCompression","siteApps","_loop","Rt","Ct","jt","toolbarParams","editorParams","toolbarVersion","isAuthenticated","loadToolbar","history","hash","action","desiredHash","replaceState","title","userIntent","_postHogToolbarLoaded","endsWith","apiURL","instrument","ph_load_toolbar","ph_load_editor","maybeLoadToolbar","Dt","isPolling","_event_queue","_empty_queue_count","_poller","_pollInterval","poll","Nt","handlePollRequest","captureMetrics","options","clearTimeout","formatQueue","offset","values","qt","metrics","Ht","Lt","Uint16Array","Ut","Bt","Vt","Gt","Wt","freb","zt","Qt","Jt","Xt","Yt","Zt","Kt","en","hMap","tn","nn","rn","on","sn","an","cn","un","shft","ln","slc","subarray","dn","wbits","pn","wbits16","fn","hTree","sort","hn","_","g","max","_n","lc","gn","clen","vn","wfblk","yn","wblk","mn","bn","wn","kn","crc","Sn","dopt","hsh","min","level","mem","En","wbytes","Fn","gzh","filename","mtime","xn","gzhl","Pn","On","TextEncoder","encode","GZipJS","Base64","Popover","Button","Email","FullScreen","Open","MultipleChoiceSingle","MultipleChoiceMulti","NPS","Rating","Link","In","addParamsToURL","ip","ver","$n","blob","Blob","sendBeacon","Tn","xhr","headers","callback","retriesPerformedSoFar","retryQueue","onXHRError","timeout","XMLHttpRequest","open","setRequestHeader","withCredentials","onreadystatechange","readyState","decr","responseText","enqueue","send","Mn","An","queue","areWeOnline","onLine","_handleWeAreNowOnline","retryAt","requestData","flush","_executeXhrRequest","Rn","Cn","jn","Dn","_windowId","_sessionId","_sessionStartTimestamp","_sessionActivityTimestamp","session_idle_timeout_seconds","_sessionTimeoutMs","_window_id_storage_key","_primary_window_exists_storage_key","_canUseSessionStorage","_listenToReloadWindow","_setSessionId","_getSessionId","_getWindowId","_setWindowId","sessionStartTimestamp","Nn","setupOnce","__loaded","tags","ui_host","api_host","sessionRecordingStarted","get_session_replay_url","withTimestamp","exception","$exception_message","$exception_type","$exception_personURL","$sentry_event_id","event_id","$sentry_exception","$sentry_exception_message","$sentry_exception_type","$sentry_tags","$sentry_url","qn","createSegmentIntegration","Promise","resolve","enrichEvent","userId","anonymousId","reset","_calculate_event_properties","version","isLoaded","track","page","identify","Hn","_seenFirstPageView","_pageViewId","Ln","Event","Un","Bn","Vn","Gn","Wn","zn","Qn","Jn","function","in_app","lineno","colno","Xn","Yn","Zn","Kn","er","tr","reverse","nr","extractSafariExtensionDetails","rr","ir","or","stacktrace","stack","framesToPop","message","sr","$exception_stack_trace_raw","ar","cr","$exception_DOMException_code","code","constructor","$exception_is_synthetic","$exception_source","$exception_lineno","$exception_colno","ur","lr","dr","pr","__POSTHOG_INSTRUMENTED__","originalOnErrorHandler","captureException","originalOnUnhandledRejectionHandler","onunhandledrejection","reason","detail","$exception_handled","sendExceptionEvent","stopCapturing","autocaptureExceptions","errors_to_ignore","errorsToIgnore","startCapturing","debugLog","fr","surveys","getSurveys","start_date","end_date","conditions","selector","querySelector","linked_flag_key","targeting_flag_key","isFeatureEnabled","INIT_MODULE","INIT_SNIPPET","hr","__NOOP","_r","gr","vr","yr","mr","defaultConfig","api_method","api_transport","autocapture","rageclick","cookie_name","loaded","store_google","save_referrer","capture_pageview","capture_pageleave","debug","upgrade","disable_session_recording","disable_cookie","enable_recording_console_log","protocol","opt_out_capturing_by_default","opt_out_persistence_by_default","opt_out_capturing_persistence_type","opt_out_capturing_cookie_prefix","opt_in_site_apps","property_blacklist","respect_dnt","sanitize_properties","xhr_headers","inapp_protocol","inapp_link_new_window","request_batching","properties_string_max_length","session_recording","mask_all_element_attributes","mask_all_text","advanced_disable_decide","advanced_disable_toolbar_metrics","on_xhr_error","statusText","get_device_id","_onCapture","_capture_metrics","capture_performance","callback_fn","bootstrap","disable_compression","br","create_phlib","initComplete","syncCode","handleCallback","wr","_init","startObservingIfEnabled","_execute_array","people","SentryIntegration","segmentIntegration","__captureHooks","__request_queue","_jsc","pageViewIdManager","_requestQueue","_retryQueue","_loaded","_triggered_notifs","segmentRegister","updateInitComplete","set_config","_handle_queued_event","_gdpr_init","segment","user","set_user_state","then","distinctID","isIdentifiedID","register_once","self","_handle_unload","_start_queue_if_opted_in","resetRequestQueue","has_opted_out_capturing","updateUnloadMetrics","unload","__compress_and_send_json_request","urlQueryArgs","async","defer","getElementsByTagName","execute","update_search_keyword","update_campaign_params","uuid","$set_once","_invokeCaptureHooks","remove_event_timer","onPageview","$pageview_id","getPageViewId","$duration","toFixed","getFeatureFlagPayload","updateEarlyAccessFeatureEnrollment","getEarlyAccessFeatures","onFeatureFlags","getActiveMatchingSurveys","get_user_state","setAnonymousDistinctId","resetGroupPropertiesForFlags","$groups","$group_type","$group_key","$group_set","setGroupPropertiesForFlags","resetPersonPropertiesForFlags","clear","resetSessionId","timestampLookBack","_register_single","alias","started","has_opted_in_capturing","persistence_type","opt_in_capturing","enable_persistence","opt_out_capturing","clear_persistence","clear_opt_in_out_capturing","_gdpr_update_persistence","cookie_prefix","capture_event_name","capture_properties","_gdpr_call_func","kr","Sr","override_ph_init_func","Er","add_dom_loaded_handler","_dom_loaded","Fr","Compression","PostHog","SurveyQuestionType","SurveyType","default","posthog"],"sources":["/Users/danielpark/notepaca/node_modules/posthog-js/src/config.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/uuidv7.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/utils.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/autocapture-utils.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/rageclick.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/storage.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/posthog-persistence.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/autocapture.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/gdpr-utils.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/posthog-people.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/posthog-featureflags.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/sessionrecording-utils.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/sessionrecording.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/web-performance.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/decide.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/cloud.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/toolbar.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/base-request-queue.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/request-queue.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/capture-metrics.ts","/Users/danielpark/notepaca/node_modules/posthog-js/node_modules/fflate/esm/browser.js","/Users/danielpark/notepaca/node_modules/posthog-js/src/types.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/send-request.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/retry-queue.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/sessionid.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/sentry-integration.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/segment-integration.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/page-view-id.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/exceptions/type-checking.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/exceptions/stack-trace.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/exceptions/error-conversion.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/extensions/exceptions/exception-autocapture.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/posthog-core.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/posthog-surveys.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/compression.ts","/Users/danielpark/notepaca/node_modules/posthog-js/src/loader-module.ts"],"sourcesContent":["import { version } from '../package.json'\n\n// overriden in posthog-core,\n// e.g.     Config.DEBUG = Config.DEBUG || instance.get_config('debug')\nconst Config = {\n    DEBUG: false,\n    LIB_VERSION: version,\n}\n\nexport default Config\n","/**\n * uuidv7: An experimental implementation of the proposed UUID Version 7\n *\n * @license Apache-2.0\n * @copyright 2021-2023 LiosK\n * @packageDocumentation\n *\n * from https://github.com/LiosK/uuidv7/blob/e501462ea3d23241de13192ceae726956f9b3b7d/src/index.ts\n */\n\n// polyfill for IE11\nif (!Math.trunc) {\n    Math.trunc = function (v) {\n        return v < 0 ? Math.ceil(v) : Math.floor(v)\n    }\n}\n\n// polyfill for IE11\nif (!Number.isInteger) {\n    Number.isInteger = function (value) {\n        return typeof value === 'number' && isFinite(value) && Math.floor(value) === value\n    }\n}\n\nconst DIGITS = '0123456789abcdef'\n\n/** Represents a UUID as a 16-byte byte array. */\nexport class UUID {\n    /** @param bytes - The 16-byte byte array representation. */\n    constructor(readonly bytes: Readonly<Uint8Array>) {\n        if (bytes.length !== 16) {\n            throw new TypeError('not 128-bit length')\n        }\n    }\n\n    /**\n     * Builds a byte array from UUIDv7 field values.\n     *\n     * @param unixTsMs - A 48-bit `unix_ts_ms` field value.\n     * @param randA - A 12-bit `rand_a` field value.\n     * @param randBHi - The higher 30 bits of 62-bit `rand_b` field value.\n     * @param randBLo - The lower 32 bits of 62-bit `rand_b` field value.\n     */\n    static fromFieldsV7(unixTsMs: number, randA: number, randBHi: number, randBLo: number): UUID {\n        if (\n            !Number.isInteger(unixTsMs) ||\n            !Number.isInteger(randA) ||\n            !Number.isInteger(randBHi) ||\n            !Number.isInteger(randBLo) ||\n            unixTsMs < 0 ||\n            randA < 0 ||\n            randBHi < 0 ||\n            randBLo < 0 ||\n            unixTsMs > 0xffff_ffff_ffff ||\n            randA > 0xfff ||\n            randBHi > 0x3fff_ffff ||\n            randBLo > 0xffff_ffff\n        ) {\n            throw new RangeError('invalid field value')\n        }\n\n        const bytes = new Uint8Array(16)\n        bytes[0] = unixTsMs / 2 ** 40\n        bytes[1] = unixTsMs / 2 ** 32\n        bytes[2] = unixTsMs / 2 ** 24\n        bytes[3] = unixTsMs / 2 ** 16\n        bytes[4] = unixTsMs / 2 ** 8\n        bytes[5] = unixTsMs\n        bytes[6] = 0x70 | (randA >>> 8)\n        bytes[7] = randA\n        bytes[8] = 0x80 | (randBHi >>> 24)\n        bytes[9] = randBHi >>> 16\n        bytes[10] = randBHi >>> 8\n        bytes[11] = randBHi\n        bytes[12] = randBLo >>> 24\n        bytes[13] = randBLo >>> 16\n        bytes[14] = randBLo >>> 8\n        bytes[15] = randBLo\n        return new UUID(bytes)\n    }\n\n    /** @returns The 8-4-4-4-12 canonical hexadecimal string representation. */\n    toString(): string {\n        let text = ''\n        for (let i = 0; i < this.bytes.length; i++) {\n            text += DIGITS.charAt(this.bytes[i] >>> 4)\n            text += DIGITS.charAt(this.bytes[i] & 0xf)\n            if (i === 3 || i === 5 || i === 7 || i === 9) {\n                text += '-'\n            }\n        }\n        return text\n    }\n\n    /** Creates an object from `this`. */\n    clone(): UUID {\n        return new UUID(this.bytes.slice(0))\n    }\n\n    /** Returns true if `this` is equivalent to `other`. */\n    equals(other: UUID): boolean {\n        return this.compareTo(other) === 0\n    }\n\n    /**\n     * Returns a negative integer, zero, or positive integer if `this` is less\n     * than, equal to, or greater than `other`, respectively.\n     */\n    compareTo(other: UUID): number {\n        for (let i = 0; i < 16; i++) {\n            const diff = this.bytes[i] - other.bytes[i]\n            if (diff !== 0) {\n                return Math.sign(diff)\n            }\n        }\n        return 0\n    }\n}\n\n/** Encapsulates the monotonic counter state. */\nclass V7Generator {\n    private timestamp = 0\n    private counter = 0\n    private readonly random = new DefaultRandom()\n\n    /**\n     * Generates a new UUIDv7 object from the current timestamp, or resets the\n     * generator upon significant timestamp rollback.\n     *\n     * This method returns monotonically increasing UUIDs unless the up-to-date\n     * timestamp is significantly (by ten seconds or more) smaller than the one\n     * embedded in the immediately preceding UUID. If such a significant clock\n     * rollback is detected, this method resets the generator and returns a new\n     * UUID based on the current timestamp.\n     */\n    generate(): UUID {\n        const value = this.generateOrAbort()\n        if (value !== undefined) {\n            return value\n        } else {\n            // reset state and resume\n            this.timestamp = 0\n            const valueAfterReset = this.generateOrAbort()\n            if (valueAfterReset === undefined) {\n                throw new Error('Could not generate UUID after timestamp reset')\n            }\n            return valueAfterReset\n        }\n    }\n\n    /**\n     * Generates a new UUIDv7 object from the current timestamp, or returns\n     * `undefined` upon significant timestamp rollback.\n     *\n     * This method returns monotonically increasing UUIDs unless the up-to-date\n     * timestamp is significantly (by ten seconds or more) smaller than the one\n     * embedded in the immediately preceding UUID. If such a significant clock\n     * rollback is detected, this method aborts and returns `undefined`.\n     */\n    generateOrAbort(): UUID | undefined {\n        const MAX_COUNTER = 0x3ff_ffff_ffff\n        const ROLLBACK_ALLOWANCE = 10_000 // 10 seconds\n\n        const ts = Date.now()\n        if (ts > this.timestamp) {\n            this.timestamp = ts\n            this.resetCounter()\n        } else if (ts + ROLLBACK_ALLOWANCE > this.timestamp) {\n            // go on with previous timestamp if new one is not much smaller\n            this.counter++\n            if (this.counter > MAX_COUNTER) {\n                // increment timestamp at counter overflow\n                this.timestamp++\n                this.resetCounter()\n            }\n        } else {\n            // abort if clock went backwards to unbearable extent\n            return undefined\n        }\n\n        return UUID.fromFieldsV7(\n            this.timestamp,\n            Math.trunc(this.counter / 2 ** 30),\n            this.counter & (2 ** 30 - 1),\n            this.random.nextUint32()\n        )\n    }\n\n    /** Initializes the counter at a 42-bit random integer. */\n    private resetCounter(): void {\n        this.counter = this.random.nextUint32() * 0x400 + (this.random.nextUint32() & 0x3ff)\n    }\n}\n\n/** A global flag to force use of cryptographically strong RNG. */\ndeclare const UUIDV7_DENY_WEAK_RNG: boolean\n\n/** Stores `crypto.getRandomValues()` available in the environment. */\nlet getRandomValues: <T extends Uint8Array | Uint32Array>(buffer: T) => T = (buffer) => {\n    // fall back on Math.random() unless the flag is set to true\n    if (typeof UUIDV7_DENY_WEAK_RNG !== 'undefined' && UUIDV7_DENY_WEAK_RNG) {\n        throw new Error('no cryptographically strong RNG available')\n    }\n\n    for (let i = 0; i < buffer.length; i++) {\n        buffer[i] = Math.trunc(Math.random() * 0x1_0000) * 0x1_0000 + Math.trunc(Math.random() * 0x1_0000)\n    }\n    return buffer\n}\n\n// detect Web Crypto API\nif (typeof crypto !== 'undefined' && crypto.getRandomValues) {\n    getRandomValues = (buffer) => crypto.getRandomValues(buffer)\n}\n\n/**\n * Wraps `crypto.getRandomValues()` and compatibles to enable buffering; this\n * uses a small buffer by default to avoid unbearable throughput decline in some\n * environments as well as the waste of time and space for unused values.\n */\nclass DefaultRandom {\n    private readonly buffer = new Uint32Array(8)\n    private cursor = Infinity\n    nextUint32(): number {\n        if (this.cursor >= this.buffer.length) {\n            getRandomValues(this.buffer)\n            this.cursor = 0\n        }\n        return this.buffer[this.cursor++]\n    }\n}\n\nlet defaultGenerator: V7Generator | undefined\n\n/**\n * Generates a UUIDv7 string.\n *\n * @returns The 8-4-4-4-12 canonical hexadecimal string representation\n * (\"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\").\n */\nexport const uuidv7 = (): string => uuidv7obj().toString()\n\n/** Generates a UUIDv7 object. */\nconst uuidv7obj = (): UUID => (defaultGenerator || (defaultGenerator = new V7Generator())).generate()\n","import Config from './config'\nimport { Breaker, EventHandler, Properties } from './types'\nimport { uuidv7 } from './uuidv7'\n\n/*\n * Saved references to long variable names, so that closure compiler can\n * minimize file size.\n */\n\nconst ArrayProto = Array.prototype\nconst ObjProto = Object.prototype\nconst toString = ObjProto.toString\nconst hasOwnProperty = ObjProto.hasOwnProperty\nconst win: Window & typeof globalThis = typeof window !== 'undefined' ? window : ({} as typeof window)\nconst navigator = win.navigator || { userAgent: '' }\nconst document = win.document || {}\nconst userAgent = navigator.userAgent\nconst localDomains = ['localhost', '127.0.0.1']\n\nconst nativeForEach = ArrayProto.forEach,\n    nativeIndexOf = ArrayProto.indexOf,\n    nativeIsArray = Array.isArray,\n    breaker: Breaker = {}\n\n// Console override\nconst logger = {\n    /** @type {function(...*)} */\n    log: function (...args: any[]) {\n        if (Config.DEBUG && !_isUndefined(window.console) && window.console) {\n            // Don't log PostHog debug messages in rrweb\n            const log =\n                '__rrweb_original__' in window.console.log\n                    ? (window.console.log as any)['__rrweb_original__']\n                    : window.console.log\n\n            try {\n                log.apply(window.console, args)\n            } catch (err) {\n                _eachArray(args, function (arg) {\n                    log(arg)\n                })\n            }\n        }\n    },\n    /** @type {function(...*)} */\n    error: function (..._args: any[]) {\n        if (Config.DEBUG && !_isUndefined(window.console) && window.console) {\n            const args = ['PostHog error:', ..._args]\n            // Don't log PostHog debug messages in rrweb\n            const error =\n                '__rrweb_original__' in window.console.error\n                    ? (window.console.error as any)['__rrweb_original__']\n                    : window.console.error\n            try {\n                error.apply(window.console, args)\n            } catch (err) {\n                _eachArray(args, function (arg) {\n                    error(arg)\n                })\n            }\n        }\n    },\n    /** @type {function(...*)} */\n    critical: function (..._args: any[]) {\n        if (!_isUndefined(window.console) && window.console) {\n            const args = ['PostHog error:', ..._args]\n            // Don't log PostHog debug messages in rrweb\n            const error =\n                '__rrweb_original__' in window.console.error\n                    ? (window.console.error as any)['__rrweb_original__']\n                    : window.console.error\n            try {\n                error.apply(window.console, args)\n            } catch (err) {\n                _eachArray(args, function (arg) {\n                    error(arg)\n                })\n            }\n        }\n    },\n}\n\n// UNDERSCORE\n// Embed part of the Underscore Library\nexport const _trim = function (str: string): string {\n    return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '')\n}\n\nexport const _bind_instance_methods = function (obj: Record<string, any>): void {\n    for (const func in obj) {\n        if (typeof obj[func] === 'function') {\n            obj[func] = obj[func].bind(obj)\n        }\n    }\n}\n\nexport function _eachArray<E = any>(\n    obj: E[] | null | undefined,\n    iterator: (value: E, key: number) => void | Breaker,\n    thisArg?: any\n): void {\n    if (Array.isArray(obj)) {\n        if (nativeForEach && obj.forEach === nativeForEach) {\n            obj.forEach(iterator, thisArg)\n        } else if ('length' in obj && obj.length === +obj.length) {\n            for (let i = 0, l = obj.length; i < l; i++) {\n                if (i in obj && iterator.call(thisArg, obj[i], i) === breaker) {\n                    return\n                }\n            }\n        }\n    }\n}\n\n/**\n * @param {*=} obj\n * @param {function(...*)=} iterator\n * @param {Object=} thisArg\n */\nexport function _each(obj: any, iterator: (value: any, key: any) => void | Breaker, thisArg?: any): void {\n    if (obj === null || obj === undefined) {\n        return\n    }\n    if (Array.isArray(obj)) {\n        return _eachArray(obj, iterator, thisArg)\n    }\n    for (const key in obj) {\n        if (hasOwnProperty.call(obj, key)) {\n            if (iterator.call(thisArg, obj[key], key) === breaker) {\n                return\n            }\n        }\n    }\n}\n\nexport const _extend = function (obj: Record<string, any>, ...args: Record<string, any>[]): Record<string, any> {\n    _eachArray(args, function (source) {\n        for (const prop in source) {\n            if (source[prop] !== void 0) {\n                obj[prop] = source[prop]\n            }\n        }\n    })\n    return obj\n}\n\nexport const _isArray =\n    nativeIsArray ||\n    function (obj: any): obj is any[] {\n        return toString.call(obj) === '[object Array]'\n    }\n\n// from a comment on http://dbj.org/dbj/?p=286\n// fails on only one very rare and deliberate custom object:\n// let bomb = { toString : undefined, valueOf: function(o) { return \"function BOMBA!\"; }};\nexport const _isFunction = function (f: any): f is (...args: any[]) => any {\n    try {\n        return /^\\s*\\bfunction\\b/.test(f)\n    } catch (x) {\n        return false\n    }\n}\n\nexport const _include = function (\n    obj: null | string | Array<any> | Record<string, any>,\n    target: any\n): boolean | Breaker {\n    let found = false\n    if (obj === null) {\n        return found\n    }\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) {\n        return obj.indexOf(target) != -1\n    }\n    _each(obj, function (value) {\n        if (found || (found = value === target)) {\n            return breaker\n        }\n        return\n    })\n    return found\n}\n\nexport function _includes<T = any>(str: T[] | string, needle: T): boolean {\n    return (str as any).indexOf(needle) !== -1\n}\n\n/**\n * Object.entries() polyfill\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries\n */\nexport function _entries<T = any>(obj: Record<string, T>): [string, T][] {\n    const ownProps = Object.keys(obj)\n    let i = ownProps.length\n    const resArray = new Array(i) // preallocate the Array\n\n    while (i--) {\n        resArray[i] = [ownProps[i], obj[ownProps[i]]]\n    }\n    return resArray\n}\n\n// Underscore Addons\nexport const _isObject = function (obj: any): obj is Record<string, any> {\n    return obj === Object(obj) && !_isArray(obj)\n}\n\nexport const _isEmptyObject = function (obj: any): obj is Record<string, any> {\n    if (_isObject(obj)) {\n        for (const key in obj) {\n            if (hasOwnProperty.call(obj, key)) {\n                return false\n            }\n        }\n        return true\n    }\n    return false\n}\n\nexport const _isUndefined = function (obj: any): obj is undefined {\n    return obj === void 0\n}\n\nexport const _isString = function (obj: any): obj is string {\n    return toString.call(obj) == '[object String]'\n}\n\nexport const _isDate = function (obj: any): obj is Date {\n    return toString.call(obj) == '[object Date]'\n}\n\nexport const _isNumber = function (obj: any): obj is number {\n    return toString.call(obj) == '[object Number]'\n}\n\nexport const _encodeDates = function (obj: Properties): Properties {\n    _each(obj, function (v, k) {\n        if (_isDate(v)) {\n            obj[k] = _formatDate(v)\n        } else if (_isObject(v)) {\n            obj[k] = _encodeDates(v) // recurse\n        }\n    })\n    return obj\n}\n\nexport const _timestamp = function (): number {\n    Date.now =\n        Date.now ||\n        function () {\n            return +new Date()\n        }\n    return Date.now()\n}\n\nexport const _formatDate = function (d: Date): string {\n    // YYYY-MM-DDTHH:MM:SS in UTC\n    function pad(n: number) {\n        return n < 10 ? '0' + n : n\n    }\n    return (\n        d.getUTCFullYear() +\n        '-' +\n        pad(d.getUTCMonth() + 1) +\n        '-' +\n        pad(d.getUTCDate()) +\n        'T' +\n        pad(d.getUTCHours()) +\n        ':' +\n        pad(d.getUTCMinutes()) +\n        ':' +\n        pad(d.getUTCSeconds())\n    )\n}\n\nexport const _safewrap = function <F extends (...args: any[]) => any = (...args: any[]) => any>(f: F): F {\n    return function (...args) {\n        try {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return f.apply(this, args)\n        } catch (e) {\n            logger.critical('Implementation error. Please turn on debug and contact support@posthog.com.')\n            logger.critical(e)\n        }\n    } as F\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport const _safewrap_class = function (klass: Function, functions: string[]): void {\n    for (let i = 0; i < functions.length; i++) {\n        klass.prototype[functions[i]] = _safewrap(klass.prototype[functions[i]])\n    }\n}\n\nexport const _safewrap_instance_methods = function (obj: Record<string, any>): void {\n    for (const func in obj) {\n        if (typeof obj[func] === 'function') {\n            obj[func] = _safewrap(obj[func])\n        }\n    }\n}\n\nexport const _strip_empty_properties = function (p: Properties): Properties {\n    const ret: Properties = {}\n    _each(p, function (v, k) {\n        if (_isString(v) && v.length > 0) {\n            ret[k] = v\n        }\n    })\n    return ret\n}\n\n/**\n * Deep copies an object.\n * It handles cycles by replacing all references to them with `undefined`\n * Also supports customizing native values\n *\n * @param value\n * @param customizer\n * @returns {{}|undefined|*}\n */\nfunction deepCircularCopy<T extends Record<string, any> = Record<string, any>>(\n    value: T,\n    customizer?: <K extends keyof T = keyof T>(value: T[K], key?: K) => T[K]\n): T | undefined {\n    const COPY_IN_PROGRESS_SET = new Set()\n\n    function internalDeepCircularCopy(value: T, key?: string): T | undefined {\n        if (value !== Object(value)) return customizer ? customizer(value as any, key) : value // primitive value\n\n        if (COPY_IN_PROGRESS_SET.has(value)) return undefined\n        COPY_IN_PROGRESS_SET.add(value)\n        let result: T\n\n        if (_isArray(value)) {\n            result = [] as any as T\n            _eachArray(value, (it) => {\n                result.push(internalDeepCircularCopy(it))\n            })\n        } else {\n            result = {} as T\n            _each(value, (val, key) => {\n                if (!COPY_IN_PROGRESS_SET.has(val)) {\n                    ;(result as any)[key] = internalDeepCircularCopy(val, key)\n                }\n            })\n        }\n        return result\n    }\n    return internalDeepCircularCopy(value)\n}\n\nconst LONG_STRINGS_ALLOW_LIST = ['$performance_raw']\n\nexport function _copyAndTruncateStrings<T extends Record<string, any> = Record<string, any>>(\n    object: T,\n    maxStringLength: number | null\n): T {\n    return deepCircularCopy(object, (value: any, key) => {\n        if (key && LONG_STRINGS_ALLOW_LIST.indexOf(key as string) > -1) {\n            return value\n        }\n        if (typeof value === 'string' && maxStringLength !== null) {\n            return (value as string).slice(0, maxStringLength)\n        }\n        return value\n    }) as T\n}\n\nexport function _base64Encode(data: null): null\nexport function _base64Encode(data: undefined): undefined\nexport function _base64Encode(data: string): string\nexport function _base64Encode(data: string | null | undefined): string | null | undefined {\n    const b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\n    let o1,\n        o2,\n        o3,\n        h1,\n        h2,\n        h3,\n        h4,\n        bits,\n        i = 0,\n        ac = 0,\n        enc = ''\n    const tmp_arr: string[] = []\n\n    if (!data) {\n        return data\n    }\n\n    data = _utf8Encode(data)\n\n    do {\n        // pack three octets into four hexets\n        o1 = data.charCodeAt(i++)\n        o2 = data.charCodeAt(i++)\n        o3 = data.charCodeAt(i++)\n\n        bits = (o1 << 16) | (o2 << 8) | o3\n\n        h1 = (bits >> 18) & 0x3f\n        h2 = (bits >> 12) & 0x3f\n        h3 = (bits >> 6) & 0x3f\n        h4 = bits & 0x3f\n\n        // use hexets to index into b64, and append result to encoded string\n        tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4)\n    } while (i < data.length)\n\n    enc = tmp_arr.join('')\n\n    switch (data.length % 3) {\n        case 1:\n            enc = enc.slice(0, -2) + '=='\n            break\n        case 2:\n            enc = enc.slice(0, -1) + '='\n            break\n    }\n\n    return enc\n}\n\nexport const _utf8Encode = function (string: string): string {\n    string = (string + '').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n')\n\n    let utftext = '',\n        start,\n        end\n    let stringl = 0,\n        n\n\n    start = end = 0\n    stringl = string.length\n\n    for (n = 0; n < stringl; n++) {\n        const c1 = string.charCodeAt(n)\n        let enc = null\n\n        if (c1 < 128) {\n            end++\n        } else if (c1 > 127 && c1 < 2048) {\n            enc = String.fromCharCode((c1 >> 6) | 192, (c1 & 63) | 128)\n        } else {\n            enc = String.fromCharCode((c1 >> 12) | 224, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128)\n        }\n        if (enc !== null) {\n            if (end > start) {\n                utftext += string.substring(start, end)\n            }\n            utftext += enc\n            start = end = n + 1\n        }\n    }\n\n    if (end > start) {\n        utftext += string.substring(start, string.length)\n    }\n\n    return utftext\n}\n\nexport const _UUID = (function () {\n    // Time/ticks information\n    // 1*new Date() is a cross browser version of Date.now()\n    const T = function () {\n        const d = new Date().valueOf()\n        let i = 0\n\n        // this while loop figures how many browser ticks go by\n        // before 1*new Date() returns a new number, ie the amount\n        // of ticks that go by per millisecond\n        while (d == new Date().valueOf()) {\n            i++\n        }\n\n        return d.toString(16) + i.toString(16)\n    }\n\n    // Math.Random entropy\n    const R = function () {\n        return Math.random().toString(16).replace('.', '')\n    }\n\n    // User agent entropy\n    // This function takes the user agent string, and then xors\n    // together each sequence of 8 bytes.  This produces a final\n    // sequence of 8 bytes which it returns as hex.\n    const UA = function () {\n        const ua = userAgent\n        let i,\n            ch,\n            ret = 0,\n            buffer: number[] = []\n\n        function xor(result: number, byte_array: number[]) {\n            let j,\n                tmp = 0\n            for (j = 0; j < byte_array.length; j++) {\n                tmp |= buffer[j] << (j * 8)\n            }\n            return result ^ tmp\n        }\n\n        for (i = 0; i < ua.length; i++) {\n            ch = ua.charCodeAt(i)\n            buffer.unshift(ch & 0xff)\n            if (buffer.length >= 4) {\n                ret = xor(ret, buffer)\n                buffer = []\n            }\n        }\n\n        if (buffer.length > 0) {\n            ret = xor(ret, buffer)\n        }\n\n        return ret.toString(16)\n    }\n\n    return function (version?: 'v7') {\n        if (version === 'v7') {\n            return uuidv7()\n        }\n\n        const se = typeof window !== 'undefined' ? (window.screen.height * window.screen.width).toString(16) : '0'\n        return T() + '-' + R() + '-' + UA() + '-' + se + '-' + T()\n    }\n})()\n\n// _.isBlockedUA()\n// This is to block various web spiders from executing our JS and\n// sending false capturing data\nexport const _isBlockedUA = function (ua: string): boolean {\n    if (\n        /(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp|ahrefsbot|facebookexternalhit|facebookcatalog|applebot|semrushbot|duckduckbot|twitterbot|rogerbot|linkedinbot|mj12bot|sitebulb|bot.htm|bot.php|hubspot|crawler|prerender)/i.test(\n            ua\n        )\n    ) {\n        return true\n    }\n    return false\n}\n\n/**\n * @param {Object=} formdata\n * @param {string=} arg_separator\n */\nexport const _HTTPBuildQuery = function (formdata: Record<string, any>, arg_separator = '&'): string {\n    let use_val: string\n    let use_key: string\n    const tph_arr: string[] = []\n\n    _each(formdata, function (val, key) {\n        use_val = encodeURIComponent(val.toString())\n        use_key = encodeURIComponent(key)\n        tph_arr[tph_arr.length] = use_key + '=' + use_val\n    })\n\n    return tph_arr.join(arg_separator)\n}\n\nexport const _getQueryParam = function (url: string, param: string): string {\n    // Expects a raw URL\n\n    const cleanParam = param.replace(/[[]/, '\\\\[').replace(/[\\]]/, '\\\\]')\n    const regexS = '[\\\\?&]' + cleanParam + '=([^&#]*)'\n    const regex = new RegExp(regexS)\n    const results = regex.exec(url)\n    if (results === null || (results && typeof results[1] !== 'string' && (results[1] as any).length)) {\n        return ''\n    } else {\n        let result = results[1]\n        try {\n            result = decodeURIComponent(result)\n        } catch (err) {\n            logger.error('Skipping decoding for malformed query param: ' + result)\n        }\n        return result.replace(/\\+/g, ' ')\n    }\n}\n\nexport const _getHashParam = function (hash: string, param: string): string | null {\n    const matches = hash.match(new RegExp(param + '=([^&]*)'))\n    return matches ? matches[1] : null\n}\n\nexport const _register_event = (function () {\n    // written by Dean Edwards, 2005\n    // with input from Tino Zijdel - crisp@xs4all.nl\n    // with input from Carl Sverre - mail@carlsverre.com\n    // with input from PostHog\n    // http://dean.edwards.name/weblog/2005/10/add-event/\n    // https://gist.github.com/1930440\n\n    /**\n     * @param {Object} element\n     * @param {string} type\n     * @param {function(...*)} handler\n     * @param {boolean=} oldSchool\n     * @param {boolean=} useCapture\n     */\n    const register_event = function (\n        element: Element | Window | Document | Node,\n        type: string,\n        handler: EventHandler,\n        oldSchool?: boolean,\n        useCapture?: boolean\n    ) {\n        if (!element) {\n            logger.error('No valid element provided to register_event')\n            return\n        }\n\n        if (element.addEventListener && !oldSchool) {\n            element.addEventListener(type, handler, !!useCapture)\n        } else {\n            const ontype = 'on' + type\n            const old_handler = (element as any)[ontype] // can be undefined\n            ;(element as any)[ontype] = makeHandler(element, handler, old_handler)\n        }\n    }\n\n    function makeHandler(\n        element: Element | Window | Document | Node,\n        new_handler: EventHandler,\n        old_handlers: EventHandler\n    ) {\n        return function (event: Event): boolean | void {\n            event = event || fixEvent(window.event)\n\n            // this basically happens in firefox whenever another script\n            // overwrites the onload callback and doesn't pass the event\n            // object to previously defined callbacks.  All the browsers\n            // that don't define window.event implement addEventListener\n            // so the dom_loaded handler will still be fired as usual.\n            if (!event) {\n                return undefined\n            }\n\n            let ret = true\n            let old_result: any\n\n            if (_isFunction(old_handlers)) {\n                old_result = old_handlers(event)\n            }\n            const new_result = new_handler.call(element, event)\n\n            if (false === old_result || false === new_result) {\n                ret = false\n            }\n\n            return ret\n        }\n    }\n\n    function fixEvent(event: Event | undefined): Event | undefined {\n        if (event) {\n            event.preventDefault = fixEvent.preventDefault\n            event.stopPropagation = fixEvent.stopPropagation\n        }\n        return event\n    }\n    fixEvent.preventDefault = function () {\n        ;(this as any as Event).returnValue = false\n    }\n    fixEvent.stopPropagation = function () {\n        ;(this as any as Event).cancelBubble = true\n    }\n\n    return register_event\n})()\n\nexport const isLocalhost = (): boolean => {\n    return localDomains.includes(location.hostname)\n}\n\nexport function loadScript(scriptUrlToLoad: string, callback: (error?: string | Event, event?: Event) => void): void {\n    const addScript = () => {\n        const scriptTag = document.createElement('script')\n        scriptTag.type = 'text/javascript'\n        scriptTag.src = scriptUrlToLoad\n        scriptTag.onload = (event) => callback(undefined, event)\n        scriptTag.onerror = (error) => callback(error)\n\n        const scripts = document.querySelectorAll('body > script')\n        if (scripts.length > 0) {\n            scripts[0].parentNode?.insertBefore(scriptTag, scripts[0])\n        } else {\n            // In exceptional situations this call might load before the DOM is fully ready.\n            document.body.appendChild(scriptTag)\n        }\n    }\n\n    if (document.body) {\n        addScript()\n    } else {\n        document.addEventListener('DOMContentLoaded', addScript)\n    }\n}\n\nexport const _info = {\n    campaignParams: function (customParams?: string[]): Record<string, any> {\n        const campaign_keywords = [\n            'utm_source',\n            'utm_medium',\n            'utm_campaign',\n            'utm_content',\n            'utm_term',\n            'gclid',\n            'fbclid',\n            'msclkid',\n        ].concat(customParams || [])\n\n        const params: Record<string, any> = {}\n        _each(campaign_keywords, function (kwkey) {\n            const kw = _getQueryParam(document.URL, kwkey)\n            if (kw.length) {\n                params[kwkey] = kw\n            }\n        })\n\n        return params\n    },\n\n    searchEngine: function (): string | null {\n        const referrer = document.referrer\n        if (!referrer) {\n            return null\n        } else if (referrer.search('https?://(.*)google.([^/?]*)') === 0) {\n            return 'google'\n        } else if (referrer.search('https?://(.*)bing.com') === 0) {\n            return 'bing'\n        } else if (referrer.search('https?://(.*)yahoo.com') === 0) {\n            return 'yahoo'\n        } else if (referrer.search('https?://(.*)duckduckgo.com') === 0) {\n            return 'duckduckgo'\n        } else {\n            return null\n        }\n    },\n\n    searchInfo: function (): Record<string, any> {\n        const search = _info.searchEngine(),\n            param = search != 'yahoo' ? 'q' : 'p',\n            ret: Record<string, any> = {}\n\n        if (search !== null) {\n            ret['$search_engine'] = search\n\n            const keyword = _getQueryParam(document.referrer, param)\n            if (keyword.length) {\n                ret['ph_keyword'] = keyword\n            }\n        }\n\n        return ret\n    },\n\n    /**\n     * This function detects which browser is running this script.\n     * The order of the checks are important since many user agents\n     * include key words used in later checks.\n     */\n    browser: function (user_agent: string, vendor: string, opera?: any): string {\n        vendor = vendor || '' // vendor is undefined for at least IE9\n        if (opera || _includes(user_agent, ' OPR/')) {\n            if (_includes(user_agent, 'Mini')) {\n                return 'Opera Mini'\n            }\n            return 'Opera'\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return 'BlackBerry'\n        } else if (_includes(user_agent, 'IEMobile') || _includes(user_agent, 'WPDesktop')) {\n            return 'Internet Explorer Mobile'\n        } else if (_includes(user_agent, 'SamsungBrowser/')) {\n            // https://developer.samsung.com/internet/user-agent-string-format\n            return 'Samsung Internet'\n        } else if (_includes(user_agent, 'Edge') || _includes(user_agent, 'Edg/')) {\n            return 'Microsoft Edge'\n        } else if (_includes(user_agent, 'FBIOS')) {\n            return 'Facebook Mobile'\n        } else if (_includes(user_agent, 'Chrome')) {\n            return 'Chrome'\n        } else if (_includes(user_agent, 'CriOS')) {\n            return 'Chrome iOS'\n        } else if (_includes(user_agent, 'UCWEB') || _includes(user_agent, 'UCBrowser')) {\n            return 'UC Browser'\n        } else if (_includes(user_agent, 'FxiOS')) {\n            return 'Firefox iOS'\n        } else if (_includes(vendor, 'Apple')) {\n            if (_includes(user_agent, 'Mobile')) {\n                return 'Mobile Safari'\n            }\n            return 'Safari'\n        } else if (_includes(user_agent, 'Android')) {\n            return 'Android Mobile'\n        } else if (_includes(user_agent, 'Konqueror')) {\n            return 'Konqueror'\n        } else if (_includes(user_agent, 'Firefox')) {\n            return 'Firefox'\n        } else if (_includes(user_agent, 'MSIE') || _includes(user_agent, 'Trident/')) {\n            return 'Internet Explorer'\n        } else if (_includes(user_agent, 'Gecko')) {\n            return 'Mozilla'\n        } else {\n            return ''\n        }\n    },\n\n    /**\n     * This function detects which browser version is running this script,\n     * parsing major and minor version (e.g., 42.1). User agent strings from:\n     * http://www.useragentstring.com/pages/useragentstring.php\n     */\n    browserVersion: function (userAgent: string, vendor: string, opera: string): number | null {\n        const browser = _info.browser(userAgent, vendor, opera)\n        const versionRegexs = {\n            'Internet Explorer Mobile': /rv:(\\d+(\\.\\d+)?)/,\n            'Microsoft Edge': /Edge?\\/(\\d+(\\.\\d+)?)/,\n            Chrome: /Chrome\\/(\\d+(\\.\\d+)?)/,\n            'Chrome iOS': /CriOS\\/(\\d+(\\.\\d+)?)/,\n            'UC Browser': /(UCBrowser|UCWEB)\\/(\\d+(\\.\\d+)?)/,\n            Safari: /Version\\/(\\d+(\\.\\d+)?)/,\n            'Mobile Safari': /Version\\/(\\d+(\\.\\d+)?)/,\n            Opera: /(Opera|OPR)\\/(\\d+(\\.\\d+)?)/,\n            Firefox: /Firefox\\/(\\d+(\\.\\d+)?)/,\n            'Firefox iOS': /FxiOS\\/(\\d+(\\.\\d+)?)/,\n            Konqueror: /Konqueror:(\\d+(\\.\\d+)?)/,\n            BlackBerry: /BlackBerry (\\d+(\\.\\d+)?)/,\n            'Android Mobile': /android\\s(\\d+(\\.\\d+)?)/,\n            'Samsung Internet': /SamsungBrowser\\/(\\d+(\\.\\d+)?)/,\n            'Internet Explorer': /(rv:|MSIE )(\\d+(\\.\\d+)?)/,\n            Mozilla: /rv:(\\d+(\\.\\d+)?)/,\n        }\n        const regex: RegExp | undefined = versionRegexs[browser as keyof typeof versionRegexs]\n        if (regex === undefined) {\n            return null\n        }\n        const matches = userAgent.match(regex)\n        if (!matches) {\n            return null\n        }\n        return parseFloat(matches[matches.length - 2])\n    },\n\n    browserLanguage: function (): string {\n        return (\n            navigator.language || // Any modern browser\n            (navigator as Record<string, any>).userLanguage // IE11\n        )\n    },\n\n    os: function (user_agent: string): { os_name: string; os_version: string } {\n        if (/Windows/i.test(user_agent)) {\n            if (/Phone/.test(user_agent) || /WPDesktop/.test(user_agent)) {\n                return { os_name: 'Windows Phone', os_version: '' }\n            }\n            const match = /Windows NT ([0-9.]+)/i.exec(user_agent)\n            if (match && match[1]) {\n                const version = match[1]\n                return { os_name: 'Windows', os_version: version }\n            }\n            return { os_name: 'Windows', os_version: '' }\n        } else if (/(iPhone|iPad|iPod)/.test(user_agent)) {\n            const match = /OS (\\d+)_(\\d+)_?(\\d+)?/i.exec(user_agent)\n            if (match && match[1]) {\n                const versionParts = [match[1], match[2], match[3] || '0']\n                return { os_name: 'iOS', os_version: versionParts.join('.') }\n            }\n            return { os_name: 'iOS', os_version: '' }\n        } else if (/Android/.test(user_agent)) {\n            const match = /Android (\\d+)\\.(\\d+)\\.?(\\d+)?/i.exec(user_agent)\n            if (match && match[1]) {\n                const versionParts = [match[1], match[2], match[3] || '0']\n                return { os_name: 'Android', os_version: versionParts.join('.') }\n            }\n            return { os_name: 'Android', os_version: '' }\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return { os_name: 'BlackBerry', os_version: '' }\n        } else if (/Mac/i.test(user_agent)) {\n            const match = /Mac OS X (\\d+)[_.](\\d+)[_.]?(\\d+)?/i.exec(user_agent)\n            if (match && match[1]) {\n                const versionParts = [match[1], match[2], match[3] || '0']\n                return { os_name: 'Mac OS X', os_version: versionParts.join('.') }\n            }\n            return { os_name: 'Mac OS X', os_version: '' }\n        } else if (/Linux/.test(user_agent)) {\n            return { os_name: 'Linux', os_version: '' }\n        } else if (/CrOS/.test(user_agent)) {\n            return { os_name: 'Chrome OS', os_version: '' }\n        } else {\n            return { os_name: '', os_version: '' }\n        }\n    },\n\n    device: function (user_agent: string): string {\n        if (/Windows Phone/i.test(user_agent) || /WPDesktop/.test(user_agent)) {\n            return 'Windows Phone'\n        } else if (/iPad/.test(user_agent)) {\n            return 'iPad'\n        } else if (/iPod/.test(user_agent)) {\n            return 'iPod Touch'\n        } else if (/iPhone/.test(user_agent)) {\n            return 'iPhone'\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return 'BlackBerry'\n        } else if (/Android/.test(user_agent) && !/Mobile/.test(user_agent)) {\n            return 'Android Tablet'\n        } else if (/Android/.test(user_agent)) {\n            return 'Android'\n        } else {\n            return ''\n        }\n    },\n\n    deviceType: function (user_agent: string): string {\n        const device = this.device(user_agent)\n        if (device === 'iPad' || device === 'Android Tablet') {\n            return 'Tablet'\n        } else if (device) {\n            return 'Mobile'\n        } else {\n            return 'Desktop'\n        }\n    },\n\n    referrer: function (): string {\n        return document.referrer || '$direct'\n    },\n\n    referringDomain: function (): string {\n        if (!document.referrer) {\n            return '$direct'\n        }\n        const parser = document.createElement('a') // Unfortunately we cannot use new URL due to IE11\n        parser.href = document.referrer\n        return parser.host\n    },\n\n    properties: function (): Properties {\n        const { os_name, os_version } = _info.os(userAgent)\n        return _extend(\n            _strip_empty_properties({\n                $os: os_name,\n                $os_version: os_version,\n                $browser: _info.browser(userAgent, navigator.vendor, (win as any).opera),\n                $device: _info.device(userAgent),\n                $device_type: _info.deviceType(userAgent),\n            }),\n            {\n                $current_url: win?.location.href,\n                $host: win?.location.host,\n                $pathname: win?.location.pathname,\n                $browser_version: _info.browserVersion(userAgent, navigator.vendor, (win as any).opera),\n                $browser_language: _info.browserLanguage(),\n                $screen_height: win?.screen.height,\n                $screen_width: win?.screen.width,\n                $viewport_height: win?.innerHeight,\n                $viewport_width: win?.innerWidth,\n                $lib: 'web',\n                $lib_version: Config.LIB_VERSION,\n                $insert_id: Math.random().toString(36).substring(2, 10) + Math.random().toString(36).substring(2, 10),\n                $time: _timestamp() / 1000, // epoch time in seconds\n            }\n        )\n    },\n\n    people_properties: function (): Properties {\n        const { os_name, os_version } = _info.os(userAgent)\n        return _extend(\n            _strip_empty_properties({\n                $os: os_name,\n                $os_version: os_version,\n                $browser: _info.browser(userAgent, navigator.vendor, (win as any).opera),\n            }),\n            {\n                $browser_version: _info.browserVersion(userAgent, navigator.vendor, (win as any).opera),\n            }\n        )\n    },\n}\n\nexport { win as window, userAgent, logger, document }\n","/*\n * Get the className of an element, accounting for edge cases where element.className is an object\n * @param {Element} el - element to get the className of\n * @returns {string} the element's class\n */\nimport { AutocaptureConfig } from 'types'\nimport { _each, _includes, _isUndefined, _trim } from './utils'\n\nexport function getClassName(el: Element): string {\n    switch (typeof el.className) {\n        case 'string':\n            return el.className\n        // TODO: when is this ever used?\n        case 'object': // handle cases where className might be SVGAnimatedString or some other type\n            return ('baseVal' in el.className ? (el.className as any).baseVal : null) || el.getAttribute('class') || ''\n        default:\n            // future proof\n            return ''\n    }\n}\n\n/*\n * Get the direct text content of an element, protecting against sensitive data collection.\n * Concats textContent of each of the element's text node children; this avoids potential\n * collection of sensitive data that could happen if we used element.textContent and the\n * element had sensitive child elements, since element.textContent includes child content.\n * Scrubs values that look like they could be sensitive (i.e. cc or ssn number).\n * @param {Element} el - element to get the text of\n * @returns {string} the element's direct text content\n */\nexport function getSafeText(el: Element): string {\n    let elText = ''\n\n    if (shouldCaptureElement(el) && !isSensitiveElement(el) && el.childNodes && el.childNodes.length) {\n        _each(el.childNodes, function (child) {\n            if (isTextNode(child) && child.textContent) {\n                elText += _trim(child.textContent)\n                    // scrub potentially sensitive values\n                    .split(/(\\s+)/)\n                    .filter(shouldCaptureValue)\n                    .join('')\n                    // normalize whitespace\n                    .replace(/[\\r\\n]/g, ' ')\n                    .replace(/[ ]+/g, ' ')\n                    // truncate\n                    .substring(0, 255)\n            }\n        })\n    }\n\n    return _trim(elText)\n}\n\n/*\n * Check whether an element has nodeType Node.ELEMENT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isElementNode(el: Element | undefined | null): el is HTMLElement {\n    return !!el && el.nodeType === 1 // Node.ELEMENT_NODE - use integer constant for browser portability\n}\n\n/*\n * Check whether an element is of a given tag type.\n * Due to potential reference discrepancies (such as the webcomponents.js polyfill),\n * we want to match tagNames instead of specific references because something like\n * element === document.body won't always work because element might not be a native\n * element.\n * @param {Element} el - element to check\n * @param {string} tag - tag name (e.g., \"div\")\n * @returns {boolean} whether el is of the given tag type\n */\nexport function isTag(el: Element | undefined | null, tag: string): el is HTMLElement {\n    return !!el && !!el.tagName && el.tagName.toLowerCase() === tag.toLowerCase()\n}\n\n/*\n * Check whether an element has nodeType Node.TEXT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isTextNode(el: Element | undefined | null): el is HTMLElement {\n    return !!el && el.nodeType === 3 // Node.TEXT_NODE - use integer constant for browser portability\n}\n\n/*\n * Check whether an element has nodeType Node.DOCUMENT_FRAGMENT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isDocumentFragment(el: Element | ParentNode | undefined | null): el is DocumentFragment {\n    return !!el && el.nodeType === 11 // Node.DOCUMENT_FRAGMENT_NODE - use integer constant for browser portability\n}\n\nexport const autocaptureCompatibleElements = ['a', 'button', 'form', 'input', 'select', 'textarea', 'label']\n/*\n * Check whether a DOM event should be \"captured\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @param {Event} event - event to check\n * @param {Object} autocaptureConfig - autocapture config\n * @returns {boolean} whether the event should be captured\n */\nexport function shouldCaptureDomEvent(\n    el: Element,\n    event: Event,\n    autocaptureConfig: AutocaptureConfig | undefined = undefined\n): boolean {\n    if (!el || isTag(el, 'html') || !isElementNode(el)) {\n        return false\n    }\n\n    if (autocaptureConfig?.url_allowlist) {\n        const url = window.location.href\n        const allowlist = autocaptureConfig.url_allowlist\n        if (allowlist && !allowlist.some((regex) => url.match(regex))) {\n            return false\n        }\n    }\n\n    if (autocaptureConfig?.dom_event_allowlist) {\n        const allowlist = autocaptureConfig.dom_event_allowlist\n        if (allowlist && !allowlist.some((eventType) => event.type === eventType)) {\n            return false\n        }\n    }\n\n    if (autocaptureConfig?.element_allowlist) {\n        const allowlist = autocaptureConfig.element_allowlist\n        if (allowlist && !allowlist.some((elementType) => el.tagName.toLowerCase() === elementType)) {\n            return false\n        }\n    }\n\n    if (autocaptureConfig?.css_selector_allowlist) {\n        const allowlist = autocaptureConfig.css_selector_allowlist\n        if (allowlist && !allowlist.some((selector) => el.matches(selector))) {\n            return false\n        }\n    }\n\n    let parentIsUsefulElement = false\n    const targetElementList: Element[] = [el] // TODO: remove this var, it's never queried\n    let parentNode: Element | boolean = true\n    let curEl: Element = el\n    while (curEl.parentNode && !isTag(curEl, 'body')) {\n        // If element is a shadow root, we skip it\n        if (isDocumentFragment(curEl.parentNode)) {\n            targetElementList.push((curEl.parentNode as any).host)\n            curEl = (curEl.parentNode as any).host\n            continue\n        }\n        parentNode = (curEl.parentNode as Element) || false\n        if (!parentNode) break\n        if (autocaptureCompatibleElements.indexOf(parentNode.tagName.toLowerCase()) > -1) {\n            parentIsUsefulElement = true\n        } else {\n            const compStyles = window.getComputedStyle(parentNode)\n            if (compStyles && compStyles.getPropertyValue('cursor') === 'pointer') {\n                parentIsUsefulElement = true\n            }\n        }\n\n        targetElementList.push(parentNode)\n        curEl = parentNode\n    }\n\n    const compStyles = window.getComputedStyle(el)\n    if (compStyles && compStyles.getPropertyValue('cursor') === 'pointer' && event.type === 'click') {\n        return true\n    }\n\n    const tag = el.tagName.toLowerCase()\n    switch (tag) {\n        case 'html':\n            return false\n        case 'form':\n            return event.type === 'submit'\n        case 'input':\n            return event.type === 'change' || event.type === 'click'\n        case 'select':\n        case 'textarea':\n            return event.type === 'change' || event.type === 'click'\n        default:\n            if (parentIsUsefulElement) return event.type === 'click'\n            return (\n                event.type === 'click' &&\n                (autocaptureCompatibleElements.indexOf(tag) > -1 || el.getAttribute('contenteditable') === 'true')\n            )\n    }\n}\n\n/*\n * Check whether a DOM element should be \"captured\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @returns {boolean} whether the element should be captured\n */\nexport function shouldCaptureElement(el: Element): boolean {\n    for (let curEl = el; curEl.parentNode && !isTag(curEl, 'body'); curEl = curEl.parentNode as Element) {\n        const classes = getClassName(curEl).split(' ')\n        if (_includes(classes, 'ph-sensitive') || _includes(classes, 'ph-no-capture')) {\n            return false\n        }\n    }\n\n    if (_includes(getClassName(el).split(' '), 'ph-include')) {\n        return true\n    }\n\n    // don't include hidden or password fields\n    const type = (el as HTMLInputElement).type || ''\n    if (typeof type === 'string') {\n        // it's possible for el.type to be a DOM element if el is a form with a child input[name=\"type\"]\n        switch (type.toLowerCase()) {\n            case 'hidden':\n                return false\n            case 'password':\n                return false\n        }\n    }\n\n    // filter out data from fields that look like sensitive fields\n    const name = (el as HTMLInputElement).name || el.id || ''\n    // See https://github.com/posthog/posthog-js/issues/165\n    // Under specific circumstances a bug caused .replace to be called on a DOM element\n    // instead of a string, removing the element from the page. Ensure this issue is mitigated.\n    if (typeof name === 'string') {\n        // it's possible for el.name or el.id to be a DOM element if el is a form with a child input[name=\"name\"]\n        const sensitiveNameRegex =\n            /^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i\n        if (sensitiveNameRegex.test(name.replace(/[^a-zA-Z0-9]/g, ''))) {\n            return false\n        }\n    }\n\n    return true\n}\n\n/*\n * Check whether a DOM element is 'sensitive' and we should only capture limited data\n * @param {Element} el - element to check\n * @returns {boolean} whether the element should be captured\n */\nexport function isSensitiveElement(el: Element): boolean {\n    // don't send data from inputs or similar elements since there will always be\n    // a risk of clientside javascript placing sensitive data in attributes\n    const allowedInputTypes = ['button', 'checkbox', 'submit', 'reset']\n    if (\n        (isTag(el, 'input') && !allowedInputTypes.includes((el as HTMLInputElement).type)) ||\n        isTag(el, 'select') ||\n        isTag(el, 'textarea') ||\n        el.getAttribute('contenteditable') === 'true'\n    ) {\n        return true\n    }\n    return false\n}\n\n/*\n * Check whether a string value should be \"captured\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {string} value - string value to check\n * @returns {boolean} whether the element should be captured\n */\nexport function shouldCaptureValue(value: string): boolean {\n    if (value === null || _isUndefined(value)) {\n        return false\n    }\n\n    if (typeof value === 'string') {\n        value = _trim(value)\n\n        // check to see if input value looks like a credit card number\n        // see: https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html\n        const ccRegex =\n            /^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/\n        if (ccRegex.test((value || '').replace(/[- ]/g, ''))) {\n            return false\n        }\n\n        // check to see if input value looks like a social security number\n        const ssnRegex = /(^\\d{3}-?\\d{2}-?\\d{4}$)/\n        if (ssnRegex.test(value)) {\n            return false\n        }\n    }\n\n    return true\n}\n\n/*\n * Check whether an attribute name is an Angular style attr (either _ngcontent or _nghost)\n * These update on each build and lead to noise in the element chain\n * More details on the attributes here: https://angular.io/guide/view-encapsulation\n * @param {string} attributeName - string value to check\n * @returns {boolean} whether the element is an angular tag\n */\nexport function isAngularStyleAttr(attributeName: string): boolean {\n    if (typeof attributeName === 'string') {\n        return attributeName.substring(0, 10) === '_ngcontent' || attributeName.substring(0, 7) === '_nghost'\n    }\n    return false\n}\n\n/*\n * Iterate through children of a target element looking for span tags\n * and return the text content of the span tags, separated by spaces,\n * along with the direct text content of the target element\n * @param {Element} target - element to check\n * @returns {string} text content of the target element and its child span tags\n */\nexport function getDirectAndNestedSpanText(target: Element): string {\n    let text = getSafeText(target)\n    text = `${text} ${getNestedSpanText(target)}`.trim()\n    return shouldCaptureValue(text) ? text : ''\n}\n\n/*\n * Iterate through children of a target element looking for span tags\n * and return the text content of the span tags, separated by spaces\n * @param {Element} target - element to check\n * @returns {string} text content of span tags\n */\nexport function getNestedSpanText(target: Element): string {\n    let text = ''\n    if (target && target.childNodes && target.childNodes.length) {\n        _each(target.childNodes, function (child) {\n            if (child && child.tagName?.toLowerCase() === 'span') {\n                try {\n                    const spanText = getSafeText(child)\n                    text = `${text} ${spanText}`.trim()\n\n                    if (child.childNodes && child.childNodes.length) {\n                        text = `${text} ${getNestedSpanText(child)}`.trim()\n                    }\n                } catch (e) {\n                    console.error(e)\n                }\n            }\n        })\n    }\n    return text\n}\n","// Naive rage click implementation: If mouse has not moved than RAGE_CLICK_THRESHOLD_PX\n// over RAGE_CLICK_CLICK_COUNT clicks with max RAGE_CLICK_TIMEOUT_MS between clicks, it's\n// counted as a rage click\n\nconst RAGE_CLICK_THRESHOLD_PX = 30\nconst RAGE_CLICK_TIMEOUT_MS = 1000\nconst RAGE_CLICK_CLICK_COUNT = 3\n\nexport default class RageClick {\n    clicks: { x: number; y: number; timestamp: number }[]\n    enabled: boolean\n\n    constructor(enabled: boolean) {\n        this.clicks = []\n        this.enabled = enabled\n    }\n\n    isRageClick(x: number, y: number, timestamp: number): boolean {\n        if (!this.enabled) {\n            return false\n        }\n\n        const lastClick = this.clicks[this.clicks.length - 1]\n        if (\n            lastClick &&\n            Math.abs(x - lastClick.x) + Math.abs(y - lastClick.y) < RAGE_CLICK_THRESHOLD_PX &&\n            timestamp - lastClick.timestamp < RAGE_CLICK_TIMEOUT_MS\n        ) {\n            this.clicks.push({ x, y, timestamp })\n\n            if (this.clicks.length === RAGE_CLICK_CLICK_COUNT) {\n                return true\n            }\n        } else {\n            this.clicks = [{ x, y, timestamp }]\n        }\n\n        return false\n    }\n}\n","import { _extend, logger } from './utils'\nimport { PersistentStore, Properties } from './types'\nimport Config from './config'\n\nconst DOMAIN_MATCH_REGEX = /[a-z0-9][a-z0-9-]+\\.[a-z.]{2,6}$/i\n\n// Methods partially borrowed from quirksmode.org/js/cookies.html\nexport const cookieStore: PersistentStore = {\n    is_supported: () => true,\n\n    error: function (msg) {\n        logger.error('cookieStore error: ' + msg)\n    },\n\n    get: function (name) {\n        try {\n            const nameEQ = name + '='\n            const ca = document.cookie.split(';')\n            for (let i = 0; i < ca.length; i++) {\n                let c = ca[i]\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length)\n                }\n                if (c.indexOf(nameEQ) === 0) {\n                    return decodeURIComponent(c.substring(nameEQ.length, c.length))\n                }\n            }\n        } catch (err) {}\n        return null\n    },\n\n    parse: function (name) {\n        let cookie\n        try {\n            cookie = JSON.parse(cookieStore.get(name)) || {}\n        } catch (err) {\n            // noop\n        }\n        return cookie\n    },\n\n    set: function (name, value, days, cross_subdomain, is_secure) {\n        try {\n            let cdomain = '',\n                expires = '',\n                secure = ''\n\n            if (cross_subdomain) {\n                const matches = document.location.hostname.match(DOMAIN_MATCH_REGEX),\n                    domain = matches ? matches[0] : ''\n\n                cdomain = domain ? '; domain=.' + domain : ''\n            }\n\n            if (days) {\n                const date = new Date()\n                date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000)\n                expires = '; expires=' + date.toUTCString()\n            }\n\n            if (is_secure) {\n                secure = '; secure'\n            }\n\n            const new_cookie_val =\n                name +\n                '=' +\n                encodeURIComponent(JSON.stringify(value)) +\n                expires +\n                '; SameSite=Lax; path=/' +\n                cdomain +\n                secure\n            document.cookie = new_cookie_val\n            return new_cookie_val\n        } catch (err) {\n            return\n        }\n    },\n\n    remove: function (name, cross_subdomain) {\n        try {\n            cookieStore.set(name, '', -1, cross_subdomain)\n        } catch (err) {\n            return\n        }\n    },\n}\n\nlet _localStorage_supported: boolean | null = null\n\nexport const localStore: PersistentStore = {\n    is_supported: function () {\n        if (_localStorage_supported !== null) {\n            return _localStorage_supported\n        }\n\n        let supported = true\n        if (typeof window !== 'undefined') {\n            try {\n                const key = '__mplssupport__',\n                    val = 'xyz'\n                localStore.set(key, val)\n                if (localStore.get(key) !== '\"xyz\"') {\n                    supported = false\n                }\n                localStore.remove(key)\n            } catch (err) {\n                supported = false\n            }\n        } else {\n            supported = false\n        }\n        if (!supported) {\n            logger.error('localStorage unsupported; falling back to cookie store')\n        }\n\n        _localStorage_supported = supported\n        return supported\n    },\n\n    error: function (msg) {\n        logger.error('localStorage error: ' + msg)\n    },\n\n    get: function (name) {\n        try {\n            return window.localStorage.getItem(name)\n        } catch (err) {\n            localStore.error(err)\n        }\n        return null\n    },\n\n    parse: function (name) {\n        try {\n            return JSON.parse(localStore.get(name)) || {}\n        } catch (err) {\n            // noop\n        }\n        return null\n    },\n\n    set: function (name, value) {\n        try {\n            window.localStorage.setItem(name, JSON.stringify(value))\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n\n    remove: function (name) {\n        try {\n            window.localStorage.removeItem(name)\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n}\n\n// Use localstorage for most data but still use cookie for distinct_id\n// This solves issues with cookies having too much data in them causing headers too large\n// Also makes sure we don't have to send a ton of data to the server\nexport const localPlusCookieStore: PersistentStore = {\n    ...localStore,\n    parse: function (name) {\n        try {\n            let extend: Properties = {}\n            try {\n                // See if there's a cookie stored with data.\n                extend = cookieStore.parse(name) || {}\n                if (extend['distinct_id']) {\n                    cookieStore.set(name, { distinct_id: extend['distinct_id'] })\n                }\n            } catch (err) {}\n            const value = _extend(extend, JSON.parse(localStore.get(name) || '{}'))\n            localStore.set(name, value)\n            return value\n        } catch (err) {\n            // noop\n        }\n        return null\n    },\n\n    set: function (name, value, days, cross_subdomain, is_secure) {\n        try {\n            localStore.set(name, value)\n            if (value.distinct_id) {\n                cookieStore.set(name, { distinct_id: value.distinct_id }, days, cross_subdomain, is_secure)\n            }\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n\n    remove: function (name, cross_subdomain) {\n        try {\n            window.localStorage.removeItem(name)\n            cookieStore.remove(name, cross_subdomain)\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n}\n\nconst memoryStorage: Properties = {}\n\n// Storage that only lasts the length of the pageview if we don't want to use cookies\nexport const memoryStore: PersistentStore = {\n    is_supported: function () {\n        return true\n    },\n\n    error: function (msg) {\n        logger.error('memoryStorage error: ' + msg)\n    },\n\n    get: function (name) {\n        return memoryStorage[name] || null\n    },\n\n    parse: function (name) {\n        return memoryStorage[name] || null\n    },\n\n    set: function (name, value) {\n        memoryStorage[name] = value\n    },\n\n    remove: function (name) {\n        delete memoryStorage[name]\n    },\n}\n\nlet sessionStorageSupported: boolean | null = null\nexport const resetSessionStorageSupported = () => {\n    sessionStorageSupported = null\n}\n// Storage that only lasts the length of a tab/window. Survives page refreshes\nexport const sessionStore: PersistentStore = {\n    is_supported: function () {\n        if (sessionStorageSupported !== null) {\n            return sessionStorageSupported\n        }\n        sessionStorageSupported = true\n        if (typeof window !== 'undefined') {\n            try {\n                const key = '__support__',\n                    val = 'xyz'\n                sessionStore.set(key, val)\n                if (sessionStore.get(key) !== '\"xyz\"') {\n                    sessionStorageSupported = false\n                }\n                sessionStore.remove(key)\n            } catch (err) {\n                sessionStorageSupported = false\n            }\n        } else {\n            sessionStorageSupported = false\n        }\n        return sessionStorageSupported\n    },\n\n    error: function (msg) {\n        if (Config.DEBUG) {\n            logger.error('sessionStorage error: ', msg)\n        }\n    },\n\n    get: function (name) {\n        try {\n            return window.sessionStorage.getItem(name)\n        } catch (err) {\n            sessionStore.error(err)\n        }\n        return null\n    },\n\n    parse: function (name) {\n        try {\n            return JSON.parse(sessionStore.get(name)) || null\n        } catch (err) {\n            // noop\n        }\n        return null\n    },\n\n    set: function (name, value) {\n        try {\n            window.sessionStorage.setItem(name, JSON.stringify(value))\n        } catch (err) {\n            sessionStore.error(err)\n        }\n    },\n\n    remove: function (name) {\n        try {\n            window.sessionStorage.removeItem(name)\n        } catch (err) {\n            sessionStore.error(err)\n        }\n    },\n}\n","/* eslint camelcase: \"off\" */\n\nimport { _each, _extend, _include, _info, _isObject, _isUndefined, _strip_empty_properties, logger } from './utils'\nimport { cookieStore, localStore, localPlusCookieStore, memoryStore, sessionStore } from './storage'\nimport { PersistentStore, PostHogConfig, Properties } from './types'\n\n/*\n * Constants\n */\n// This key is deprecated, but we want to check for it to see whether aliasing is allowed.\nexport const PEOPLE_DISTINCT_ID_KEY = '$people_distinct_id'\nexport const ALIAS_ID_KEY = '__alias'\nexport const CAMPAIGN_IDS_KEY = '__cmpns'\nexport const EVENT_TIMERS_KEY = '__timers'\nexport const AUTOCAPTURE_DISABLED_SERVER_SIDE = '$autocapture_disabled_server_side'\nexport const SESSION_RECORDING_ENABLED_SERVER_SIDE = '$session_recording_enabled_server_side'\nexport const CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE = '$console_log_recording_enabled_server_side'\nexport const SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE = '$session_recording_recorder_version_server_side' // follows rrweb versioning\nexport const SESSION_ID = '$sesid'\nexport const ENABLED_FEATURE_FLAGS = '$enabled_feature_flags'\nexport const PERSISTENCE_EARLY_ACCESS_FEATURES = '$early_access_features'\nexport const STORED_PERSON_PROPERTIES_KEY = '$stored_person_properties'\nexport const STORED_GROUP_PROPERTIES_KEY = '$stored_group_properties'\nexport const SURVEYS = '$surveys'\nexport const FLAG_CALL_REPORTED = '$flag_call_reported'\n\nconst USER_STATE = '$user_state'\n\nexport const RESERVED_PROPERTIES = [\n    PEOPLE_DISTINCT_ID_KEY,\n    ALIAS_ID_KEY,\n    CAMPAIGN_IDS_KEY,\n    EVENT_TIMERS_KEY,\n    SESSION_RECORDING_ENABLED_SERVER_SIDE,\n    SESSION_ID,\n    ENABLED_FEATURE_FLAGS,\n    USER_STATE,\n    PERSISTENCE_EARLY_ACCESS_FEATURES,\n    STORED_GROUP_PROPERTIES_KEY,\n    STORED_PERSON_PROPERTIES_KEY,\n    SURVEYS,\n    FLAG_CALL_REPORTED,\n]\n\nconst CASE_INSENSITIVE_PERSISTENCE_TYPES: readonly Lowercase<PostHogConfig['persistence']>[] = [\n    'cookie',\n    'localstorage',\n    'localstorage+cookie',\n    'sessionstorage',\n    'memory',\n]\n\n/**\n * PostHog Persistence Object\n * @constructor\n */\nexport class PostHogPersistence {\n    props: Properties\n    storage: PersistentStore\n    campaign_params_saved: boolean\n    custom_campaign_params: string[]\n    name: string\n    disabled: boolean | undefined\n    secure: boolean | undefined\n    expire_days: number | undefined\n    default_expiry: number | undefined\n    cross_subdomain: boolean | undefined\n    user_state: 'anonymous' | 'identified'\n\n    constructor(config: PostHogConfig) {\n        // clean chars that aren't accepted by the http spec for cookie values\n        // https://datatracker.ietf.org/doc/html/rfc2616#section-2.2\n        let token = ''\n\n        if (config['token']) {\n            token = config['token'].replace(/\\+/g, 'PL').replace(/\\//g, 'SL').replace(/=/g, 'EQ')\n        }\n\n        this.props = {}\n        this.campaign_params_saved = false\n        this.custom_campaign_params = config['custom_campaign_params'] || []\n\n        if (config['persistence_name']) {\n            this.name = 'ph_' + config['persistence_name']\n        } else {\n            this.name = 'ph_' + token + '_posthog'\n        }\n\n        if (\n            CASE_INSENSITIVE_PERSISTENCE_TYPES.indexOf(\n                config['persistence'].toLowerCase() as Lowercase<PostHogConfig['persistence']>\n            ) === -1\n        ) {\n            logger.critical('Unknown persistence type ' + config['persistence'] + '; falling back to cookie')\n            config['persistence'] = 'cookie'\n        }\n        // We handle storage type in a case-insensitive way for backwards compatibility\n        const storage_type = config['persistence'].toLowerCase() as Lowercase<PostHogConfig['persistence']>\n        if (storage_type === 'localstorage' && localStore.is_supported()) {\n            this.storage = localStore\n        } else if (storage_type === 'localstorage+cookie' && localPlusCookieStore.is_supported()) {\n            this.storage = localPlusCookieStore\n        } else if (storage_type === 'sessionstorage' && sessionStore.is_supported()) {\n            this.storage = sessionStore\n        } else if (storage_type === 'memory') {\n            this.storage = memoryStore\n        } else {\n            this.storage = cookieStore\n        }\n\n        this.user_state = 'anonymous'\n\n        this.load()\n        this.update_config(config)\n        this.save()\n    }\n\n    properties(): Properties {\n        const p: Properties = {}\n        // Filter out reserved properties\n        _each(this.props, function (v, k) {\n            if (k === ENABLED_FEATURE_FLAGS && typeof v === 'object') {\n                const keys = Object.keys(v)\n                for (let i = 0; i < keys.length; i++) {\n                    p[`$feature/${keys[i]}`] = v[keys[i]]\n                }\n            } else if (!_include(RESERVED_PROPERTIES, k)) {\n                p[k] = v\n            }\n        })\n        return p\n    }\n\n    load(): void {\n        if (this.disabled) {\n            return\n        }\n\n        const entry = this.storage.parse(this.name)\n\n        if (entry) {\n            this.props = _extend({}, entry)\n        }\n    }\n\n    /**\n     * NOTE: Saving frequently causes issues with Recordings and Consent Management Platform (CMP) tools which\n     * observe cookie changes, and modify their UI, often causing infinite loops.\n     * As such callers of this should ideally check that the data has changed beforehand\n     */\n    save(): void {\n        if (this.disabled) {\n            return\n        }\n        this.storage.set(this.name, this.props, this.expire_days, this.cross_subdomain, this.secure)\n    }\n\n    remove(): void {\n        // remove both domain and subdomain cookies\n        this.storage.remove(this.name, false)\n        this.storage.remove(this.name, true)\n    }\n\n    // removes the storage entry and deletes all loaded data\n    // forced name for tests\n\n    clear(): void {\n        this.remove()\n        this.props = {}\n    }\n\n    /**\n     * @param {Object} props\n     * @param {*=} default_value\n     * @param {number=} days\n     */\n\n    register_once(props: Properties, default_value: any, days?: number): boolean {\n        if (_isObject(props)) {\n            if (typeof default_value === 'undefined') {\n                default_value = 'None'\n            }\n            this.expire_days = typeof days === 'undefined' ? this.default_expiry : days\n\n            let hasChanges = false\n\n            _each(props, (val, prop) => {\n                if (!this.props.hasOwnProperty(prop) || this.props[prop] === default_value) {\n                    this.props[prop] = val\n                    hasChanges = true\n                }\n            })\n\n            if (hasChanges) {\n                this.save()\n                return true\n            }\n        }\n        return false\n    }\n\n    /**\n     * @param {Object} props\n     * @param {number=} days\n     */\n\n    register(props: Properties, days?: number): boolean {\n        if (_isObject(props)) {\n            this.expire_days = typeof days === 'undefined' ? this.default_expiry : days\n\n            let hasChanges = false\n\n            _each(props, (val, prop) => {\n                if (props.hasOwnProperty(prop) && this.props[prop] !== val) {\n                    this.props[prop] = val\n                    hasChanges = true\n                }\n            })\n\n            if (hasChanges) {\n                this.save()\n                return true\n            }\n        }\n        return false\n    }\n\n    unregister(prop: string): void {\n        if (prop in this.props) {\n            delete this.props[prop]\n            this.save()\n        }\n    }\n\n    update_campaign_params(): void {\n        if (!this.campaign_params_saved) {\n            this.register(_info.campaignParams(this.custom_campaign_params))\n            this.campaign_params_saved = true\n        }\n    }\n\n    update_search_keyword(): void {\n        this.register(_info.searchInfo())\n    }\n\n    update_referrer_info(): void {\n        this.register({\n            $referrer: this.props['$referrer'] || _info.referrer(),\n            $referring_domain: this.props['$referring_domain'] || _info.referringDomain(),\n        })\n    }\n\n    get_referrer_info(): Properties {\n        return _strip_empty_properties({\n            $referrer: this['props']['$referrer'],\n            $referring_domain: this['props']['$referring_domain'],\n        })\n    }\n\n    // safely fills the passed in object with stored properties,\n    // does not override any properties defined in both\n    // returns the passed in object\n\n    safe_merge(props: Properties): Properties {\n        _each(this.props, function (val, prop) {\n            if (!(prop in props)) {\n                props[prop] = val\n            }\n        })\n\n        return props\n    }\n\n    update_config(config: PostHogConfig): void {\n        this.default_expiry = this.expire_days = config['cookie_expiration']\n        this.set_disabled(config['disable_persistence'])\n        this.set_cross_subdomain(config['cross_subdomain_cookie'])\n        this.set_secure(config['secure_cookie'])\n    }\n\n    set_disabled(disabled: boolean): void {\n        this.disabled = disabled\n        if (this.disabled) {\n            this.remove()\n        } else {\n            this.save()\n        }\n    }\n\n    set_cross_subdomain(cross_subdomain: boolean): void {\n        if (cross_subdomain !== this.cross_subdomain) {\n            this.cross_subdomain = cross_subdomain\n            this.remove()\n            this.save()\n        }\n    }\n\n    get_cross_subdomain(): boolean {\n        return !!this.cross_subdomain\n    }\n\n    set_secure(secure: boolean): void {\n        if (secure !== this.secure) {\n            this.secure = secure\n            this.remove()\n            this.save()\n        }\n    }\n\n    set_event_timer(event_name: string, timestamp: number): void {\n        const timers = this.props[EVENT_TIMERS_KEY] || {}\n        timers[event_name] = timestamp\n        this.props[EVENT_TIMERS_KEY] = timers\n        this.save()\n    }\n\n    remove_event_timer(event_name: string): number {\n        const timers = this.props[EVENT_TIMERS_KEY] || {}\n        const timestamp = timers[event_name]\n        if (!_isUndefined(timestamp)) {\n            delete this.props[EVENT_TIMERS_KEY][event_name]\n            this.save()\n        }\n        return timestamp\n    }\n\n    get_user_state(): 'anonymous' | 'identified' {\n        return this.props[USER_STATE] || 'anonymous'\n    }\n\n    set_user_state(state: 'anonymous' | 'identified'): void {\n        this.props[USER_STATE] = state\n        this.save()\n    }\n}\n","import {\n    _bind_instance_methods,\n    _each,\n    _extend,\n    _includes,\n    _isFunction,\n    _isUndefined,\n    _register_event,\n    _safewrap_instance_methods,\n    logger,\n} from './utils'\nimport {\n    getClassName,\n    getSafeText,\n    isElementNode,\n    isSensitiveElement,\n    isTag,\n    isTextNode,\n    shouldCaptureDomEvent,\n    shouldCaptureElement,\n    shouldCaptureValue,\n    autocaptureCompatibleElements,\n    isAngularStyleAttr,\n    isDocumentFragment,\n    getDirectAndNestedSpanText,\n} from './autocapture-utils'\nimport RageClick from './extensions/rageclick'\nimport { AutocaptureConfig, AutoCaptureCustomProperty, DecideResponse, Properties } from './types'\nimport { PostHog } from './posthog-core'\nimport { AUTOCAPTURE_DISABLED_SERVER_SIDE } from './posthog-persistence'\n\nconst autocapture = {\n    _initializedTokens: [] as string[],\n\n    _isAutocaptureEnabled: false as boolean,\n\n    _setIsAutocaptureEnabled: function (instance: PostHog): void {\n        const disabled_server_side = !!instance.get_property(AUTOCAPTURE_DISABLED_SERVER_SIDE)\n        const enabled_client_side = !!instance.get_config('autocapture')\n        this._isAutocaptureEnabled = enabled_client_side && !disabled_server_side\n    },\n\n    _previousElementSibling: function (el: Element): Element | null {\n        if (el.previousElementSibling) {\n            return el.previousElementSibling\n        } else {\n            let _el: Element | null = el\n            do {\n                _el = _el.previousSibling as Element | null // resolves to ChildNode->Node, which is Element's parent class\n            } while (_el && !isElementNode(_el))\n            return _el\n        }\n    },\n\n    _getAugmentPropertiesFromElement: function (elem: Element): Properties {\n        const shouldCaptureEl = shouldCaptureElement(elem)\n        if (!shouldCaptureEl) {\n            return {}\n        }\n\n        const props: Properties = {}\n\n        _each(elem.attributes, function (attr: Attr) {\n            if (attr.name.indexOf('data-ph-capture-attribute') === 0) {\n                const propertyKey = attr.name.replace('data-ph-capture-attribute-', '')\n                const propertyValue = attr.value\n                if (propertyKey && propertyValue && shouldCaptureValue(propertyValue)) {\n                    props[propertyKey] = propertyValue\n                }\n            }\n        })\n        return props\n    },\n\n    _getPropertiesFromElement: function (elem: Element, maskInputs: boolean, maskText: boolean): Properties {\n        const tag_name = elem.tagName.toLowerCase()\n        const props: Properties = {\n            tag_name: tag_name,\n        }\n        if (autocaptureCompatibleElements.indexOf(tag_name) > -1 && !maskText) {\n            if (tag_name.toLowerCase() === 'a' || tag_name.toLowerCase() === 'button') {\n                props['$el_text'] = getDirectAndNestedSpanText(elem)\n            } else {\n                props['$el_text'] = getSafeText(elem)\n            }\n        }\n\n        const classes = getClassName(elem)\n        if (classes.length > 0)\n            props['classes'] = classes.split(' ').filter(function (c) {\n                return c !== ''\n            })\n\n        _each(elem.attributes, function (attr: Attr) {\n            // Only capture attributes we know are safe\n            if (isSensitiveElement(elem) && ['name', 'id', 'class'].indexOf(attr.name) === -1) return\n\n            if (!maskInputs && shouldCaptureValue(attr.value) && !isAngularStyleAttr(attr.name)) {\n                props['attr__' + attr.name] = attr.value\n            }\n        })\n\n        let nthChild = 1\n        let nthOfType = 1\n        let currentElem: Element | null = elem\n        while ((currentElem = this._previousElementSibling(currentElem))) {\n            // eslint-disable-line no-cond-assign\n            nthChild++\n            if (currentElem.tagName === elem.tagName) {\n                nthOfType++\n            }\n        }\n        props['nth_child'] = nthChild\n        props['nth_of_type'] = nthOfType\n\n        return props\n    },\n\n    _getDefaultProperties: function (eventType: string): Properties {\n        return {\n            $event_type: eventType,\n            $ce_version: 1,\n        }\n    },\n\n    _extractCustomPropertyValue: function (customProperty: AutoCaptureCustomProperty): string {\n        const propValues: string[] = []\n        _each(document.querySelectorAll(customProperty['css_selector']), function (matchedElem) {\n            let value\n\n            if (['input', 'select'].indexOf(matchedElem.tagName.toLowerCase()) > -1) {\n                value = matchedElem['value']\n            } else if (matchedElem['textContent']) {\n                value = matchedElem['textContent']\n            }\n\n            if (shouldCaptureValue(value)) {\n                propValues.push(value)\n            }\n        })\n        return propValues.join(', ')\n    },\n\n    // TODO: delete custom_properties after changeless typescript refactor\n    _getCustomProperties: function (targetElementList: Element[]): Properties {\n        const props: Properties = {} // will be deleted\n        _each(this._customProperties, (customProperty) => {\n            _each(customProperty['event_selectors'], (eventSelector) => {\n                const eventElements = document.querySelectorAll(eventSelector)\n                _each(eventElements, (eventElement) => {\n                    if (_includes(targetElementList, eventElement) && shouldCaptureElement(eventElement)) {\n                        props[customProperty['name']] = this._extractCustomPropertyValue(customProperty)\n                    }\n                })\n            })\n        })\n        return props\n    },\n\n    _getEventTarget: function (e: Event): Element | null {\n        // https://developer.mozilla.org/en-US/docs/Web/API/Event/target#Compatibility_notes\n        if (typeof e.target === 'undefined') {\n            return (e.srcElement as Element) || null\n        } else {\n            if ((e.target as HTMLElement)?.shadowRoot) {\n                return (e.composedPath()[0] as Element) || null\n            }\n            return (e.target as Element) || null\n        }\n    },\n\n    _captureEvent: function (e: Event, instance: PostHog, eventName = '$autocapture'): boolean | void {\n        /*** Don't mess with this code without running IE8 tests on it ***/\n        let target = this._getEventTarget(e)\n        if (isTextNode(target)) {\n            // defeat Safari bug (see: http://www.quirksmode.org/js/events_properties.html)\n            target = (target.parentNode || null) as Element | null\n        }\n\n        if (eventName === '$autocapture' && e.type === 'click' && e instanceof MouseEvent) {\n            if (this.rageclicks?.isRageClick(e.clientX, e.clientY, new Date().getTime())) {\n                this._captureEvent(e, instance, '$rageclick')\n            }\n        }\n\n        if (target && shouldCaptureDomEvent(target, e, this.config)) {\n            const targetElementList = [target]\n            let curEl = target\n            while (curEl.parentNode && !isTag(curEl, 'body')) {\n                if (isDocumentFragment(curEl.parentNode)) {\n                    targetElementList.push((curEl.parentNode as any).host)\n                    curEl = (curEl.parentNode as any).host\n                    continue\n                }\n                targetElementList.push(curEl.parentNode as Element)\n                curEl = curEl.parentNode as Element\n            }\n\n            const elementsJson: Properties[] = []\n            const autocaptureAugmentProperties: Properties = {}\n            let href,\n                explicitNoCapture = false\n            _each(targetElementList, (el) => {\n                const shouldCaptureEl = shouldCaptureElement(el)\n\n                // if the element or a parent element is an anchor tag\n                // include the href as a property\n                if (el.tagName.toLowerCase() === 'a') {\n                    href = el.getAttribute('href')\n                    href = shouldCaptureEl && shouldCaptureValue(href) && href\n                }\n\n                // allow users to programmatically prevent capturing of elements by adding class 'ph-no-capture'\n                const classes = getClassName(el).split(' ')\n                if (_includes(classes, 'ph-no-capture')) {\n                    explicitNoCapture = true\n                }\n\n                elementsJson.push(\n                    this._getPropertiesFromElement(\n                        el,\n                        instance.get_config('mask_all_element_attributes'),\n                        instance.get_config('mask_all_text')\n                    )\n                )\n\n                const augmentProperties = this._getAugmentPropertiesFromElement(el)\n                _extend(autocaptureAugmentProperties, augmentProperties)\n            })\n\n            if (!instance.get_config('mask_all_text')) {\n                // if the element is a button or anchor tag get the span text from any\n                // children and include it as/with the text property on the parent element\n                if (target.tagName.toLowerCase() === 'a' || target.tagName.toLowerCase() === 'button') {\n                    elementsJson[0]['$el_text'] = getDirectAndNestedSpanText(target)\n                } else {\n                    elementsJson[0]['$el_text'] = getSafeText(target)\n                }\n            }\n\n            if (href) {\n                elementsJson[0]['attr__href'] = href\n            }\n\n            if (explicitNoCapture) {\n                return false\n            }\n\n            const props = _extend(\n                this._getDefaultProperties(e.type),\n                {\n                    $elements: elementsJson,\n                },\n                this._getCustomProperties(targetElementList),\n                autocaptureAugmentProperties\n            )\n\n            instance.capture(eventName, props)\n            return true\n        }\n    },\n\n    // only reason is to stub for unit tests\n    // since you can't override window.location props\n    _navigate: function (href: string): void {\n        window.location.href = href\n    },\n\n    _addDomEventHandlers: function (instance: PostHog): void {\n        const handler = (e: Event) => {\n            e = e || window.event\n            this._captureEvent(e, instance)\n        }\n        _register_event(document, 'submit', handler, false, true)\n        _register_event(document, 'change', handler, false, true)\n        _register_event(document, 'click', handler, false, true)\n    },\n\n    _customProperties: [] as AutoCaptureCustomProperty[],\n    rageclicks: null as RageClick | null,\n    config: undefined as AutocaptureConfig | undefined,\n\n    init: function (instance: PostHog): void {\n        if (typeof instance.__autocapture !== 'boolean') {\n            this.config = instance.__autocapture\n        }\n\n        // precompile the regex\n        if (this.config?.url_allowlist) {\n            this.config.url_allowlist = this.config.url_allowlist.map((url) => new RegExp(url))\n        }\n\n        this.rageclicks = new RageClick(instance.get_config('rageclick'))\n    },\n\n    afterDecideResponse: function (response: DecideResponse, instance: PostHog): void {\n        this._setIsAutocaptureEnabled(instance)\n        const token = instance.get_config('token')\n        if (this._initializedTokens.indexOf(token) > -1) {\n            logger.log('autocapture already initialized for token \"' + token + '\"')\n            return\n        }\n\n        if (instance.persistence) {\n            instance.persistence.register({\n                [AUTOCAPTURE_DISABLED_SERVER_SIDE]: !!response['autocapture_opt_out'],\n            })\n        }\n\n        this._initializedTokens.push(token)\n\n        if (\n            response &&\n            response['config'] &&\n            response['config']['enable_collect_everything'] &&\n            this._isAutocaptureEnabled\n        ) {\n            // TODO: delete custom_properties after changeless typescript refactor\n            if (response['custom_properties']) {\n                this._customProperties = response['custom_properties']\n            }\n            this._addDomEventHandlers(instance)\n        } else {\n            instance['__autocapture'] = false\n        }\n    },\n\n    // this is a mechanism to ramp up CE with no server-side interaction.\n    // when CE is active, every page load results in a decide request. we\n    // need to gently ramp this up so we don't overload decide. this decides\n    // deterministically if CE is enabled for this project by modding the char\n    // value of the project token.\n    enabledForProject: function (\n        token: string | null | undefined,\n        numBuckets: number,\n        numEnabledBuckets: number\n    ): boolean {\n        if (!token) {\n            return true\n        }\n        numBuckets = !_isUndefined(numBuckets) ? numBuckets : 10\n        numEnabledBuckets = !_isUndefined(numEnabledBuckets) ? numEnabledBuckets : 10\n        let charCodeSum = 0\n        for (let i = 0; i < token.length; i++) {\n            charCodeSum += token.charCodeAt(i)\n        }\n        return charCodeSum % numBuckets < numEnabledBuckets\n    },\n\n    isBrowserSupported: function (): boolean {\n        return _isFunction(document.querySelectorAll)\n    },\n}\n\n_bind_instance_methods(autocapture)\n_safewrap_instance_methods(autocapture)\n\nexport { autocapture }\n","/**\n * GDPR utils\n *\n * The General Data Protection Regulation (GDPR) is a regulation in EU law on data protection\n * and privacy for all individuals within the European Union. It addresses the export of personal\n * data outside the EU. The GDPR aims primarily to give control back to citizens and residents\n * over their personal data and to simplify the regulatory environment for international business\n * by unifying the regulation within the EU.\n *\n * This set of utilities is intended to enable opt in/out functionality in the PostHog JS SDK.\n * These functions are used internally by the SDK and are not intended to be publicly exposed.\n */\n\nimport { _each, _includes, _isNumber, _isString, window } from './utils'\nimport { cookieStore, localStore, localPlusCookieStore } from './storage'\nimport { GDPROptions, PersistentStore } from './types'\nimport { PostHog } from './posthog-core'\n\n/**\n * A function used to capture a PostHog event (e.g. PostHogLib.capture)\n * @callback captureFunction\n * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n * @param {Function} [callback] If provided, the callback function will be called after capturing the event.\n */\n\n/** Public **/\n\nconst GDPR_DEFAULT_PERSISTENCE_PREFIX = '__ph_opt_in_out_'\n\n/**\n * Opt the user in to data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {captureFunction} [options.capture] - function used for capturing a PostHog event to record the opt-in action\n * @param {string} [options.captureEventName] - event name to be used for capturing the opt-in action\n * @param {Object} [options.captureProperties] - set of properties to be captured along with the opt-in action\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nexport function optIn(token: string, options: GDPROptions): void {\n    _optInOut(true, token, options)\n}\n\n/**\n * Opt the user out of data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-out cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-out cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-out cookie is set as secure or not\n */\nexport function optOut(token: string, options: GDPROptions): void {\n    _optInOut(false, token, options)\n}\n\n/**\n * Check whether the user has opted in to data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} whether the user has opted in to the given opt type\n */\nexport function hasOptedIn(token: string, options: GDPROptions): boolean {\n    return _getStorageValue(token, options) === '1'\n}\n\n/**\n * Check whether the user has opted out of data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {boolean} [options.respectDnt] - flag to take browser DNT setting into account\n * @returns {boolean} whether the user has opted out of the given opt type\n */\nexport function hasOptedOut(token: string, options: Partial<GDPROptions>): boolean {\n    if (_hasDoNotTrackFlagOn(options)) {\n        return true\n    }\n    return _getStorageValue(token, options) === '0'\n}\n\n/**\n * Clear the user's opt in/out status of data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nexport function clearOptInOut(token: string, options: GDPROptions) {\n    options = options || {}\n    _getStorage(options).remove(_getStorageKey(token, options), !!options.crossSubdomainCookie)\n}\n\n/** Private **/\n\n/**\n * Get storage util\n * @param {Object} [options]\n * @param {string} [options.persistenceType]\n * @returns {object} either cookieStore or localStore\n */\nfunction _getStorage(options: GDPROptions): PersistentStore {\n    options = options || {}\n    if (options.persistenceType === 'localStorage') {\n        return localStore\n    }\n    if (options.persistenceType === 'localStorage+cookie') {\n        return localPlusCookieStore\n    }\n    return cookieStore\n}\n\n/**\n * Get the name of the cookie that is used for the given opt type (capturing, cookie, etc.)\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the name of the cookie for the given opt type\n */\nfunction _getStorageKey(token: string, options: GDPROptions) {\n    options = options || {}\n    return (options.persistencePrefix || GDPR_DEFAULT_PERSISTENCE_PREFIX) + token\n}\n\n/**\n * Get the value of the cookie that is used for the given opt type (capturing, cookie, etc.)\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the value of the cookie for the given opt type\n */\nfunction _getStorageValue(token: string, options: GDPROptions) {\n    return _getStorage(options).get(_getStorageKey(token, options))\n}\n\n/**\n * Check whether the user has set the DNT/doNotTrack setting to true in their browser\n * @param {Object} [options]\n * @param {string} [options.window] - alternate window object to check; used to force various DNT settings in browser tests\n * @param {boolean} [options.respectDnt] - flag to take browser DNT setting into account\n * @returns {boolean} whether the DNT setting is true\n */\nfunction _hasDoNotTrackFlagOn(options: GDPROptions) {\n    if (options && options.respectDnt) {\n        const win = (options && options.window) || window\n        const nav = win['navigator'] || {}\n        let hasDntOn = false\n        _each(\n            [\n                nav['doNotTrack'], // standard\n                (nav as any)['msDoNotTrack'],\n                (win as any)['doNotTrack'],\n            ],\n            function (dntValue) {\n                if (_includes([true, 1, '1', 'yes'], dntValue)) {\n                    hasDntOn = true\n                }\n            }\n        )\n        return hasDntOn\n    }\n    return false\n}\n\n/**\n * Set cookie/localstorage for the user indicating that they are opted in or out for the given opt type\n * @param {boolean} optValue - whether to opt the user in or out for the given opt type\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {captureFunction} [options.capture] - function used for capturing a PostHog event to record the opt-in action\n * @param {string} [options.captureEventName] - event name to be used for capturing the opt-in action\n * @param {Object} [options.captureProperties] - set of properties to be captured along with the opt-in action\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nfunction _optInOut(optValue: boolean, token: string, options: GDPROptions) {\n    if (!_isString(token) || !token.length) {\n        console.error('gdpr.' + (optValue ? 'optIn' : 'optOut') + ' called with an invalid token')\n        return\n    }\n\n    options = options || {}\n\n    _getStorage(options).set(\n        _getStorageKey(token, options),\n        optValue ? 1 : 0,\n        _isNumber(options.cookieExpiration) ? options.cookieExpiration : null,\n        options.crossSubdomainCookie,\n        options.secureCookie\n    )\n\n    if (options.capture && optValue) {\n        // only capture event if opting in (optValue=true)\n        options.capture(options.captureEventName || '$opt_in', options.captureProperties || {}, {\n            send_instantly: true,\n        })\n    }\n}\n\nexport function userOptedOut(posthog: PostHog, silenceErrors: boolean | undefined) {\n    let optedOut = false\n\n    try {\n        const token = posthog.get_config('token')\n        const respectDnt = posthog.get_config('respect_dnt')\n        const persistenceType = posthog.get_config('opt_out_capturing_persistence_type')\n        const persistencePrefix = posthog.get_config('opt_out_capturing_cookie_prefix') || undefined\n        const win = posthog.get_config('window' as any) as Window | undefined // used to override window during browser tests\n\n        if (token) {\n            // if there was an issue getting the token, continue method execution as normal\n            optedOut = hasOptedOut(token, {\n                respectDnt,\n                persistenceType,\n                persistencePrefix,\n                window: win,\n            })\n        }\n    } catch (err) {\n        if (!silenceErrors) {\n            console.error('Unexpected error when checking capturing opt-out status: ' + err)\n        }\n    }\n    return optedOut\n}\n\n/**\n * Wrap a method with a check for whether the user is opted out of data capturing and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {PostHog} posthog - the posthog instance\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @param silenceErrors\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\nexport function addOptOutCheck<M extends (...args: any[]) => any = (...args: any[]) => any>(\n    posthog: PostHog,\n    method: M,\n    silenceErrors?: boolean\n): M {\n    return function (...args) {\n        const optedOut = userOptedOut(posthog, silenceErrors)\n\n        if (!optedOut) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return method.apply(this, args)\n        }\n\n        const callback = args[args.length - 1]\n        if (typeof callback === 'function') {\n            callback(0)\n        }\n\n        return\n    } as M\n}\n","/* eslint camelcase: \"off\" */\nimport { addOptOutCheck } from './gdpr-utils'\nimport { _base64Encode, _copyAndTruncateStrings, _each, _encodeDates, _extend, _info, _isObject } from './utils'\nimport { PostHogConfig, Properties, RequestCallback } from './types'\nimport { PostHog } from './posthog-core'\n\nconst SET_ACTION = '$set'\nconst SET_ONCE_ACTION = '$set_once'\n\n/**\n * PostHog People Object\n * @constructor\n */\nclass PostHogPeople {\n    _posthog: PostHog\n\n    set: (prop: string | Properties, to?: string, callback?: RequestCallback) => void\n    set_once: (prop: string | Properties, to?: string, callback?: RequestCallback) => void\n\n    constructor(posthog: PostHog) {\n        this._posthog = posthog\n\n        /*\n         * Set properties on a user record.\n         *\n         * ### Usage:\n         *\n         *     posthog.people.set('gender', 'm');\n         *\n         *     // or set multiple properties at once\n         *     posthog.people.set({\n         *         'Company': 'Acme',\n         *         'Plan': 'Premium',\n         *         'Upgrade date': new Date()\n         *     });\n         *     // properties can be strings, integers, dates, or lists\n         *\n         * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n         * @param {*} [to] A value to set on the given property name\n         * @param {Function} [callback] If provided, the callback will be called after capturing the event.\n         */\n        this.set = addOptOutCheck(posthog, (prop: string | Properties, to?: string, callback?: RequestCallback) => {\n            const data = this.set_action(prop, to)\n\n            // Update current user properties\n            this._posthog.setPersonPropertiesForFlags(data['$set'] || {})\n\n            if (_isObject(prop)) {\n                callback = to as any\n            }\n            // make sure that the referrer info has been updated and saved\n            if (this._get_config('save_referrer')) {\n                this._posthog.sessionPersistence.update_referrer_info()\n            }\n\n            // update $set object with default people properties\n            data[SET_ACTION] = _extend(\n                {},\n                _info.people_properties(),\n                this._posthog.sessionPersistence.get_referrer_info(),\n                data[SET_ACTION]\n            )\n            return this._send_request(data, callback)\n        })\n\n        /*\n         * Set properties on a user record, only if they do not yet exist.\n         * This will not overwrite previous people property values, unlike\n         * people.set().\n         *\n         * ### Usage:\n         *\n         *     posthog.people.set_once('First Login Date', new Date());\n         *\n         *     // or set multiple properties at once\n         *     posthog.people.set_once({\n         *         'First Login Date': new Date(),\n         *         'Starting Plan': 'Premium'\n         *     });\n         *\n         *     // properties can be strings, integers or dates\n         *\n         * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n         * @param {*} [to] A value to set on the given property name\n         * @param {Function} [callback] If provided, the callback will be called after capturing the event.\n         */\n        this.set_once = addOptOutCheck(\n            posthog,\n            (prop: string | Properties, to?: string, callback?: RequestCallback) => {\n                const data = this.set_once_action(prop, to)\n                if (_isObject(prop)) {\n                    callback = to as any\n                }\n                return this._send_request(data, callback)\n            }\n        )\n    }\n\n    toString(): string {\n        return this._posthog.toString() + '.people'\n    }\n\n    _send_request(data: Properties, callback?: RequestCallback): Properties {\n        data['$token'] = this._get_config('token')\n        data['$distinct_id'] = this._posthog.get_distinct_id()\n        const device_id = this._posthog.get_property('$device_id')\n        const user_id = this._posthog.get_property('$user_id')\n        const had_persisted_distinct_id = this._posthog.get_property('$had_persisted_distinct_id')\n        if (device_id) {\n            data['$device_id'] = device_id\n        }\n        if (user_id) {\n            data['$user_id'] = user_id\n        }\n        if (had_persisted_distinct_id) {\n            data['$had_persisted_distinct_id'] = had_persisted_distinct_id\n        }\n\n        const date_encoded_data = _encodeDates(data)\n        const truncated_data = _copyAndTruncateStrings(\n            date_encoded_data,\n            this._get_config('properties_string_max_length')\n        )\n        const json_data = JSON.stringify(date_encoded_data)\n        const encoded_data = _base64Encode(json_data)\n\n        this._posthog._send_request(\n            this._get_config('api_host') + '/engage/',\n            { data: encoded_data },\n            {},\n            this._posthog._prepare_callback(callback, truncated_data) as RequestCallback\n        )\n\n        return truncated_data\n    }\n\n    _get_config<K extends keyof PostHogConfig>(conf_var: K): PostHogConfig[K] {\n        return this._posthog.get_config(conf_var)\n    }\n\n    _is_reserved_property(prop: string): boolean {\n        return (\n            prop === '$distinct_id' ||\n            prop === '$token' ||\n            prop === '$device_id' ||\n            prop === '$user_id' ||\n            prop === '$had_persisted_distinct_id'\n        )\n    }\n\n    // Internal methods for posthog.people API.\n    // These methods shouldn't involve network I/O.\n    private set_action(prop: string | Properties, to?: string): Properties {\n        return this.apiActionParser(SET_ACTION, prop, to)\n    }\n\n    private set_once_action(prop: string | Properties, to?: string): Properties {\n        return this.apiActionParser(SET_ONCE_ACTION, prop, to)\n    }\n\n    private apiActionParser(actionType: '$set' | '$set_once', prop: string | Properties, to?: string): Properties {\n        const data: Properties = {}\n        const props: Properties = {}\n\n        if (_isObject(prop)) {\n            _each(prop, (v, k: string) => {\n                if (!(this as any)._is_reserved_property(k)) {\n                    props[k] = v\n                }\n            })\n        } else {\n            props[prop] = to\n        }\n\n        data[actionType] = props\n        return data\n    }\n}\n\nexport { PostHogPeople }\n","import { _base64Encode, _entries, _extend } from './utils'\nimport { PostHog } from './posthog-core'\nimport {\n    DecideResponse,\n    FeatureFlagsCallback,\n    EarlyAccessFeatureCallback,\n    EarlyAccessFeatureResponse,\n    Properties,\n    JsonType,\n    RequestCallback,\n} from './types'\nimport {\n    PERSISTENCE_EARLY_ACCESS_FEATURES,\n    PostHogPersistence,\n    ENABLED_FEATURE_FLAGS,\n    STORED_GROUP_PROPERTIES_KEY,\n    STORED_PERSON_PROPERTIES_KEY,\n    FLAG_CALL_REPORTED,\n} from './posthog-persistence'\n\nconst PERSISTENCE_ACTIVE_FEATURE_FLAGS = '$active_feature_flags'\nconst PERSISTENCE_OVERRIDE_FEATURE_FLAGS = '$override_feature_flags'\nconst PERSISTENCE_FEATURE_FLAG_PAYLOADS = '$feature_flag_payloads'\n\nexport const filterActiveFeatureFlags = (featureFlags?: Record<string, string | boolean>) => {\n    const activeFeatureFlags: Record<string, string | boolean> = {}\n    for (const [key, value] of _entries(featureFlags || {})) {\n        if (value) {\n            activeFeatureFlags[key] = value\n        }\n    }\n    return activeFeatureFlags\n}\n\nexport const parseFeatureFlagDecideResponse = (\n    response: Partial<DecideResponse>,\n    persistence: PostHogPersistence,\n    currentFlags: Record<string, string | boolean> = {},\n    currentFlagPayloads: Record<string, JsonType> = {}\n) => {\n    const flags = response['featureFlags']\n    const flagPayloads = response['featureFlagPayloads']\n    if (flags) {\n        // using the v1 api\n        if (Array.isArray(flags)) {\n            const $enabled_feature_flags: Record<string, boolean> = {}\n            if (flags) {\n                for (let i = 0; i < flags.length; i++) {\n                    $enabled_feature_flags[flags[i]] = true\n                }\n            }\n            persistence &&\n                persistence.register({\n                    [PERSISTENCE_ACTIVE_FEATURE_FLAGS]: flags,\n                    [ENABLED_FEATURE_FLAGS]: $enabled_feature_flags,\n                })\n        } else {\n            // using the v2+ api\n            let newFeatureFlags = flags\n            let newFeatureFlagPayloads = flagPayloads\n            if (response.errorsWhileComputingFlags) {\n                // if not all flags were computed, we upsert flags instead of replacing them\n                newFeatureFlags = { ...currentFlags, ...newFeatureFlags }\n                newFeatureFlagPayloads = { ...currentFlagPayloads, ...newFeatureFlagPayloads }\n            }\n            persistence &&\n                persistence.register({\n                    [PERSISTENCE_ACTIVE_FEATURE_FLAGS]: Object.keys(filterActiveFeatureFlags(newFeatureFlags)),\n                    [ENABLED_FEATURE_FLAGS]: newFeatureFlags || {},\n                    [PERSISTENCE_FEATURE_FLAG_PAYLOADS]: newFeatureFlagPayloads || {},\n                })\n        }\n    }\n}\n\nexport class PostHogFeatureFlags {\n    instance: PostHog\n    _override_warning: boolean\n    featureFlagEventHandlers: FeatureFlagsCallback[]\n    reloadFeatureFlagsQueued: boolean\n    reloadFeatureFlagsInAction: boolean\n    $anon_distinct_id: string | undefined\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n        this._override_warning = false\n        this.featureFlagEventHandlers = []\n\n        this.reloadFeatureFlagsQueued = false\n        this.reloadFeatureFlagsInAction = false\n    }\n\n    getFlags(): string[] {\n        return Object.keys(this.getFlagVariants())\n    }\n\n    getFlagVariants(): Record<string, string | boolean> {\n        const enabledFlags = this.instance.get_property(ENABLED_FEATURE_FLAGS)\n        const overriddenFlags = this.instance.get_property(PERSISTENCE_OVERRIDE_FEATURE_FLAGS)\n        if (!overriddenFlags) {\n            return enabledFlags || {}\n        }\n\n        const finalFlags = _extend({}, enabledFlags)\n        const overriddenKeys = Object.keys(overriddenFlags)\n        for (let i = 0; i < overriddenKeys.length; i++) {\n            if (overriddenFlags[overriddenKeys[i]] === false) {\n                delete finalFlags[overriddenKeys[i]]\n            } else {\n                finalFlags[overriddenKeys[i]] = overriddenFlags[overriddenKeys[i]]\n            }\n        }\n        if (!this._override_warning) {\n            console.warn('[PostHog] Overriding feature flags!', {\n                enabledFlags,\n                overriddenFlags,\n                finalFlags,\n            })\n            this._override_warning = true\n        }\n        return finalFlags\n    }\n\n    getFlagPayloads(): Record<string, JsonType> {\n        const flagPayloads = this.instance.get_property(PERSISTENCE_FEATURE_FLAG_PAYLOADS)\n        return flagPayloads || {}\n    }\n\n    /**\n     * Reloads feature flags asynchronously.\n     *\n     * Constraints:\n     *\n     * 1. Avoid parallel requests\n     * 2. Delay a few milliseconds after each reloadFeatureFlags call to batch subsequent changes together\n     * 3. Don't call this during initial load (as /decide will be called instead), see posthog-core.js\n     */\n    reloadFeatureFlags(): void {\n        if (!this.reloadFeatureFlagsQueued) {\n            this.reloadFeatureFlagsQueued = true\n            this._startReloadTimer()\n        }\n    }\n\n    setAnonymousDistinctId(anon_distinct_id: string): void {\n        this.$anon_distinct_id = anon_distinct_id\n    }\n\n    setReloadingPaused(isPaused: boolean): void {\n        this.reloadFeatureFlagsInAction = isPaused\n    }\n\n    resetRequestQueue(): void {\n        this.reloadFeatureFlagsQueued = false\n    }\n\n    _startReloadTimer(): void {\n        if (this.reloadFeatureFlagsQueued && !this.reloadFeatureFlagsInAction) {\n            setTimeout(() => {\n                if (!this.reloadFeatureFlagsInAction && this.reloadFeatureFlagsQueued) {\n                    this.reloadFeatureFlagsQueued = false\n                    this._reloadFeatureFlagsRequest()\n                }\n            }, 5)\n        }\n    }\n\n    _reloadFeatureFlagsRequest(): void {\n        this.setReloadingPaused(true)\n        const token = this.instance.get_config('token')\n        const personProperties = this.instance.get_property(STORED_PERSON_PROPERTIES_KEY)\n        const groupProperties = this.instance.get_property(STORED_GROUP_PROPERTIES_KEY)\n        const json_data = JSON.stringify({\n            token: token,\n            distinct_id: this.instance.get_distinct_id(),\n            groups: this.instance.getGroups(),\n            $anon_distinct_id: this.$anon_distinct_id,\n            person_properties: personProperties,\n            group_properties: groupProperties,\n        })\n\n        const encoded_data = _base64Encode(json_data)\n        this.instance._send_request(\n            this.instance.get_config('api_host') + '/decide/?v=3',\n            { data: encoded_data },\n            { method: 'POST' },\n            this.instance._prepare_callback((response) => {\n                // reset anon_distinct_id after at least a single request with it\n                // makes it through\n                this.$anon_distinct_id = undefined\n                this.receivedFeatureFlags(response as DecideResponse)\n\n                // :TRICKY: Reload - start another request if queued!\n                this.setReloadingPaused(false)\n                this._startReloadTimer()\n            }) as RequestCallback\n        )\n    }\n\n    /*\n     * Get feature flag's value for user.\n     *\n     * ### Usage:\n     *\n     *     if(posthog.getFeatureFlag('my-flag') === 'some-variant') { // do something }\n     *\n     * @param {Object|String} key Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    getFeatureFlag(key: string, options: { send_event?: boolean } = {}): boolean | string | undefined {\n        if (!this.getFlags() || this.getFlags().length === 0) {\n            console.warn('getFeatureFlag for key \"' + key + '\" failed. Feature flags didn\\'t load in time.')\n            return undefined\n        }\n        const flagValue = this.getFlagVariants()[key]\n        const flagReportValue = `${flagValue}`\n        const flagCallReported: Record<string, string[]> = this.instance.get_property(FLAG_CALL_REPORTED) || {}\n\n        if (options.send_event || !('send_event' in options)) {\n            if (!(key in flagCallReported) || !flagCallReported[key].includes(flagReportValue)) {\n                if (Array.isArray(flagCallReported[key])) {\n                    flagCallReported[key].push(flagReportValue)\n                } else {\n                    flagCallReported[key] = [flagReportValue]\n                }\n                this.instance.persistence.register({ [FLAG_CALL_REPORTED]: flagCallReported })\n\n                this.instance.capture('$feature_flag_called', { $feature_flag: key, $feature_flag_response: flagValue })\n            }\n        }\n        return flagValue\n    }\n\n    getFeatureFlagPayload(key: string): JsonType {\n        const payloads = this.getFlagPayloads()\n        return payloads[key]\n    }\n\n    /*\n     * See if feature flag is enabled for user.\n     *\n     * ### Usage:\n     *\n     *     if(posthog.isFeatureEnabled('beta-feature')) { // do something }\n     *\n     * @param {Object|String} key Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    isFeatureEnabled(key: string, options: { send_event?: boolean } = {}): boolean | undefined {\n        if (!this.getFlags() || this.getFlags().length === 0) {\n            console.warn('isFeatureEnabled for key \"' + key + '\" failed. Feature flags didn\\'t load in time.')\n            return undefined\n        }\n        return !!this.getFeatureFlag(key, options)\n    }\n\n    addFeatureFlagsHandler(handler: FeatureFlagsCallback): void {\n        this.featureFlagEventHandlers.push(handler)\n    }\n\n    removeFeatureFlagsHandler(handler: FeatureFlagsCallback): void {\n        this.featureFlagEventHandlers = this.featureFlagEventHandlers.filter((h) => h !== handler)\n    }\n\n    receivedFeatureFlags(response: Partial<DecideResponse>): void {\n        this.instance.decideEndpointWasHit = true\n        const currentFlags = this.getFlagVariants()\n        const currentFlagPayloads = this.getFlagPayloads()\n        parseFeatureFlagDecideResponse(response, this.instance.persistence, currentFlags, currentFlagPayloads)\n        this._fireFeatureFlagsCallbacks()\n    }\n\n    /*\n     * Override feature flags for debugging.\n     *\n     * ### Usage:\n     *\n     *     - posthog.feature_flags.override(false)\n     *     - posthog.feature_flags.override(['beta-feature'])\n     *     - posthog.feature_flags.override({'beta-feature': 'variant', 'other-feature': True})\n     *\n     * @param {Object|Array|String} flags Flags to override with.\n     */\n    override(flags: boolean | string[] | Record<string, string | boolean>): void {\n        this._override_warning = false\n\n        if (flags === false) {\n            this.instance.persistence.unregister(PERSISTENCE_OVERRIDE_FEATURE_FLAGS)\n        } else if (Array.isArray(flags)) {\n            const flagsObj: Record<string, string | boolean> = {}\n            for (let i = 0; i < flags.length; i++) {\n                flagsObj[flags[i]] = true\n            }\n            this.instance.persistence.register({ [PERSISTENCE_OVERRIDE_FEATURE_FLAGS]: flagsObj })\n        } else {\n            this.instance.persistence.register({ [PERSISTENCE_OVERRIDE_FEATURE_FLAGS]: flags })\n        }\n    }\n    /*\n     * Register an event listener that runs when feature flags become available or when they change.\n     * If there are flags, the listener is called immediately in addition to being called on future changes.\n     *\n     * ### Usage:\n     *\n     *     posthog.onFeatureFlags(function(featureFlags) { // do something })\n     *\n     * @param {Function} [callback] The callback function will be called once the feature flags are ready or when they are updated.\n     *                              It'll return a list of feature flags enabled for the user.\n     * @returns {Function} A function that can be called to unsubscribe the listener. Used by useEffect when the component unmounts.\n     */\n    onFeatureFlags(callback: FeatureFlagsCallback): () => void {\n        this.addFeatureFlagsHandler(callback)\n        if (this.instance.decideEndpointWasHit) {\n            const { flags, flagVariants } = this._prepareFeatureFlagsForCallbacks()\n            callback(flags, flagVariants)\n        }\n        return () => this.removeFeatureFlagsHandler(callback)\n    }\n\n    updateEarlyAccessFeatureEnrollment(key: string, isEnrolled: boolean): void {\n        const enrollmentPersonProp = {\n            [`$feature_enrollment/${key}`]: isEnrolled,\n        }\n        this.instance.capture('$feature_enrollment_update', {\n            $feature_flag: key,\n            $feature_enrollment: isEnrolled,\n            $set: enrollmentPersonProp,\n        })\n        this.setPersonPropertiesForFlags(enrollmentPersonProp, false)\n\n        const newFlags = { ...this.getFlagVariants(), [key]: isEnrolled }\n        this.instance.persistence.register({\n            [PERSISTENCE_ACTIVE_FEATURE_FLAGS]: Object.keys(filterActiveFeatureFlags(newFlags)),\n            [ENABLED_FEATURE_FLAGS]: newFlags,\n        })\n        this._fireFeatureFlagsCallbacks()\n    }\n\n    getEarlyAccessFeatures(callback: EarlyAccessFeatureCallback, force_reload = false): void {\n        const existing_early_access_features = this.instance.get_property(PERSISTENCE_EARLY_ACCESS_FEATURES)\n\n        if (!existing_early_access_features || force_reload) {\n            this.instance._send_request(\n                `${this.instance.get_config('api_host')}/api/early_access_features/?token=${this.instance.get_config(\n                    'token'\n                )}`,\n                {},\n                { method: 'GET' },\n                (response) => {\n                    const earlyAccessFeatures = (response as EarlyAccessFeatureResponse).earlyAccessFeatures\n                    this.instance.persistence.register({ [PERSISTENCE_EARLY_ACCESS_FEATURES]: earlyAccessFeatures })\n                    return callback(earlyAccessFeatures)\n                }\n            )\n        } else {\n            return callback(existing_early_access_features)\n        }\n    }\n\n    _prepareFeatureFlagsForCallbacks(): { flags: string[]; flagVariants: Record<string, string | boolean> } {\n        const flags = this.getFlags()\n        const flagVariants = this.getFlagVariants()\n\n        // Return truthy\n        const truthyFlags = flags.filter((flag) => flagVariants[flag])\n        const truthyFlagVariants = Object.keys(flagVariants)\n            .filter((variantKey) => flagVariants[variantKey])\n            .reduce((res: Record<string, string | boolean>, key) => {\n                res[key] = flagVariants[key]\n                return res\n            }, {})\n\n        return {\n            flags: truthyFlags,\n            flagVariants: truthyFlagVariants,\n        }\n    }\n\n    _fireFeatureFlagsCallbacks(): void {\n        const { flags, flagVariants } = this._prepareFeatureFlagsForCallbacks()\n        this.featureFlagEventHandlers.forEach((handler) => handler(flags, flagVariants))\n    }\n\n    /**\n     * Set override person properties for feature flags.\n     * This is used when dealing with new persons / where you don't want to wait for ingestion\n     * to update user properties.\n     */\n    setPersonPropertiesForFlags(properties: Properties, reloadFeatureFlags = true): void {\n        // Get persisted person properties\n        const existingProperties = this.instance.get_property(STORED_PERSON_PROPERTIES_KEY) || {}\n\n        this.instance.register({\n            [STORED_PERSON_PROPERTIES_KEY]: {\n                ...existingProperties,\n                ...properties,\n            },\n        })\n\n        if (reloadFeatureFlags) {\n            this.instance.reloadFeatureFlags()\n        }\n    }\n\n    resetPersonPropertiesForFlags(): void {\n        this.instance.unregister(STORED_PERSON_PROPERTIES_KEY)\n    }\n\n    /**\n     * Set override group properties for feature flags.\n     * This is used when dealing with new groups / where you don't want to wait for ingestion\n     * to update properties.\n     * Takes in an object, the key of which is the group type.\n     * For example:\n     *     setGroupPropertiesForFlags({'organization': { name: 'CYZ', employees: '11' } })\n     */\n    setGroupPropertiesForFlags(properties: { [type: string]: Properties }, reloadFeatureFlags = true): void {\n        // Get persisted group properties\n        const existingProperties = this.instance.get_property(STORED_GROUP_PROPERTIES_KEY) || {}\n\n        if (Object.keys(existingProperties).length !== 0) {\n            Object.keys(existingProperties).forEach((groupType) => {\n                existingProperties[groupType] = {\n                    ...existingProperties[groupType],\n                    ...properties[groupType],\n                }\n                delete properties[groupType]\n            })\n        }\n\n        this.instance.register({\n            [STORED_GROUP_PROPERTIES_KEY]: {\n                ...existingProperties,\n                ...properties,\n            },\n        })\n\n        if (reloadFeatureFlags) {\n            this.instance.reloadFeatureFlags()\n        }\n    }\n\n    resetGroupPropertiesForFlags(group_type?: string): void {\n        if (group_type) {\n            const existingProperties = this.instance.get_property(STORED_GROUP_PROPERTIES_KEY) || {}\n            this.instance.register({\n                [STORED_GROUP_PROPERTIES_KEY]: { ...existingProperties, [group_type]: {} },\n            })\n        } else {\n            this.instance.unregister(STORED_GROUP_PROPERTIES_KEY)\n        }\n    }\n}\n","import type { pluginEvent } from '@rrweb/types'\n\nexport const replacementImageURI =\n    'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNOCAwSDE2TDAgMTZWOEw4IDBaIiBmaWxsPSIjMkQyRDJEIi8+CjxwYXRoIGQ9Ik0xNiA4VjE2SDhMMTYgOFoiIGZpbGw9IiMyRDJEMkQiLz4KPC9zdmc+Cg=='\n\nexport const FULL_SNAPSHOT_EVENT_TYPE = 2\nexport const META_EVENT_TYPE = 4\nexport const INCREMENTAL_SNAPSHOT_EVENT_TYPE = 3\nexport const PLUGIN_EVENT_TYPE = 6\nexport const MUTATION_SOURCE_TYPE = 0\n\n/*\n * Check whether a data payload is nearing 5mb. If it is, it checks the data for\n * data URIs (the likely culprit for large payloads). If it finds data URIs, it either replaces\n * it with a generic image (if it's an image) or removes it.\n * @data {object} the rr-web data object\n * @returns {object} the rr-web data object with data uris filtered out\n */\nexport function filterDataURLsFromLargeDataObjects(data: Record<string, any>): Record<string, any> {\n    if (data && typeof data === 'object') {\n        let stringifiedData = JSON.stringify(data)\n        // String length of 5000000 is an approximation of 5mb\n        // Note: with compression, this limit may be able to be increased\n        // but we're assuming most of the size is from a data uri which\n        // is unlikely to be compressed further\n        if (stringifiedData.length > 5000000) {\n            // Regex that matches the pattern for a dataURI with the shape 'data:{mime type};{encoding},{data}'. It:\n            // 1) Checks if the pattern starts with 'data:' (potentially, not at the start of the string)\n            // 2) Extracts the mime type of the data uri in the first group\n            // 3) Determines when the data URI ends.Depending on if it's used in the src tag or css, it can end with a ) or \"\n            const dataURIRegex = /data:([\\w\\/\\-\\.]+);(\\w+),([^)\"]*)/gim\n            const matches = stringifiedData.matchAll(dataURIRegex)\n            for (const match of matches) {\n                if (match[1].toLocaleLowerCase().slice(0, 6) === 'image/') {\n                    stringifiedData = stringifiedData.replace(match[0], replacementImageURI)\n                } else {\n                    stringifiedData = stringifiedData.replace(match[0], '')\n                }\n            }\n        }\n        return JSON.parse(stringifiedData)\n    }\n    return data\n}\n\nexport const CONSOLE_LOG_PLUGIN_NAME = 'rrweb/console@1' // The name of the rr-web plugin that emits console logs\n\n// Console logs can be really large. This function truncates large logs\n// It's a simple function that just truncates long strings.\n// TODO: Ideally this function would have better handling of objects + lists,\n// so they could still be rendered in a pretty way after truncation.\nexport function truncateLargeConsoleLogs(event: pluginEvent<{ payload: string[] }>) {\n    const MAX_STRING_SIZE = 2000 // Maximum number of characters allowed in a string\n    const MAX_STRINGS_PER_LOG = 10 // A log can consist of multiple strings (e.g. consol.log('string1', 'string2'))\n\n    if (\n        event &&\n        typeof event === 'object' &&\n        event.type === PLUGIN_EVENT_TYPE &&\n        typeof event.data === 'object' &&\n        event.data.plugin === CONSOLE_LOG_PLUGIN_NAME\n    ) {\n        // Note: event.data.payload.payload comes from rr-web, and is an array of strings\n        if (event.data.payload.payload.length > MAX_STRINGS_PER_LOG) {\n            event.data.payload.payload = event.data.payload.payload.slice(0, MAX_STRINGS_PER_LOG)\n            event.data.payload.payload.push('...[truncated]')\n        }\n        const updatedPayload = []\n        for (let i = 0; i < event.data.payload.payload.length; i++) {\n            if (\n                event.data.payload.payload[i] && // Value can be null\n                event.data.payload.payload[i].length > MAX_STRING_SIZE\n            ) {\n                updatedPayload.push(event.data.payload.payload[i].slice(0, MAX_STRING_SIZE) + '...[truncated]')\n            } else {\n                updatedPayload.push(event.data.payload.payload[i])\n            }\n        }\n        event.data.payload.payload = updatedPayload\n        return event\n    }\n    return event\n}\n","import {\n    CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE,\n    SESSION_RECORDING_ENABLED_SERVER_SIDE,\n    SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE,\n} from '../posthog-persistence'\nimport {\n    filterDataURLsFromLargeDataObjects,\n    FULL_SNAPSHOT_EVENT_TYPE,\n    INCREMENTAL_SNAPSHOT_EVENT_TYPE,\n    META_EVENT_TYPE,\n    truncateLargeConsoleLogs,\n} from './sessionrecording-utils'\nimport { PostHog } from '../posthog-core'\nimport { DecideResponse, Properties } from '../types'\nimport type {\n    KeepIframeSrcFn,\n    RecordPlugin,\n    SamplingStrategy,\n    blockClass,\n    eventWithTime,\n    hooksParam,\n    listenerHandler,\n    maskTextClass,\n    pluginEvent,\n} from '@rrweb/types'\nimport Config from '../config'\nimport { logger, loadScript } from '../utils'\nimport type { DataURLOptions, MaskInputFn, MaskInputOptions, MaskTextFn, SlimDOMOptions } from 'rrweb-snapshot'\n\nconst BASE_ENDPOINT = '/s/'\n\nexport const RECORDING_IDLE_ACTIVITY_TIMEOUT_MS = 5 * 60 * 1000 // 5 minutes\n\n// NOTE: Importing this type is problematic as we can't safely bundle it to a TS definition so, instead we redefine.\n// import type { record } from 'rrweb2/typings'\n// import type { recordOptions } from 'rrweb/typings/types'\n\nexport type rrwebRecord = {\n    (options: recordOptions<eventWithTime>): listenerHandler\n    addCustomEvent: (tag: string, payload: any) => void\n    takeFullSnapshot: () => void\n}\n\nexport declare type recordOptions<T> = {\n    emit?: (e: T, isCheckout?: boolean) => void\n    checkoutEveryNth?: number\n    checkoutEveryNms?: number\n    blockClass?: blockClass\n    blockSelector?: string\n    ignoreClass?: string\n    maskTextClass?: maskTextClass\n    maskTextSelector?: string\n    maskAllInputs?: boolean\n    maskInputOptions?: MaskInputOptions\n    maskInputFn?: MaskInputFn\n    maskTextFn?: MaskTextFn\n    slimDOMOptions?: SlimDOMOptions | 'all' | true\n    ignoreCSSAttributes?: Set<string>\n    inlineStylesheet?: boolean\n    hooks?: hooksParam\n    // packFn?: PackFn\n    sampling?: SamplingStrategy\n    dataURLOptions?: DataURLOptions\n    recordCanvas?: boolean\n    recordCrossOriginIframes?: boolean\n    recordAfter?: 'DOMContentLoaded' | 'load'\n    userTriggeredOnInput?: boolean\n    collectFonts?: boolean\n    inlineImages?: boolean\n    plugins?: RecordPlugin[]\n    mousemoveWait?: number\n    keepIframeSrcFn?: KeepIframeSrcFn\n    // errorHandler?: ErrorHandler\n}\n\n// Copied from rrweb typings to avoid import\nenum IncrementalSource {\n    Mutation = 0,\n    MouseMove = 1,\n    MouseInteraction = 2,\n    Scroll = 3,\n    ViewportResize = 4,\n    Input = 5,\n    TouchMove = 6,\n    MediaInteraction = 7,\n    StyleSheetRule = 8,\n    CanvasMutation = 9,\n    Font = 10,\n    Log = 11,\n    Drag = 12,\n    StyleDeclaration = 13,\n    Selection = 14,\n    AdoptedStyleSheet = 15,\n}\n\nconst ACTIVE_SOURCES = [\n    IncrementalSource.MouseMove,\n    IncrementalSource.MouseInteraction,\n    IncrementalSource.Scroll,\n    IncrementalSource.ViewportResize,\n    IncrementalSource.Input,\n    IncrementalSource.TouchMove,\n    IncrementalSource.MediaInteraction,\n    IncrementalSource.Drag,\n]\n\nexport class SessionRecording {\n    instance: PostHog\n    captureStarted: boolean\n    snapshots: any[]\n    emit: boolean\n    endpoint: string\n    stopRrweb: listenerHandler | undefined\n    windowId: string | null\n    sessionId: string | null\n    receivedDecide: boolean\n    rrwebRecord: rrwebRecord | undefined\n    recorderVersion?: string\n    lastActivityTimestamp: number = Date.now()\n    isIdle = false\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n        this.captureStarted = false\n        this.snapshots = []\n        this.emit = false // Controls whether data is sent to the server or not\n        this.endpoint = BASE_ENDPOINT\n        this.stopRrweb = undefined\n        this.windowId = null\n        this.sessionId = null\n        this.receivedDecide = false\n    }\n\n    startRecordingIfEnabled() {\n        if (this.isRecordingEnabled()) {\n            this.startCaptureAndTrySendingQueuedSnapshots()\n        } else {\n            this.stopRecording()\n        }\n    }\n\n    started() {\n        return this.captureStarted\n    }\n\n    stopRecording() {\n        if (this.captureStarted && this.stopRrweb) {\n            this.stopRrweb()\n            this.stopRrweb = undefined\n            this.captureStarted = false\n        }\n    }\n\n    isRecordingEnabled() {\n        const enabled_server_side = !!this.instance.get_property(SESSION_RECORDING_ENABLED_SERVER_SIDE)\n        const enabled_client_side = !this.instance.get_config('disable_session_recording')\n        return enabled_server_side && enabled_client_side\n    }\n\n    isConsoleLogCaptureEnabled() {\n        const enabled_server_side = !!this.instance.get_property(CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE)\n        const enabled_client_side = this.instance.get_config('enable_recording_console_log')\n        return enabled_client_side ?? enabled_server_side\n    }\n\n    getRecordingVersion() {\n        const recordingVersion_server_side = this.instance.get_property(SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE)\n        const recordingVersion_client_side = this.instance.get_config('session_recording')?.recorderVersion\n        return recordingVersion_client_side || recordingVersion_server_side || 'v1'\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        this.receivedDecide = true\n        if (this.instance.persistence) {\n            this.instance.persistence.register({\n                [SESSION_RECORDING_ENABLED_SERVER_SIDE]: !!response['sessionRecording'],\n                [CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE]: response.sessionRecording?.consoleLogRecordingEnabled,\n                [SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE]: response.sessionRecording?.recorderVersion,\n            })\n        }\n        if (response.sessionRecording?.endpoint) {\n            this.endpoint = response.sessionRecording?.endpoint\n        }\n\n        if (response.sessionRecording?.recorderVersion) {\n            this.recorderVersion = response.sessionRecording.recorderVersion\n        }\n        this.startRecordingIfEnabled()\n    }\n\n    startCaptureAndTrySendingQueuedSnapshots() {\n        // Only submit data after we've received a decide response to account for\n        // changing endpoints and the feature being disabled on the server side.\n        if (this.receivedDecide) {\n            this.emit = true\n            this.snapshots.forEach((properties) => this._captureSnapshot(properties))\n        }\n        this._startCapture()\n    }\n\n    _startCapture() {\n        // According to the rrweb docs, rrweb is not supported on IE11 and below:\n        // \"rrweb does not support IE11 and below because it uses the MutationObserver API which was supported by these browsers.\"\n        // https://github.com/rrweb-io/rrweb/blob/master/guide.md#compatibility-note\n        //\n        // However, MutationObserver does exist on IE11, it just doesn't work well and does not detect all changes.\n        // Instead, when we load \"recorder.js\", the first JS error is about \"Object.assign\" being undefined.\n        // Thus instead of MutationObserver, we look for this function and block recording if it's undefined.\n        if (typeof Object.assign === 'undefined') {\n            return\n        }\n\n        // We do not switch recorder versions midway through a recording.\n        if (this.captureStarted || this.instance.get_config('disable_session_recording')) {\n            return\n        }\n\n        this.captureStarted = true\n        // We want to ensure the sessionManager is reset if necessary on load of the recorder\n        this.instance.sessionManager.checkAndGetSessionAndWindowId()\n\n        const recorderJS = this.getRecordingVersion() === 'v2' ? 'recorder-v2.js' : 'recorder.js'\n\n        // If recorder.js is already loaded (if array.full.js snippet is used or posthog-js/dist/recorder is\n        // imported) or matches the requested recorder version, don't load script. Otherwise, remotely import\n        // recorder.js from cdn since it hasn't been loaded.\n        if (this.instance.__loaded_recorder_version !== this.getRecordingVersion()) {\n            loadScript(\n                this.instance.get_config('api_host') + `/static/${recorderJS}?v=${Config.LIB_VERSION}`,\n                (err) => {\n                    if (err) {\n                        return logger.error(`Could not load ${recorderJS}`, err)\n                    }\n\n                    this._onScriptLoaded()\n                }\n            )\n        } else {\n            this._onScriptLoaded()\n        }\n    }\n\n    _isInteractiveEvent(event: eventWithTime) {\n        return event.type === INCREMENTAL_SNAPSHOT_EVENT_TYPE && ACTIVE_SOURCES.indexOf(event.data?.source) !== -1\n    }\n\n    _updateWindowAndSessionIds(event: eventWithTime) {\n        // Some recording events are triggered by non-user events (e.g. \"X minutes ago\" text updating on the screen).\n        // We don't want to extend the session or trigger a new session in these cases. These events are designated by event\n        // type -> incremental update, and source -> mutation.\n\n        const isUserInteraction = this._isInteractiveEvent(event)\n\n        if (!isUserInteraction && !this.isIdle) {\n            // We check if the lastActivityTimestamp is old enough to go idle\n            if (event.timestamp - this.lastActivityTimestamp > RECORDING_IDLE_ACTIVITY_TIMEOUT_MS) {\n                this.isIdle = true\n            }\n        }\n\n        if (isUserInteraction) {\n            this.lastActivityTimestamp = event.timestamp\n            if (this.isIdle) {\n                // Remove the idle state if set and trigger a full snapshot as we will have ingored previous mutations\n                this.isIdle = false\n                this._tryTakeFullSnapshot()\n            }\n        }\n\n        if (this.isIdle) {\n            return\n        }\n\n        // We only want to extend the session if it is an interactive event.\n        const { windowId, sessionId } = this.instance.sessionManager.checkAndGetSessionAndWindowId(\n            !isUserInteraction,\n            event.timestamp\n        )\n\n        if (\n            [FULL_SNAPSHOT_EVENT_TYPE, META_EVENT_TYPE].indexOf(event.type) === -1 &&\n            (this.windowId !== windowId || this.sessionId !== sessionId)\n        ) {\n            this._tryTakeFullSnapshot()\n        }\n        this.windowId = windowId\n        this.sessionId = sessionId\n    }\n\n    _tryTakeFullSnapshot(): boolean {\n        if (!this.captureStarted) {\n            return false\n        }\n        try {\n            this.rrwebRecord?.takeFullSnapshot()\n            return true\n        } catch (e) {\n            // Sometimes a race can occur where the recorder is not fully started yet, so we can't take a full snapshot.\n            logger.error('Error taking full snapshot.', e)\n            return false\n        }\n    }\n\n    _onScriptLoaded() {\n        // rrweb config info: https://github.com/rrweb-io/rrweb/blob/7d5d0033258d6c29599fb08412202d9a2c7b9413/src/record/index.ts#L28\n        const sessionRecordingOptions: recordOptions<eventWithTime> = {\n            // select set of rrweb config options we expose to our users\n            // see https://github.com/rrweb-io/rrweb/blob/master/guide.md\n            blockClass: 'ph-no-capture',\n            blockSelector: undefined,\n            ignoreClass: 'ph-ignore-input',\n            maskTextClass: 'ph-mask',\n            maskTextSelector: undefined,\n            maskTextFn: undefined,\n            maskAllInputs: true,\n            maskInputOptions: {},\n            maskInputFn: undefined,\n            slimDOMOptions: {},\n            collectFonts: false,\n            inlineStylesheet: true,\n            recordCrossOriginIframes: false,\n        }\n        // We switched from loading all of rrweb to just the record part, but\n        // keep backwards compatibility if someone hasn't upgraded PostHog\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        this.rrwebRecord = window.rrweb ? window.rrweb.record : window.rrwebRecord\n\n        // only allows user to set our 'allowlisted' options\n        const userSessionRecordingOptions = this.instance.get_config('session_recording')\n        for (const [key, value] of Object.entries(userSessionRecordingOptions || {})) {\n            if (key in sessionRecordingOptions) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                sessionRecordingOptions[key] = value\n            }\n        }\n\n        if (!this.rrwebRecord) {\n            logger.error(\n                'onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.'\n            )\n            return\n        }\n\n        this.stopRrweb = this.rrwebRecord({\n            emit: (event) => {\n                this.onRRwebEmit(event)\n            },\n            plugins:\n                (window as any).rrwebConsoleRecord && this.isConsoleLogCaptureEnabled()\n                    ? [(window as any).rrwebConsoleRecord.getRecordConsolePlugin()]\n                    : [],\n            ...sessionRecordingOptions,\n        })\n\n        // :TRICKY: rrweb does not capture navigation within SPA-s, so hook into our $pageview events to get access to all events.\n        //   Dropping the initial event is fine (it's always captured by rrweb).\n        this.instance._addCaptureHook((eventName) => {\n            // If anything could go wrong here it has the potential to block the main loop so we catch all errors.\n            try {\n                if (eventName === '$pageview') {\n                    this.rrwebRecord?.addCustomEvent('$pageview', { href: window.location.href })\n                }\n            } catch (e) {\n                logger.error('Could not add $pageview to rrweb session', e)\n            }\n        })\n\n        // We reset the last activity timestamp, resetting the idle timer\n        this.lastActivityTimestamp = Date.now()\n        this.isIdle = false\n    }\n\n    onRRwebEmit(event: eventWithTime) {\n        event = truncateLargeConsoleLogs(\n            filterDataURLsFromLargeDataObjects(event) as pluginEvent<{ payload: string[] }>\n        ) as eventWithTime\n\n        this._updateWindowAndSessionIds(event)\n\n        if (this.isIdle) {\n            // When in an idle state we keep recording, but don't capture the events\n            return\n        }\n\n        const properties = {\n            $snapshot_data: event,\n            $session_id: this.sessionId,\n            $window_id: this.windowId,\n        }\n\n        this.instance._captureMetrics.incr('rrweb-record')\n        this.instance._captureMetrics.incr(`rrweb-record-${event.type}`)\n\n        if (this.emit) {\n            this._captureSnapshot(properties)\n        } else {\n            this.snapshots.push(properties)\n        }\n    }\n\n    _captureSnapshot(properties: Properties) {\n        // :TRICKY: Make sure we batch these requests, use a custom endpoint and don't truncate the strings.\n        this.instance.capture('$snapshot', properties, {\n            transport: 'XHR',\n            method: 'POST',\n            endpoint: this.endpoint,\n            _noTruncate: true,\n            _batchKey: 'sessionRecording',\n            _metrics: {\n                rrweb_full_snapshot: properties.$snapshot_data.type === FULL_SNAPSHOT_EVENT_TYPE,\n            },\n        })\n    }\n}\n","import { isLocalhost, logger } from '../utils'\nimport { PostHog } from '../posthog-core'\nimport { DecideResponse, NetworkRequest } from '../types'\n\nconst PERFORMANCE_EVENTS_MAPPING: { [key: string]: number } = {\n    // BASE_PERFORMANCE_EVENT_COLUMNS\n    entryType: 0,\n    timeOrigin: 1,\n    name: 2,\n\n    // RESOURCE_EVENT_COLUMNS\n    startTime: 3,\n    redirectStart: 4,\n    redirectEnd: 5,\n    workerStart: 6,\n    fetchStart: 7,\n    domainLookupStart: 8,\n    domainLookupEnd: 9,\n    connectStart: 10,\n    secureConnectionStart: 11,\n    connectEnd: 12,\n    requestStart: 13,\n    responseStart: 14,\n    responseEnd: 15,\n    decodedBodySize: 16,\n    encodedBodySize: 17,\n    initiatorType: 18,\n    nextHopProtocol: 19,\n    renderBlockingStatus: 20,\n    responseStatus: 21,\n    transferSize: 22,\n\n    // LARGEST_CONTENTFUL_PAINT_EVENT_COLUMNS\n    element: 23,\n    renderTime: 24,\n    loadTime: 25,\n    size: 26,\n    id: 27,\n    url: 28,\n\n    // NAVIGATION_EVENT_COLUMNS\n    domComplete: 29,\n    domContentLoadedEvent: 30,\n    domInteractive: 31,\n    loadEventEnd: 32,\n    loadEventStart: 33,\n    redirectCount: 34,\n    navigationType: 35,\n    unloadEventEnd: 36,\n    unloadEventStart: 37,\n\n    // Added after v1\n    duration: 39,\n    timestamp: 40,\n\n    // NOTE: CURRENTLY UNSUPPORTED\n    // EVENT_TIMING_EVENT_COLUMNS\n    // processingStart: null,\n    // processingEnd: null,\n\n    // MARK_AND_MEASURE_EVENT_COLUMNS\n    // detail: null,\n}\n\nconst ENTRY_TYPES_TO_OBSERVE = [\n    // 'event', // This is too noisy as it covers all browser events\n    'first-input',\n    // 'mark', // Mark is used too liberally. We would need to filter for specific marks\n    // 'measure', // Measure is used too liberally. We would need to filter for specific measures\n    'navigation',\n    'paint',\n    'resource',\n]\n\nconst PERFORMANCE_INGESTION_ENDPOINT = '/e/'\n// Don't monitor posthog paths because then events cause performance events which are events and the snake eats its tail \nconst POSTHOG_PATHS_TO_IGNORE = ['/s/', PERFORMANCE_INGESTION_ENDPOINT]\n\nexport class WebPerformanceObserver {\n    instance: PostHog\n    remoteEnabled: boolean | undefined\n    observer: PerformanceObserver | undefined\n\n    // Util to help developers working on this feature manually override\n    _forceAllowLocalhost = false\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    startObservingIfEnabled() {\n        if (this.isEnabled()) {\n            this.startObserving()\n        } else {\n            this.stopObserving()\n        }\n    }\n\n    startObserving() {\n        if (this.observer) {\n            return\n        }\n\n        if (window?.PerformanceObserver?.supportedEntryTypes === undefined) {\n            logger.log(\n                'PostHog Performance observer not started because PerformanceObserver is not supported by this browser.'\n            )\n            return\n        }\n\n        if (isLocalhost() && !this._forceAllowLocalhost) {\n            logger.log('PostHog Peformance observer not started because we are on localhost.')\n            return\n        }\n\n        try {\n            // compat checked above with early return\n            // eslint-disable-next-line compat/compat\n            this.observer = new PerformanceObserver((list) => {\n                list.getEntries().forEach((entry) => {\n                    this._capturePerformanceEvent(entry)\n                })\n            })\n\n            // compat checked above with early return\n            // eslint-disable-next-line compat/compat\n            const entryTypes = PerformanceObserver.supportedEntryTypes.filter((x) => ENTRY_TYPES_TO_OBSERVE.includes(x))\n\n            entryTypes.forEach((entryType) => {\n                this.observer?.observe({ type: entryType, buffered: true })\n            })\n        } catch (e) {\n            console.error('PostHog failed to start performance observer', e)\n            this.stopObserving()\n        }\n    }\n\n    stopObserving() {\n        if (this.observer) {\n            this.observer.disconnect()\n            this.observer = undefined\n        }\n    }\n\n    isObserving() {\n        return !!this.observer\n    }\n\n    isEnabled() {\n        return this.instance.get_config('capture_performance') ?? this.remoteEnabled ?? false\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        this.remoteEnabled = response.capturePerformance || false\n        if (this.isEnabled()) {\n            this.startObserving()\n        }\n    }\n\n    _capturePerformanceEvent(event: PerformanceEntry) {\n        // NOTE: We don't want to capture our own request events.\n\n        if (event.name.indexOf(this.instance.get_config('api_host')) === 0) {\n            const path = event.name.replace(this.instance.get_config('api_host'), '')\n\n            if (POSTHOG_PATHS_TO_IGNORE.find((x) => path.indexOf(x) === 0)) {\n                return\n            }\n        }\n\n        // NOTE: This is minimal atm but will include more options when we move to the\n        // built-in rrweb network recorder\n        let networkRequest: NetworkRequest | null | undefined = {\n            url: event.name,\n        }\n\n        const userSessionRecordingOptions = this.instance.get_config('session_recording')\n\n        if (userSessionRecordingOptions.maskNetworkRequestFn) {\n            networkRequest = userSessionRecordingOptions.maskNetworkRequestFn(networkRequest)\n        }\n\n        if (!networkRequest) {\n            return\n        }\n\n        const eventJson = event.toJSON()\n        eventJson.name = networkRequest.url\n        const properties: { [key: number]: any } = {}\n        // kudos to sentry javascript sdk for excellent background on why to use Date.now() here\n        // https://github.com/getsentry/sentry-javascript/blob/e856e40b6e71a73252e788cd42b5260f81c9c88e/packages/utils/src/time.ts#L70\n        // can't start observer if performance.now() is not available\n        // eslint-disable-next-line compat/compat\n        const timeOrigin = Math.floor(Date.now() - performance.now())\n        properties[PERFORMANCE_EVENTS_MAPPING['timeOrigin']] = timeOrigin\n        // clickhouse can't ingest timestamps that are floats\n        // (in this case representing fractions of a millisecond we don't care about anyway)\n        properties[PERFORMANCE_EVENTS_MAPPING['timestamp']] = Math.floor(timeOrigin + event.startTime)\n        for (const key in PERFORMANCE_EVENTS_MAPPING) {\n            if (eventJson[key] !== undefined) {\n                properties[PERFORMANCE_EVENTS_MAPPING[key]] = eventJson[key]\n            }\n        }\n\n        this.capturePerformanceEvent(properties)\n\n        if (exposesServerTiming(event)) {\n            for (const timing of event.serverTiming || []) {\n                this.capturePerformanceEvent({\n                    [PERFORMANCE_EVENTS_MAPPING['timeOrigin']]: timeOrigin,\n                    [PERFORMANCE_EVENTS_MAPPING['timestamp']]: Math.floor(timeOrigin + event.startTime),\n                    [PERFORMANCE_EVENTS_MAPPING['name']]: timing.name,\n                    [PERFORMANCE_EVENTS_MAPPING['duration']]: timing.duration,\n                    // the spec has a closed list of possible types\n                    // https://developer.mozilla.org/en-US/docs/Web/API/PerformanceEntry/entryType\n                    // but, we need to know this was a server timing so that we know to\n                    // match it to the appropriate navigation or resource timing\n                    // that matching will have to be on timestamp and $current_url\n                    [PERFORMANCE_EVENTS_MAPPING['entryType']]: 'serverTiming',\n                })\n            }\n        }\n    }\n\n    /**\n     * :TRICKY: Make sure we batch these requests, and don't truncate the strings.\n     */\n    private capturePerformanceEvent(properties: { [key: number]: any }) {\n        const timestamp = properties[PERFORMANCE_EVENTS_MAPPING['timestamp']]\n\n        this.instance.sessionRecording?.onRRwebEmit({\n            type: 6, // EventType.Plugin,\n            data: {\n                plugin: 'posthog/network@1',\n                payload: properties,\n            },\n            timestamp,\n        })\n\n        // this.instance.capture('$performance_event', properties, {\n        //     transport: 'XHR',\n        //     method: 'POST',\n        //     endpoint: PERFORMANCE_INGESTION_ENDPOINT,\n        //     _noTruncate: true,\n        //     _batchKey: 'performanceEvent',\n        // })\n    }\n}\n\n/**\n *  Check if this PerformanceEntry is either a PerformanceResourceTiming or a PerformanceNavigationTiming\n *  NB PerformanceNavigationTiming extends PerformanceResourceTiming\n *  Here we don't care which interface it implements as both expose `serverTimings`\n */\nconst exposesServerTiming = (event: PerformanceEntry): event is PerformanceResourceTiming =>\n    event.entryType === 'navigation' || event.entryType === 'resource'\n","import { autocapture } from './autocapture'\nimport { _base64Encode, loadScript } from './utils'\nimport { PostHog } from './posthog-core'\nimport { Compression, DecideResponse } from './types'\nimport { STORED_GROUP_PROPERTIES_KEY, STORED_PERSON_PROPERTIES_KEY } from './posthog-persistence'\n\nexport class Decide {\n    instance: PostHog\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n        // don't need to wait for `decide` to return if flags were provided on initialisation\n        this.instance.decideEndpointWasHit = this.instance._hasBootstrappedFeatureFlags()\n    }\n\n    call(): void {\n        /*\n        Calls /decide endpoint to fetch options for autocapture, session recording, feature flags & compression.\n        */\n        const json_data = JSON.stringify({\n            token: this.instance.get_config('token'),\n            distinct_id: this.instance.get_distinct_id(),\n            groups: this.instance.getGroups(),\n            person_properties: this.instance.get_property(STORED_PERSON_PROPERTIES_KEY),\n            group_properties: this.instance.get_property(STORED_GROUP_PROPERTIES_KEY),\n        })\n\n        const encoded_data = _base64Encode(json_data)\n        this.instance._send_request(\n            `${this.instance.get_config('api_host')}/decide/?v=3`,\n            { data: encoded_data, verbose: true },\n            { method: 'POST' },\n            (response) => this.parseDecideResponse(response as DecideResponse)\n        )\n    }\n\n    parseDecideResponse(response: DecideResponse): void {\n        if (response?.status === 0) {\n            console.error('Failed to fetch feature flags from PostHog.')\n            return\n        }\n        this.instance.decideEndpointWasHit = true\n        if (!(document && document.body)) {\n            console.log('document not ready yet, trying again in 500 milliseconds...')\n            setTimeout(() => {\n                this.parseDecideResponse(response)\n            }, 500)\n            return\n        }\n\n        this.instance.toolbar.afterDecideResponse(response)\n        this.instance.sessionRecording?.afterDecideResponse(response)\n        autocapture.afterDecideResponse(response, this.instance)\n        this.instance.webPerformance?.afterDecideResponse(response)\n        this.instance.exceptionAutocapture?.afterDecideResponse(response)\n\n        this.instance.featureFlags.receivedFeatureFlags(response)\n\n        this.instance['compression'] = {}\n        if (response['supportedCompression'] && !this.instance.get_config('disable_compression')) {\n            const compression: Partial<Record<Compression, boolean>> = {}\n            for (const method of response['supportedCompression']) {\n                compression[method] = true\n            }\n            this.instance['compression'] = compression\n        }\n\n        if (response['siteApps']) {\n            if (this.instance.get_config('opt_in_site_apps')) {\n                const apiHost = this.instance.get_config('api_host')\n                for (const { id, url } of response['siteApps']) {\n                    const scriptUrl = [\n                        apiHost,\n                        apiHost[apiHost.length - 1] === '/' && url[0] === '/' ? url.substring(1) : url,\n                    ].join('')\n\n                    ;(window as any)[`__$$ph_site_app_${id}`] = this.instance\n\n                    loadScript(scriptUrl, (err) => {\n                        if (err) {\n                            console.error(`Error while initializing PostHog app with config id ${id}`, err)\n                        }\n                    })\n                }\n            } else if (response['siteApps'].length > 0) {\n                console.error('PostHog site apps are disabled. Enable the \"opt_in_site_apps\" config to proceed.')\n            }\n        }\n    }\n}\n","export const POSTHOG_MANAGED_HOSTS = ['https://app.posthog.com', 'https://eu.posthog.com']\n","import { _getHashParam, _register_event, loadScript, logger } from '../utils'\nimport { PostHog } from '../posthog-core'\nimport { DecideResponse, ToolbarParams } from '../types'\nimport { POSTHOG_MANAGED_HOSTS } from './cloud'\n\nexport class Toolbar {\n    instance: PostHog\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        const toolbarParams: ToolbarParams =\n            response['toolbarParams'] ||\n            response['editorParams'] ||\n            (response['toolbarVersion'] ? { toolbarVersion: response['toolbarVersion'] } : {})\n        if (\n            response['isAuthenticated'] &&\n            toolbarParams['toolbarVersion'] &&\n            toolbarParams['toolbarVersion'].indexOf('toolbar') === 0\n        ) {\n            this.loadToolbar({\n                ...toolbarParams,\n            })\n        }\n    }\n\n    /**\n     * To load the toolbar, we need an access token and other state. That state comes from one of three places:\n     * 1. In the URL hash params\n     * 2. From session storage under the key `toolbarParams` if the toolbar was initialized on a previous page\n     */\n    maybeLoadToolbar(\n        location = window.location,\n        localStorage: Storage | undefined = undefined,\n        history = window.history\n    ): boolean {\n        try {\n            // Before running the code we check if we can access localStorage, if not we opt-out\n            if (!localStorage) {\n                try {\n                    window.localStorage.setItem('test', 'test')\n                    window.localStorage.removeItem('test')\n                } catch (error) {\n                    return false\n                }\n\n                // If localStorage was undefined, and localStorage is supported we set the default value\n                localStorage = window.localStorage\n            }\n\n            const stateHash = _getHashParam(location.hash, '__posthog') || _getHashParam(location.hash, 'state')\n            const state = stateHash ? JSON.parse(decodeURIComponent(stateHash)) : null\n            const parseFromUrl = state && state['action'] === 'ph_authorize'\n            let toolbarParams: ToolbarParams\n\n            if (parseFromUrl) {\n                // happens if they are initializing the toolbar using an old snippet\n                toolbarParams = state\n                toolbarParams.source = 'url'\n\n                if (toolbarParams && Object.keys(toolbarParams).length > 0) {\n                    if (state['desiredHash']) {\n                        // hash that was in the url before the redirect\n                        location.hash = state['desiredHash']\n                    } else if (history) {\n                        history.replaceState('', document.title, location.pathname + location.search) // completely remove hash\n                    } else {\n                        location.hash = '' // clear hash (but leaves # unfortunately)\n                    }\n                }\n            } else {\n                // get credentials from localStorage from a previous initialzation\n                toolbarParams = JSON.parse(localStorage.getItem('_postHogToolbarParams') || '{}')\n                toolbarParams.source = 'localstorage'\n\n                // delete \"add-action\" or other intent from toolbarParams, otherwise we'll have the same intent\n                // every time we open the page (e.g. you just visiting your own site an hour later)\n                delete toolbarParams.userIntent\n            }\n\n            if (toolbarParams['token'] && this.instance.get_config('token') === toolbarParams['token']) {\n                this.loadToolbar(toolbarParams)\n                return true\n            } else {\n                return false\n            }\n        } catch (e) {\n            return false\n        }\n    }\n\n    loadToolbar(params?: ToolbarParams): boolean {\n        if ((window as any)['_postHogToolbarLoaded']) {\n            return false\n        }\n        // only load the toolbar once, even if there are multiple instances of PostHogLib\n        ;(window as any)['_postHogToolbarLoaded'] = true\n\n        // By design array.js, recorder.js, and toolbar.js are served from Django with no or limited caching, not from our CDN\n        // Django respects the query params for caching, returning a 304 if appropriate\n        const host = this.instance.get_config('api_host')\n        const timestampToNearestThirtySeconds = Math.floor(Date.now() / 30000) * 30000\n        const toolbarUrl = `${host}${\n            host.endsWith('/') ? '' : '/'\n        }static/toolbar.js?_ts=${timestampToNearestThirtySeconds}`\n        const disableToolbarMetrics =\n            !POSTHOG_MANAGED_HOSTS.includes(this.instance.get_config('api_host')) &&\n            this.instance.get_config('advanced_disable_toolbar_metrics')\n\n        const toolbarParams = {\n            token: this.instance.get_config('token'),\n            ...params,\n            apiURL: host, // defaults to api_host from the instance config if nothing else set\n            ...(disableToolbarMetrics ? { instrument: false } : {}),\n        }\n\n        const { source: _discard, ...paramsToPersist } = toolbarParams // eslint-disable-line\n        window.localStorage.setItem('_postHogToolbarParams', JSON.stringify(paramsToPersist))\n\n        loadScript(toolbarUrl, (err) => {\n            if (err) {\n                logger.error('Failed to load toolbar', err)\n                return\n            }\n            ;((window as any)['ph_load_toolbar'] || (window as any)['ph_load_editor'])(toolbarParams, this.instance)\n        })\n        // Turbolinks doesn't fire an onload event but does replace the entire body, including the toolbar.\n        // Thus, we ensure the toolbar is only loaded inside the body, and then reloaded on turbolinks:load.\n        _register_event(window, 'turbolinks:load', () => {\n            ;(window as any)['_postHogToolbarLoaded'] = false\n            this.loadToolbar(toolbarParams)\n        })\n        return true\n    }\n\n    /** @deprecated Use \"loadToolbar\" instead. */\n    _loadEditor(params: ToolbarParams): boolean {\n        return this.loadToolbar(params)\n    }\n\n    /** @deprecated Use \"maybeLoadToolbar\" instead. */\n    maybeLoadEditor(\n        location = window.location,\n        localStorage: Storage | undefined = undefined,\n        history = window.history\n    ): boolean {\n        return this.maybeLoadToolbar(location, localStorage, history)\n    }\n}\n","export class RequestQueueScaffold {\n    isPolling: boolean // flag to continue to recursively poll or not\n    _event_queue: any[]\n    _empty_queue_count: number // to track empty polls\n    _poller: number | undefined // to become interval for reference to clear later\n    _pollInterval: number\n\n    constructor(pollInterval = 3000) {\n        this.isPolling = true // flag to continue to recursively poll or not\n        this._event_queue = []\n        this._empty_queue_count = 0 // to track empty polls\n        this._poller = undefined // to become interval for reference to clear later\n        this._pollInterval = pollInterval\n    }\n\n    setPollInterval(interval: number): void {\n        this._pollInterval = interval\n        // Reset interval if running already\n        if (this.isPolling) {\n            this.poll()\n        }\n    }\n\n    // // eslint-disable-next-line no-unused-vars\n    // enqueue(_requestData: Record<string, any>): void {\n    //     return\n    // }\n\n    poll(): void {\n        return\n    }\n\n    unload(): void {\n        return\n    }\n\n    getTime(): number {\n        return new Date().getTime()\n    }\n}\n","import { RequestQueueScaffold } from './base-request-queue'\nimport { _each } from './utils'\nimport { CaptureMetrics } from './capture-metrics'\nimport { Properties, QueuedRequestData, XHROptions } from './types'\n\nexport class RequestQueue extends RequestQueueScaffold {\n    captureMetrics: CaptureMetrics\n    handlePollRequest: (url: string, data: Properties, options?: XHROptions) => void\n\n    constructor(\n        captureMetrics: CaptureMetrics,\n        handlePollRequest: (url: string, data: Properties, options?: XHROptions) => void,\n        pollInterval = 3000\n    ) {\n        super(pollInterval)\n        this.handlePollRequest = handlePollRequest\n        this.captureMetrics = captureMetrics\n    }\n\n    enqueue(url: string, data: Properties, options: XHROptions): void {\n        this.captureMetrics.incr('batch-enqueue')\n\n        this._event_queue.push({ url, data, options })\n\n        if (!this.isPolling) {\n            this.isPolling = true\n            this.poll()\n        }\n    }\n\n    poll(): void {\n        clearTimeout(this._poller)\n        this._poller = setTimeout(() => {\n            if (this._event_queue.length > 0) {\n                const requests = this.formatQueue()\n                for (const key in requests) {\n                    const { url, data, options } = requests[key]\n                    _each(data, (_, dataKey) => {\n                        data[dataKey]['offset'] = Math.abs(data[dataKey]['timestamp'] - this.getTime())\n                        delete data[dataKey]['timestamp']\n                    })\n                    this.handlePollRequest(url, data, options)\n\n                    this.captureMetrics.incr('batch-requests')\n                    this.captureMetrics.incr(`batch-requests-${url.slice(url.length - 2)}`)\n                    this.captureMetrics.incr('batch-handle', data.length)\n                    this.captureMetrics.incr(`batch-handle-${url.slice(url.length - 2)}`, data.length)\n                }\n                this._event_queue.length = 0 // flush the _event_queue\n                this._empty_queue_count = 0\n            } else {\n                this._empty_queue_count++\n            }\n\n            /**\n             * _empty_queue_count will increment each time the queue is polled\n             *  and it is empty. To avoid empty polling (user went idle, stepped away from comp)\n             *  we can turn it off with the isPolling flag.\n             *\n             * Polling will be re enabled when the next time PostHogLib.capture is called with\n             *  an event that should be added to the event queue.\n             */\n            if (this._empty_queue_count > 4) {\n                this.isPolling = false\n                this._empty_queue_count = 0\n            }\n            if (this.isPolling) {\n                this.poll()\n            }\n        }, this._pollInterval) as any as number\n    }\n\n    updateUnloadMetrics(): void {\n        const requests = this.formatQueue()\n        for (const key in requests) {\n            const { url, data } = requests[key]\n\n            this.captureMetrics.incr('batch-unload-requests')\n            this.captureMetrics.incr(`batch-unload-requests-${url.slice(url.length - 2)}`)\n            this.captureMetrics.incr('batch-unload', data.length)\n            this.captureMetrics.incr(`batch-unload-${url.slice(url.length - 2)}`, data.length)\n        }\n    }\n\n    unload(): void {\n        clearTimeout(this._poller)\n        const requests = this._event_queue.length > 0 ? this.formatQueue() : {}\n        this._event_queue.length = 0\n        const requestValues = Object.values(requests)\n\n        // Always force events to be sent before recordings, as events are more important, and recordings are bigger and thus less likely to arrive\n        const sortedRequests = [\n            ...requestValues.filter((r) => r.url.indexOf('/e') === 0),\n            ...requestValues.filter((r) => r.url.indexOf('/e') !== 0),\n        ]\n        sortedRequests.map(({ url, data, options }) => {\n            this.handlePollRequest(url, data, { ...options, transport: 'sendBeacon' })\n        })\n    }\n\n    formatQueue(): Record<string, QueuedRequestData> {\n        const requests: Record<string, QueuedRequestData> = {}\n        _each(this._event_queue, (request) => {\n            const { url, data, options } = request\n            const key = (options ? options._batchKey : null) || url\n            if (requests[key] === undefined) {\n                requests[key] = { data: [], url, options }\n            }\n\n            // :TRICKY: Metrics-only code\n            if (\n                options &&\n                requests[key].options &&\n                requests[key].options._metrics &&\n                !(requests[key].options._metrics as any)['rrweb_full_snapshot']\n            ) {\n                ;(requests[key].options._metrics as any)['rrweb_full_snapshot'] =\n                    options._metrics['rrweb_full_snapshot']\n            }\n            requests[key].data.push(data)\n        })\n        return requests\n    }\n}\n","export class CaptureMetrics {\n    enabled: boolean\n    metrics: Record<string, number>\n\n    constructor(enabled: boolean) {\n        this.enabled = enabled\n        this.metrics = {}\n    }\n\n    incr(key: string, by = 1): void {\n        if (this.enabled) {\n            key = `phjs-${key}`\n            this.metrics[key] = (this.metrics[key] || 0) + by\n        }\n    }\n\n    decr(key: string): void {\n        if (this.enabled) {\n            key = `phjs-${key}`\n            this.metrics[key] = (this.metrics[key] || 0) - 1\n        }\n    }\n}\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Much of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// Many optimizations have been made, so the bundle size is ultimately smaller but performance is similar.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var u = ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([c], { type: 'text/javascript' })));\n    var w = new Worker(u);\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i)\n            co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) >> 0;\n    return ((d[o] | (d[o + 1] << 8)) >>> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) >> 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >>> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) >> 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                if (!noSt && pos + tl * (clb + 7) > tbts)\n                    break;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts)\n                throw 'unexpected EOF';\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var mxa = lbt + dbt + 18;\n        while (noSt || pos + mxa < tbts) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts)\n                throw 'unexpected EOF';\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts)\n                    throw 'unexpected EOF';\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = pos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) >> 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) >> 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [new u8(0), 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.floor(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768\n            var imod = i & 32767;\n            // previous index with this value\n            var pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst)\n            pos = wfblk(w, pos, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = 0xFFFFFFFF;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return c ^ 0xFFFFFFFF; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 5552, l);\n                for (; i < e; ++i)\n                    n += d[i], m += n;\n                n %= 65521, m %= 65521;\n            }\n            a = n, b = m;\n        },\n        d: function () { return ((a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8)) + ((a & 255) << 23) * 2; }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    if (!opts.consume)\n        dat = new u8(dat);\n    w.postMessage([dat, opts], [dat.buffer]);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16)) + (d[b + 3] << 23) * 2; };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) + (2 * (d[l - 1] << 23));\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    return dopt(data, opts, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) >> 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = gzs(this.p);\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    var l = str.length;\n    if (!latin1 && typeof TextEncoder != 'undefined')\n        return new TextEncoder().encode(str);\n    var ar = new u8(str.length + (str.length >>> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >>> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >>> 18)), w(128 | ((c >>> 12) & 63)), w(128 | ((c >>> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >>> 12)), w(128 | ((c >>> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    var r = '';\n    if (!latin1 && typeof TextDecoder != 'undefined')\n        return new TextDecoder().decode(dat);\n    for (var i = 0; i < dat.length;) {\n        var c = dat[i++];\n        if (c < 128 || latin1)\n            r += String.fromCharCode(c);\n        else if (c < 224)\n            r += String.fromCharCode((c & 31) << 6 | (dat[i++] & 63));\n        else if (c < 240)\n            r += String.fromCharCode((c & 15) << 12 | (dat[i++] & 63) << 6 | (dat[i++] & 63));\n        else\n            c = ((c & 15) << 18 | (dat[i++] & 63) << 12 | (dat[i++] & 63) << 6 | (dat[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n    }\n    return r;\n}\n;\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl;\n    var _a = z ? z64e(d, es) : [b4(d, b + 20), b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b4(d, b + 12), b4(d, b + 4), b4(d, b + 20)];\n};\n// write zip header\nvar wzh = function (d, b, c, cmp, su, fn, u, o, ce, t) {\n    var fl = fn.length, l = cmp.length;\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b] = 20, b += 2;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (t == 8 && (o.level == 1 ? 6 : o.level < 6 ? 4 : o.level == 9 ? 2 : 0)), d[b++] = u && 8;\n    d[b] = t, b += 2;\n    var dt = new Date(o.mtime || Date.now()), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, ((y << 24) * 2) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1));\n    b += 4;\n    wbytes(d, b, c);\n    wbytes(d, b + 4, l);\n    wbytes(d, b + 8, su);\n    wbytes(d, b + 12, fl), b += 16; // skip extra field, comment\n    if (ce != null)\n        wbytes(d, b += 10, ce), b += 4;\n    d.set(fn, b);\n    b += fl;\n    if (ce == null)\n        d.set(cmp, b);\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                wzh(out, tot, f.c, f.d, f.m, f.n, f.u, f.p, null, f.t);\n                wzh(out, o, f.c, f.d, f.m, f.n, f.u, f.p, tot, f.t), o += 46 + f.n.length, tot += 30 + f.n.length + f.d.length;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), m = file.length;\n        c.p(file);\n        var n = strToU8(fn), s = n.length;\n        var t = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = {\n                    t: t,\n                    d: d,\n                    m: m,\n                    c: c.d(),\n                    u: fn.length != l,\n                    n: n,\n                    p: p\n                };\n                o += 30 + s + l;\n                tot += 76 + 2 * s + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (n.length > 65535)\n            cbl('filename too long', null);\n        if (!t)\n            cbl(null, file);\n        else if (m < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var t = p.level == 0 ? 0 : 8;\n        var n = strToU8(fn), s = n.length;\n        if (n.length > 65535)\n            throw 'filename too long';\n        var d = t ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push({\n            t: t,\n            d: d,\n            m: file.length,\n            c: c.d(),\n            u: fn.length != s,\n            n: n,\n            o: o,\n            p: p\n        });\n        o += 30 + s + l;\n        tot += 76 + 2 * s + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f.c, f.d, f.m, f.n, f.u, f.p, null, f.t);\n        wzh(out, o, f.c, f.d, f.m, f.n, f.u, f.p, f.o, f.t), o += 46 + f.n.length;\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_2 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_2(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import type { MaskInputOptions, SlimDOMOptions } from 'rrweb-snapshot'\nimport { PostHog } from './posthog-core'\nimport { CaptureMetrics } from './capture-metrics'\nimport { RetryQueue } from './retry-queue'\n\nexport type Property = any\nexport type Properties = Record<string, Property>\nexport interface CaptureResult {\n    uuid: string\n    event: string\n    properties: Properties\n    $set?: Properties\n    $set_once?: Properties\n    timestamp?: Date\n}\nexport type CaptureCallback = (response: any, data: any) => void\n\nexport type AutocaptureCompatibleElement = 'a' | 'button' | 'form' | 'input' | 'select' | 'textarea' | 'label'\nexport type DomAutocaptureEvents = 'click' | 'change' | 'submit'\n\n/**\n * If an array is passed for an allowlist, autocapture events will only be sent for elements matching\n * at least one of the elements in the array. Multiple allowlists can be used\n */\nexport interface AutocaptureConfig {\n    /**\n     * List of URLs to allow autocapture on, can be strings to match\n     * or regexes e.g. ['https://example.com', 'test.com/.*']\n     */\n    url_allowlist?: (string | RegExp)[]\n\n    /**\n     * List of DOM events to allow autocapture on  e.g. ['click', 'change', 'submit']\n     */\n    dom_event_allowlist?: DomAutocaptureEvents[]\n\n    /**\n     * List of DOM elements to allow autocapture on\n     * e.g. ['a', 'button', 'form', 'input', 'select', 'textarea', 'label']\n     */\n    element_allowlist?: AutocaptureCompatibleElement[]\n\n    /**\n     * List of CSS selectors to allow autocapture on\n     * e.g. ['[ph-capture]']\n     */\n    css_selector_allowlist?: string[]\n}\n\nexport interface PostHogConfig {\n    api_host: string\n    api_method: string\n    api_transport: string\n    ui_host: string | null\n    token: string\n    autocapture: boolean | AutocaptureConfig\n    rageclick: boolean\n    cross_subdomain_cookie: boolean\n    persistence: 'localStorage' | 'cookie' | 'memory' | 'localStorage+cookie' | 'sessionStorage'\n    persistence_name: string\n    cookie_name: string\n    loaded: (posthog_instance: PostHog) => void\n    store_google: boolean\n    custom_campaign_params: string[]\n    save_referrer: boolean\n    test: boolean\n    verbose: boolean\n    capture_pageview: boolean\n    capture_pageleave: boolean\n    debug: boolean\n    cookie_expiration: number\n    upgrade: boolean\n    disable_session_recording: boolean\n    disable_persistence: boolean\n    disable_cookie: boolean\n    enable_recording_console_log?: boolean\n    secure_cookie: boolean\n    ip: boolean\n    opt_out_capturing_by_default: boolean\n    opt_out_persistence_by_default: boolean\n    opt_out_capturing_persistence_type: 'localStorage' | 'cookie'\n    opt_out_capturing_cookie_prefix: string | null\n    opt_in_site_apps: boolean\n    respect_dnt: boolean\n    property_blacklist: string[]\n    xhr_headers: { [header_name: string]: string }\n    on_xhr_error: (failedRequest: XMLHttpRequest) => void\n    inapp_protocol: string\n    inapp_link_new_window: boolean\n    request_batching: boolean\n    sanitize_properties: ((properties: Properties, event_name: string) => Properties) | null\n    properties_string_max_length: number\n    session_recording: SessionRecordingOptions\n    session_idle_timeout_seconds: number\n    mask_all_element_attributes: boolean\n    mask_all_text: boolean\n    advanced_disable_decide: boolean\n    advanced_disable_toolbar_metrics: boolean\n    get_device_id: (uuid: string) => string\n    name: string\n    callback_fn: string\n    _onCapture: (eventName: string, eventData: CaptureResult) => void\n    _capture_metrics: boolean\n    capture_performance?: boolean\n    // Should only be used for testing. Could negatively impact performance.\n    disable_compression: boolean\n    bootstrap: {\n        distinctID?: string\n        isIdentifiedID?: boolean\n        featureFlags?: Record<string, boolean | string>\n        featureFlagPayloads?: Record<string, JsonType>\n    }\n    segment?: any\n}\n\nexport interface OptInOutCapturingOptions {\n    capture: (event: string, properties: Properties, options: CaptureOptions) => void\n    capture_event_name: string\n    capture_properties: Properties\n    enable_persistence: boolean\n    clear_persistence: boolean\n    persistence_type: 'cookie' | 'localStorage' | 'localStorage+cookie'\n    cookie_prefix: string\n    cookie_expiration: number\n    cross_subdomain_cookie: boolean\n    secure_cookie: boolean\n}\n\nexport interface isFeatureEnabledOptions {\n    send_event: boolean\n}\n\nexport interface SessionRecordingOptions {\n    blockClass?: string | RegExp\n    blockSelector?: string | null\n    ignoreClass?: string\n    maskTextClass?: string | RegExp\n    maskTextSelector?: string | null\n    maskTextFn?: ((text: string) => string) | null\n    maskAllInputs?: boolean\n    maskInputOptions?: MaskInputOptions\n    maskInputFn?: ((text: string, element?: HTMLElement) => string) | null\n    /** Modify the network request before it is captured. Returning null stops it being captured */\n    maskNetworkRequestFn?: ((url: NetworkRequest) => NetworkRequest | null | undefined) | null\n    slimDOMOptions?: SlimDOMOptions | 'all' | true\n    collectFonts?: boolean\n    inlineStylesheet?: boolean\n    recorderVersion?: 'v1' | 'v2'\n    recordCrossOriginIframes?: boolean\n}\n\nexport enum Compression {\n    GZipJS = 'gzip-js',\n    Base64 = 'base64',\n}\n\nexport interface XHROptions {\n    transport?: 'XHR' | 'sendBeacon'\n    method?: 'POST' | 'GET'\n    urlQueryArgs?: { compression: Compression }\n    verbose?: boolean\n    blob?: boolean\n    sendBeacon?: boolean\n}\n\nexport interface CaptureOptions extends XHROptions {\n    $set?: Properties /** used with $identify */\n    $set_once?: Properties /** used with $identify */\n    _batchKey?: string /** key of queue, e.g. 'sessionRecording' vs 'event' */\n    _metrics?: Properties\n    _noTruncate?: boolean /** if set, overrides and disables config.properties_string_max_length */\n    endpoint?: string /** defaults to '/e/' */\n    send_instantly?: boolean /** if set skips the batched queue */\n    timestamp?: Date\n}\n\nexport interface RetryQueueElement {\n    retryAt: Date\n    requestData: QueuedRequestData\n}\nexport interface QueuedRequestData {\n    url: string\n    data: Properties\n    options: CaptureOptions\n    headers?: Properties\n    callback?: RequestCallback\n    retriesPerformedSoFar?: number\n}\n\nexport interface XHRParams extends QueuedRequestData {\n    captureMetrics: CaptureMetrics\n    retryQueue: RetryQueue\n    onXHRError: (req: XMLHttpRequest) => void\n    timeout?: number\n}\n\nexport interface DecideResponse {\n    status: number\n    supportedCompression: Compression[]\n    config: {\n        enable_collect_everything: boolean\n    }\n    custom_properties: AutoCaptureCustomProperty[] // TODO: delete, not sent\n    featureFlags: Record<string, string | boolean>\n    featureFlagPayloads: Record<string, JsonType>\n    errorsWhileComputingFlags: boolean\n    autocapture_opt_out?: boolean\n    capturePerformance?: boolean\n    // this is currently in development and may have breaking changes without a major version bump\n    autocaptureExceptions?:\n        | boolean\n        | {\n              endpoint?: string\n              errors_to_ignore: string[]\n          }\n    sessionRecording?: {\n        endpoint?: string\n        consoleLogRecordingEnabled?: boolean\n        recorderVersion?: 'v1' | 'v2'\n    }\n    toolbarParams: ToolbarParams\n    editorParams?: ToolbarParams /** @deprecated, renamed to toolbarParams, still present on older API responses */\n    toolbarVersion: 'toolbar' /** @deprecated, moved to toolbarParams */\n    isAuthenticated: boolean\n    siteApps: { id: number; url: string }[]\n}\n\nexport type FeatureFlagsCallback = (flags: string[], variants: Record<string, string | boolean>) => void\n\n// TODO: delete custom_properties after changeless typescript refactor\nexport interface AutoCaptureCustomProperty {\n    name: string\n    css_selector: string\n    event_selectors: string[]\n}\n\nexport interface CompressionData {\n    data: string\n    compression?: Compression\n}\n\nexport interface GDPROptions {\n    capture?: (\n        event: string,\n        properties: Properties,\n        options: CaptureOptions\n    ) => void /** function used for capturing a PostHog event to record the opt-in action */\n    captureEventName?: string /** event name to be used for capturing the opt-in action */\n    captureProperties?: Properties /** set of properties to be captured along with the opt-in action */\n    /** persistence mechanism used */\n    persistenceType?: 'cookie' | 'localStorage' | 'localStorage+cookie'\n    persistencePrefix?: string /** [__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name */\n    cookieExpiration?: number /** number of days until the opt-in cookie expires */\n    crossSubdomainCookie?: boolean /** whether the opt-in cookie is set as cross-subdomain or not */\n    secureCookie?: boolean /** whether the opt-in cookie is set as secure or not */\n    respectDnt?: boolean\n    window?: Window\n}\n\nexport type RequestCallback = (response: Record<string, any>, data?: Properties) => void\n\nexport interface PersistentStore {\n    is_supported: () => boolean\n    error: (error: any) => void\n    parse: (name: string) => any\n    get: (name: string) => any\n    set: (name: string, value: any, expire_days?: number | null, cross_subdomain?: boolean, secure?: boolean) => void\n    remove: (name: string, cross_subdomain?: boolean) => void\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport type Breaker = {}\nexport type EventHandler = (event: Event) => boolean | void\n\nexport type ToolbarUserIntent = 'add-action' | 'edit-action'\nexport type ToolbarSource = 'url' | 'localstorage'\nexport type ToolbarVersion = 'toolbar'\n\n/* sync with posthog */\nexport interface ToolbarParams {\n    token?: string /** public posthog-js token */\n    temporaryToken?: string /** private temporary user token */\n    actionId?: number\n    userIntent?: ToolbarUserIntent\n    source?: ToolbarSource\n    toolbarVersion?: ToolbarVersion\n    instrument?: boolean\n    distinctId?: string\n    userEmail?: string\n    dataAttributes?: string[]\n    featureFlags?: Record<string, string | boolean>\n}\n\nexport interface PostData {\n    buffer?: BlobPart\n    compression?: Compression\n    data?: string\n}\n\nexport interface JSC {\n    (): void\n    [key: string]: (response: any) => void\n}\n\nexport type SnippetArrayItem = [method: string, ...args: any[]]\n\nexport type JsonType = string | number | boolean | null | { [key: string]: JsonType } | Array<JsonType>\n\n/** A feature that isn't publicly available yet.*/\nexport interface EarlyAccessFeature {\n    // Sync this with the backend's EarlyAccessFeatureSerializer!\n    name: string\n    description: string\n    stage: 'concept' | 'alpha' | 'beta'\n    documentationUrl: string | null\n    flagKey: string | null\n}\n\nexport type EarlyAccessFeatureCallback = (earlyAccessFeatures: EarlyAccessFeature[]) => void\n\nexport interface EarlyAccessFeatureResponse {\n    earlyAccessFeatures: EarlyAccessFeature[]\n}\n\nexport type NetworkRequest = {\n    url: string\n}\n\nexport interface Survey {\n    // Sync this with the backend's SurveySerializer!\n    name: string\n    description: string\n    type: SurveyType\n    linked_flag_key?: string | null\n    targeting_flag_key?: string | null\n    questions: SurveyQuestion[]\n    appearance?: SurveyAppearance | null\n    conditions?: { url?: string; selector?: string } | null\n    start_date?: string | null\n    end_date?: string | null\n}\n\nexport interface SurveyAppearance {\n    background_color?: string\n    button_color?: string\n    text_color?: string\n}\n\nexport enum SurveyType {\n    Popover = 'Popover',\n    Button = 'Button',\n    Email = 'Email',\n    FullScreen = 'Fullscreen',\n}\n\nexport interface SurveyQuestion {\n    type: SurveyQuestionType\n    question: string\n    required?: boolean\n    link?: boolean\n    choices?: string[]\n}\n\nexport enum SurveyQuestionType {\n    Open = 'open',\n    MultipleChoiceSingle = 'multiple_single',\n    MultipleChoiceMulti = 'multiple_multi',\n    NPS = 'nps',\n    Rating = 'rating',\n    Link = 'link',\n}\n\nexport type SurveyCallback = (surveys: Survey[]) => void\n\nexport interface SurveyResponse {\n    surveys: Survey[]\n}\n","import { _each, _HTTPBuildQuery, logger } from './utils'\nimport Config from './config'\nimport { PostData, XHROptions, XHRParams } from './types'\n\nexport const addParamsToURL = (\n    url: string,\n    urlQueryArgs: Record<string, any> | undefined,\n    parameterOptions: { ip?: boolean }\n): string => {\n    const args = urlQueryArgs || {}\n    args['ip'] = parameterOptions['ip'] ? 1 : 0\n    args['_'] = new Date().getTime().toString()\n    args['ver'] = Config.LIB_VERSION\n\n    const halves = url.split('?')\n    if (halves.length > 1) {\n        const params = halves[1].split('&')\n        for (const p of params) {\n            const key = p.split('=')[0]\n            if (args[key]) {\n                delete args[key]\n            }\n        }\n    }\n\n    const argSeparator = url.indexOf('?') > -1 ? '&' : '?'\n    return url + argSeparator + _HTTPBuildQuery(args)\n}\n\nexport const encodePostData = (data: PostData | Uint8Array, options: Partial<XHROptions>): string | BlobPart | null => {\n    if (options.blob && data.buffer) {\n        return new Blob([data.buffer], { type: 'text/plain' })\n    }\n\n    if (options.sendBeacon || options.blob) {\n        const body = encodePostData(data, { method: 'POST' }) as BlobPart\n        return new Blob([body], { type: 'application/x-www-form-urlencoded' })\n    }\n\n    if (options.method !== 'POST') {\n        return null\n    }\n\n    let body_data\n    const isUint8Array = (d: unknown): d is Uint8Array => Object.prototype.toString.call(d) === '[object Uint8Array]'\n    if (Array.isArray(data) || isUint8Array(data)) {\n        // TODO: eh? passing an Array here?\n        body_data = 'data=' + encodeURIComponent(data as any)\n    } else {\n        body_data = 'data=' + encodeURIComponent(data.data as string)\n    }\n\n    if ('compression' in data && data.compression) {\n        body_data += '&compression=' + data.compression\n    }\n\n    return body_data\n}\n\nexport const xhr = ({\n    url,\n    data,\n    headers,\n    options,\n    captureMetrics,\n    callback,\n    retriesPerformedSoFar,\n    retryQueue,\n    onXHRError,\n    timeout = 10000,\n}: XHRParams) => {\n    const req = new XMLHttpRequest()\n    req.open(options.method || 'GET', url, true)\n\n    const body = encodePostData(data, options)\n\n    captureMetrics.incr('_send_request')\n    captureMetrics.incr('_send_request_inflight')\n\n    _each(headers, function (headerValue, headerName) {\n        req.setRequestHeader(headerName, headerValue)\n    })\n\n    if (options.method === 'POST' && !options.blob) {\n        req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n    }\n\n    req.timeout = timeout\n    // send the ph_optout cookie\n    // withCredentials cannot be modified until after calling .open on Android and Mobile Safari\n    req.withCredentials = true\n    req.onreadystatechange = () => {\n        if (req.readyState === 4) {\n            captureMetrics.incr(`xhr-response`)\n            captureMetrics.incr(`xhr-response-${req.status}`)\n            captureMetrics.decr('_send_request_inflight')\n\n            // XMLHttpRequest.DONE == 4, except in safari 4\n            if (req.status === 200) {\n                if (callback) {\n                    let response\n                    try {\n                        response = JSON.parse(req.responseText)\n                    } catch (e) {\n                        logger.error(e)\n                        return\n                    }\n                    callback(response)\n                }\n            } else {\n                if (typeof onXHRError === 'function') {\n                    onXHRError(req)\n                }\n\n                // don't retry certain errors\n                if ([401, 403, 404, 500].indexOf(req.status) < 0) {\n                    retryQueue.enqueue({\n                        url,\n                        data,\n                        options,\n                        headers,\n                        retriesPerformedSoFar: (retriesPerformedSoFar || 0) + 1,\n                        callback,\n                    })\n                }\n\n                if (callback) {\n                    callback({ status: 0 })\n                }\n            }\n        }\n    }\n    req.send(body)\n}\n","import { RequestQueueScaffold } from './base-request-queue'\nimport { encodePostData, xhr } from './send-request'\nimport { CaptureMetrics } from './capture-metrics'\nimport { QueuedRequestData, RetryQueueElement } from './types'\nimport Config from './config'\n\nconst thirtyMinutes = 30 * 60 * 1000\n\n/**\n * Generates a jitter-ed exponential backoff delay in milliseconds\n *\n * The base value is 6 seconds, which is doubled with each retry\n * up to the maximum of 30 minutes\n *\n * Each value then has +/- 50% jitter\n *\n * Giving a range of 6 seconds up to 45 minutes\n */\nexport function pickNextRetryDelay(retriesPerformedSoFar: number): number {\n    const rawBackoffTime = 3000 * 2 ** retriesPerformedSoFar\n    const minBackoff = rawBackoffTime / 2\n    const cappedBackoffTime = Math.min(thirtyMinutes, rawBackoffTime)\n    const jitterFraction = Math.random() - 0.5 // A random number between -0.5 and 0.5\n    const jitter = jitterFraction * (cappedBackoffTime - minBackoff)\n    return Math.ceil(cappedBackoffTime + jitter)\n}\n\nexport class RetryQueue extends RequestQueueScaffold {\n    captureMetrics: CaptureMetrics\n    queue: RetryQueueElement[]\n    isPolling: boolean\n    areWeOnline: boolean\n    onXHRError: (failedRequest: XMLHttpRequest) => void\n\n    constructor(captureMetrics: CaptureMetrics, onXHRError: (failedRequest: XMLHttpRequest) => void) {\n        super()\n        this.captureMetrics = captureMetrics\n        this.isPolling = false\n        this.queue = []\n        this.areWeOnline = true\n        this.onXHRError = onXHRError\n\n        if (typeof window !== 'undefined' && 'onLine' in window.navigator) {\n            this.areWeOnline = window.navigator.onLine\n            window.addEventListener('online', () => {\n                this._handleWeAreNowOnline()\n            })\n            window.addEventListener('offline', () => {\n                this.areWeOnline = false\n            })\n        }\n    }\n\n    enqueue(requestData: QueuedRequestData): void {\n        const retriesPerformedSoFar = requestData.retriesPerformedSoFar || 0\n        if (retriesPerformedSoFar >= 10) {\n            return\n        }\n        const msToNextRetry = pickNextRetryDelay(retriesPerformedSoFar)\n        const retryAt = new Date(Date.now() + msToNextRetry)\n\n        this.queue.push({ retryAt, requestData })\n        console.warn(`Enqueued failed request for retry in ${msToNextRetry}`)\n        if (!this.isPolling) {\n            this.isPolling = true\n            this.poll()\n        }\n    }\n\n    poll(): void {\n        this._poller && clearTimeout(this._poller)\n        this._poller = setTimeout(() => {\n            if (this.areWeOnline && this.queue.length > 0) {\n                this.flush()\n            }\n            this.poll()\n        }, this._pollInterval) as any as number\n    }\n\n    flush(): void {\n        // using Date.now to make tests easier as recommended here https://codewithhugo.com/mocking-the-current-date-in-jest-tests/\n        const now = new Date(Date.now())\n        const toFlush = this.queue.filter(({ retryAt }) => retryAt < now)\n        if (toFlush.length > 0) {\n            this.queue = this.queue.filter(({ retryAt }) => retryAt >= now)\n            for (const { requestData } of toFlush) {\n                this._executeXhrRequest(requestData)\n            }\n        }\n    }\n\n    unload(): void {\n        if (this._poller) {\n            clearTimeout(this._poller)\n            this._poller = undefined\n        }\n        for (const { requestData } of this.queue) {\n            const { url, data, options } = requestData\n            try {\n                // we've had send beacon in place for at least 2 years\n                // eslint-disable-next-line compat/compat\n                window.navigator.sendBeacon(url, encodePostData(data, { ...options, sendBeacon: true }))\n            } catch (e) {\n                // Note sendBeacon automatically retries, and after the first retry it will loose reference to contextual `this`.\n                // This means in some cases `this.getConfig` will be undefined.\n                if (Config.DEBUG) {\n                    console.error(e)\n                }\n            }\n        }\n        this.queue = []\n    }\n\n    _executeXhrRequest({ url, data, options, headers, callback, retriesPerformedSoFar }: QueuedRequestData): void {\n        xhr({\n            url,\n            data: data || {},\n            options: options || {},\n            headers: headers || {},\n            retriesPerformedSoFar: retriesPerformedSoFar || 0,\n            callback,\n            captureMetrics: this.captureMetrics,\n            retryQueue: this,\n            onXHRError: this.onXHRError,\n        })\n    }\n\n    _handleWeAreNowOnline(): void {\n        this.areWeOnline = true\n        this.flush()\n    }\n}\n","import { PostHogPersistence, SESSION_ID } from './posthog-persistence'\nimport { sessionStore } from './storage'\nimport { _UUID } from './utils'\nimport { PostHogConfig } from './types'\n\nconst MAX_SESSION_IDLE_TIMEOUT = 30 * 60 // 30 mins\nconst MIN_SESSION_IDLE_TIMEOUT = 60 // 1 mins\nconst SESSION_LENGTH_LIMIT = 24 * 3600 * 1000 // 24 hours\n\nexport class SessionIdManager {\n    private config: Partial<PostHogConfig>\n    private persistence: PostHogPersistence\n    private _windowId: string | null | undefined\n    private _sessionId: string | null | undefined\n    private _window_id_storage_key: string\n    private _primary_window_exists_storage_key: string\n    private _sessionStartTimestamp: number | null\n    private _sessionActivityTimestamp: number | null\n    private _sessionTimeoutMs: number\n\n    constructor(config: Partial<PostHogConfig>, persistence: PostHogPersistence) {\n        this.config = config\n        this.persistence = persistence\n        this._windowId = undefined\n        this._sessionId = undefined\n        this._sessionStartTimestamp = null\n        this._sessionActivityTimestamp = null\n\n        const persistenceName = config['persistence_name'] || config['token']\n        let desiredTimeout = config['session_idle_timeout_seconds'] || MAX_SESSION_IDLE_TIMEOUT\n\n        if (typeof desiredTimeout !== 'number') {\n            console.warn('[PostHog] session_idle_timeout_seconds must be a number. Defaulting to 30 minutes.')\n            desiredTimeout = MAX_SESSION_IDLE_TIMEOUT\n        } else if (desiredTimeout > MAX_SESSION_IDLE_TIMEOUT) {\n            console.warn(\n                '[PostHog] session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead.'\n            )\n        } else if (desiredTimeout < MIN_SESSION_IDLE_TIMEOUT) {\n            console.warn(\n                '[PostHog] session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead.'\n            )\n        }\n\n        this._sessionTimeoutMs =\n            Math.min(Math.max(desiredTimeout, MIN_SESSION_IDLE_TIMEOUT), MAX_SESSION_IDLE_TIMEOUT) * 1000\n        this._window_id_storage_key = 'ph_' + persistenceName + '_window_id'\n        this._primary_window_exists_storage_key = 'ph_' + persistenceName + '_primary_window_exists'\n\n        // primary_window_exists is set when the DOM has been loaded and is cleared on unload\n        // if it exists here it means there was no unload which suggests this window is opened as a tab duplication, window.open, etc.\n        if (this._canUseSessionStorage()) {\n            const lastWindowId = sessionStore.parse(this._window_id_storage_key)\n\n            const primaryWindowExists = sessionStore.parse(this._primary_window_exists_storage_key)\n            if (lastWindowId && !primaryWindowExists) {\n                // Persist window from previous storage state\n                this._windowId = lastWindowId\n            } else {\n                // Wipe any reference to previous window id\n                sessionStore.remove(this._window_id_storage_key)\n            }\n            // Flag this session as having a primary window\n            sessionStore.set(this._primary_window_exists_storage_key, true)\n        }\n\n        this._listenToReloadWindow()\n    }\n\n    private _canUseSessionStorage(): boolean {\n        // We only want to use sessionStorage if persistence is enabled and not memory storage\n        return this.config.persistence !== 'memory' && !this.persistence.disabled && sessionStore.is_supported()\n    }\n\n    // Note: this tries to store the windowId in sessionStorage. SessionStorage is unique to the current window/tab,\n    // and persists page loads/reloads. So it's uniquely suited for storing the windowId. This function also respects\n    // when persistence is disabled (by user config) and when sessionStorage is not supported (it *should* be supported on all browsers),\n    // and in that case, it falls back to memory (which sadly, won't persist page loads)\n    private _setWindowId(windowId: string): void {\n        if (windowId !== this._windowId) {\n            this._windowId = windowId\n            if (this._canUseSessionStorage()) {\n                sessionStore.set(this._window_id_storage_key, windowId)\n            }\n        }\n    }\n\n    private _getWindowId(): string | null {\n        if (this._windowId) {\n            return this._windowId\n        }\n        if (this._canUseSessionStorage()) {\n            return sessionStore.parse(this._window_id_storage_key)\n        }\n        // New window id will be generated\n        return null\n    }\n\n    // Note: 'this.persistence.register' can be disabled in the config.\n    // In that case, this works by storing sessionId and the timestamp in memory.\n    private _setSessionId(\n        sessionId: string | null,\n        sessionActivityTimestamp: number | null,\n        sessionStartTimestamp: number | null\n    ): void {\n        if (\n            sessionId !== this._sessionId ||\n            sessionActivityTimestamp !== this._sessionActivityTimestamp ||\n            sessionStartTimestamp !== this._sessionStartTimestamp\n        ) {\n            this._sessionStartTimestamp = sessionStartTimestamp\n            this._sessionActivityTimestamp = sessionActivityTimestamp\n            this._sessionId = sessionId\n            this.persistence.register({\n                [SESSION_ID]: [sessionActivityTimestamp, sessionId, sessionStartTimestamp],\n            })\n        }\n    }\n\n    private _getSessionId(): [number, string, number] {\n        if (this._sessionId && this._sessionActivityTimestamp && this._sessionStartTimestamp) {\n            return [this._sessionActivityTimestamp, this._sessionId, this._sessionStartTimestamp]\n        }\n        const sessionId = this.persistence.props[SESSION_ID]\n\n        if (Array.isArray(sessionId) && sessionId.length === 2) {\n            // Storage does not yet have a session start time. Add the last activity timestamp as the start time\n            sessionId.push(sessionId[0])\n        }\n\n        return sessionId || [0, null, 0]\n    }\n\n    // Resets the session id by setting it to null. On the subsequent call to checkAndGetSessionAndWindowId,\n    // new ids will be generated.\n    resetSessionId(): void {\n        this._setSessionId(null, null, null)\n    }\n\n    /*\n     * Listens to window unloads and removes the primaryWindowExists key from sessionStorage.\n     * Reloaded or fresh tabs created after a DOM unloads (reloading the same tab) WILL NOT have this primaryWindowExists flag in session storage.\n     * Cloned sessions (new tab, tab duplication, window.open(), ...) WILL have this primaryWindowExists flag in their copied session storage.\n     * We conditionally check the primaryWindowExists value in the constructor to decide if the window id in the last session storage should be carried over.\n     */\n    private _listenToReloadWindow(): void {\n        window.addEventListener('beforeunload', () => {\n            if (this._canUseSessionStorage()) {\n                sessionStore.remove(this._primary_window_exists_storage_key)\n            }\n        })\n    }\n\n    /*\n     * This function returns the current sessionId and windowId. It should be used to\n     * access these values over directly calling `._sessionId` or `._windowId`. In addition\n     * to returning the sessionId and windowId, this function also manages cycling the\n     * sessionId and windowId when appropriate by doing the following:\n     *\n     * 1. If the sessionId or windowId is not set, it will generate a new one and store it.\n     * 2. If the readOnly param is set to false, it will:\n     *    a. Check if it has been > SESSION_CHANGE_THRESHOLD since the last call with this flag set.\n     *       If so, it will generate a new sessionId and store it.\n     *    b. Update the timestamp stored with the sessionId to ensure the current session is extended\n     *       for the appropriate amount of time.\n     *\n     * @param {boolean} readOnly (optional) Defaults to False. Should be set to True when the call to the function should not extend or cycle the session (e.g. being called for non-user generated events)\n     * @param {Number} timestamp (optional) Defaults to the current time. The timestamp to be stored with the sessionId (used when determining if a new sessionId should be generated)\n     */\n    checkAndGetSessionAndWindowId(readOnly = false, _timestamp: number | null = null) {\n        const timestamp = _timestamp || new Date().getTime()\n\n        // eslint-disable-next-line prefer-const\n        let [lastTimestamp, sessionId, startTimestamp] = this._getSessionId()\n        let windowId = this._getWindowId()\n\n        const sessionPastMaximumLength =\n            startTimestamp && startTimestamp > 0 && Math.abs(timestamp - startTimestamp) > SESSION_LENGTH_LIMIT\n\n        if (\n            !sessionId ||\n            (!readOnly && Math.abs(timestamp - lastTimestamp) > this._sessionTimeoutMs) ||\n            sessionPastMaximumLength\n        ) {\n            sessionId = _UUID()\n            windowId = _UUID()\n            startTimestamp = timestamp\n        } else if (!windowId) {\n            windowId = _UUID()\n        }\n\n        const newTimestamp = lastTimestamp === 0 || !readOnly || sessionPastMaximumLength ? timestamp : lastTimestamp\n        const sessionStartTimestamp = startTimestamp === 0 ? new Date().getTime() : startTimestamp\n\n        this._setWindowId(windowId)\n        this._setSessionId(sessionId, newTimestamp, sessionStartTimestamp)\n\n        return {\n            sessionId,\n            windowId,\n            sessionStartTimestamp,\n        }\n    }\n}\n","/**\n * Integrate Sentry with PostHog. This will add a direct link to the person in Sentry, and an $exception event in PostHog\n *\n * ### Usage\n *\n *     Sentry.init({\n *          dsn: 'https://example',\n *          integrations: [\n *              new posthog.SentryIntegration(posthog)\n *          ]\n *     })\n *\n * @param {Object} [posthog] The posthog object\n * @param {string} [organization] Optional: The Sentry organization, used to send a direct link from PostHog to Sentry\n * @param {Number} [projectId] Optional: The Sentry project id, used to send a direct link from PostHog to Sentry\n * @param {string} [prefix] Optional: Url of a self-hosted sentry instance (default: https://sentry.io/organizations/)\n */\n\nimport { PostHog } from '../posthog-core'\nimport { ErrorProperties } from './exceptions/error-conversion'\n\n// NOTE - we can't import from @sentry/types because it changes frequently and causes clashes\n// We only use a small subset of the types, so we can just define the integration overall and use any for the rest\n\n// import {\n//     Event as _SentryEvent,\n//     EventProcessor as _SentryEventProcessor,\n//     Hub as _SentryHub,\n//     Integration as _SentryIntegration,\n// } from '@sentry/types'\n\n// Uncomment the above and comment the below to get type checking for development\n\ntype _SentryEvent = any\ntype _SentryEventProcessor = any\ntype _SentryHub = any\n\ninterface _SentryIntegration {\n    name: string\n    setupOnce(addGlobalEventProcessor: (callback: _SentryEventProcessor) => void, getCurrentHub: () => _SentryHub): void\n}\n\ninterface SentryExceptionProperties {\n    $sentry_event_id: any\n    $sentry_exception: any\n    $sentry_exception_message: any\n    $sentry_exception_type: any\n    $sentry_tags: any\n    $sentry_url?: string\n}\n\nexport class SentryIntegration implements _SentryIntegration {\n    name: string\n\n    setupOnce: (\n        addGlobalEventProcessor: (callback: _SentryEventProcessor) => void,\n        getCurrentHub: () => _SentryHub\n    ) => void\n\n    constructor(_posthog: PostHog, organization?: string, projectId?: number, prefix?: string) {\n        // setupOnce gets called by Sentry when it intializes the plugin\n        this.name = 'posthog-js'\n        this.setupOnce = function (addGlobalEventProcessor: (callback: _SentryEventProcessor) => void) {\n            addGlobalEventProcessor((event: _SentryEvent) => {\n                if (event.level !== 'error' || !_posthog.__loaded) return event\n                if (!event.tags) event.tags = {}\n\n                const host = _posthog.config.ui_host || _posthog.config.api_host\n                event.tags['PostHog Person URL'] = host + '/person/' + _posthog.get_distinct_id()\n                if (_posthog.sessionRecordingStarted()) {\n                    event.tags['PostHog Recording URL'] = _posthog.get_session_replay_url({ withTimestamp: true })\n                }\n\n                const exceptions = event.exception?.values || []\n\n                const data: SentryExceptionProperties & ErrorProperties = {\n                    // PostHog Exception Properties,\n                    $exception_message: exceptions[0]?.value,\n                    $exception_type: exceptions[0]?.type,\n                    $exception_personURL: host + '/person/' + _posthog.get_distinct_id(),\n                    // Sentry Exception Properties\n                    $sentry_event_id: event.event_id,\n                    $sentry_exception: event.exception,\n                    $sentry_exception_message: exceptions[0]?.value,\n                    $sentry_exception_type: exceptions[0]?.type,\n                    $sentry_tags: event.tags,\n                }\n\n                if (organization && projectId)\n                    data['$sentry_url'] =\n                        (prefix || 'https://sentry.io/organizations/') +\n                        organization +\n                        '/issues/?project=' +\n                        projectId +\n                        '&query=' +\n                        event.event_id\n                _posthog.capture('$exception', data)\n                return event\n            })\n        }\n    }\n}\n","/**\n * Extend Segment with extra PostHog JS functionality. Required for things like Recordings and feature flags to work correctly.\n *\n * ### Usage\n *\n *  ```js\n *  // After your standard segment anyalytics install\n *  analytics.load(\"GOEDfA21zZTtR7clsBuDvmBKAtAdZ6Np\");\n *\n *  analytics.ready(() => {\n *    posthog.init('<posthog-api-key>', {\n *      capture_pageview: false,\n *      segment: window.analytics, // NOTE: Be sure to use window.analytics here!\n *    });\n *    window.analytics.page();\n *  })\n *  ```\n */\nimport { PostHog } from '../posthog-core'\n\n// Loosely based on https://github.com/segmentio/analytics-next/blob/master/packages/core/src/plugins/index.ts\ninterface SegmentPluginContext {\n    event: {\n        event: string\n        userId?: string\n        anonymousId?: string\n        properties: any\n    }\n}\n\ninterface SegmentPlugin {\n    name: string\n    version: string\n    type: 'enrichment'\n    isLoaded: () => boolean\n    load: (ctx: SegmentPluginContext, instance: any, config?: any) => Promise<unknown>\n    unload?: (ctx: SegmentPluginContext, instance: any) => Promise<unknown> | unknown\n    ready?: () => Promise<unknown>\n    track?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    identify?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    page?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    group?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    alias?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    screen?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n}\n\nexport const createSegmentIntegration = (posthog: PostHog): SegmentPlugin => {\n    if (!Promise || !Promise.resolve) {\n        console.warn('This browser does not have Promise support, and can not use the segment integration')\n    }\n\n    const enrichEvent = (ctx: SegmentPluginContext, eventName: string) => {\n        if (!ctx.event.userId && ctx.event.anonymousId !== posthog.get_distinct_id()) {\n            // This is our only way of detecting that segment's analytics.reset() has been called so we also call it\n            posthog.reset()\n        }\n        if (ctx.event.userId && ctx.event.userId !== posthog.get_distinct_id()) {\n            posthog.register({\n                distinct_id: ctx.event.userId,\n            })\n            posthog.reloadFeatureFlags()\n        }\n\n        const additionalProperties = posthog._calculate_event_properties(eventName, ctx.event.properties)\n        ctx.event.properties = Object.assign({}, additionalProperties, ctx.event.properties)\n        return ctx\n    }\n\n    return {\n        name: 'PostHog JS',\n        type: 'enrichment',\n        version: '1.0.0',\n        isLoaded: () => true,\n        // check and early return above\n        // eslint-disable-next-line compat/compat\n        load: () => Promise.resolve(),\n        track: (ctx) => enrichEvent(ctx, ctx.event.event),\n        page: (ctx) => enrichEvent(ctx, '$pageview'),\n        identify: (ctx) => enrichEvent(ctx, '$identify'),\n        screen: (ctx) => enrichEvent(ctx, '$screen'),\n    }\n}\n","import { _UUID } from './utils'\n\nexport class PageViewIdManager {\n    _pageViewId: string | undefined\n\n    _seenFirstPageView = false\n\n    onPageview(): void {\n        // As the first $pageview event may come after a different event,\n        // we only reset the ID _after_ the second $pageview event.\n        if (this._seenFirstPageView) {\n            this._pageViewId = _UUID()\n        }\n        this._seenFirstPageView = true\n    }\n\n    getPageViewId(): string {\n        if (!this._pageViewId) {\n            this._pageViewId = _UUID()\n        }\n\n        return this._pageViewId\n    }\n}\n","export function isEvent(candidate: unknown): candidate is Event {\n    return typeof Event !== 'undefined' && isInstanceOf(candidate, Event)\n}\n\nexport function isPlainObject(candidate: unknown): candidate is Record<string, unknown> {\n    return isBuiltin(candidate, 'Object')\n}\n\nexport function isInstanceOf(candidate: unknown, base: any): boolean {\n    try {\n        return candidate instanceof base\n    } catch (_e) {\n        return false\n    }\n}\n\nexport function isPrimitive(\n    candidate: unknown\n): candidate is number | string | boolean | bigint | symbol | null | undefined {\n    return candidate === null || (typeof candidate !== 'object' && typeof candidate !== 'function')\n}\n\nexport function isError(candidate: unknown): candidate is Error {\n    switch (Object.prototype.toString.call(candidate)) {\n        case '[object Error]':\n        case '[object Exception]':\n        case '[object DOMException]':\n            return true\n        default:\n            return isInstanceOf(candidate, Error)\n    }\n}\n\nexport function isErrorEvent(event: string | Error | Event): event is ErrorEvent {\n    return isBuiltin(event, 'ErrorEvent')\n}\n\nexport function isErrorWithStack(candidate: unknown): candidate is Error {\n    return 'stack' in (candidate as Error)\n}\n\nexport function isBuiltin(candidate: unknown, className: string): boolean {\n    return Object.prototype.toString.call(candidate) === `[object ${className}]`\n}\n\nexport function isDOMException(candidate: unknown): boolean {\n    return isBuiltin(candidate, 'DOMException')\n}\n\nexport function isDOMError(candidate: unknown): boolean {\n    return isBuiltin(candidate, 'DOMError')\n}\n","// copied and adapted from https://github.com/getsentry/sentry-javascript/blob/41fef4b10f3a644179b77985f00f8696c908539f/packages/browser/src/stack-parsers.ts\n// open source\n\n// This was originally forked from https://github.com/csnover/TraceKit, and was largely\n// re-written as part of raven - js.\n//\n// This code was later copied to the JavaScript mono - repo and further modified and\n// refactored over the years.\n\n// Copyright (c) 2013 Onur Can Cakmak onur.cakmak@gmail.com and all TraceKit contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this\n// software and associated documentation files(the 'Software'), to deal in the Software\n// without restriction, including without limitation the rights to use, copy, modify,\n// merge, publish, distribute, sublicense, and / or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to the following\n// conditions:\n//\n// The above copyright notice and this permission notice shall be included in all copies\n// or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF\n// CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE\n// OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nconst WEBPACK_ERROR_REGEXP = /\\(error: (.*)\\)/\nconst STACKTRACE_FRAME_LIMIT = 50\n\nconst UNKNOWN_FUNCTION = '?'\n\nconst OPERA10_PRIORITY = 10\nconst OPERA11_PRIORITY = 20\nconst CHROME_PRIORITY = 30\nconst WINJS_PRIORITY = 40\nconst GECKO_PRIORITY = 50\n\nexport interface StackFrame {\n    filename?: string\n    function?: string\n    module?: string\n    platform?: string\n    lineno?: number\n    colno?: number\n    abs_path?: string\n    context_line?: string\n    pre_context?: string[]\n    post_context?: string[]\n    in_app?: boolean\n    instruction_addr?: string\n    addr_mode?: string\n    vars?: { [key: string]: any }\n    debug_id?: string\n}\n\nfunction createFrame(filename: string, func: string, lineno?: number, colno?: number): StackFrame {\n    const frame: StackFrame = {\n        filename,\n        function: func,\n        in_app: true, // All browser frames are considered in_app\n    }\n\n    if (lineno !== undefined) {\n        frame.lineno = lineno\n    }\n\n    if (colno !== undefined) {\n        frame.colno = colno\n    }\n\n    return frame\n}\n\nexport type StackParser = (stack: string, skipFirst?: number) => StackFrame[]\nexport type StackLineParserFn = (line: string) => StackFrame | undefined\nexport type StackLineParser = [number, StackLineParserFn]\n\n// Chromium based browsers: Chrome, Brave, new Opera, new Edge\nconst chromeRegex =\n    /^\\s*at (?:(.+?\\)(?: \\[.+\\])?|.*?) ?\\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\\/)?.*?)(?::(\\d+))?(?::(\\d+))?\\)?\\s*$/i\nconst chromeEvalRegex = /\\((\\S*)(?::(\\d+))(?::(\\d+))\\)/\n\nconst chrome: StackLineParserFn = (line) => {\n    const parts = chromeRegex.exec(line)\n\n    if (parts) {\n        const isEval = parts[2] && parts[2].indexOf('eval') === 0 // start of line\n\n        if (isEval) {\n            const subMatch = chromeEvalRegex.exec(parts[2])\n\n            if (subMatch) {\n                // throw out eval line/column and use top-most line/column number\n                parts[2] = subMatch[1] // url\n                parts[3] = subMatch[2] // line\n                parts[4] = subMatch[3] // column\n            }\n        }\n\n        // Kamil: One more hack won't hurt us right? Understanding and adding more rules on top of these regexps right now\n        // would be way too time consuming. (TODO: Rewrite whole RegExp to be more readable)\n        const [func, filename] = extractSafariExtensionDetails(parts[1] || UNKNOWN_FUNCTION, parts[2])\n\n        return createFrame(filename, func, parts[3] ? +parts[3] : undefined, parts[4] ? +parts[4] : undefined)\n    }\n\n    return\n}\n\nexport const chromeStackLineParser: StackLineParser = [CHROME_PRIORITY, chrome]\n\n// gecko regex: `(?:bundle|\\d+\\.js)`: `bundle` is for react native, `\\d+\\.js` also but specifically for ram bundles because it\n// generates filenames without a prefix like `file://` the filenames in the stacktrace are just 42.js\n// We need this specific case for now because we want no other regex to match.\nconst geckoREgex =\n    /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)?((?:[-a-z]+)?:\\/.*?|\\[native code\\]|[^@]*(?:bundle|\\d+\\.js)|\\/[\\w\\-. /=]+)(?::(\\d+))?(?::(\\d+))?\\s*$/i\nconst geckoEvalRegex = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i\n\nconst gecko: StackLineParserFn = (line) => {\n    const parts = geckoREgex.exec(line)\n\n    if (parts) {\n        const isEval = parts[3] && parts[3].indexOf(' > eval') > -1\n        if (isEval) {\n            const subMatch = geckoEvalRegex.exec(parts[3])\n\n            if (subMatch) {\n                // throw out eval line/column and use top-most line number\n                parts[1] = parts[1] || 'eval'\n                parts[3] = subMatch[1]\n                parts[4] = subMatch[2]\n                parts[5] = '' // no column when eval\n            }\n        }\n\n        let filename = parts[3]\n        let func = parts[1] || UNKNOWN_FUNCTION\n        ;[func, filename] = extractSafariExtensionDetails(func, filename)\n\n        return createFrame(filename, func, parts[4] ? +parts[4] : undefined, parts[5] ? +parts[5] : undefined)\n    }\n\n    return\n}\n\nexport const geckoStackLineParser: StackLineParser = [GECKO_PRIORITY, gecko]\n\nconst winjsRegex = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:[-a-z]+):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i\n\nconst winjs: StackLineParserFn = (line) => {\n    const parts = winjsRegex.exec(line)\n\n    return parts\n        ? createFrame(parts[2], parts[1] || UNKNOWN_FUNCTION, +parts[3], parts[4] ? +parts[4] : undefined)\n        : undefined\n}\n\nexport const winjsStackLineParser: StackLineParser = [WINJS_PRIORITY, winjs]\n\nconst opera10Regex = / line (\\d+).*script (?:in )?(\\S+)(?:: in function (\\S+))?$/i\n\nconst opera10: StackLineParserFn = (line) => {\n    const parts = opera10Regex.exec(line)\n    return parts ? createFrame(parts[2], parts[3] || UNKNOWN_FUNCTION, +parts[1]) : undefined\n}\n\nexport const opera10StackLineParser: StackLineParser = [OPERA10_PRIORITY, opera10]\n\nconst opera11Regex = / line (\\d+), column (\\d+)\\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\\(.*\\))? in (.*):\\s*$/i\n\nconst opera11: StackLineParserFn = (line) => {\n    const parts = opera11Regex.exec(line)\n    return parts ? createFrame(parts[5], parts[3] || parts[4] || UNKNOWN_FUNCTION, +parts[1], +parts[2]) : undefined\n}\n\nexport const opera11StackLineParser: StackLineParser = [OPERA11_PRIORITY, opera11]\n\nexport const defaultStackLineParsers = [chromeStackLineParser, geckoStackLineParser, winjsStackLineParser]\n\nexport function reverse(stack: ReadonlyArray<StackFrame>): StackFrame[] {\n    if (!stack.length) {\n        return []\n    }\n\n    const localStack = stack.slice(0, STACKTRACE_FRAME_LIMIT)\n\n    localStack.reverse()\n\n    return localStack.map((frame) => ({\n        ...frame,\n        filename: frame.filename || localStack[localStack.length - 1].filename,\n        function: frame.function || '?',\n    }))\n}\n\nexport function createStackParser(...parsers: StackLineParser[]): StackParser {\n    const sortedParsers = parsers.sort((a, b) => a[0] - b[0]).map((p) => p[1])\n\n    return (stack: string, skipFirst = 0): StackFrame[] => {\n        const frames: StackFrame[] = []\n        const lines = stack.split('\\n')\n\n        for (let i = skipFirst; i < lines.length; i++) {\n            const line = lines[i]\n            // Ignore lines over 1kb as they are unlikely to be stack frames.\n            // Many of the regular expressions use backtracking which results in run time that increases exponentially with\n            // input size. Huge strings can result in hangs/Denial of Service:\n            // https://github.com/getsentry/sentry-javascript/issues/2286\n            if (line.length > 1024) {\n                continue\n            }\n\n            // https://github.com/getsentry/sentry-javascript/issues/5459\n            // Remove webpack (error: *) wrappers\n            const cleanedLine = WEBPACK_ERROR_REGEXP.test(line) ? line.replace(WEBPACK_ERROR_REGEXP, '$1') : line\n\n            // https://github.com/getsentry/sentry-javascript/issues/7813\n            // Skip Error: lines\n            if (cleanedLine.match(/\\S*Error: /)) {\n                continue\n            }\n\n            for (const parser of sortedParsers) {\n                const frame = parser(cleanedLine)\n\n                if (frame) {\n                    frames.push(frame)\n                    break\n                }\n            }\n\n            if (frames.length >= STACKTRACE_FRAME_LIMIT) {\n                break\n            }\n        }\n\n        return reverse(frames)\n    }\n}\n\nexport const defaultStackParser = createStackParser(...defaultStackLineParsers)\n\n/**\n * Safari web extensions, starting version unknown, can produce \"frames-only\" stacktraces.\n * What it means, is that instead of format like:\n *\n * Error: wat\n *   at function@url:row:col\n *   at function@url:row:col\n *   at function@url:row:col\n *\n * it produces something like:\n *\n *   function@url:row:col\n *   function@url:row:col\n *   function@url:row:col\n *\n * Because of that, it won't be captured by `chrome` RegExp and will fall into `Gecko` branch.\n * This function is extracted so that we can use it in both places without duplicating the logic.\n * Unfortunately \"just\" changing RegExp is too complicated now and making it pass all tests\n * and fix this case seems like an impossible, or at least way too time-consuming task.\n */\nconst extractSafariExtensionDetails = (func: string, filename: string): [string, string] => {\n    const isSafariExtension = func.indexOf('safari-extension') !== -1\n    const isSafariWebExtension = func.indexOf('safari-web-extension') !== -1\n\n    return isSafariExtension || isSafariWebExtension\n        ? [\n              func.indexOf('@') !== -1 ? func.split('@')[0] : UNKNOWN_FUNCTION,\n              isSafariExtension ? `safari-extension:${filename}` : `safari-web-extension:${filename}`,\n          ]\n        : [func, filename]\n}\n","import {\n    isDOMError,\n    isDOMException,\n    isError,\n    isErrorEvent,\n    isErrorWithStack,\n    isEvent,\n    isPlainObject,\n    isPrimitive,\n} from './type-checking'\nimport { defaultStackParser, StackFrame } from './stack-trace'\n\n/**\n * based on the very wonderful MIT licensed Sentry SDK\n */\n\nconst ERROR_TYPES_PATTERN =\n    /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i\n\nexport type ErrorEventArgs = [\n    event: string | Event,\n    source?: string | undefined,\n    lineno?: number | undefined,\n    colno?: number | undefined,\n    error?: Error | undefined\n]\n\nexport interface ErrorProperties {\n    $exception_type: string\n    $exception_message: string\n    $exception_source?: string\n    $exception_lineno?: number\n    $exception_colno?: number\n    $exception_DOMException_code?: string\n    $exception_is_synthetic?: boolean\n    $exception_stack_trace_raw?: string\n    $exception_handled?: boolean\n    $exception_personURL?: string\n}\n\nconst reactMinifiedRegexp = /Minified React error #\\d+;/i\n\nfunction getPopSize(ex: Error & { framesToPop?: number }): number {\n    if (ex) {\n        if (typeof ex.framesToPop === 'number') {\n            return ex.framesToPop\n        }\n\n        if (reactMinifiedRegexp.test(ex.message)) {\n            return 1\n        }\n    }\n\n    return 0\n}\n\nexport function parseStackFrames(ex: Error & { framesToPop?: number; stacktrace?: string }): StackFrame[] {\n    // Access and store the stacktrace property before doing ANYTHING\n    // else to it because Opera is not very good at providing it\n    // reliably in other circumstances.\n    const stacktrace = ex.stacktrace || ex.stack || ''\n\n    const popSize = getPopSize(ex)\n\n    try {\n        return defaultStackParser(stacktrace, popSize)\n    } catch (e) {\n        // no-empty\n    }\n\n    return []\n}\n\nfunction errorPropertiesFromError(error: Error): ErrorProperties {\n    const frames = parseStackFrames(error)\n\n    return {\n        $exception_type: error.name,\n        $exception_message: error.message,\n        $exception_stack_trace_raw: JSON.stringify(frames),\n    }\n}\n\nfunction errorPropertiesFromString(candidate: string): ErrorProperties {\n    return {\n        $exception_type: 'Error',\n        $exception_message: candidate,\n    }\n}\n\n/**\n * Given any captured exception, extract its keys and create a sorted\n * and truncated list that will be used inside the event message.\n * eg. `Non-error exception captured with keys: foo, bar, baz`\n */\nfunction extractExceptionKeysForMessage(exception: Record<string, unknown>, maxLength = 40): string {\n    const keys = Object.keys(exception)\n    keys.sort()\n\n    if (!keys.length) {\n        return '[object has no keys]'\n    }\n\n    for (let i = keys.length; i > 0; i--) {\n        const serialized = keys.slice(0, i).join(', ')\n        if (serialized.length > maxLength) {\n            continue\n        }\n        if (i === keys.length) {\n            return serialized\n        }\n        return serialized.length <= maxLength ? serialized : `${serialized.slice(0, maxLength)}...`\n    }\n\n    return ''\n}\n\nfunction errorPropertiesFromObject(candidate: Record<string, unknown>): ErrorProperties {\n    return {\n        $exception_type: isEvent(candidate) ? candidate.constructor.name : 'Error',\n        $exception_message: `Non-Error ${'exception'} captured with keys: ${extractExceptionKeysForMessage(candidate)}`,\n    }\n}\n\nexport function errorToProperties([event, source, lineno, colno, error]: ErrorEventArgs): ErrorProperties {\n    // exception type and message are not optional but, it's useful to start off without them enforced\n    let errorProperties: Omit<ErrorProperties, '$exception_type' | '$exception_message'> & {\n        $exception_type?: string\n        $exception_message?: string\n    } = {}\n\n    if (error === undefined && typeof event === 'string') {\n        let name = 'Error'\n        let message = event\n        const groups = event.match(ERROR_TYPES_PATTERN)\n        if (groups) {\n            name = groups[1]\n            message = groups[2]\n        }\n        errorProperties = {\n            $exception_type: name,\n            $exception_message: message,\n        }\n    }\n\n    const candidate = error || event\n\n    if (isDOMError(candidate) || isDOMException(candidate)) {\n        // https://developer.mozilla.org/en-US/docs/Web/API/DOMError\n        // https://developer.mozilla.org/en-US/docs/Web/API/DOMException\n\n        const domException = candidate as unknown as DOMException\n\n        if (isErrorWithStack(candidate)) {\n            errorProperties = errorPropertiesFromError(candidate as Error)\n        } else {\n            const name = domException.name || (isDOMError(domException) ? 'DOMError' : 'DOMException')\n            const message = domException.message ? `${name}: ${domException.message}` : name\n            errorProperties = errorPropertiesFromString(message)\n            errorProperties.$exception_type = isDOMError(domException) ? 'DOMError' : 'DOMException'\n            errorProperties.$exception_message = errorProperties.$exception_message || message\n        }\n        if ('code' in domException) {\n            errorProperties['$exception_DOMException_code'] = `${domException.code}`\n        }\n    } else if (isErrorEvent(candidate as ErrorEvent) && (candidate as ErrorEvent).error) {\n        errorProperties = errorPropertiesFromError((candidate as ErrorEvent).error as Error)\n    } else if (isError(candidate)) {\n        errorProperties = errorPropertiesFromError(candidate)\n    } else if (isPlainObject(candidate) || isEvent(candidate)) {\n        // group these by using the keys available on the object\n        const objectException = candidate as Record<string, unknown>\n        errorProperties = errorPropertiesFromObject(objectException)\n        errorProperties.$exception_is_synthetic = true\n    } else {\n        // If none of previous checks were valid, then it must be a string\n        errorProperties.$exception_type = errorProperties.$exception_type || 'Error'\n        errorProperties.$exception_message = errorProperties.$exception_message || candidate\n        errorProperties.$exception_is_synthetic = true\n    }\n\n    return {\n        ...errorProperties,\n        // now we make sure the mandatory fields that were made optional are present\n        $exception_type: errorProperties.$exception_type || 'UnknownErrorType',\n        $exception_message: errorProperties.$exception_message || '',\n        ...(source\n            ? {\n                  $exception_source: source, // TODO get this from URL if not present\n              }\n            : {}),\n        ...(lineno ? { $exception_lineno: lineno } : {}),\n        ...(colno ? { $exception_colno: colno } : {}),\n    }\n}\n\nexport function unhandledRejectionToProperties([ev]: [ev: PromiseRejectionEvent]): ErrorProperties {\n    // dig the object of the rejection out of known event types\n    let error: unknown = ev\n    try {\n        // PromiseRejectionEvents store the object of the rejection under 'reason'\n        // see https://developer.mozilla.org/en-US/docs/Web/API/PromiseRejectionEvent\n        if ('reason' in ev) {\n            error = ev.reason\n        }\n        // something, somewhere, (likely a browser extension) effectively casts PromiseRejectionEvents\n        // to CustomEvents, moving the `promise` and `reason` attributes of the PRE into\n        // the CustomEvent's `detail` attribute, since they're not part of CustomEvent's spec\n        // see https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent and\n        // https://github.com/getsentry/sentry-javascript/issues/2380\n        else if ('detail' in ev && 'reason' in (ev as any).detail) {\n            error = (ev as any).detail.reason\n        }\n    } catch (_oO) {\n        // no-empty\n    }\n\n    // exception type and message are not optional but, it's useful to start off without them enforced\n    let errorProperties: Omit<ErrorProperties, '$exception_type' | '$exception_message'> & {\n        $exception_type?: string\n        $exception_message?: string\n    } = {}\n    if (isPrimitive(error)) {\n        errorProperties = {\n            $exception_message: `Non-Error promise rejection captured with value: ${String(error)}`,\n        }\n    } else {\n        errorProperties = errorToProperties([error as string | Event])\n    }\n    errorProperties.$exception_handled = false\n\n    return {\n        ...errorProperties,\n        // now we make sure the mandatory fields that were made optional are present\n        $exception_type: (errorProperties.$exception_type = 'UnhandledRejection'),\n        $exception_message: (errorProperties.$exception_message =\n            errorProperties.$exception_message || (ev as any).reason || String(error)),\n    }\n}\n","import { window } from '../../utils'\nimport { PostHog } from '../../posthog-core'\nimport { DecideResponse, Properties } from '../../types'\nimport { ErrorEventArgs, ErrorProperties, errorToProperties, unhandledRejectionToProperties } from './error-conversion'\nimport { isPrimitive } from './type-checking'\n\nconst EXCEPTION_INGESTION_ENDPOINT = '/e/'\n\nexport class ExceptionObserver {\n    instance: PostHog\n    remoteEnabled: boolean | undefined\n    private originalOnErrorHandler: typeof window['onerror'] | null | undefined = undefined\n    private originalOnUnhandledRejectionHandler: typeof window['onunhandledrejection'] | null | undefined = undefined\n\n    private errorsToIgnore: RegExp[] = []\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    private debugLog(...args: any[]) {\n        if (this.instance.get_config('debug')) {\n            console.log('PostHog.js [PostHog.ExceptionObserver]', ...args)\n        }\n    }\n\n    startCapturing() {\n        if (!this.isEnabled() || (window.onerror as any)?.__POSTHOG_INSTRUMENTED__) {\n            return\n        }\n\n        try {\n            this.originalOnErrorHandler = window.onerror\n\n            window.onerror = function (this: ExceptionObserver, ...args: ErrorEventArgs): boolean {\n                this.captureException(args)\n\n                if (this.originalOnErrorHandler) {\n                    // eslint-disable-next-line prefer-rest-params\n                    return this.originalOnErrorHandler.apply(this, args)\n                }\n\n                return false\n            }.bind(this)\n            ;(window.onerror as any).__POSTHOG_INSTRUMENTED__ = true\n\n            this.originalOnUnhandledRejectionHandler = window.onunhandledrejection\n\n            window.onunhandledrejection = function (\n                this: ExceptionObserver,\n                ...args: [ev: PromiseRejectionEvent]\n            ): boolean {\n                const errorProperties: ErrorProperties = unhandledRejectionToProperties(args)\n                this.sendExceptionEvent(errorProperties)\n\n                if (this.originalOnUnhandledRejectionHandler) {\n                    // eslint-disable-next-line prefer-rest-params\n                    return this.originalOnUnhandledRejectionHandler.apply(window, args)\n                }\n\n                return true\n            }.bind(this)\n            ;(window.onunhandledrejection as any).__POSTHOG_INSTRUMENTED__ = true\n        } catch (e) {\n            console.error('PostHog failed to start exception autocapture', e)\n            this.stopCapturing()\n        }\n    }\n\n    stopCapturing() {\n        if (this.originalOnErrorHandler !== undefined) {\n            window.onerror = this.originalOnErrorHandler\n            this.originalOnErrorHandler = null\n        }\n        delete (window.onerror as any)?.__POSTHOG_INSTRUMENTED__\n\n        if (this.originalOnUnhandledRejectionHandler !== undefined) {\n            window.onunhandledrejection = this.originalOnUnhandledRejectionHandler\n            this.originalOnUnhandledRejectionHandler = null\n        }\n        delete (window.onunhandledrejection as any)?.__POSTHOG_INSTRUMENTED__\n    }\n\n    isCapturing() {\n        return !!(window.onerror as any)?.__POSTHOG_INSTRUMENTED__\n    }\n\n    isEnabled() {\n        return this.remoteEnabled ?? false\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        const autocaptureExceptionsResponse = response.autocaptureExceptions\n        this.remoteEnabled = !!autocaptureExceptionsResponse || false\n        if (\n            !isPrimitive(autocaptureExceptionsResponse) &&\n            'errors_to_ignore' in autocaptureExceptionsResponse &&\n            Array.isArray(autocaptureExceptionsResponse.errors_to_ignore)\n        ) {\n            const dropRules = autocaptureExceptionsResponse.errors_to_ignore\n\n            this.errorsToIgnore = dropRules.map((rule) => {\n                return new RegExp(rule)\n            })\n        }\n\n        if (this.isEnabled()) {\n            this.startCapturing()\n            this.debugLog('Remote config for exception autocapture is enabled, starting', autocaptureExceptionsResponse)\n        } else {\n            this.debugLog(\n                'Remote config for exception autocapture is disabled, not starting',\n                autocaptureExceptionsResponse\n            )\n        }\n    }\n\n    captureException(args: ErrorEventArgs, properties?: Properties) {\n        const errorProperties = errorToProperties(args)\n\n        if (this.errorsToIgnore.some((regex) => regex.test(errorProperties.$exception_message || ''))) {\n            this.debugLog('Ignoring exception based on remote config', errorProperties)\n            return\n        }\n\n        const propertiesToSend = { ...properties, ...errorProperties }\n\n        const posthogHost = this.instance.get_config('ui_host') || this.instance.get_config('api_host')\n        errorProperties.$exception_personURL = posthogHost + '/person/' + this.instance.get_distinct_id()\n\n        this.sendExceptionEvent(propertiesToSend)\n    }\n\n    /**\n     * :TRICKY: Make sure we batch these requests\n     */\n    sendExceptionEvent(properties: { [key: string]: any }) {\n        this.instance.capture('$exception', properties, {\n            transport: 'XHR',\n            method: 'POST',\n            endpoint: EXCEPTION_INGESTION_ENDPOINT,\n            _noTruncate: true,\n            _batchKey: 'exceptionEvent',\n        })\n    }\n}\n","import Config from './config'\nimport {\n    logger,\n    document,\n    userAgent,\n    window,\n    _isUndefined,\n    _extend,\n    _each,\n    _isObject,\n    _isBlockedUA,\n    _copyAndTruncateStrings,\n    _isArray,\n    _safewrap_class,\n    _register_event,\n    _UUID,\n    _info,\n    _eachArray,\n} from './utils'\nimport { autocapture } from './autocapture'\nimport { PostHogPeople } from './posthog-people'\nimport { PostHogFeatureFlags } from './posthog-featureflags'\nimport { ALIAS_ID_KEY, FLAG_CALL_REPORTED, PEOPLE_DISTINCT_ID_KEY, PostHogPersistence } from './posthog-persistence'\nimport { SessionRecording } from './extensions/sessionrecording'\nimport { WebPerformanceObserver } from './extensions/web-performance'\nimport { Decide } from './decide'\nimport { Toolbar } from './extensions/toolbar'\nimport { clearOptInOut, hasOptedIn, hasOptedOut, optIn, optOut, userOptedOut } from './gdpr-utils'\nimport { cookieStore, localStore } from './storage'\nimport { RequestQueue } from './request-queue'\nimport { CaptureMetrics } from './capture-metrics'\nimport { compressData, decideCompression } from './compression'\nimport { addParamsToURL, encodePostData, xhr } from './send-request'\nimport { RetryQueue } from './retry-queue'\nimport { SessionIdManager } from './sessionid'\nimport {\n    CaptureOptions,\n    CaptureResult,\n    Compression,\n    ToolbarParams,\n    GDPROptions,\n    isFeatureEnabledOptions,\n    JSC,\n    OptInOutCapturingOptions,\n    PostHogConfig,\n    Properties,\n    Property,\n    RequestCallback,\n    SnippetArrayItem,\n    XHROptions,\n    AutocaptureConfig,\n    JsonType,\n    EarlyAccessFeatureCallback,\n    SurveyCallback,\n} from './types'\nimport { SentryIntegration } from './extensions/sentry-integration'\nimport { createSegmentIntegration } from './extensions/segment-integration'\nimport { PageViewIdManager } from './page-view-id'\nimport { ExceptionObserver } from './extensions/exceptions/exception-autocapture'\nimport { PostHogSurveys } from './posthog-surveys'\n\n/*\nSIMPLE STYLE GUIDE:\n\nthis.x === public function\nthis._x === internal - only use within this file\nthis.__x === private - only use within the class\n\nGlobals should be all caps\n*/\n\nenum InitType {\n    INIT_MODULE = 0,\n    INIT_SNIPPET = 1,\n}\n\nlet init_type: InitType\n\n// TODO: the type of this is very loose. Sometimes it's also PostHogLib itself\nlet posthog_master: Record<string, PostHog> & {\n    init: (token: string, config: Partial<PostHogConfig>, name: string) => void\n}\n\n// some globals for comparisons\nconst __NOOP = () => {}\nconst __NOOPTIONS = {}\n\nconst PRIMARY_INSTANCE_NAME = 'posthog'\n\n/*\n * Dynamic... constants? Is that an oxymoron?\n */\n// http://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/\n// https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#withCredentials\nconst USE_XHR = window.XMLHttpRequest && 'withCredentials' in new XMLHttpRequest()\n\n// IE<10 does not support cross-origin XHR's but script tags\n// with defer won't block window.onload; ENQUEUE_REQUESTS\n// should only be true for Opera<12\nlet ENQUEUE_REQUESTS = !USE_XHR && userAgent.indexOf('MSIE') === -1 && userAgent.indexOf('Mozilla') === -1\n\nconst defaultConfig = (): PostHogConfig => ({\n    api_host: 'https://app.posthog.com',\n    api_method: 'POST',\n    api_transport: 'XHR',\n    ui_host: null,\n    token: '',\n    autocapture: true,\n    rageclick: true,\n    cross_subdomain_cookie: document?.location?.hostname?.indexOf('herokuapp.com') === -1,\n    persistence: 'cookie',\n    persistence_name: '',\n    cookie_name: '',\n    loaded: __NOOP,\n    store_google: true,\n    custom_campaign_params: [],\n    save_referrer: true,\n    test: false,\n    verbose: false,\n    capture_pageview: true,\n    capture_pageleave: true, // We'll only capture pageleave events if capture_pageview is also true\n    debug: false,\n    cookie_expiration: 365,\n    upgrade: false,\n    disable_session_recording: false,\n    disable_persistence: false,\n    disable_cookie: false,\n    enable_recording_console_log: undefined, // When undefined, it falls back to the server-side setting\n    secure_cookie: window?.location?.protocol === 'https:',\n    ip: true,\n    opt_out_capturing_by_default: false,\n    opt_out_persistence_by_default: false,\n    opt_out_capturing_persistence_type: 'localStorage',\n    opt_out_capturing_cookie_prefix: null,\n    opt_in_site_apps: false,\n    property_blacklist: [],\n    respect_dnt: false,\n    sanitize_properties: null,\n    xhr_headers: {}, // { header: value, header2: value }\n    inapp_protocol: '//',\n    inapp_link_new_window: false,\n    request_batching: true,\n    properties_string_max_length: 65535,\n    session_recording: {},\n    mask_all_element_attributes: false,\n    mask_all_text: false,\n    advanced_disable_decide: false,\n    advanced_disable_toolbar_metrics: false,\n    on_xhr_error: (req) => {\n        const error = 'Bad HTTP status: ' + req.status + ' ' + req.statusText\n        console.error(error)\n    },\n    get_device_id: (uuid) => uuid,\n    // Used for internal testing\n    _onCapture: __NOOP,\n    _capture_metrics: false,\n    capture_performance: undefined,\n    name: 'posthog',\n    callback_fn: 'posthog._jsc',\n    bootstrap: {},\n    disable_compression: false,\n    session_idle_timeout_seconds: 30 * 60, // 30 minutes\n})\n\n/**\n * create_phlib(token:string, config:object, name:string)\n *\n * This function is used by the init method of PostHogLib objects\n * as well as the main initializer at the end of the JSLib (that\n * initializes document.posthog as well as any additional instances\n * declared before this file has loaded).\n */\nconst create_phlib = function (\n    token: string,\n    config?: Partial<PostHogConfig>,\n    name?: string,\n    createComplete?: (instance: PostHog) => void\n): PostHog {\n    let instance: PostHog\n    const target =\n        name === PRIMARY_INSTANCE_NAME || !posthog_master ? posthog_master : name ? posthog_master[name] : undefined\n    const callbacksHandled = {\n        initComplete: false,\n        syncCode: false,\n    }\n    const handleCallback = (callbackName: keyof typeof callbacksHandled) => (instance: PostHog) => {\n        if (!callbacksHandled[callbackName]) {\n            callbacksHandled[callbackName] = true\n            if (callbacksHandled.initComplete && callbacksHandled.syncCode) {\n                createComplete?.(instance)\n            }\n        }\n    }\n\n    if (target && init_type === InitType.INIT_MODULE) {\n        instance = target as any\n    } else {\n        if (target && !_isArray(target)) {\n            console.error('You have already initialized ' + name)\n            // TODO: throw something instead?\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return\n        }\n        instance = new PostHog()\n    }\n\n    instance._init(token, config, name, handleCallback('initComplete'))\n    instance.toolbar.maybeLoadToolbar()\n\n    instance.sessionRecording = new SessionRecording(instance)\n    instance.sessionRecording.startRecordingIfEnabled()\n\n    instance.webPerformance = new WebPerformanceObserver(instance)\n    instance.webPerformance.startObservingIfEnabled()\n\n    instance.exceptionAutocapture = new ExceptionObserver(instance)\n\n    instance.__autocapture = instance.get_config('autocapture')\n    autocapture._setIsAutocaptureEnabled(instance)\n    if (autocapture._isAutocaptureEnabled) {\n        instance.__autocapture = instance.get_config('autocapture')\n        const num_buckets = 100\n        const num_enabled_buckets = 100\n        if (!autocapture.enabledForProject(instance.get_config('token'), num_buckets, num_enabled_buckets)) {\n            instance.__autocapture = false\n            logger.log('Not in active bucket: disabling Automatic Event Collection.')\n        } else if (!autocapture.isBrowserSupported()) {\n            instance.__autocapture = false\n            logger.log('Disabling Automatic Event Collection because this browser is not supported')\n        } else {\n            autocapture.init(instance)\n        }\n    }\n\n    // if any instance on the page has debug = true, we set the\n    // global debug to be true\n    Config.DEBUG = Config.DEBUG || instance.get_config('debug')\n\n    // if target is not defined, we called init after the lib already\n    // loaded, so there won't be an array of things to execute\n    if (typeof target !== 'undefined' && _isArray(target)) {\n        // Crunch through the people queue first - we queue this data up &\n        // flush on identify, so it's better to do all these operations first\n        instance._execute_array.call(instance.people, (target as any).people)\n        instance._execute_array(target)\n    }\n\n    handleCallback('syncCode')(instance)\n    return instance\n}\n\n/**\n * PostHog Library Object\n * @constructor\n */\nexport class PostHog {\n    __loaded: boolean\n    __loaded_recorder_version: 'v1' | 'v2' | undefined // flag that keeps track of which version of recorder is loaded\n    config: PostHogConfig\n\n    persistence: PostHogPersistence\n    sessionPersistence: PostHogPersistence\n    sessionManager: SessionIdManager\n    pageViewIdManager: PageViewIdManager\n    people: PostHogPeople\n    featureFlags: PostHogFeatureFlags\n    surveys: PostHogSurveys\n    toolbar: Toolbar\n    sessionRecording: SessionRecording | undefined\n    webPerformance: WebPerformanceObserver | undefined\n    exceptionAutocapture: ExceptionObserver | undefined\n\n    _captureMetrics: CaptureMetrics\n    _requestQueue: RequestQueue\n    _retryQueue: RetryQueue\n\n    _triggered_notifs: any\n    compression: Partial<Record<Compression, boolean>>\n    _jsc: JSC\n    __captureHooks: ((eventName: string) => void)[]\n    __request_queue: [url: string, data: Record<string, any>, options: XHROptions, callback?: RequestCallback][]\n    __autocapture: boolean | AutocaptureConfig | undefined\n    decideEndpointWasHit: boolean\n\n    SentryIntegration: typeof SentryIntegration\n    segmentIntegration: () => any\n\n    constructor() {\n        this.config = defaultConfig()\n        this.compression = {}\n        this.decideEndpointWasHit = false\n        this.SentryIntegration = SentryIntegration\n        this.segmentIntegration = () => createSegmentIntegration(this)\n        this.__captureHooks = []\n        this.__request_queue = []\n        this.__loaded = false\n        this.__loaded_recorder_version = undefined\n        this.__autocapture = undefined\n        this._jsc = function () {} as JSC\n        this.people = new PostHogPeople(this)\n        this.featureFlags = new PostHogFeatureFlags(this)\n        this.toolbar = new Toolbar(this)\n        this.pageViewIdManager = new PageViewIdManager()\n        this.surveys = new PostHogSurveys(this)\n\n        // these are created in _init() after we have the config\n        this._captureMetrics = undefined as any\n        this._requestQueue = undefined as any\n        this._retryQueue = undefined as any\n        this.persistence = undefined as any\n        this.sessionPersistence = undefined as any\n        this.sessionManager = undefined as any\n    }\n\n    // Initialization methods\n\n    /**\n     * This function initializes a new instance of the PostHog capturing object.\n     * All new instances are added to the main posthog object as sub properties (such as\n     * posthog.library_name) and also returned by this function. To define a\n     * second instance on the page, you would call:\n     *\n     *     posthog.init('new token', { your: 'config' }, 'library_name');\n     *\n     * and use it like so:\n     *\n     *     posthog.library_name.capture(...);\n     *\n     * @param {String} token   Your PostHog API token\n     * @param {Object} [config]  A dictionary of config options to override. <a href=\"https://github.com/posthog/posthog-js/blob/6e0e873/src/posthog-core.js#L57-L91\">See a list of default config options</a>.\n     * @param {String} [name]    The name for the new posthog instance that you want created\n     */\n    init(token: string, config?: Partial<PostHogConfig>, name?: string): PostHog | void {\n        if (_isUndefined(name)) {\n            console.error('You must name your new library: init(token, config, name)')\n            return\n        }\n        if (name === PRIMARY_INSTANCE_NAME) {\n            console.error('You must initialize the main posthog object right after you include the PostHog js snippet')\n            return\n        }\n\n        const instance: PostHog = create_phlib(token, config, name, (instance: PostHog) => {\n            posthog_master[name] = instance\n            instance._loaded()\n        })\n        posthog_master[name] = instance\n\n        return instance\n    }\n\n    // posthog._init(token:string, config:object, name:string)\n    //\n    // This function sets up the current instance of the posthog\n    // library.  The difference between this method and the init(...)\n    // method is this one initializes the actual instance, whereas the\n    // init(...) method sets up a new library and calls _init on it.\n    //\n    // Note that there are operations that can be asynchronous, so we\n    // accept a callback that is called when all the asynchronous work\n    // is done. Note that we do not use promises because we want to be\n    // IE11 compatible. We could use polyfills, which would make the\n    // code a bit cleaner, but will add some overhead.\n    //\n    _init(\n        token: string,\n        config: Partial<PostHogConfig> = {},\n        name?: string,\n        initComplete?: (instance: PostHog) => void\n    ): void {\n        this.__loaded = true\n        this.config = {} as PostHogConfig // will be set right below\n        this._triggered_notifs = []\n\n        // To avoid using Promises and their helper functions, we instead keep\n        // track of which callbacks have been called, and then call initComplete\n        // when all of them have been called. To add additional async code, add\n        // to `callbacksHandled` and pass updateInitComplete as a callback to\n        // the async code.\n        const callbacksHandled = { segmentRegister: false, syncCode: false }\n        const updateInitComplete = (callbackName: keyof typeof callbacksHandled) => () => {\n            // Update the register of callbacks that have been called, and if\n            // they have all been called, then we are ready to call\n            // initComplete.\n            if (!callbacksHandled[callbackName]) {\n                callbacksHandled[callbackName] = true\n                if (callbacksHandled.segmentRegister && callbacksHandled.syncCode) {\n                    initComplete?.(this)\n                }\n            }\n        }\n\n        this.set_config(\n            _extend({}, defaultConfig(), config, {\n                name: name,\n                token: token,\n                callback_fn: (name === PRIMARY_INSTANCE_NAME ? name : PRIMARY_INSTANCE_NAME + '.' + name) + '._jsc',\n            })\n        )\n\n        this._jsc = function () {} as JSC\n\n        // Check if recorder.js is already loaded\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        if (window?.rrweb?.record || window?.rrwebRecord) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            this.__loaded_recorder_version = window?.rrweb?.version\n        }\n\n        this._captureMetrics = new CaptureMetrics(this.get_config('_capture_metrics'))\n        this._requestQueue = new RequestQueue(this._captureMetrics, this._handle_queued_event.bind(this))\n        this._retryQueue = new RetryQueue(this._captureMetrics, this.get_config('on_xhr_error'))\n        this.__captureHooks = []\n        this.__request_queue = []\n\n        this.persistence = new PostHogPersistence(this.config)\n        this.sessionManager = new SessionIdManager(this.config, this.persistence)\n        this.sessionPersistence =\n            this.config.persistence === 'sessionStorage'\n                ? this.persistence\n                : new PostHogPersistence({ ...this.config, persistence: 'sessionStorage' })\n\n        this._gdpr_init()\n\n        if (config.segment) {\n            // Use segments anonymousId instead\n            this.config.get_device_id = () => config.segment.user().anonymousId()\n\n            // If a segment user ID exists, set it as the distinct_id\n            if (config.segment.user().id()) {\n                this.register({\n                    distinct_id: config.segment.user().id(),\n                })\n                this.persistence.set_user_state('identified')\n            }\n\n            config.segment.register(this.segmentIntegration()).then(updateInitComplete('segmentRegister'))\n        } else {\n            updateInitComplete('segmentRegister')()\n        }\n\n        if (config.bootstrap?.distinctID !== undefined) {\n            const uuid = this.get_config('get_device_id')(_UUID())\n            const deviceID = config.bootstrap?.isIdentifiedID ? uuid : config.bootstrap.distinctID\n            this.persistence.set_user_state(config.bootstrap?.isIdentifiedID ? 'identified' : 'anonymous')\n            this.register({\n                distinct_id: config.bootstrap.distinctID,\n                $device_id: deviceID,\n            })\n        }\n\n        if (this._hasBootstrappedFeatureFlags()) {\n            const activeFlags = Object.keys(config.bootstrap?.featureFlags || {})\n                .filter((flag) => !!config.bootstrap?.featureFlags?.[flag])\n                .reduce(\n                    (res: Record<string, string | boolean>, key) => (\n                        (res[key] = config.bootstrap?.featureFlags?.[key] || false), res\n                    ),\n                    {}\n                )\n            const featureFlagPayloads = Object.keys(config.bootstrap?.featureFlagPayloads || {})\n                .filter((key) => activeFlags[key])\n                .reduce((res: Record<string, JsonType>, key) => {\n                    if (config.bootstrap?.featureFlagPayloads?.[key]) {\n                        res[key] = config.bootstrap?.featureFlagPayloads?.[key]\n                    }\n                    return res\n                }, {})\n\n            this.featureFlags.receivedFeatureFlags({ featureFlags: activeFlags, featureFlagPayloads })\n        }\n\n        if (!this.get_distinct_id()) {\n            // There is no need to set the distinct id\n            // or the device id if something was already stored\n            // in the persitence\n            const uuid = this.get_config('get_device_id')(_UUID())\n            this.register_once(\n                {\n                    distinct_id: uuid,\n                    $device_id: uuid,\n                },\n                ''\n            )\n            // distinct id == $device_id is a proxy for anonymous user\n            this.persistence.set_user_state('anonymous')\n        }\n        // Set up event handler for pageleave\n        // Use `onpagehide` if available, see https://calendar.perfplanet.com/2020/beaconing-in-practice/#beaconing-reliability-avoiding-abandons\n        window.addEventListener &&\n            window.addEventListener('onpagehide' in self ? 'pagehide' : 'unload', this._handle_unload.bind(this))\n\n        // Make sure that we also call the initComplete callback at the end of\n        // the synchronous code as well.\n        updateInitComplete('syncCode')()\n    }\n\n    // Private methods\n\n    _loaded(): void {\n        // Pause `reloadFeatureFlags` calls in config.loaded callback.\n        // These feature flags are loaded in the decide call made right\n        // afterwards\n        this.featureFlags.setReloadingPaused(true)\n\n        try {\n            this.get_config('loaded')(this)\n        } catch (err) {\n            console.error('`loaded` function failed', err)\n        }\n\n        this._start_queue_if_opted_in()\n\n        // this happens after so a user can call identify in\n        // the loaded callback\n        if (this.get_config('capture_pageview')) {\n            this.capture('$pageview', {}, { send_instantly: true })\n        }\n\n        // Call decide to get what features are enabled and other settings.\n        // As a reminder, if the /decide endpoint is disabled, feature flags, toolbar, session recording, autocapture,\n        // and compression will not be available.\n        if (!this.get_config('advanced_disable_decide')) {\n            new Decide(this).call()\n        }\n\n        this.featureFlags.resetRequestQueue()\n        this.featureFlags.setReloadingPaused(false)\n    }\n\n    _start_queue_if_opted_in(): void {\n        if (!this.has_opted_out_capturing()) {\n            if (this.get_config('request_batching')) {\n                this._requestQueue.poll()\n            }\n        }\n    }\n\n    _dom_loaded(): void {\n        if (!this.has_opted_out_capturing()) {\n            _eachArray(this.__request_queue, (item) => {\n                this._send_request(...item)\n            })\n        }\n\n        this.__request_queue = []\n\n        this._start_queue_if_opted_in()\n    }\n\n    /**\n     * _prepare_callback() should be called by callers of _send_request for use\n     * as the callback argument.\n     *\n     * If there is no callback, this returns null.\n     * If we are going to make XHR/XDR requests, this returns a function.\n     * If we are going to use script tags, this returns a string to use as the\n     * callback GET param.\n     */\n    // TODO: get rid of the \"| string\"\n    _prepare_callback(callback?: RequestCallback, data?: Properties): RequestCallback | null | string {\n        if (_isUndefined(callback)) {\n            return null\n        }\n\n        if (USE_XHR) {\n            return function (response) {\n                callback(response, data)\n            }\n        } else {\n            // if the user gives us a callback, we store as a random\n            // property on this instances jsc function and update our\n            // callback string to reflect that.\n            const jsc = this._jsc\n            const randomized_cb = '' + Math.floor(Math.random() * 100000000)\n            const callback_string = this.get_config('callback_fn') + '[' + randomized_cb + ']'\n            jsc[randomized_cb] = function (response: any) {\n                delete jsc[randomized_cb]\n                callback(response, data)\n            }\n            return callback_string\n        }\n    }\n\n    _handle_unload(): void {\n        if (!this.get_config('request_batching')) {\n            if (this.get_config('capture_pageview') && this.get_config('capture_pageleave')) {\n                this.capture('$pageleave', null, { transport: 'sendBeacon' })\n            }\n            return\n        }\n\n        if (this.get_config('capture_pageview') && this.get_config('capture_pageleave')) {\n            this.capture('$pageleave')\n        }\n        if (this.get_config('_capture_metrics')) {\n            this._requestQueue.updateUnloadMetrics()\n            this.capture('$capture_metrics', this._captureMetrics.metrics)\n        }\n        this._requestQueue.unload()\n        this._retryQueue.unload()\n    }\n\n    _handle_queued_event(url: string, data: Record<string, any>, options?: XHROptions): void {\n        const jsonData = JSON.stringify(data)\n        this.__compress_and_send_json_request(url, jsonData, options || __NOOPTIONS, __NOOP)\n    }\n\n    __compress_and_send_json_request(\n        url: string,\n        jsonData: string,\n        options: XHROptions,\n        callback?: RequestCallback\n    ): void {\n        const [data, _options] = compressData(decideCompression(this.compression), jsonData, options)\n        this._send_request(url, data, _options, callback)\n    }\n\n    _send_request(url: string, data: Record<string, any>, options: XHROptions, callback?: RequestCallback): void {\n        if (ENQUEUE_REQUESTS) {\n            this.__request_queue.push([url, data, options, callback])\n            return\n        }\n\n        const DEFAULT_OPTIONS = {\n            method: this.get_config('api_method'),\n            transport: this.get_config('api_transport'),\n            verbose: this.get_config('verbose'),\n        }\n\n        options = _extend(DEFAULT_OPTIONS, options || {})\n        if (!USE_XHR) {\n            options.method = 'GET'\n        }\n\n        const useSendBeacon = 'sendBeacon' in window.navigator && options.transport === 'sendBeacon'\n        url = addParamsToURL(url, options.urlQueryArgs || {}, {\n            ip: this.get_config('ip'),\n        })\n\n        if (useSendBeacon) {\n            // beacon documentation https://w3c.github.io/beacon/\n            // beacons format the message and use the type property\n            // also no need to try catch as sendBeacon does not report errors\n            //   and is defined as best effort attempt\n            try {\n                window.navigator.sendBeacon(url, encodePostData(data, { ...options, sendBeacon: true }))\n            } catch (e) {\n                if (this.get_config('debug')) {\n                    console.error(e)\n                }\n            }\n        } else if (USE_XHR) {\n            try {\n                xhr({\n                    url: url,\n                    data: data,\n                    headers: this.get_config('xhr_headers'),\n                    options: options,\n                    captureMetrics: this._captureMetrics,\n                    callback,\n                    retriesPerformedSoFar: 0,\n                    retryQueue: this._retryQueue,\n                    onXHRError: this.get_config('on_xhr_error'),\n                })\n            } catch (e) {\n                console.error(e)\n            }\n        } else {\n            const script = document.createElement('script')\n            script.type = 'text/javascript'\n            script.async = true\n            script.defer = true\n            script.src = url\n            const s = document.getElementsByTagName('script')[0]\n            s.parentNode?.insertBefore(script, s)\n        }\n    }\n\n    /**\n     * _execute_array() deals with processing any posthog function\n     * calls that were called before the PostHog library were loaded\n     * (and are thus stored in an array so they can be called later)\n     *\n     * Note: we fire off all the posthog function calls && user defined\n     * functions BEFORE we fire off posthog capturing calls. This is so\n     * identify/register/set_config calls can properly modify early\n     * capturing calls.\n     *\n     * @param {Array} array\n     */\n    _execute_array(array: SnippetArrayItem[]): void {\n        let fn_name\n        const alias_calls: SnippetArrayItem[] = []\n        const other_calls: SnippetArrayItem[] = []\n        const capturing_calls: SnippetArrayItem[] = []\n        _eachArray(array, (item) => {\n            if (item) {\n                fn_name = item[0]\n                if (_isArray(fn_name)) {\n                    capturing_calls.push(item) // chained call e.g. posthog.get_group().set()\n                } else if (typeof item === 'function') {\n                    ;(item as any).call(this)\n                } else if (_isArray(item) && fn_name === 'alias') {\n                    alias_calls.push(item)\n                } else if (\n                    _isArray(item) &&\n                    fn_name.indexOf('capture') !== -1 &&\n                    typeof (this as any)[fn_name] === 'function'\n                ) {\n                    capturing_calls.push(item)\n                } else {\n                    other_calls.push(item)\n                }\n            }\n        })\n\n        const execute = function (calls: SnippetArrayItem[], thisArg: any) {\n            _eachArray(\n                calls,\n                function (item) {\n                    if (_isArray(item[0])) {\n                        // chained call\n                        let caller = thisArg\n                        _each(item, function (call) {\n                            caller = caller[call[0]].apply(caller, call.slice(1))\n                        })\n                    } else {\n                        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                        // @ts-ignore\n                        this[item[0]].apply(this, item.slice(1))\n                    }\n                },\n                thisArg\n            )\n        }\n\n        execute(alias_calls, this)\n        execute(other_calls, this)\n        execute(capturing_calls, this)\n    }\n\n    _hasBootstrappedFeatureFlags(): boolean {\n        return (\n            (this.config.bootstrap?.featureFlags && Object.keys(this.config.bootstrap?.featureFlags).length > 0) ||\n            false\n        )\n    }\n\n    /**\n     * push() keeps the standard async-array-push\n     * behavior around after the lib is loaded.\n     * This is only useful for external integrations that\n     * do not wish to rely on our convenience methods\n     * (created in the snippet).\n     *\n     * ### Usage:\n     *     posthog.push(['register', { a: 'b' }]);\n     *\n     * @param {Array} item A [function_name, args...] array to be executed\n     */\n    push(item: SnippetArrayItem): void {\n        this._execute_array([item])\n    }\n\n    /*\n     * PostHog supports exception autocapture, however, this function\n     * is used to manually capture an exception\n     * and can be used to add more context to that exception\n     *\n     * Properties passed as the second option will be merged with the properties\n     * of the exception event.\n     * Where there is a key in both generated exception and passed properties,\n     * the generated exception property takes precedence.\n     */\n    captureException(exception: Error, properties?: Properties): void {\n        this.exceptionAutocapture?.captureException(\n            [exception.name, undefined, undefined, undefined, exception],\n            properties\n        )\n    }\n\n    /**\n     * Capture an event. This is the most important and\n     * frequently used PostHog function.\n     *\n     * ### Usage:\n     *\n     *     // capture an event named 'Registered'\n     *     posthog.capture('Registered', {'Gender': 'Male', 'Age': 21});\n     *\n     *     // capture an event using navigator.sendBeacon\n     *     posthog.capture('Left page', {'duration_seconds': 35}, {transport: 'sendBeacon'});\n     *\n     * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n     * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n     * @param {Object} [options] Optional configuration for this capture request.\n     * @param {String} [options.transport] Transport method for network request ('XHR' or 'sendBeacon').\n     * @param {Date} [options.timestamp] Timestamp is a Date object. If not set, it'll automatically be set to the current time.\n     */\n    capture(\n        event_name: string,\n        properties?: Properties | null,\n        options: CaptureOptions = __NOOPTIONS\n    ): CaptureResult | void {\n        // While developing, a developer might purposefully _not_ call init(),\n        // in this case, we would like capture to be a noop.\n        if (!this.__loaded) {\n            return\n        }\n\n        if (userOptedOut(this, false)) {\n            return\n        }\n\n        this._captureMetrics.incr('capture')\n        if (event_name === '$snapshot') {\n            this._captureMetrics.incr('snapshot')\n        }\n\n        options = options || __NOOPTIONS\n        const transport = options['transport'] // external API, don't minify 'transport' prop\n        if (transport) {\n            options.transport = transport // 'transport' prop name can be minified internally\n        }\n\n        // typing doesn't prevent interesting data\n        if (_isUndefined(event_name) || typeof event_name !== 'string') {\n            console.error('No event name provided to posthog.capture')\n            return\n        }\n\n        if (_isBlockedUA(userAgent)) {\n            return\n        }\n\n        // update persistence\n        this.sessionPersistence.update_search_keyword()\n\n        if (this.get_config('store_google')) {\n            this.sessionPersistence.update_campaign_params()\n        }\n        if (this.get_config('save_referrer')) {\n            this.sessionPersistence.update_referrer_info()\n        }\n\n        let data: CaptureResult = {\n            uuid: _UUID('v7'),\n            event: event_name,\n            properties: this._calculate_event_properties(event_name, properties || {}),\n        }\n\n        if (event_name === '$identify') {\n            data['$set'] = options['$set']\n            data['$set_once'] = options['$set_once']\n        }\n\n        data = _copyAndTruncateStrings(\n            data,\n            options._noTruncate ? null : this.get_config('properties_string_max_length')\n        )\n        data.timestamp = options.timestamp || new Date()\n\n        if (this.get_config('debug')) {\n            logger.log('PostHog.js send', data)\n        }\n        const jsonData = JSON.stringify(data)\n\n        const url = this.get_config('api_host') + (options.endpoint || '/e/')\n\n        const has_unique_traits = options !== __NOOPTIONS\n\n        if (\n            this.get_config('request_batching') &&\n            (!has_unique_traits || options._batchKey) &&\n            !options.send_instantly\n        ) {\n            this._requestQueue.enqueue(url, data, options)\n        } else {\n            this.__compress_and_send_json_request(url, jsonData, options)\n        }\n\n        this._invokeCaptureHooks(event_name, data)\n\n        return data\n    }\n\n    _addCaptureHook(callback: (eventName: string) => void): void {\n        this.__captureHooks.push(callback)\n    }\n\n    _invokeCaptureHooks(eventName: string, eventData: CaptureResult): void {\n        this.config._onCapture(eventName, eventData)\n        _each(this.__captureHooks, (callback) => callback(eventName))\n    }\n\n    _calculate_event_properties(event_name: string, event_properties: Properties): Properties {\n        // set defaults\n        const start_timestamp = this.persistence.remove_event_timer(event_name)\n        let properties = { ...event_properties }\n        properties['token'] = this.get_config('token')\n\n        if (event_name === '$snapshot') {\n            const persistenceProps = { ...this.persistence.properties(), ...this.sessionPersistence.properties() }\n            properties['distinct_id'] = persistenceProps.distinct_id\n            return properties\n        }\n\n        const infoProperties = _info.properties()\n\n        if (this.sessionManager) {\n            const { sessionId, windowId } = this.sessionManager.checkAndGetSessionAndWindowId()\n            properties['$session_id'] = sessionId\n            properties['$window_id'] = windowId\n        }\n\n        if (this.webPerformance?.isEnabled) {\n            if (event_name === '$pageview') {\n                this.pageViewIdManager.onPageview()\n            }\n            properties = _extend(properties, { $pageview_id: this.pageViewIdManager.getPageViewId() })\n        }\n\n        if (event_name === '$performance_event') {\n            const persistenceProps = this.persistence.properties()\n            // Early exit for $performance_event as we only need session and $current_url\n            properties['distinct_id'] = persistenceProps.distinct_id\n            properties['$current_url'] = infoProperties.$current_url\n            return properties\n        }\n\n        // set $duration if time_event was previously called for this event\n        if (typeof start_timestamp !== 'undefined') {\n            const duration_in_ms = new Date().getTime() - start_timestamp\n            properties['$duration'] = parseFloat((duration_in_ms / 1000).toFixed(3))\n        }\n\n        // note: extend writes to the first object, so lets make sure we\n        // don't write to the persistence properties object and info\n        // properties object by passing in a new object\n\n        // update properties with pageview info and super-properties\n        properties = _extend(\n            {},\n            _info.properties(),\n            this.persistence.properties(),\n            this.sessionPersistence.properties(),\n            properties\n        )\n\n        const property_blacklist = this.get_config('property_blacklist')\n        if (_isArray(property_blacklist)) {\n            _each(property_blacklist, function (blacklisted_prop) {\n                delete properties[blacklisted_prop]\n            })\n        } else {\n            console.error('Invalid value for property_blacklist config: ' + property_blacklist)\n        }\n\n        const sanitize_properties = this.get_config('sanitize_properties')\n        if (sanitize_properties) {\n            properties = sanitize_properties(properties, event_name)\n        }\n\n        return properties\n    }\n\n    /**\n     * Register a set of super properties, which are included with all\n     * events. This will overwrite previous super property values, except\n     * for session properties (see `register_for_session(properties)`).\n     *\n     * ### Usage:\n     *\n     *     // register 'Gender' as a super property\n     *     posthog.register({'Gender': 'Female'});\n     *\n     *     // register several super properties when a user signs up\n     *     posthog.register({\n     *         'Email': 'jdoe@example.com',\n     *         'Account Type': 'Free'\n     *     });\n     *\n     *     // Display the properties\n     *     console.log(posthog.persistence.properties())\n     *\n     * @param {Object} properties An associative array of properties to store about the user\n     * @param {Number} [days] How many days since the user's last visit to store the super properties\n     */\n    register(properties: Properties, days?: number): void {\n        this.persistence.register(properties, days)\n    }\n\n    /**\n     * Register a set of super properties only once. These will not\n     * overwrite previous super property values, unlike register().\n     *\n     * ### Usage:\n     *\n     *     // register a super property for the first time only\n     *     posthog.register_once({\n     *         'First Login Date': new Date().toISOString()\n     *     });\n     *\n     *     // Display the properties\n     *     console.log(posthog.persistence.properties())\n     *\n     * ### Notes:\n     *\n     * If default_value is specified, current super properties\n     * with that value will be overwritten.\n     *\n     * @param {Object} properties An associative array of properties to store about the user\n     * @param {*} [default_value] Value to override if already set in super properties (ex: 'False') Default: 'None'\n     * @param {Number} [days] How many days since the users last visit to store the super properties\n     */\n    register_once(properties: Properties, default_value?: Property, days?: number): void {\n        this.persistence.register_once(properties, default_value, days)\n    }\n\n    /**\n     * Register a set of super properties, which are included with all events, but only\n     * for THIS SESSION. These will overwrite all other super property values.\n     *\n     * Unlike regular super properties, which last in LocalStorage for a long time,\n     * session super properties get cleared after a session ends.\n     *\n     * ### Usage:\n     *\n     *     // register on all events this session\n     *     posthog.register_for_session({'referer': customGetReferer()});\n     *\n     *     // register several session super properties when a user signs up\n     *     posthog.register_for_session({\n     *         'selectedPlan': 'pro',\n     *         'completedSteps': 4,\n     *     });\n     *\n     *     // Display the properties\n     *     console.log(posthog.sessionPersistence.properties())\n     *\n     * @param {Object} properties An associative array of properties to store about the user\n     */\n    register_for_session(properties: Properties): void {\n        this.sessionPersistence.register(properties)\n    }\n\n    /**\n     * Delete a super property stored with the current user.\n     *\n     * @param {String} property The name of the super property to remove\n     */\n    unregister(property: string): void {\n        this.persistence.unregister(property)\n    }\n\n    /**\n     * Delete a session super property stored with the current user.\n     *\n     * @param {String} property The name of the session super property to remove\n     */\n    unregister_for_session(property: string): void {\n        this.sessionPersistence.unregister(property)\n    }\n\n    _register_single(prop: string, value: Property) {\n        this.register({ [prop]: value })\n    }\n\n    /*\n     * Get feature flag value for user (supports multivariate flags).\n     *\n     * ### Usage:\n     *\n     *     if(posthog.getFeatureFlag('beta-feature') === 'some-value') { // do something }\n     *\n     * @param {Object|String} prop Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    getFeatureFlag(key: string, options?: { send_event?: boolean }): boolean | string | undefined {\n        return this.featureFlags.getFeatureFlag(key, options)\n    }\n\n    /*\n     * Get feature flag payload value matching key for user (supports multivariate flags).\n     *\n     * ### Usage:\n     *\n     *     if(posthog.getFeatureFlag('beta-feature') === 'some-value') {\n     *          const someValue = posthog.getFeatureFlagPayload('beta-feature')\n     *          // do something\n     *     }\n     *\n     * @param {Object|String} prop Key of the feature flag.\n     */\n    getFeatureFlagPayload(key: string): JsonType {\n        const payload = this.featureFlags.getFeatureFlagPayload(key)\n        try {\n            return JSON.parse(payload as any)\n        } catch {\n            return payload\n        }\n    }\n\n    /*\n     * See if feature flag is enabled for user.\n     *\n     * ### Usage:\n     *\n     *     if(posthog.isFeatureEnabled('beta-feature')) { // do something }\n     *\n     * @param {Object|String} prop Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    isFeatureEnabled(key: string, options?: isFeatureEnabledOptions): boolean | undefined {\n        return this.featureFlags.isFeatureEnabled(key, options)\n    }\n\n    reloadFeatureFlags(): void {\n        this.featureFlags.reloadFeatureFlags()\n    }\n\n    /** Opt the user in or out of an early access feature. */\n    updateEarlyAccessFeatureEnrollment(key: string, isEnrolled: boolean): void {\n        this.featureFlags.updateEarlyAccessFeatureEnrollment(key, isEnrolled)\n    }\n\n    /** Get the list of early access features. To check enrollment status, use `isFeatureEnabled`. */\n    getEarlyAccessFeatures(callback: EarlyAccessFeatureCallback, force_reload = false): void {\n        return this.featureFlags.getEarlyAccessFeatures(callback, force_reload)\n    }\n\n    /*\n     * Register an event listener that runs when feature flags become available or when they change.\n     * If there are flags, the listener is called immediately in addition to being called on future changes.\n     *\n     * ### Usage:\n     *\n     *     posthog.onFeatureFlags(function(featureFlags) { // do something })\n     *\n     * @param {Function} [callback] The callback function will be called once the feature flags are ready or when they are updated.\n     *                              It'll return a list of feature flags enabled for the user.\n     * @returns {Function} A function that can be called to unsubscribe the listener. Used by useEffect when the component unmounts.\n     */\n    onFeatureFlags(callback: (flags: string[], variants: Record<string, string | boolean>) => void): () => void {\n        return this.featureFlags.onFeatureFlags(callback)\n    }\n\n    /** Get list of all surveys. */\n    getSurveys(callback: SurveyCallback, forceReload = false): void {\n        this.surveys.getSurveys(callback, forceReload)\n    }\n\n    /** Get surveys that should be enabled for the current user. */\n    getActiveMatchingSurveys(callback: SurveyCallback, forceReload = false): void {\n        this.surveys.getActiveMatchingSurveys(callback, forceReload)\n    }\n\n    /**\n     * Identify a user with a unique ID instead of a PostHog\n     * randomly generated distinct_id. If the method is never called,\n     * then unique visitors will be identified by a UUID that is generated\n     * the first time they visit the site.\n     *\n     * If user properties are passed, they are also sent to posthog.\n     *\n     * ### Usage:\n     *\n     *      posthog.identify('[user unique id]')\n     *      posthog.identify('[user unique id]', { email: 'john@example.com' })\n     *      posthog.identify('[user unique id]', {}, { referral_code: '12345' })\n     *\n     * ### Notes:\n     *\n     * You can call this function to overwrite a previously set\n     * unique ID for the current user.\n     *\n     * If the user has been identified ($user_state in persistence is set to 'identified'),\n     * then capture of $identify is skipped to avoid merging users. For example,\n     * if your system allows an admin user to impersonate another user.\n     *\n     * Then a single browser instance can have:\n     *\n     *  `identify('a') -> capture(1) -> identify('b') -> capture(2)`\n     *\n     * and capture 1 and capture 2 will have the correct distinct_id.\n     * but users a and b will NOT be merged in posthog.\n     *\n     * However, if reset is called then:\n     *\n     *  `identify('a') -> capture(1) -> reset() -> capture(2) -> identify('b') -> capture(3)`\n     *\n     * users a and b are not merged.\n     * Capture 1 is associated with user a.\n     * A new distinct id is generated for capture 2.\n     * which is merged with user b.\n     * So, capture 2 and 3 are associated with user b.\n     *\n     * If you want to merge two identified users, you can call posthog.alias\n     *\n     * @param {String} [new_distinct_id] A string that uniquely identifies a user. If not provided, the distinct_id currently in the persistent store (cookie or localStorage) will be used.\n     * @param {Object} [userPropertiesToSet] Optional: An associative array of properties to store about the user\n     * @param {Object} [userPropertiesToSetOnce] Optional: An associative array of properties to store about the user. If property is previously set, this does not override that value.\n     */\n    identify(new_distinct_id?: string, userPropertiesToSet?: Properties, userPropertiesToSetOnce?: Properties): void {\n        //if the new_distinct_id has not been set ignore the identify event\n        if (!new_distinct_id) {\n            console.error('Unique user id has not been set in posthog.identify')\n            return\n        }\n\n        this._captureMetrics.incr('identify')\n\n        const previous_distinct_id = this.get_distinct_id()\n        this.register({ $user_id: new_distinct_id })\n\n        if (!this.get_property('$device_id')) {\n            // The persisted distinct id might not actually be a device id at all\n            // it might be a distinct id of the user from before\n            const device_id = previous_distinct_id\n            this.register_once(\n                {\n                    $had_persisted_distinct_id: true,\n                    $device_id: device_id,\n                },\n                ''\n            )\n        }\n\n        // if the previous distinct id had an alias stored, then we clear it\n        if (new_distinct_id !== previous_distinct_id && new_distinct_id !== this.get_property(ALIAS_ID_KEY)) {\n            this.unregister(ALIAS_ID_KEY)\n            this.register({ distinct_id: new_distinct_id })\n        }\n\n        const isKnownAnonymous = this.persistence.get_user_state() === 'anonymous'\n\n        // send an $identify event any time the distinct_id is changing and the old ID is an anoymous ID\n        // - logic on the server will determine whether or not to do anything with it.\n        if (new_distinct_id !== previous_distinct_id && isKnownAnonymous) {\n            this.persistence.set_user_state('identified')\n            this.capture(\n                '$identify',\n                {\n                    distinct_id: new_distinct_id,\n                    $anon_distinct_id: previous_distinct_id,\n                },\n                { $set: userPropertiesToSet || {}, $set_once: userPropertiesToSetOnce || {} }\n            )\n            // let the reload feature flag request know to send this previous distinct id\n            // for flag consistency\n            this.featureFlags.setAnonymousDistinctId(previous_distinct_id)\n        } else {\n            if (userPropertiesToSet) {\n                this.people.set(userPropertiesToSet)\n            }\n            if (userPropertiesToSetOnce) {\n                this.people.set_once(userPropertiesToSetOnce)\n            }\n        }\n\n        // Reload active feature flags if the user identity changes.\n        // Note we don't reload this on property changes as these get processed async\n        if (new_distinct_id !== previous_distinct_id) {\n            this.reloadFeatureFlags()\n            // also clear any stored flag calls\n            this.unregister(FLAG_CALL_REPORTED)\n        }\n    }\n\n    /**\n     * Alpha feature: don't use unless you know what you're doing!\n     *\n     * Sets group analytics information for subsequent events and reloads feature flags.\n     *\n     * @param {String} groupType Group type (example: 'organization')\n     * @param {String} groupKey Group key (example: 'org::5')\n     * @param {Object} groupPropertiesToSet Optional properties to set for group\n     */\n    group(groupType: string, groupKey: string, groupPropertiesToSet?: Properties): void {\n        if (!groupType || !groupKey) {\n            console.error('posthog.group requires a group type and group key')\n            return\n        }\n\n        this._captureMetrics.incr('group')\n\n        const existingGroups = this.getGroups()\n\n        // if group key changes, remove stored group properties\n        if (existingGroups[groupType] !== groupKey) {\n            this.resetGroupPropertiesForFlags(groupType)\n        }\n\n        this.register({ $groups: { ...existingGroups, [groupType]: groupKey } })\n\n        if (groupPropertiesToSet) {\n            this.capture('$groupidentify', {\n                $group_type: groupType,\n                $group_key: groupKey,\n                $group_set: groupPropertiesToSet,\n            })\n            this.setGroupPropertiesForFlags({ [groupType]: groupPropertiesToSet })\n        }\n\n        // If groups change and no properties change, reload feature flags.\n        // The property change reload case is handled in setGroupPropertiesForFlags.\n        if (existingGroups[groupType] !== groupKey && !groupPropertiesToSet) {\n            this.reloadFeatureFlags()\n        }\n    }\n\n    /**\n     * Resets only the group properties of the user currently logged in.\n     */\n    resetGroups(): void {\n        this.register({ $groups: {} })\n        this.resetGroupPropertiesForFlags()\n\n        // If groups changed, reload feature flags.\n        this.reloadFeatureFlags()\n    }\n\n    /**\n     * Set override person properties for feature flags.\n     * This is used when dealing with new persons / where you don't want to wait for ingestion\n     * to update user properties.\n     */\n    setPersonPropertiesForFlags(properties: Properties, reloadFeatureFlags = true): void {\n        this.featureFlags.setPersonPropertiesForFlags(properties, reloadFeatureFlags)\n    }\n\n    resetPersonPropertiesForFlags(): void {\n        this.featureFlags.resetPersonPropertiesForFlags()\n    }\n\n    /**\n     * Set override group properties for feature flags.\n     * This is used when dealing with new groups / where you don't want to wait for ingestion\n     * to update properties.\n     * Takes in an object, the key of which is the group type.\n     * For example:\n     *     setGroupPropertiesForFlags({'organization': { name: 'CYZ', employees: '11' } })\n     */\n    setGroupPropertiesForFlags(properties: { [type: string]: Properties }, reloadFeatureFlags = true): void {\n        this.featureFlags.setGroupPropertiesForFlags(properties, reloadFeatureFlags)\n    }\n\n    resetGroupPropertiesForFlags(group_type?: string): void {\n        this.featureFlags.resetGroupPropertiesForFlags(group_type)\n    }\n\n    /**\n     * Clears super properties and generates a new random distinct_id for this instance.\n     * Useful for clearing data when a user logs out.\n     */\n    reset(reset_device_id?: boolean): void {\n        const device_id = this.get_property('$device_id')\n        this.persistence.clear()\n        this.sessionPersistence.clear()\n        this.persistence.set_user_state('anonymous')\n        this.sessionManager.resetSessionId()\n        const uuid = this.get_config('get_device_id')(_UUID())\n        this.register_once(\n            {\n                distinct_id: uuid,\n                $device_id: reset_device_id ? uuid : device_id,\n            },\n            ''\n        )\n    }\n\n    /**\n     * Returns the current distinct id of the user. This is either the id automatically\n     * generated by the library or the id that has been passed by a call to identify().\n     *\n     * ### Notes:\n     *\n     * get_distinct_id() can only be called after the PostHog library has finished loading.\n     * init() has a loaded function available to handle this automatically. For example:\n     *\n     *     // set distinct_id after the posthog library has loaded\n     *     posthog.init('YOUR PROJECT TOKEN', {\n     *         loaded: function(posthog) {\n     *             distinct_id = posthog.get_distinct_id();\n     *         }\n     *     });\n     */\n    get_distinct_id(): string {\n        return this.get_property('distinct_id')\n    }\n\n    getGroups(): Record<string, any> {\n        return this.get_property('$groups') || {}\n    }\n\n    /**\n     * Returns the current session_id.\n     *\n     * NOTE: This should only be used for informative purposes.\n     * Any actual internal use case for the session_id should be handled by the sessionManager.\n     */\n\n    get_session_id(): string {\n        return this.sessionManager.checkAndGetSessionAndWindowId(true).sessionId\n    }\n\n    /**\n     * Returns the Replay url for the current session.\n     *\n     * @param options Options for the url\n     * @param options.withTimestamp Whether to include the timestamp in the url (defaults to false)\n     * @param options.timestampLookBack How many seconds to look back for the timestamp (defaults to 10)\n     */\n    get_session_replay_url(options?: { withTimestamp?: boolean; timestampLookBack?: number }): string {\n        const host = this.config.ui_host || this.config.api_host\n        const { sessionId, sessionStartTimestamp } = this.sessionManager.checkAndGetSessionAndWindowId(true)\n        let url = host + '/replay/' + sessionId\n        if (options?.withTimestamp && sessionStartTimestamp) {\n            const LOOK_BACK = options.timestampLookBack ?? 10\n            if (!sessionStartTimestamp) {\n                return url\n            }\n            const recordingStartTime = Math.max(\n                Math.floor((new Date().getTime() - sessionStartTimestamp) / 1000) - LOOK_BACK,\n                0\n            )\n            url += `?t=${recordingStartTime}`\n        }\n\n        return url\n    }\n\n    /**\n     * Create an alias, which PostHog will use to link two distinct_ids going forward (not retroactively).\n     * Multiple aliases can map to the same original ID, but not vice-versa. Aliases can also be chained - the\n     * following is a valid scenario:\n     *\n     *     posthog.alias('new_id', 'existing_id');\n     *     ...\n     *     posthog.alias('newer_id', 'new_id');\n     *\n     * If the original ID is not passed in, we will use the current distinct_id - probably the auto-generated GUID.\n     *\n     * ### Notes:\n     *\n     * The best practice is to call alias() when a unique ID is first created for a user\n     * (e.g., when a user first registers for an account and provides an email address).\n     * alias() should never be called more than once for a given user, except to\n     * chain a newer ID to a previously new ID, as described above.\n     *\n     * @param {String} alias A unique identifier that you want to use for this user in the future.\n     * @param {String} [original] The current identifier being used for this user.\n     */\n    alias(alias: string, original?: string): CaptureResult | void | number {\n        // If the $people_distinct_id key exists in persistence, there has been a previous\n        // posthog.people.identify() call made for this user. It is VERY BAD to make an alias with\n        // this ID, as it will duplicate users.\n        if (alias === this.get_property(PEOPLE_DISTINCT_ID_KEY)) {\n            logger.critical('Attempting to create alias for existing People user - aborting.')\n            return -2\n        }\n\n        if (_isUndefined(original)) {\n            original = this.get_distinct_id()\n        }\n        if (alias !== original) {\n            this._register_single(ALIAS_ID_KEY, alias)\n            return this.capture('$create_alias', { alias: alias, distinct_id: original })\n        } else {\n            console.error('alias matches current distinct_id - skipping api call.')\n            this.identify(alias)\n            return -1\n        }\n    }\n\n    /**\n     * Update the configuration of a posthog library instance.\n     *\n     * The default config is:\n     *\n     *     {\n     *       // PostHog API host\n     *       api_host: 'https://app.posthog.com',\n     *\n     *       // HTTP method for capturing requests\n     *       api_method: 'POST'\n     *\n     *       // PostHog web app host, currently only used by the Sentry integration.\n     *       // This will only be different from api_host when using a reverse-proxied API host  in that case\n     *       // the original web app host needs to be passed here so that links to the web app are still convenient.\n     *       ui_host: 'https://app.posthog.com',\n     *\n     *       // Automatically capture clicks, form submissions and change events\n     *       autocapture: true\n     *\n     *       // Capture rage clicks\n     *       rageclick: true\n     *\n     *       // transport for sending requests ('XHR' or 'sendBeacon')\n     *       // NB: sendBeacon should only be used for scenarios such as\n     *       // page unload where a \"best-effort\" attempt to send is\n     *       // acceptable; the sendBeacon API does not support callbacks\n     *       // or any way to know the result of the request. PostHog\n     *       // capturing via sendBeacon will not support any event-\n     *       // batching or retry mechanisms.\n     *       api_transport: 'XHR'\n     *\n     *       // super properties cookie expiration (in days)\n     *       cookie_expiration: 365\n     *\n     *       // super properties span subdomains\n     *       cross_subdomain_cookie: true\n     *\n     *       // debug mode\n     *       debug: false\n     *\n     *       // if this is true, the posthog cookie or localStorage entry\n     *       // will be deleted, and no user persistence will take place\n     *       disable_persistence: false\n     *\n     *       // if this is true, PostHog will automatically determine\n     *       // City, Region and Country data using the IP address of\n     *       //the client\n     *       ip: true\n     *\n     *       // opt users out of capturing by this PostHog instance by default\n     *       opt_out_capturing_by_default: false\n     *\n     *       // opt users out of browser data storage by this PostHog instance by default\n     *       opt_out_persistence_by_default: false\n     *\n     *       // persistence mechanism used by opt-in/opt-out methods - cookie\n     *       // or localStorage - falls back to cookie if localStorage is unavailable\n     *       opt_out_capturing_persistence_type: 'localStorage'\n     *\n     *       // customize the name of cookie/localStorage set by opt-in/opt-out methods\n     *       opt_out_capturing_cookie_prefix: null\n     *\n     *       // type of persistent store for super properties (cookie/\n     *       // localStorage) if set to 'localStorage', any existing\n     *       // posthog cookie value with the same persistence_name\n     *       // will be transferred to localStorage and deleted\n     *       persistence: 'cookie'\n     *\n     *       // name for super properties persistent store\n     *       persistence_name: ''\n     *\n     *       // names of properties/superproperties which should never\n     *       // be sent with capture() calls\n     *       property_blacklist: []\n     *\n     *       // if this is true, posthog cookies will be marked as\n     *       // secure, meaning they will only be transmitted over https\n     *       secure_cookie: false\n     *\n     *       // should we capture a page view on page load\n     *       capture_pageview: true\n     *\n     *       // if you set upgrade to be true, the library will check for\n     *       // a cookie from our old js library and import super\n     *       // properties from it, then the old cookie is deleted\n     *       // The upgrade config option only works in the initialization,\n     *       // so make sure you set it when you create the library.\n     *       upgrade: false\n     *\n     *       // if this is true, session recording is always disabled.\n     *       disable_session_recording: false,\n     *\n     *       // extra HTTP request headers to set for each API request, in\n     *       // the format {'Header-Name': value}\n     *       xhr_headers: {}\n     *\n     *       // protocol for fetching in-app message resources, e.g.\n     *       // 'https://' or 'http://'; defaults to '//' (which defers to the\n     *       // current page's protocol)\n     *       inapp_protocol: '//'\n     *\n     *       // whether to open in-app message link in new tab/window\n     *       inapp_link_new_window: false\n     *\n     *      // a set of rrweb config options that PostHog users can configure\n     *      // see https://github.com/rrweb-io/rrweb/blob/master/guide.md\n     *      session_recording: {\n     *         blockClass: 'ph-no-capture',\n     *         blockSelector: null,\n     *         ignoreClass: 'ph-ignore-input',\n     *         maskAllInputs: true,\n     *         maskInputOptions: {},\n     *         maskInputFn: null,\n     *         slimDOMOptions: {},\n     *         collectFonts: false\n     *      }\n     *\n     *      // prevent autocapture from capturing any attribute names on elements\n     *      mask_all_element_attributes: false\n     *\n     *      // prevent autocapture from capturing textContent on all elements\n     *      mask_all_text: false\n     *\n     *      // Anonymous users get a random UUID as their device by default.\n     *      // This option allows overriding that option.\n     *      get_device_id: (uuid) => uuid\n     *     }\n     *\n     *\n     * @param {Object} config A dictionary of new configuration values to update\n     */\n\n    set_config(config: Partial<PostHogConfig>): void {\n        const oldConfig = { ...this.config }\n        if (_isObject(config)) {\n            _extend(this.config, config)\n\n            if (!this.get_config('persistence_name')) {\n                this.config.persistence_name = this.config.cookie_name\n            }\n            if (!this.get_config('disable_persistence')) {\n                this.config.disable_persistence = this.config.disable_cookie\n            }\n\n            if (this.persistence) {\n                this.persistence.update_config(this.config)\n            }\n            if (this.sessionPersistence) {\n                this.sessionPersistence.update_config(this.config)\n            }\n            if (localStore.is_supported() && localStore.get('ph_debug') === 'true') {\n                this.config.debug = true\n            }\n            if (this.get_config('debug')) {\n                Config.DEBUG = true\n            }\n\n            if (this.sessionRecording && typeof config.disable_session_recording !== 'undefined') {\n                if (oldConfig.disable_session_recording !== config.disable_session_recording) {\n                    if (config.disable_session_recording) {\n                        this.sessionRecording.stopRecording()\n                    } else {\n                        this.sessionRecording.startRecordingIfEnabled()\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * turns session recording on, and updates the config option\n     * disable_session_recording to false\n     */\n    startSessionRecording(): void {\n        this.set_config({ disable_session_recording: false })\n    }\n\n    /**\n     * turns session recording off, and updates the config option\n     * disable_session_recording to true\n     */\n    stopSessionRecording(): void {\n        this.set_config({ disable_session_recording: true })\n    }\n\n    /**\n     * returns a boolean indicating whether session recording\n     * is currently running\n     */\n    sessionRecordingStarted(): boolean {\n        return !!this.sessionRecording?.started()\n    }\n\n    /**\n     * returns a boolean indicating whether the toolbar loaded\n     * @param toolbarParams\n     */\n\n    loadToolbar(params: ToolbarParams): boolean {\n        return this.toolbar.loadToolbar(params)\n    }\n\n    /**\n     * returns the current config object for the library.\n     */\n    get_config<K extends keyof PostHogConfig>(prop_name: K): PostHogConfig[K] {\n        return this.config?.[prop_name]\n    }\n\n    /**\n     * Returns the value of the super property named property_name. If no such\n     * property is set, get_property() will return the undefined value.\n     *\n     * ### Notes:\n     *\n     * get_property() can only be called after the PostHog library has finished loading.\n     * init() has a loaded function available to handle this automatically. For example:\n     *\n     *     // grab value for '$user_id' after the posthog library has loaded\n     *     posthog.init('YOUR PROJECT TOKEN', {\n     *         loaded: function(posthog) {\n     *             user_id = posthog.get_property('$user_id');\n     *         }\n     *     });\n     *\n     * @param {String} property_name The name of the super property you want to retrieve\n     */\n    get_property(property_name: string): Property | undefined {\n        return this.persistence['props'][property_name]\n    }\n\n    /**\n     * Returns the value of the session super property named property_name. If no such\n     * property is set, getSessionProperty() will return the undefined value.\n     *\n     * ### Notes:\n     *\n     * This is based on browser-level `sessionStorage`, NOT the PostHog session.\n     * getSessionProperty() can only be called after the PostHog library has finished loading.\n     * init() has a loaded function available to handle this automatically. For example:\n     *\n     *     // grab value for 'user_id' after the posthog library has loaded\n     *     posthog.init('YOUR PROJECT TOKEN', {\n     *         loaded: function(posthog) {\n     *             user_id = posthog.getSessionProperty('user_id');\n     *         }\n     *     });\n     *\n     * @param {String} property_name The name of the session super property you want to retrieve\n     */\n    getSessionProperty(property_name: string): Property | undefined {\n        return this.sessionPersistence['props'][property_name]\n    }\n\n    toString(): string {\n        let name = this.get_config('name') ?? PRIMARY_INSTANCE_NAME\n        if (name !== PRIMARY_INSTANCE_NAME) {\n            name = PRIMARY_INSTANCE_NAME + '.' + name\n        }\n        return name\n    }\n\n    // perform some housekeeping around GDPR opt-in/out state\n    _gdpr_init(): void {\n        const is_localStorage_requested = this.get_config('opt_out_capturing_persistence_type') === 'localStorage'\n\n        // try to convert opt-in/out cookies to localStorage if possible\n        if (is_localStorage_requested && localStore.is_supported()) {\n            if (!this.has_opted_in_capturing() && this.has_opted_in_capturing({ persistence_type: 'cookie' })) {\n                this.opt_in_capturing({ enable_persistence: false })\n            }\n            if (!this.has_opted_out_capturing() && this.has_opted_out_capturing({ persistence_type: 'cookie' })) {\n                this.opt_out_capturing({ clear_persistence: false })\n            }\n            this.clear_opt_in_out_capturing({\n                persistence_type: 'cookie',\n                enable_persistence: false,\n            })\n        }\n\n        // check whether the user has already opted out - if so, clear & disable persistence\n        if (this.has_opted_out_capturing()) {\n            this._gdpr_update_persistence({ clear_persistence: true })\n\n            // check whether we should opt out by default\n            // note: we don't clear persistence here by default since opt-out default state is often\n            //       used as an initial state while GDPR information is being collected\n        } else if (\n            !this.has_opted_in_capturing() &&\n            (this.get_config('opt_out_capturing_by_default') || cookieStore.get('ph_optout'))\n        ) {\n            cookieStore.remove('ph_optout')\n            this.opt_out_capturing({\n                clear_persistence: this.get_config('opt_out_persistence_by_default'),\n            })\n        }\n    }\n\n    /**\n     * Enable or disable persistence based on options\n     * only enable/disable if persistence is not already in this state\n     * @param {boolean} [options.clear_persistence] If true, will delete all data stored by the sdk in persistence and disable it\n     * @param {boolean} [options.enable_persistence] If true, will re-enable sdk persistence\n     */\n    _gdpr_update_persistence(options: Partial<OptInOutCapturingOptions>): void {\n        let disabled\n        if (options && options['clear_persistence']) {\n            disabled = true\n        } else if (options && options['enable_persistence']) {\n            disabled = false\n        } else {\n            return\n        }\n\n        if (!this.get_config('disable_persistence') && this.persistence.disabled !== disabled) {\n            this.persistence.set_disabled(disabled)\n        }\n        if (!this.get_config('disable_persistence') && this.sessionPersistence.disabled !== disabled) {\n            this.sessionPersistence.set_disabled(disabled)\n        }\n    }\n\n    // call a base gdpr function after constructing the appropriate token and options args\n    _gdpr_call_func<R = any>(\n        func: (token: string, options: GDPROptions) => R,\n        options?: Partial<OptInOutCapturingOptions>\n    ): R {\n        options = _extend(\n            {\n                capture: this.capture.bind(this),\n                persistence_type: this.get_config('opt_out_capturing_persistence_type'),\n                cookie_prefix: this.get_config('opt_out_capturing_cookie_prefix'),\n                cookie_expiration: this.get_config('cookie_expiration'),\n                cross_subdomain_cookie: this.get_config('cross_subdomain_cookie'),\n                secure_cookie: this.get_config('secure_cookie'),\n            },\n            options || {}\n        )\n\n        // check if localStorage can be used for recording opt out status, fall back to cookie if not\n        if (!localStore.is_supported() && options['persistence_type'] === 'localStorage') {\n            options['persistence_type'] = 'cookie'\n        }\n\n        return func(this.get_config('token'), {\n            capture: options['capture'],\n            captureEventName: options['capture_event_name'],\n            captureProperties: options['capture_properties'],\n            persistenceType: options['persistence_type'],\n            persistencePrefix: options['cookie_prefix'],\n            cookieExpiration: options['cookie_expiration'],\n            crossSubdomainCookie: options['cross_subdomain_cookie'],\n            secureCookie: options['secure_cookie'],\n        })\n    }\n\n    /**\n     * Opt the user in to data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     // opt user in\n     *     posthog.opt_in_capturing();\n     *\n     *     // opt user in with specific event name, properties, cookie configuration\n     *     posthog.opt_in_capturing({\n     *         capture_event_name: 'User opted in',\n     *         capture_event_properties: {\n     *             'Email': 'jdoe@example.com'\n     *         },\n     *         cookie_expiration: 30,\n     *         secure_cookie: true\n     *     });\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {function} [options.capture] Function used for capturing a PostHog event to record the opt-in action (default is this PostHog instance's capture method)\n     * @param {string} [options.capture_event_name=$opt_in] Event name to be used for capturing the opt-in action\n     * @param {Object} [options.capture_properties] Set of properties to be captured along with the opt-in action\n     * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n     */\n    opt_in_capturing(options?: Partial<OptInOutCapturingOptions>): void {\n        options = _extend(\n            {\n                enable_persistence: true,\n            },\n            options || {}\n        )\n\n        this._gdpr_call_func(optIn, options)\n        this._gdpr_update_persistence(options)\n    }\n\n    /**\n     * Opt the user out of data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     // opt user out\n     *     posthog.opt_out_capturing();\n     *\n     *     // opt user out with different cookie configuration from PostHog instance\n     *     posthog.opt_out_capturing({\n     *         cookie_expiration: 30,\n     *         secure_cookie: true\n     *     });\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {boolean} [options.clear_persistence=true] If true, will delete all data stored by the sdk in persistence\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n     */\n    opt_out_capturing(options?: Partial<OptInOutCapturingOptions>): void {\n        const _options = _extend(\n            {\n                clear_persistence: true,\n            },\n            options || {}\n        )\n\n        this._gdpr_call_func(optOut, _options)\n        this._gdpr_update_persistence(_options)\n    }\n\n    /**\n     * Check whether the user has opted in to data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     const has_opted_in = posthog.has_opted_in_capturing();\n     *     // use has_opted_in value\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @returns {boolean} current opt-in status\n     */\n    has_opted_in_capturing(options?: Partial<OptInOutCapturingOptions>): boolean {\n        return this._gdpr_call_func(hasOptedIn, options)\n    }\n\n    /**\n     * Check whether the user has opted out of data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     const has_opted_out = posthog.has_opted_out_capturing();\n     *     // use has_opted_out value\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @returns {boolean} current opt-out status\n     */\n    has_opted_out_capturing(options?: Partial<OptInOutCapturingOptions>): boolean {\n        return this._gdpr_call_func(hasOptedOut, options)\n    }\n\n    /**\n     * Clear the user's opt in/out status of data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     // clear user's opt-in/out status\n     *     posthog.clear_opt_in_out_capturing();\n     *\n     *     // clear user's opt-in/out status with specific cookie configuration - should match\n     *     // configuration used when opt_in_capturing/opt_out_capturing methods were called.\n     *     posthog.clear_opt_in_out_capturing({\n     *         cookie_expiration: 30,\n     *         secure_cookie: true\n     *     });\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n     */\n    clear_opt_in_out_capturing(options?: Partial<OptInOutCapturingOptions>): void {\n        const _options: Partial<OptInOutCapturingOptions> = _extend(\n            {\n                enable_persistence: true,\n            },\n            options ?? {}\n        )\n        this._gdpr_call_func(clearOptInOut, _options)\n        this._gdpr_update_persistence(_options)\n    }\n\n    debug(debug?: boolean): void {\n        if (debug === false) {\n            window.console.log(\"You've disabled debug mode.\")\n            localStorage && localStorage.removeItem('ph_debug')\n            this.set_config({ debug: false })\n        } else {\n            window.console.log(\n                \"You're now in debug mode. All calls to PostHog will be logged in your console.\\nYou can disable this with `posthog.debug(false)`.\"\n            )\n            localStorage && localStorage.setItem('ph_debug', 'true')\n            this.set_config({ debug: true })\n        }\n    }\n}\n\n_safewrap_class(PostHog, ['identify'])\n\nconst instances: Record<string, PostHog> = {}\nconst extend_mp = function () {\n    // add all the sub posthog instances\n    _each(instances, function (instance, name) {\n        if (name !== PRIMARY_INSTANCE_NAME) {\n            posthog_master[name] = instance\n        }\n    })\n}\n\nconst override_ph_init_func = function () {\n    // we override the snippets init function to handle the case where a\n    // user initializes the posthog library after the script loads & runs\n    posthog_master['init'] = function (token?: string, config?: Partial<PostHogConfig>, name?: string) {\n        if (name) {\n            // initialize a sub library\n            if (!posthog_master[name]) {\n                posthog_master[name] = instances[name] = create_phlib(\n                    token || '',\n                    config || {},\n                    name,\n                    (instance: PostHog) => {\n                        posthog_master[name] = instances[name] = instance\n                        instance._loaded()\n                    }\n                )\n            }\n            return posthog_master[name]\n        } else {\n            let instance: PostHog = posthog_master as any as PostHog\n\n            if (instances[PRIMARY_INSTANCE_NAME]) {\n                // main posthog lib already initialized\n                instance = instances[PRIMARY_INSTANCE_NAME]\n            } else if (token) {\n                // intialize the main posthog lib\n                instance = create_phlib(token, config || {}, PRIMARY_INSTANCE_NAME, (instance: PostHog) => {\n                    instances[PRIMARY_INSTANCE_NAME] = instance\n                    instance._loaded()\n                })\n                instances[PRIMARY_INSTANCE_NAME] = instance\n            }\n\n            ;(posthog_master as any) = instance\n            if (init_type === InitType.INIT_SNIPPET) {\n                ;(window as any)[PRIMARY_INSTANCE_NAME] = posthog_master\n            }\n            extend_mp()\n            return instance\n        }\n    }\n}\n\nconst add_dom_loaded_handler = function () {\n    // Cross browser DOM Loaded support\n    function dom_loaded_handler() {\n        // function flag since we only want to execute this once\n        if ((dom_loaded_handler as any).done) {\n            return\n        }\n        ;(dom_loaded_handler as any).done = true\n\n        ENQUEUE_REQUESTS = false\n\n        _each(instances, function (inst: PostHog) {\n            inst._dom_loaded()\n        })\n    }\n\n    if (document.addEventListener) {\n        if (document.readyState === 'complete') {\n            // safari 4 can fire the DOMContentLoaded event before loading all\n            // external JS (including this file). you will see some copypasta\n            // on the internet that checks for 'complete' and 'loaded', but\n            // 'loaded' is an IE thing\n            dom_loaded_handler()\n        } else {\n            document.addEventListener('DOMContentLoaded', dom_loaded_handler, false)\n        }\n    }\n\n    // fallback handler, always will work\n    _register_event(window, 'load', dom_loaded_handler, true)\n}\n\nexport function init_from_snippet(): void {\n    init_type = InitType.INIT_SNIPPET\n    if (_isUndefined((window as any).posthog)) {\n        ;(window as any).posthog = []\n    }\n    posthog_master = (window as any).posthog\n\n    if (posthog_master['__loaded'] || (posthog_master['config'] && posthog_master['persistence'])) {\n        // lib has already been loaded at least once; we don't want to override the global object this time so bomb early\n        console.error('PostHog library has already been downloaded at least once.')\n        return\n    }\n\n    // Load instances of the PostHog Library\n    _each(posthog_master['_i'], function (item: [token: string, config: Partial<PostHogConfig>, name: string]) {\n        if (item && _isArray(item)) {\n            instances[item[2]] = create_phlib(...item)\n        }\n    })\n\n    override_ph_init_func()\n    ;(posthog_master['init'] as any)()\n\n    // Fire loaded events after updating the window's posthog object\n    _each(instances, function (instance) {\n        instance._loaded()\n    })\n\n    add_dom_loaded_handler()\n}\n\nexport function init_as_module(): PostHog {\n    init_type = InitType.INIT_MODULE\n    ;(posthog_master as any) = new PostHog()\n\n    override_ph_init_func()\n    ;(posthog_master['init'] as any)()\n    add_dom_loaded_handler()\n\n    return posthog_master as any\n}\n","import { PostHog } from './posthog-core'\nimport { SURVEYS } from './posthog-persistence'\nimport { SurveyCallback } from 'types'\n\nexport class PostHogSurveys {\n    instance: PostHog\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    getSurveys(callback: SurveyCallback, forceReload = false) {\n        const existingSurveys = this.instance.get_property(SURVEYS)\n        if (!existingSurveys || forceReload) {\n            this.instance._send_request(\n                `${this.instance.get_config('api_host')}/api/surveys/?token=${this.instance.get_config('token')}`,\n                {},\n                { method: 'GET' },\n                (response) => {\n                    const surveys = response.surveys\n                    this.instance.persistence.register({ [SURVEYS]: surveys })\n                    return callback(surveys)\n                }\n            )\n        } else {\n            return callback(existingSurveys)\n        }\n    }\n\n    getActiveMatchingSurveys(callback: SurveyCallback, forceReload = false) {\n        this.getSurveys((surveys) => {\n            const activeSurveys = surveys.filter((survey) => {\n                return !!(survey.start_date && !survey.end_date)\n            })\n            const conditionMatchedSurveys = activeSurveys.filter((survey) => {\n                if (!survey.conditions) {\n                    return true\n                }\n                const urlCheck = survey.conditions?.url\n                    ? window.location.href.indexOf(survey.conditions.url) > -1\n                    : true\n                const selectorCheck = survey.conditions?.selector\n                    ? document.querySelector(survey.conditions.selector)\n                    : true\n                return urlCheck && selectorCheck\n            })\n            const targetingMatchedSurveys = conditionMatchedSurveys.filter((survey) => {\n                if (!survey.linked_flag_key && !survey.targeting_flag_key) {\n                    return true\n                }\n                const linkedFlagCheck = survey.linked_flag_key\n                    ? this.instance.featureFlags.isFeatureEnabled(survey.linked_flag_key)\n                    : true\n                const targetingFlagCheck = survey.targeting_flag_key\n                    ? this.instance.featureFlags.isFeatureEnabled(survey.targeting_flag_key)\n                    : true\n                return linkedFlagCheck && targetingFlagCheck\n            })\n\n            return callback(targetingMatchedSurveys)\n        }, forceReload)\n    }\n}\n","import { gzipSync, strToU8 } from 'fflate'\nimport { _base64Encode } from './utils'\nimport { Compression, CompressionData, XHROptions } from './types'\n\nexport function decideCompression(compressionSupport: Partial<Record<Compression, boolean>>): Compression {\n    if (compressionSupport[Compression.GZipJS]) {\n        return Compression.GZipJS\n    } else {\n        return Compression.Base64\n    }\n}\n\nexport function compressData(\n    compression: Compression,\n    jsonData: string,\n    options: XHROptions\n): [CompressionData | Uint8Array, XHROptions] {\n    if (compression === Compression.GZipJS) {\n        // :TRICKY: This returns an UInt8Array. We don't encode this to a string - returning a blob will do this for us.\n        return [\n            gzipSync(strToU8(jsonData), { mtime: 0 }),\n            { ...options, blob: true, urlQueryArgs: { compression: Compression.GZipJS } },\n        ]\n    } else {\n        return [{ data: _base64Encode(jsonData) }, options]\n    }\n}\n","import { init_as_module } from './posthog-core'\nexport { PostHog } from './posthog-core'\nexport * from './types'\nexport const posthog = init_as_module()\nexport default posthog\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAIMA,CAAA,GAAS;EACXC,KAAA,GAAO;EACPC,WAAA;AAAA;;;;;;;;;;ACKCC,IAAA,CAAKC,KAAA,KACND,IAAA,CAAKC,KAAA,GAAQ,UAAUC,CAAA;EACnB,OAAOA,CAAA,GAAI,IAAIF,IAAA,CAAKG,IAAA,CAAKD,CAAA,IAAKF,IAAA,CAAKI,KAAA,CAAMF,CAAA;AAAA,IAK5CG,MAAA,CAAOC,SAAA,KACRD,MAAA,CAAOC,SAAA,GAAY,UAAUJ,CAAA;EACzB,OAAwB,mBAAVA,CAAA,IAAsBK,QAAA,CAASL,CAAA,KAAUF,IAAA,CAAKI,KAAA,CAAMF,CAAA,MAAWA,CAAA;AAAA;AAIrF,IAAMM,CAAA,GAAS;EAGFC,CAAA,GAAb;IAEI,SAAAP,EAAqBQ,CAAA;MACjB,IAD8CC,CAAA,OAAAT,CAAA,QAA7BU,KAAA,GAAAF,CAAA,EACI,OAAjBA,CAAA,CAAMG,MAAA,EACN,MAAM,IAAIC,SAAA,CAAU,qBAE3B;IAAA;IANL,OAAAC,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAuDI,SAAAA,CAAA;QAEI,KADA,IAAIf,CAAA,GAAO,IACFQ,CAAA,GAAI,GAAGA,CAAA,GAAI,KAAKE,KAAA,CAAMC,MAAA,EAAQH,CAAA,IACnCR,CAAA,IAAQM,CAAA,CAAOU,MAAA,CAAO,KAAKN,KAAA,CAAMF,CAAA,MAAO,IACxCR,CAAA,IAAQM,CAAA,CAAOU,MAAA,CAAuB,KAAhB,KAAKN,KAAA,CAAMF,CAAA,IACvB,MAANA,CAAA,IAAiB,MAANA,CAAA,IAAiB,MAANA,CAAA,IAAiB,MAANA,CAAA,KACjCR,CAAA,IAAQ;QAGhB,OAAOA,CACV;MAAA;IAAA,GAjEL;MAAAc,GAAA;MAAAC,KAAA,EAoEI,SAAAA,CAAA;QACI,OAAO,IAAIf,CAAA,CAAK,KAAKU,KAAA,CAAMO,KAAA,CAAM,GACpC;MAAA;IAAA,GAtEL;MAAAH,GAAA;MAAAC,KAAA,EAyEI,SAAAA,CAAOf,CAAA;QACH,OAAiC,MAA1B,KAAKkB,SAAA,CAAUlB,CAAA,CACzB;MAAA;IAAA,GA3EL;MAAAc,GAAA;MAAAC,KAAA,EAiFI,SAAAA,CAAUf,CAAA;QACN,KAAK,IAAIQ,CAAA,GAAI,GAAGA,CAAA,GAAI,IAAIA,CAAA,IAAK;UACzB,IAAMW,CAAA,GAAO,KAAKT,KAAA,CAAMF,CAAA,IAAKR,CAAA,CAAMU,KAAA,CAAMF,CAAA;UACzC,IAAa,MAATW,CAAA,EACA,OAAOrB,IAAA,CAAKsB,IAAA,CAAKD,CAAA,CAExB;QAAA;QACD,OAAO,CACV;MAAA;IAAA,IAzFL;MAAAL,GAAA;MAAAC,KAAA,EAgBI,SAAAA,CAAoBP,CAAA,EAAkBW,CAAA,EAAeV,CAAA,EAAiBY,CAAA;QAClE,KACKlB,MAAA,CAAOC,SAAA,CAAUI,CAAA,MACjBL,MAAA,CAAOC,SAAA,CAAUe,CAAA,MACjBhB,MAAA,CAAOC,SAAA,CAAUK,CAAA,MACjBN,MAAA,CAAOC,SAAA,CAAUiB,CAAA,KAClBb,CAAA,GAAW,KACXW,CAAA,GAAQ,KACRV,CAAA,GAAU,KACVY,CAAA,GAAU,KACVb,CAAA,GAAW,kBACXW,CAAA,GAAQ,QACRV,CAAA,GAAU,cACVY,CAAA,GAAU,YAEV,MAAM,IAAIC,UAAA,CAAW;QAGzB,IAAMT,CAAA,GAAQ,IAAIU,UAAA,CAAW;QAiB7B,OAhBAV,CAAA,CAAM,KAAKL,CAAA,GAAWV,IAAA,CAAA0B,GAAA,IAAK,KAC3BX,CAAA,CAAM,KAAKL,CAAA,GAAWV,IAAA,CAAA0B,GAAA,IAAK,KAC3BX,CAAA,CAAM,KAAKL,CAAA,GAAWV,IAAA,CAAA0B,GAAA,IAAK,KAC3BX,CAAA,CAAM,KAAKL,CAAA,GAAWV,IAAA,CAAA0B,GAAA,IAAK,KAC3BX,CAAA,CAAM,KAAKL,CAAA,GAAWV,IAAA,CAAA0B,GAAA,IAAK,IAC3BX,CAAA,CAAM,KAAKL,CAAA,EACXK,CAAA,CAAM,KAAK,MAAQM,CAAA,KAAU,GAC7BN,CAAA,CAAM,KAAKM,CAAA,EACXN,CAAA,CAAM,KAAK,MAAQJ,CAAA,KAAY,IAC/BI,CAAA,CAAM,KAAKJ,CAAA,KAAY,IACvBI,CAAA,CAAM,MAAMJ,CAAA,KAAY,GACxBI,CAAA,CAAM,MAAMJ,CAAA,EACZI,CAAA,CAAM,MAAMQ,CAAA,KAAY,IACxBR,CAAA,CAAM,MAAMQ,CAAA,KAAY,IACxBR,CAAA,CAAM,MAAMQ,CAAA,KAAY,GACxBR,CAAA,CAAM,MAAMQ,CAAA,EACL,IAAIrB,CAAA,CAAKa,CAAA,CACnB;MAAA;IAAA,KApDLb,CAAA;EAAA;EA6FMyB,CAAA;IAAA,SAAAzB,EAAA;MAAAS,CAAA,OAAAT,CAAA,GAAA0B,CAAA,oBACkB,IAAAA,CAAA,kBACF,IACQA,CAAA,qBAAIC,CAAA;IAAA;IAAA,OAAAd,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAY9B,SAAAa,CAAA;QACI,IAAM5B,CAAA,GAAQ,KAAK6B,eAAA;QACnB,SAAc,MAAV7B,CAAA,EACA,OAAOA,CAAA;QAGP,KAAK8B,SAAA,GAAY;QACjB,IAAMtB,CAAA,GAAkB,KAAKqB,eAAA;QAC7B,SAAwB,MAApBrB,CAAA,EACA,MAAM,IAAIuB,KAAA,CAAM;QAEpB,OAAOvB,CAEd;MAAA;IAAA;MAAAM,GAAA;MAAAC,KAAA,EAWD,SAAAA,CAAA;QACI,IAGMf,CAAA,GAAKgC,IAAA,CAAKC,GAAA;QAChB,IAAIjC,CAAA,GAAK,KAAK8B,SAAA,EACV,KAAKA,SAAA,GAAY9B,CAAA,EACjB,KAAKkC,YAAA,QACF;UAAA,MAAIlC,CAAA,GANgB,MAMU,KAAK8B,SAAA,GAUtC;UARA,KAAKK,OAAA,IACD,KAAKA,OAAA,GAVO,kBAYZ,KAAKL,SAAA,IACL,KAAKI,YAAA,GAKZ;QAAA;QAED,OAAO3B,CAAA,CAAK6B,YAAA,CACR,KAAKN,SAAA,EACLhC,IAAA,CAAKC,KAAA,CAAM,KAAKoC,OAAA,GAAArC,IAAA,CAAA0B,GAAA,CAAU,GAAK,MAC/B,KAAKW,OAAA,GAAWrC,IAAA,CAAK0B,GAAA,UAAK,GAC1B,KAAKa,MAAA,CAAOC,UAAA,GAEnB;MAAA;IAAA;MAAAxB,GAAA;MAAAC,KAAA,EAGD,SAAAA,CAAA;QACI,KAAKoB,OAAA,GAAqC,OAA3B,KAAKE,MAAA,CAAOC,UAAA,MAAmD,OAA3B,KAAKD,MAAA,CAAOC,UAAA,GAClE;MAAA;IAAA,KAAAtC,CAAA;EAAA;EAODuC,CAAA,GAAwE,SAAAC,CAACxC,CAAA;IAEzE,IAAoC,sBAAzByC,oBAAA,IAAwCA,oBAAA,EAC/C,MAAM,IAAIV,KAAA,CAAM;IAGpB,KAAK,IAAIvB,CAAA,GAAI,GAAGA,CAAA,GAAIR,CAAA,CAAOW,MAAA,EAAQH,CAAA,IAC/BR,CAAA,CAAOQ,CAAA,IAA4C,QAAvCV,IAAA,CAAKC,KAAA,CAAsB,QAAhBD,IAAA,CAAKuC,MAAA,MAAkCvC,IAAA,CAAKC,KAAA,CAAsB,QAAhBD,IAAA,CAAKuC,MAAA;IAElF,OAAOrC,CACV;EAAA;AAGqB,sBAAX0C,MAAA,IAA0BA,MAAA,CAAOF,eAAA,KACxCD,CAAA,GAAkB,SAAAC,CAACxC,CAAA;EAAD,OAAY0C,MAAA,CAAOF,eAAA,CAAgBxC,CAAA;AAAA;AAAA,IAoBrD2C,CAAA;EAZEhB,CAAA;IAAA,SAAA3B,EAAA;MAAAS,CAAA,OAAAT,CAAA,GAAA0B,CAAA,iBACwB,IAAIkB,WAAA,CAAY,KAAAlB,CAAA,iBACzB;IAAA;IAAA,OAAAb,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EACjB,SAAA8B,CAAA;QAKI,OAJI,KAAKC,MAAA,IAAU,KAAKC,MAAA,CAAOpC,MAAA,KAC3B4B,CAAA,CAAgB,KAAKQ,MAAA,GACrB,KAAKD,MAAA,GAAS,IAEX,KAAKC,MAAA,CAAO,KAAKD,MAAA,GAC3B;MAAA;IAAA,KAAA9C,CAAA;EAAA;EAcCgD,CAAA,GAAY,SAAAC,CAAA;IAAA,QAAaN,CAAA,KAAqBA,CAAA,GAAmB,IAAIlB,CAAA,KAAgByB,QAAA,EAAzE;EAAA;EC1OZC,CAAA,GAAaC,KAAA,CAAMC,SAAA;EACnBC,CAAA,GAAWC,MAAA,CAAOF,SAAA;EAClBG,CAAA,GAAWF,CAAA,CAASG,QAAA;EACpBC,CAAA,GAAiBJ,CAAA,CAASK,cAAA;EAC1BC,CAAA,GAAoD,sBAAXC,MAAA,GAAyBA,MAAA,GAAU;EAC5EC,CAAA,GAAYF,CAAA,CAAIG,SAAA,IAAa;IAAEC,SAAA,EAAW;EAAA;EAC1CC,CAAA,GAAWL,CAAA,CAAIM,QAAA,IAAY;EAC3BC,CAAA,GAAYL,CAAA,CAAUE,SAAA;EACtBI,CAAA,GAAe,CAAC,aAAa;EAE7BC,CAAA,GAAgBlB,CAAA,CAAWmB,OAAA;EAC7BC,CAAA,GAAgBpB,CAAA,CAAWqB,OAAA;EAC3BC,CAAA,GAAgBrB,KAAA,CAAMsB,OAAA;EACtBC,CAAA,GAAmB;EAGjBC,CAAA,GAAS;IAEXC,GAAA,EAAK,SAAAA,CAAA;MACD,IAAIlF,CAAA,CAAOC,KAAA,KAAUkF,CAAA,CAAajB,MAAA,CAAOkB,OAAA,KAAYlB,MAAA,CAAOkB,OAAA,EAAS;QAAA,KAEjE,IAAM/E,CAAA,GACF,yBAAwB6D,MAAA,CAAOkB,OAAA,CAAQF,GAAA,IAChChB,MAAA,CAAOkB,OAAA,CAAQF,GAAA,CAAhBG,kBAAA,GACAnB,MAAA,CAAOkB,OAAA,CAAQF,GAAA,EALwCrE,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,EADvDQ,CAAA,GACuD,IAAAiC,KAAA,CAAA5C,CAAA,GAAAC,CAAA,MAAAA,CAAA,GAAAD,CAAA,EAAAC,CAAA,IADvDU,CAAA,CACuDV,CAAA,IAAAwE,SAAA,CAAAxE,CAAA;QAOjE;UACIT,CAAA,CAAIkF,KAAA,CAAMrB,MAAA,CAAOkB,OAAA,EAAS5D,CAAA,CAD9B;QAAA,CAEE,QAAOX,CAAA;UACL2E,CAAA,CAAWhE,CAAA,EAAM,UAAUX,CAAA;YACvBR,CAAA,CAAIQ,CAAA,CACP;UAAA,EACJ;QAAA;MACJ;IAjBM;IAoBX4E,KAAA,EAAO,SAAAA,CAAA;MACH,IAAIzF,CAAA,CAAOC,KAAA,KAAUkF,CAAA,CAAajB,MAAA,CAAOkB,OAAA,KAAYlB,MAAA,CAAOkB,OAAA,EAAS;QAAA,SAAA/E,CAAA,GAAAiF,SAAA,CAAAtE,MAAA,EADrDH,CAAA,GACqD,IAAA4C,KAAA,CAAApD,CAAA,GAAAmB,CAAA,MAAAA,CAAA,GAAAnB,CAAA,EAAAmB,CAAA,IADrDX,CAAA,CACqDW,CAAA,IAAA8D,SAAA,CAAA9D,CAAA;QACjE,IAAMV,CAAA,GAAQ,mBAAA4E,MAAA,CAAqB7E,CAAA;UAE7Ba,CAAA,GACF,wBAAwBwC,MAAA,CAAOkB,OAAA,CAAQK,KAAA,GAChCvB,MAAA,CAAOkB,OAAA,CAAQK,KAAA,CAAhBJ,kBAAA,GACAnB,MAAA,CAAOkB,OAAA,CAAQK,KAAA;QACzB;UACI/D,CAAA,CAAM6D,KAAA,CAAMrB,MAAA,CAAOkB,OAAA,EAAStE,CAAA,CADhC;QAAA,CAEE,QAAOT,CAAA;UACLmF,CAAA,CAAW1E,CAAA,EAAM,UAAUT,CAAA;YACvBqB,CAAA,CAAMrB,CAAA,CACT;UAAA,EACJ;QAAA;MACJ;IAnCM;IAsCXsF,QAAA,EAAU,SAAAA,CAAA;MACN,KAAKR,CAAA,CAAajB,MAAA,CAAOkB,OAAA,KAAYlB,MAAA,CAAOkB,OAAA,EAAS;QAAA,SAAA/E,CAAA,GAAAiF,SAAA,CAAAtE,MAAA,EADlCH,CAAA,GACkC,IAAA4C,KAAA,CAAApD,CAAA,GAAAmB,CAAA,MAAAA,CAAA,GAAAnB,CAAA,EAAAmB,CAAA,IADlCX,CAAA,CACkCW,CAAA,IAAA8D,SAAA,CAAA9D,CAAA;QACjD,IAAMV,CAAA,GAAQ,mBAAA4E,MAAA,CAAqB7E,CAAA;UAE7Ba,CAAA,GACF,wBAAwBwC,MAAA,CAAOkB,OAAA,CAAQK,KAAA,GAChCvB,MAAA,CAAOkB,OAAA,CAAQK,KAAA,CAAhBJ,kBAAA,GACAnB,MAAA,CAAOkB,OAAA,CAAQK,KAAA;QACzB;UACI/D,CAAA,CAAM6D,KAAA,CAAMrB,MAAA,CAAOkB,OAAA,EAAStE,CAAA,CADhC;QAAA,CAEE,QAAOT,CAAA;UACLmF,CAAA,CAAW1E,CAAA,EAAM,UAAUT,CAAA;YACvBqB,CAAA,CAAMrB,CAAA,CACT;UAAA,EACJ;QAAA;MACJ;IACJ;EAAA;EAKQuF,CAAA,GAAQ,SAAAC,CAAUxF,CAAA;IAC3B,OAAOA,CAAA,CAAIyF,OAAA,CAAQ,sCAAsC,GAC5D;EAAA;AAUM,SAASN,EACZnF,CAAA,EACAQ,CAAA,EACAW,CAAA;EAEA,IAAIiC,KAAA,CAAMsB,OAAA,CAAQ1E,CAAA,GACd,IAAIqE,CAAA,IAAiBrE,CAAA,CAAIsE,OAAA,KAAYD,CAAA,EACjCrE,CAAA,CAAIsE,OAAA,CAAQ9D,CAAA,EAAUW,CAAA,OACnB,IAAI,YAAYnB,CAAA,IAAOA,CAAA,CAAIW,MAAA,MAAYX,CAAA,CAAIW,MAAA,EAC9C,KAAK,IAAIF,CAAA,GAAI,GAAGY,CAAA,GAAIrB,CAAA,CAAIW,MAAA,EAAQF,CAAA,GAAIY,CAAA,EAAGZ,CAAA,IACnC,IAAIA,CAAA,IAAKT,CAAA,IAAOQ,CAAA,CAASkF,IAAA,CAAKvE,CAAA,EAASnB,CAAA,CAAIS,CAAA,GAAIA,CAAA,MAAOkE,CAAA,EAClD;AAKnB;AAOM,SAASgB,EAAM3F,CAAA,EAAUQ,CAAA,EAAoDW,CAAA;EAChF,IAAI,QAAAnB,CAAA,EAAJ;IAGA,IAAIoD,KAAA,CAAMsB,OAAA,CAAQ1E,CAAA,GACd,OAAOmF,CAAA,CAAWnF,CAAA,EAAKQ,CAAA,EAAUW,CAAA;IAErC,KAAK,IAAMV,CAAA,IAAOT,CAAA,EACd,IAAI0D,CAAA,CAAegC,IAAA,CAAK1F,CAAA,EAAKS,CAAA,KACrBD,CAAA,CAASkF,IAAA,CAAKvE,CAAA,EAASnB,CAAA,CAAIS,CAAA,GAAMA,CAAA,MAASkE,CAAA,EAC1C;EAPX;AAWJ;AAEM,IAAMiB,CAAA,GAAU,SAAAC,CAAU7F,CAAA;IAA+E,SAAAQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,EAAlDQ,CAAA,GAAkD,IAAAiC,KAAA,CAAA5C,CAAA,OAAAA,CAAA,WAAAC,CAAA,MAAAA,CAAA,GAAAD,CAAA,EAAAC,CAAA,IAAlDU,CAAA,CAAkDV,CAAA,QAAAwE,SAAA,CAAAxE,CAAA;IAQ5G,OAPA0E,CAAA,CAAWhE,CAAA,EAAM,UAAUX,CAAA;MACvB,KAAK,IAAMW,CAAA,IAAQX,CAAA,OACM,MAAjBA,CAAA,CAAOW,CAAA,MACPnB,CAAA,CAAImB,CAAA,IAAQX,CAAA,CAAOW,CAAA,EAG9B;IAAA,IACMnB,CACV;EAAA;EAEY8F,CAAA,GACTrB,CAAA,IACA,UAAUzE,CAAA;IACN,OAA8B,qBAAvBwD,CAAA,CAASkC,IAAA,CAAK1F,CAAA,CACxB;EAAA;EAKQ+F,CAAA,GAAc,SAAAC,CAAUhG,CAAA;IACjC;MACI,OAAO,mBAAmBiG,IAAA,CAAKjG,CAAA,CADnC;IAAA,CAEE,QAAOA,CAAA;MACL,QAAO,CACV;IAAA;EACJ;AAsBM,SAASkG,EAAmBlG,CAAA,EAAmBQ,CAAA;EAClD,QAAyC,MAAjCR,CAAA,CAAYwE,OAAA,CAAQhE,CAAA,CAC/B;AAAA;AAkBM,IAAM2F,CAAA,GAAY,SAAAC,CAAUpG,CAAA;IAC/B,OAAOA,CAAA,KAAQuD,MAAA,CAAOvD,CAAA,MAAS8F,CAAA,CAAS9F,CAAA,CAC3C;EAAA;EAcY8E,CAAA,GAAe,SAAAuB,CAAUrG,CAAA;IAClC,YAAe,MAARA,CACV;EAAA;EAEYsG,CAAA,GAAY,SAAAC,CAAUvG,CAAA;IAC/B,OAA6B,qBAAtBwD,CAAA,CAASkC,IAAA,CAAK1F,CAAA,CACxB;EAAA;EAMYwG,CAAA,GAAY,SAAAC,CAAUzG,CAAA;IAC/B,OAA6B,qBAAtBwD,CAAA,CAASkC,IAAA,CAAK1F,CAAA,CACxB;EAAA;EAEY0G,CAAA,GAAe,SAAf1G,EAAyBQ,CAAA;IAQlC,OAPAmF,CAAA,CAAMnF,CAAA,EAAK,UAAUW,CAAA,EAAGV,CAAA;MAAA,CATL,UAAUT,CAAA;QAC7B,OAA6B,mBAAtBwD,CAAA,CAASkC,IAAA,CAAK1F,CAAA,CACxB;MAAA,CAQW,CAAQmB,CAAA,IAEDgF,CAAA,CAAUhF,CAAA,MACjBX,CAAA,CAAIC,CAAA,IAAKT,CAAA,CAAamB,CAAA,KAFtBX,CAAA,CAAIC,CAAA,IAAKkG,CAAA,CAAYxF,CAAA,CAI5B;IAAA,IACMX,CACV;EAAA;EAWYmG,CAAA,GAAc,SAAAC,CAAU5G,CAAA;IAEjC,SAASQ,EAAIR,CAAA;MACT,OAAOA,CAAA,GAAI,KAAK,MAAMA,CAAA,GAAIA,CAC7B;IAAA;IACD,OACIA,CAAA,CAAE6G,cAAA,KACF,MACArG,CAAA,CAAIR,CAAA,CAAE8G,WAAA,KAAgB,KACtB,MACAtG,CAAA,CAAIR,CAAA,CAAE+G,UAAA,MACN,MACAvG,CAAA,CAAIR,CAAA,CAAEgH,WAAA,MACN,MACAxG,CAAA,CAAIR,CAAA,CAAEiH,aAAA,MACN,MACAzG,CAAA,CAAIR,CAAA,CAAEkH,aAAA,GAEb;EAAA;EAEYC,CAAA,GAAY,SAAAC,CAAuEpH,CAAA;IAC5F,OAAO;MACH;QAAI,SAAAQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,EADYQ,CAAA,GACZ,IAAAiC,KAAA,CAAA5C,CAAA,GAAAC,CAAA,MAAAA,CAAA,GAAAD,CAAA,EAAAC,CAAA,IADYU,CAAA,CACZV,CAAA,IAAAwE,SAAA,CAAAxE,CAAA;QAGA,OAAOT,CAAA,CAAEkF,KAAA,CAAM,MAAM/D,CAAA,CAHzB;MAAA,CAIE,QAAOnB,CAAA;QACL4E,CAAA,CAAOU,QAAA,CAAS,gFAChBV,CAAA,CAAOU,QAAA,CAAStF,CAAA,CACnB;MAAA;IAAA,CAER;EAAA;EAiBYqH,EAAA,GAA0B,SAAAC,CAAUtH,CAAA;IAC7C,IAAMQ,CAAA,GAAkB;IAMxB,OALAmF,CAAA,CAAM3F,CAAA,EAAG,UAAUA,CAAA,EAAGmB,CAAA;MACdmF,CAAA,CAAUtG,CAAA,KAAMA,CAAA,CAAEW,MAAA,GAAS,MAC3BH,CAAA,CAAIW,CAAA,IAAKnB,CAAA,CAEhB;IAAA,IACMQ,CACV;EAAA;AA0CD,IAAM+G,EAAA,GAA0B,CAAC;AAE1B,SAASC,GACZxH,CAAA,EACAQ,CAAA;EAEA,OApCAW,CAAA,GAoCwBnB,CAAA,EAnCxBS,CAAA,GAmCgC,SAAAgH,CAACzH,CAAA,EAAYmB,CAAA;IACzC,OAAIA,CAAA,IAAOoG,EAAA,CAAwB/C,OAAA,CAAQrD,CAAA,KAAkB,IAClDnB,CAAA,GAEU,mBAAVA,CAAA,IAA0C,SAApBQ,CAAA,GACrBR,CAAA,CAAiBiB,KAAA,CAAM,GAAGT,CAAA,IAE/BR,CACV;EAAA,GAzCKqB,CAAA,GAAuB,IAAIqG,GAAA,IAEjC,SAAS1H,EAAyBQ,CAAA,EAAUW,CAAA;IACxC,OAAIX,CAAA,KAAU+C,MAAA,CAAO/C,CAAA,IAAeC,CAAA,GAAaA,CAAA,CAAWD,CAAA,EAAcW,CAAA,IAAOX,CAAA,GAE7Ea,CAAA,CAAqBsG,GAAA,CAAInH,CAAA,SAA7B,KACAa,CAAA,CAAqBuG,GAAA,CAAIpH,CAAA,GAGrBsF,CAAA,CAAStF,CAAA,KACTK,CAAA,GAAS,IACTsE,CAAA,CAAW3E,CAAA,EAAO,UAACA,CAAA;MACfK,CAAA,CAAOgH,IAAA,CAAK7H,CAAA,CAAyBQ,CAAA,EACxC;IAAA,OAEDK,CAAA,GAAS,IACT8E,CAAA,CAAMnF,CAAA,EAAO,UAACA,CAAA,EAAKW,CAAA;MACVE,CAAA,CAAqBsG,GAAA,CAAInH,CAAA,MACxBK,CAAA,CAAeM,CAAA,IAAOnB,CAAA,CAAyBQ,CAAA,EAAKW,CAAA,EAE7D;IAAA,KAEEN,CAAA;IAfP,IAAIA,CAgBP;EAAA,CACM,CAAyBM,CAAA;EA5BpC,IACIA,CAAA,EACAV,CAAA,EAEMY,CA0CT;AAAA;AAKM,SAASyG,GAAc9H,CAAA;EAC1B,IAIIQ,CAAA;IACAW,CAAA;IACAV,CAAA;IACAY,CAAA;IACAR,CAAA;IAREa,CAAA,GAAM;IASRqG,CAAA,GAAI;IACJC,CAAA,GAAK;IACLC,CAAA,GAAM;IACJC,CAAA,GAAoB;EAE1B,KAAKlI,CAAA,EACD,OAAOA,CAAA;EAGXA,CAAA,GAAOmI,EAAA,CAAYnI,CAAA;EAEnB;IAQIQ,CAAA,IAFAK,CAAA,GAJKb,CAAA,CAAKoI,UAAA,CAAWL,CAAA,OAIP,KAHT/H,CAAA,CAAKoI,UAAA,CAAWL,CAAA,OAGM,IAFtB/H,CAAA,CAAKoI,UAAA,CAAWL,CAAA,QAIP,KAAM,IACpB5G,CAAA,GAAMN,CAAA,IAAQ,KAAM,IACpBJ,CAAA,GAAMI,CAAA,IAAQ,IAAK,IACnBQ,CAAA,GAAY,KAAPR,CAAA,EAGLqH,CAAA,CAAQF,CAAA,MAAQtG,CAAA,CAAIV,MAAA,CAAOR,CAAA,IAAMkB,CAAA,CAAIV,MAAA,CAAOG,CAAA,IAAMO,CAAA,CAAIV,MAAA,CAAOP,CAAA,IAAMiB,CAAA,CAAIV,MAAA,CAAOK,CAAA;EAAA,SACzE0G,CAAA,GAAI/H,CAAA,CAAKW,MAAA;EAIlB,QAFAsH,CAAA,GAAMC,CAAA,CAAQG,IAAA,CAAK,KAEXrI,CAAA,CAAKW,MAAA,GAAS;IAClB,KAAK;MACDsH,CAAA,GAAMA,CAAA,CAAIhH,KAAA,CAAM,IAAI,KAAK;MACzB;IACJ,KAAK;MACDgH,CAAA,GAAMA,CAAA,CAAIhH,KAAA,CAAM,IAAI,KAAK;EAAA;EAIjC,OAAOgH,CACV;AAAA;AAEM,IA0CGK,EAAA;EA1CGH,EAAA,GAAc,SAAAI,CAAUvI,CAAA;IAGjC,IACIQ,CAAA;MACAW,CAAA;MACAV,CAAA;MACAY,CAAA;MAJAR,CAAA,GAAU;IASd,KAHAL,CAAA,GAAQW,CAAA,GAAM,GACdV,CAAA,IATAT,CAAA,IAAUA,CAAA,GAAS,IAAIyF,OAAA,CAAQ,SAAS,MAAMA,OAAA,CAAQ,OAAO,OAS5C9E,MAAA,EAEZU,CAAA,GAAI,GAAGA,CAAA,GAAIZ,CAAA,EAASY,CAAA,IAAK;MAC1B,IAAMK,CAAA,GAAK1B,CAAA,CAAOoI,UAAA,CAAW/G,CAAA;QACzB0G,CAAA,GAAM;MAENrG,CAAA,GAAK,MACLP,CAAA,KAEA4G,CAAA,GADOrG,CAAA,GAAK,OAAOA,CAAA,GAAK,OAClB8G,MAAA,CAAOC,YAAA,CAAc/G,CAAA,IAAM,IAAK,KAAW,KAALA,CAAA,GAAW,OAEjD8G,MAAA,CAAOC,YAAA,CAAc/G,CAAA,IAAM,KAAM,KAAOA,CAAA,IAAM,IAAK,KAAM,KAAW,KAALA,CAAA,GAAW,MAExE,SAARqG,CAAA,KACI5G,CAAA,GAAMX,CAAA,KACNK,CAAA,IAAWb,CAAA,CAAO0I,SAAA,CAAUlI,CAAA,EAAOW,CAAA,IAEvCN,CAAA,IAAWkH,CAAA,EACXvH,CAAA,GAAQW,CAAA,GAAME,CAAA,GAAI,EAEzB;IAAA;IAMD,OAJIF,CAAA,GAAMX,CAAA,KACNK,CAAA,IAAWb,CAAA,CAAO0I,SAAA,CAAUlI,CAAA,EAAOR,CAAA,CAAOW,MAAA,IAGvCE,CACV;EAAA;EAEY8H,EAAA,IAGHL,EAAA,GAAI,SAAAxE,CAAA;IAON,KANA,IAAM9D,CAAA,GAAI,IAAIgC,IAAA,GAAO4G,OAAA,IACjBpI,CAAA,GAAI,GAKDR,CAAA,IAAK,IAAIgC,IAAA,GAAO4G,OAAA,KACnBpI,CAAA;IAGJ,OAAOR,CAAA,CAAEyD,QAAA,CAAS,MAAMjD,CAAA,CAAEiD,QAAA,CAAS,GACtC;EAAA,GA2CM,UAAUzD,CAAA;IACb,IAAgB,SAAZA,CAAA,EACA,OD5RwBgD,CAAA,GAAYS,QAAA;IC+RxC,IAAMjD,CAAA,GAAuB,sBAAXqD,MAAA,IAA0BA,MAAA,CAAOgF,MAAA,CAAOC,MAAA,GAASjF,MAAA,CAAOgF,MAAA,CAAOE,KAAA,EAAOtF,QAAA,CAAS,MAAM;IACvG,OAAO6E,EAAA,KAAM,MA7CNxI,IAAA,CAAKuC,MAAA,GAASoB,QAAA,CAAS,IAAIgC,OAAA,CAAQ,KAAK,MA6CtB,MAtClB;MACP,IACIzF,CAAA;QACAQ,CAAA;QAFEW,CAAA,GAAKgD,CAAA;QAGP1D,CAAA,GAAM;QACNY,CAAA,GAAmB;MAEvB,SAASR,EAAIb,CAAA,EAAgBQ,CAAA;QACzB,IAAIW,CAAA;UACAV,CAAA,GAAM;QACV,KAAKU,CAAA,GAAI,GAAGA,CAAA,GAAIX,CAAA,CAAWG,MAAA,EAAQQ,CAAA,IAC/BV,CAAA,IAAOY,CAAA,CAAOF,CAAA,KAAW,IAAJA,CAAA;QAEzB,OAAOnB,CAAA,GAASS,CACnB;MAAA;MAED,KAAKT,CAAA,GAAI,GAAGA,CAAA,GAAImB,CAAA,CAAGR,MAAA,EAAQX,CAAA,IACvBQ,CAAA,GAAKW,CAAA,CAAGiH,UAAA,CAAWpI,CAAA,GACnBqB,CAAA,CAAO2H,OAAA,CAAa,MAALxI,CAAA,GACXa,CAAA,CAAOV,MAAA,IAAU,MACjBF,CAAA,GAAMI,CAAA,CAAIJ,CAAA,EAAKY,CAAA,GACfA,CAAA,GAAS;MAQjB,OAJIA,CAAA,CAAOV,MAAA,GAAS,MAChBF,CAAA,GAAMI,CAAA,CAAIJ,CAAA,EAAKY,CAAA,IAGZZ,CAAA,CAAIgD,QAAA,CAAS;IAAA,CASW,KAAO,MAAMjD,CAAA,GAAK,MAAM8H,EAAA;EAAA;EAOlDW,EAAA,GAAe,SAAAC,CAAUlJ,CAAA;IAClC,SACI,sPAAsPiG,IAAA,CAClPjG,CAAA,CAMX;EAAA;EAoBYmJ,EAAA,GAAiB,SAAAC,CAAUpJ,CAAA,EAAaQ,CAAA;IAGjD,IAAMW,CAAA,GAAaX,CAAA,CAAMiF,OAAA,CAAQ,OAAO,OAAOA,OAAA,CAAQ,QAAQ;MAGzDhF,CAAA,GADQ,IAAI4I,MAAA,CADH,WAAWlI,CAAA,GAAa,aAEjBmI,IAAA,CAAKtJ,CAAA;IAC3B,IAAgB,SAAZS,CAAA,IAAqBA,CAAA,IAAiC,mBAAfA,CAAA,CAAQ,MAAoBA,CAAA,CAAQ,GAAWE,MAAA,EACtF,OAAO;IAEP,IAAIU,CAAA,GAASZ,CAAA,CAAQ;IACrB;MACIY,CAAA,GAASkI,kBAAA,CAAmBlI,CAAA,CADhC;IAAA,CAEE,QAAOrB,CAAA;MACL4E,CAAA,CAAOQ,KAAA,CAAM,kDAAkD/D,CAAA,CAClE;IAAA;IACD,OAAOA,CAAA,CAAOoE,OAAA,CAAQ,OAAO,IAEpC;EAAA;EAEY+D,EAAA,GAAgB,SAAAC,CAAUzJ,CAAA,EAAcQ,CAAA;IACjD,IAAMW,CAAA,GAAUnB,CAAA,CAAK0J,KAAA,CAAM,IAAIL,MAAA,CAAO7I,CAAA,GAAQ;IAC9C,OAAOW,CAAA,GAAUA,CAAA,CAAQ,KAAK,IACjC;EAAA;EAEYwI,EAAA,GAAmB;IAqE5B,SAAS3J,EAASQ,CAAA;MAKd,OAJIA,CAAA,KACAA,CAAA,CAAMoJ,cAAA,GAAiB5J,CAAA,CAAS4J,cAAA,EAChCpJ,CAAA,CAAMqJ,eAAA,GAAkB7J,CAAA,CAAS6J,eAAA,GAE9BrJ,CACV;IAAA;IAQD,OAPAR,CAAA,CAAS4J,cAAA,GAAiB;MACpB,KAAsBE,WAAA,IAAc;IAAA,GAE1C9J,CAAA,CAAS6J,eAAA,GAAkB;MACrB,KAAsBE,YAAA,IAAe;IAAA,GAjEpB,UACnBvJ,CAAA,EACAW,CAAA,EACAV,CAAA,EACAY,CAAA,EACAR,CAAA;MAEA,IAAKL,CAAA;QAKL,IAAIA,CAAA,CAAQwJ,gBAAA,KAAqB3I,CAAA,EAC7Bb,CAAA,CAAQwJ,gBAAA,CAAiB7I,CAAA,EAAMV,CAAA,IAAWI,CAAA,OACvC;UACH,IAAMa,CAAA,GAAS,OAAOP,CAAA;YAChB4G,CAAA,GAAevH,CAAA,CAAgBkB,CAAA;UACnClB,CAAA,CAAgBkB,CAAA,IAI1B,UACIlB,CAAA,EACAW,CAAA,EACAV,CAAA;YAEA,OAAO,UAAUY,CAAA;cAQb,IAPAA,CAAA,GAAQA,CAAA,IAASrB,CAAA,CAAS6D,MAAA,CAAOoG,KAAA,GAOjC;gBAIA,IACIpJ,CAAA;kBADAa,CAAA,IAAM;gBAGNqE,CAAA,CAAYtF,CAAA,MACZI,CAAA,GAAaJ,CAAA,CAAaY,CAAA;gBAE9B,IAAM0G,CAAA,GAAa5G,CAAA,CAAYuE,IAAA,CAAKlF,CAAA,EAASa,CAAA;gBAM7C,QAJI,MAAUR,CAAA,KAAc,MAAUkH,CAAA,KAClCrG,CAAA,IAAM,IAGHA,CAdN;cAAA;YAAA,CAgBR;UAAA,CAnCmC,CAAYlB,CAAA,EAASC,CAAA,EAASsH,CAAA,CAC7D;QAAA;MAAA,OAVGnD,CAAA,CAAOQ,KAAA,CAAM;IAAA,CA6DxB;EAAA,CApF+B;AA0FzB,SAAS8E,GAAWlK,CAAA,EAAyBQ,CAAA;EAChD,IAAMW,CAAA,GAAY,SAAAgJ,CAAA;IACd,IAAMhJ,CAAA,GAAY8C,CAAA,CAASmG,aAAA,CAAc;IACzCjJ,CAAA,CAAUkJ,IAAA,GAAO,mBACjBlJ,CAAA,CAAUmJ,GAAA,GAAMtK,CAAA,EAChBmB,CAAA,CAAUoJ,MAAA,GAAS,UAACvK,CAAA;MAAD,OAAWQ,CAAA,MAAS,GAAWR,CAAA;IAAA,GAClDmB,CAAA,CAAUqJ,OAAA,GAAU,UAACxK,CAAA;MAAD,OAAWQ,CAAA,CAASR,CAAA;IAAA;IAExC,IACwBS,CAAA;MADlBY,CAAA,GAAU4C,CAAA,CAASwG,gBAAA,CAAiB;IACtCpJ,CAAA,CAAQV,MAAA,GAAS,IACjB,UAAAF,CAAA,GAAAY,CAAA,CAAQ,GAAGqJ,UAAA,UAAX,MAAAjK,CAAA,IAAAA,CAAA,CAAuBkK,YAAA,CAAaxJ,CAAA,EAAWE,CAAA,CAAQ,MAGvD4C,CAAA,CAAS2G,IAAA,CAAKC,WAAA,CAAY1J,CAAA;EAAA;EAI9B8C,CAAA,CAAS2G,IAAA,GACTzJ,CAAA,KAEA8C,CAAA,CAAS+F,gBAAA,CAAiB,oBAAoB7I,CAAA,CAErD;AAAA;AAEM,IAAM2J,EAAA,GAAQ;EACjBC,cAAA,EAAgB,SAAAA,CAAU/K,CAAA;IACtB,IAAMQ,CAAA,GAAoB,CACtB,cACA,cACA,gBACA,eACA,YACA,SACA,UACA,WACF6E,MAAA,CAAOrF,CAAA,IAAgB;MAEnBmB,CAAA,GAA8B;IAQpC,OAPAwE,CAAA,CAAMnF,CAAA,EAAmB,UAAUR,CAAA;MAC/B,IAAMQ,CAAA,GAAK2I,EAAA,CAAelF,CAAA,CAAS+G,GAAA,EAAKhL,CAAA;MACpCQ,CAAA,CAAGG,MAAA,KACHQ,CAAA,CAAOnB,CAAA,IAASQ,CAAA,CAEvB;IAAA,IAEMW,CArBM;EAAA;EAwBjB8J,YAAA,EAAc,SAAAA,CAAA;IACV,IAAMjL,CAAA,GAAWiE,CAAA,CAASiH,QAAA;IAC1B,OAAKlL,CAAA,GAE0D,MAApDA,CAAA,CAASmL,MAAA,CAAO,kCAChB,WAC6C,MAA7CnL,CAAA,CAASmL,MAAA,CAAO,2BAChB,SAC8C,MAA9CnL,CAAA,CAASmL,MAAA,CAAO,4BAChB,UACmD,MAAnDnL,CAAA,CAASmL,MAAA,CAAO,iCAChB,eAEA,OAVA,IA3BE;EAAA;EAyCjBC,UAAA,EAAY,SAAAA,CAAA;IACR,IAAMpL,CAAA,GAAS8K,EAAA,CAAMG,YAAA;MACjBzK,CAAA,GAAkB,WAAVR,CAAA,GAAoB,MAAM;MAClCmB,CAAA,GAA2B;IAE/B,IAAe,SAAXnB,CAAA,EAAiB;MACjBmB,CAAA,CAAGkK,cAAA,GAAqBrL,CAAA;MAExB,IAAMS,CAAA,GAAU0I,EAAA,CAAelF,CAAA,CAASiH,QAAA,EAAU1K,CAAA;MAC9CC,CAAA,CAAQE,MAAA,KACRQ,CAAA,CAAGmK,UAAA,GAAiB7K,CAAA,CAE3B;IAAA;IAED,OAAOU,CAvDM;EAAA;EA+DjBoK,OAAA,EAAS,SAAAA,CAAUvL,CAAA,EAAoBQ,CAAA,EAAgBW,CAAA;IAEnD,OADAX,CAAA,GAASA,CAAA,IAAU,IACfW,CAAA,IAAS+E,CAAA,CAAUlG,CAAA,EAAY,WAC3BkG,CAAA,CAAUlG,CAAA,EAAY,UACf,eAEJ,UACA,8BAA8BiG,IAAA,CAAKjG,CAAA,IACnC,eACAkG,CAAA,CAAUlG,CAAA,EAAY,eAAekG,CAAA,CAAUlG,CAAA,EAAY,eAC3D,6BACAkG,CAAA,CAAUlG,CAAA,EAAY,qBAEtB,qBACAkG,CAAA,CAAUlG,CAAA,EAAY,WAAWkG,CAAA,CAAUlG,CAAA,EAAY,UACvD,mBACAkG,CAAA,CAAUlG,CAAA,EAAY,WACtB,oBACAkG,CAAA,CAAUlG,CAAA,EAAY,YACtB,WACAkG,CAAA,CAAUlG,CAAA,EAAY,WACtB,eACAkG,CAAA,CAAUlG,CAAA,EAAY,YAAYkG,CAAA,CAAUlG,CAAA,EAAY,eACxD,eACAkG,CAAA,CAAUlG,CAAA,EAAY,WACtB,gBACAkG,CAAA,CAAU1F,CAAA,EAAQ,WACrB0F,CAAA,CAAUlG,CAAA,EAAY,YACf,kBAEJ,WACAkG,CAAA,CAAUlG,CAAA,EAAY,aACtB,mBACAkG,CAAA,CAAUlG,CAAA,EAAY,eACtB,cACAkG,CAAA,CAAUlG,CAAA,EAAY,aACtB,YACAkG,CAAA,CAAUlG,CAAA,EAAY,WAAWkG,CAAA,CAAUlG,CAAA,EAAY,cACvD,sBACAkG,CAAA,CAAUlG,CAAA,EAAY,WACtB,YAEA,EAzGE;EAAA;EAkHjBwL,cAAA,EAAgB,SAAAA,CAAUxL,CAAA,EAAmBQ,CAAA,EAAgBW,CAAA;IACzD,IAmBMV,CAAA,GAlBgB;MAClB,4BAA4B;MAC5B,kBAAkB;MAClBgL,MAAA,EAAQ;MACR,cAAc;MACd,cAAc;MACdC,MAAA,EAAQ;MACR,iBAAiB;MACjBC,KAAA,EAAO;MACPC,OAAA,EAAS;MACT,eAAe;MACfC,SAAA,EAAW;MACXC,UAAA,EAAY;MACZ,kBAAkB;MAClB,oBAAoB;MACpB,qBAAqB;MACrBC,OAAA,EAAS;IAAA,EAjBGjB,EAAA,CAAMS,OAAA,CAAQvL,CAAA,EAAWQ,CAAA,EAAQW,CAAA;IAoBjD,SAAc,MAAVV,CAAA,EACA,OAAO;IAEX,IAAMY,CAAA,GAAUrB,CAAA,CAAU0J,KAAA,CAAMjJ,CAAA;IAChC,OAAKY,CAAA,GAGE2K,UAAA,CAAW3K,CAAA,CAAQA,CAAA,CAAQV,MAAA,GAAS,MAFhC,IA5IE;EAAA;EAiJjBsL,eAAA,EAAiB,SAAAA,CAAA;IACb,OACInI,CAAA,CAAUoI,QAAA,IACTpI,CAAA,CAAkCqI,YApJ1B;EAAA;EAwJjBC,EAAA,EAAI,SAAAA,CAAUpM,CAAA;IACV,IAAI,WAAWiG,IAAA,CAAKjG,CAAA,GAAa;MAC7B,IAAI,QAAQiG,IAAA,CAAKjG,CAAA,KAAe,YAAYiG,IAAA,CAAKjG,CAAA,GAC7C,OAAO;QAAEqM,OAAA,EAAS;QAAiBC,UAAA,EAAY;MAAA;MAEnD,IAAM9L,CAAA,GAAQ,wBAAwB8I,IAAA,CAAKtJ,CAAA;MAC3C,OAAIQ,CAAA,IAASA,CAAA,CAAM,KAER;QAAE6L,OAAA,EAAS;QAAWC,UAAA,EADb9L,CAAA,CAAM;MAAA,IAGnB;QAAE6L,OAAA,EAAS;QAAWC,UAAA,EAAY;MAAA,CAT7C;IAAA;IAUO,IAAI,qBAAqBrG,IAAA,CAAKjG,CAAA,GAAa;MAC9C,IAAMmB,CAAA,GAAQ,0BAA0BmI,IAAA,CAAKtJ,CAAA;MAC7C,OAAImB,CAAA,IAASA,CAAA,CAAM,KAER;QAAEkL,OAAA,EAAS;QAAOC,UAAA,EADJ,CAACnL,CAAA,CAAM,IAAIA,CAAA,CAAM,IAAIA,CAAA,CAAM,MAAM,KACJkH,IAAA,CAAK;MAAA,IAEpD;QAAEgE,OAAA,EAAS;QAAOC,UAAA,EAAY;MAAA,CANlC;IAAA;IAOA,IAAI,UAAUrG,IAAA,CAAKjG,CAAA,GAAa;MACnC,IAAMS,CAAA,GAAQ,iCAAiC6I,IAAA,CAAKtJ,CAAA;MACpD,OAAIS,CAAA,IAASA,CAAA,CAAM,KAER;QAAE4L,OAAA,EAAS;QAAWC,UAAA,EADR,CAAC7L,CAAA,CAAM,IAAIA,CAAA,CAAM,IAAIA,CAAA,CAAM,MAAM,KACA4H,IAAA,CAAK;MAAA,IAExD;QAAEgE,OAAA,EAAS;QAAWC,UAAA,EAAY;MAAA,CANtC;IAAA;IAOA,IAAI,8BAA8BrG,IAAA,CAAKjG,CAAA,GAC1C,OAAO;MAAEqM,OAAA,EAAS;MAAcC,UAAA,EAAY;IAAA;IACzC,IAAI,OAAOrG,IAAA,CAAKjG,CAAA,GAAa;MAChC,IAAMqB,CAAA,GAAQ,sCAAsCiI,IAAA,CAAKtJ,CAAA;MACzD,OAAIqB,CAAA,IAASA,CAAA,CAAM,KAER;QAAEgL,OAAA,EAAS;QAAYC,UAAA,EADT,CAACjL,CAAA,CAAM,IAAIA,CAAA,CAAM,IAAIA,CAAA,CAAM,MAAM,KACCgH,IAAA,CAAK;MAAA,IAEzD;QAAEgE,OAAA,EAAS;QAAYC,UAAA,EAAY;MAAA,CANvC;IAAA;IAOA,OAAI,QAAQrG,IAAA,CAAKjG,CAAA,IACb;MAAEqM,OAAA,EAAS;MAASC,UAAA,EAAY;IAAA,IAChC,OAAOrG,IAAA,CAAKjG,CAAA,IACZ;MAAEqM,OAAA,EAAS;MAAaC,UAAA,EAAY;IAAA,IAEpC;MAAED,OAAA,EAAS;MAAIC,UAAA,EAAY;IAAA,CA/LzB;EAAA;EAmMjBC,MAAA,EAAQ,SAAAA,CAAUvM,CAAA;IACd,OAAI,iBAAiBiG,IAAA,CAAKjG,CAAA,KAAe,YAAYiG,IAAA,CAAKjG,CAAA,IAC/C,kBACA,OAAOiG,IAAA,CAAKjG,CAAA,IACZ,SACA,OAAOiG,IAAA,CAAKjG,CAAA,IACZ,eACA,SAASiG,IAAA,CAAKjG,CAAA,IACd,WACA,8BAA8BiG,IAAA,CAAKjG,CAAA,IACnC,eACA,UAAUiG,IAAA,CAAKjG,CAAA,MAAgB,SAASiG,IAAA,CAAKjG,CAAA,IAC7C,mBACA,UAAUiG,IAAA,CAAKjG,CAAA,IACf,YAEA,EAnNE;EAAA;EAuNjBwM,UAAA,EAAY,SAAAA,CAAUxM,CAAA;IAClB,IAAMQ,CAAA,GAAS,KAAK+L,MAAA,CAAOvM,CAAA;IAC3B,OAAe,WAAXQ,CAAA,IAAgC,qBAAXA,CAAA,GACd,WACAA,CAAA,GACA,WAEA,SA9NE;EAAA;EAkOjB0K,QAAA,EAAU,SAAAA,CAAA;IACN,OAAOjH,CAAA,CAASiH,QAAA,IAAY,SAnOf;EAAA;EAsOjBuB,eAAA,EAAiB,SAAAA,CAAA;IACb,KAAKxI,CAAA,CAASiH,QAAA,EACV,OAAO;IAEX,IAAMlL,CAAA,GAASiE,CAAA,CAASmG,aAAA,CAAc;IAEtC,OADApK,CAAA,CAAO0M,IAAA,GAAOzI,CAAA,CAASiH,QAAA,EAChBlL,CAAA,CAAO2M,IA5OD;EAAA;EA+OjBC,UAAA,EAAY,SAAAA,CAAA;IACR,IAAA5M,CAAA,GAAgC8K,EAAA,CAAMsB,EAAA,CAAGjI,CAAA;MAAjC3D,CAAA,GAAAR,CAAA,CAAAqM,OAAA;MAASlL,CAAA,GAAAnB,CAAA,CAAAsM,UAAA;IACjB,OAAO1G,CAAA,CACHyB,EAAA,CAAwB;MACpBwF,GAAA,EAAKrM,CAAA;MACLsM,WAAA,EAAa3L,CAAA;MACb4L,QAAA,EAAUjC,EAAA,CAAMS,OAAA,CAAQpH,CAAA,EAAWL,CAAA,CAAUkJ,MAAA,EAASpJ,CAAA,CAAYqJ,KAAA;MAClEC,OAAA,EAASpC,EAAA,CAAMyB,MAAA,CAAOpI,CAAA;MACtBgJ,YAAA,EAAcrC,EAAA,CAAM0B,UAAA,CAAWrI,CAAA;IAAA,IAEnC;MACIiJ,YAAA,EAAc,QAAAxJ,CAAA,YAAAA,CAAA,CAAKyJ,QAAA,CAASX,IAAA;MAC5BY,KAAA,EAAO,QAAA1J,CAAA,YAAAA,CAAA,CAAKyJ,QAAA,CAASV,IAAA;MACrBY,SAAA,EAAW,QAAA3J,CAAA,YAAAA,CAAA,CAAKyJ,QAAA,CAASG,QAAA;MACzBC,gBAAA,EAAkB3C,EAAA,CAAMU,cAAA,CAAerH,CAAA,EAAWL,CAAA,CAAUkJ,MAAA,EAASpJ,CAAA,CAAYqJ,KAAA;MACjFS,iBAAA,EAAmB5C,EAAA,CAAMmB,eAAA;MACzB0B,cAAA,EAAgB,QAAA/J,CAAA,YAAAA,CAAA,CAAKiF,MAAA,CAAOC,MAAA;MAC5B8E,aAAA,EAAe,QAAAhK,CAAA,YAAAA,CAAA,CAAKiF,MAAA,CAAOE,KAAA;MAC3B8E,gBAAA,EAAkB,QAAAjK,CAAA,YAAAA,CAAA,CAAKkK,WAAA;MACvBC,eAAA,EAAiB,QAAAnK,CAAA,YAAAA,CAAA,CAAKoK,UAAA;MACtBC,IAAA,EAAM;MACNC,YAAA,EAAcvO,CAAA,CAAOE,WAAA;MACrBsO,UAAA,EAAYrO,IAAA,CAAKuC,MAAA,GAASoB,QAAA,CAAS,IAAIiF,SAAA,CAAU,GAAG,MAAM5I,IAAA,CAAKuC,MAAA,GAASoB,QAAA,CAAS,IAAIiF,SAAA,CAAU,GAAG;MAClG0F,KAAA,GA9sBZpM,IAAA,CAAKC,GAAA,GACDD,IAAA,CAAKC,GAAA,IACL;QACI,QAAQ,IAAID,IAAA;MAAA,GAEbA,IAAA,CAAKC,GAAA,KAysBsB;IAAA,EAtQjB;EAAA;EA2QjBoM,iBAAA,EAAmB,SAAAA,CAAA;IACf,IAAArO,CAAA,GAAgC8K,EAAA,CAAMsB,EAAA,CAAGjI,CAAA;MAAjC3D,CAAA,GAAAR,CAAA,CAAAqM,OAAA;MAASlL,CAAA,GAAAnB,CAAA,CAAAsM,UAAA;IACjB,OAAO1G,CAAA,CACHyB,EAAA,CAAwB;MACpBwF,GAAA,EAAKrM,CAAA;MACLsM,WAAA,EAAa3L,CAAA;MACb4L,QAAA,EAAUjC,EAAA,CAAMS,OAAA,CAAQpH,CAAA,EAAWL,CAAA,CAAUkJ,MAAA,EAASpJ,CAAA,CAAYqJ,KAAA;IAAA,IAEtE;MACIQ,gBAAA,EAAkB3C,EAAA,CAAMU,cAAA,CAAerH,CAAA,EAAWL,CAAA,CAAUkJ,MAAA,EAASpJ,CAAA,CAAYqJ,KAAA;IAAA,EAG5F;EAAA;AAAA;AC98BE,SAASqB,GAAatO,CAAA;EACzB,QAAemB,CAAA,CAAAnB,CAAA,CAAGuO,SAAA;IACd,KAAK;MACD,OAAOvO,CAAA,CAAGuO,SAAA;IAEd,KAAK;MACD,QAAQ,aAAavO,CAAA,CAAGuO,SAAA,GAAavO,CAAA,CAAGuO,SAAA,CAAkBC,OAAA,GAAU,SAASxO,CAAA,CAAGyO,YAAA,CAAa,YAAY;IAC7G;MAEI,OAAO;EAAA;AAElB;AAWM,SAASC,GAAY1O,CAAA;EACxB,IAAIQ,CAAA,GAAS;EAmBb,OAjBImO,EAAA,CAAqB3O,CAAA,MAAQ4O,EAAA,CAAmB5O,CAAA,KAAOA,CAAA,CAAG6O,UAAA,IAAc7O,CAAA,CAAG6O,UAAA,CAAWlO,MAAA,IACtFgF,CAAA,CAAM3F,CAAA,CAAG6O,UAAA,EAAY,UAAU7O,CAAA;IACvB8O,EAAA,CAAW9O,CAAA,KAAUA,CAAA,CAAM+O,WAAA,KAC3BvO,CAAA,IAAU+E,CAAA,CAAMvF,CAAA,CAAM+O,WAAA,EAEjBC,KAAA,CAAM,SACNC,MAAA,CAAOC,EAAA,EACP7G,IAAA,CAAK,IAEL5C,OAAA,CAAQ,WAAW,KACnBA,OAAA,CAAQ,SAAS,KAEjBiD,SAAA,CAAU,GAAG,KAEzB;EAAA,IAGEnD,CAAA,CAAM/E,CAAA,CAChB;AAAA;AAOM,SAAS2O,GAAcnP,CAAA;EAC1B,SAASA,CAAA,IAAsB,MAAhBA,CAAA,CAAGoP,QACrB;AAAA;AAYM,SAASC,GAAMrP,CAAA,EAAgCQ,CAAA;EAClD,SAASR,CAAA,MAAQA,CAAA,CAAGsP,OAAA,IAAWtP,CAAA,CAAGsP,OAAA,CAAQC,WAAA,OAAkB/O,CAAA,CAAI+O,WAAA,EACnE;AAAA;AAOM,SAAST,GAAW9O,CAAA;EACvB,SAASA,CAAA,IAAsB,MAAhBA,CAAA,CAAGoP,QACrB;AAAA;AAOM,SAASI,GAAmBxP,CAAA;EAC/B,SAASA,CAAA,IAAsB,OAAhBA,CAAA,CAAGoP,QACrB;AAAA;AAEM,IAAMK,EAAA,GAAgC,CAAC,KAAK,UAAU,QAAQ,SAAS,UAAU,YAAY;AAwG7F,SAASd,GAAqB3O,CAAA;EACjC,KAAK,IAAIQ,CAAA,GAAQR,CAAA,EAAIQ,CAAA,CAAMkK,UAAA,KAAe2E,EAAA,CAAM7O,CAAA,EAAO,SAASA,CAAA,GAAQA,CAAA,CAAMkK,UAAA,EAAuB;IACjG,IAAMvJ,CAAA,GAAUmN,EAAA,CAAa9N,CAAA,EAAOwO,KAAA,CAAM;IAC1C,IAAI9I,CAAA,CAAU/E,CAAA,EAAS,mBAAmB+E,CAAA,CAAU/E,CAAA,EAAS,kBACzD,QAAO,CAEd;EAAA;EAED,IAAI+E,CAAA,CAAUoI,EAAA,CAAatO,CAAA,EAAIgP,KAAA,CAAM,MAAM,eACvC,QAAO;EAIX,IAAMvO,CAAA,GAAQT,CAAA,CAAwBqK,IAAA,IAAQ;EAC9C,IAAoB,mBAAT5J,CAAA,EAEP,QAAQA,CAAA,CAAK8O,WAAA;IACT,KAAK;IAEL,KAAK;MACD,QAAO;EAAA;EAKnB,IAAMlO,CAAA,GAAQrB,CAAA,CAAwB0P,IAAA,IAAQ1P,CAAA,CAAG2P,EAAA,IAAM;EAIvD,IAAoB,mBAATtO,CAAA,EAAmB;IAI1B,IADI,uHACmB4E,IAAA,CAAK5E,CAAA,CAAKoE,OAAA,CAAQ,iBAAiB,MACtD,QAAO,CAEd;EAAA;EAED,QAAO,CACV;AAAA;AAOM,SAASmJ,GAAmB5O,CAAA;EAI/B,UACKqP,EAAA,CAAMrP,CAAA,EAAI,aAFW,CAAC,UAAU,YAAY,UAAU,SAEb4P,QAAA,CAAU5P,CAAA,CAAwBqK,IAAA,KAC5EgF,EAAA,CAAMrP,CAAA,EAAI,aACVqP,EAAA,CAAMrP,CAAA,EAAI,eAC6B,WAAvCA,CAAA,CAAGyO,YAAA,CAAa,mBAKvB;AAAA;AAQM,SAASS,GAAmBlP,CAAA;EAC/B,IAAc,SAAVA,CAAA,IAAkB8E,CAAA,CAAa9E,CAAA,GAC/B,QAAO;EAGX,IAAqB,mBAAVA,CAAA,EAAoB;IAC3BA,CAAA,GAAQuF,CAAA,CAAMvF,CAAA;IAMd,IADI,wKACQiG,IAAA,EAAMjG,CAAA,IAAS,IAAIyF,OAAA,CAAQ,SAAS,MAC5C,QAAO;IAKX,IADiB,0BACJQ,IAAA,CAAKjG,CAAA,GACd,QAAO,CAEd;EAAA;EAED,QAAO,CACV;AAAA;AAuBM,SAAS6P,GAA2B7P,CAAA;EACvC,IAAIQ,CAAA,GAAOkO,EAAA,CAAY1O,CAAA;EAEvB,OAAOkP,EAAA,CADP1O,CAAA,GAAO,GAAG6E,MAAA,CAAA7E,CAAA,EAAQ,KAAA6E,MAAA,CAAAyK,EAAA,CAAkB9P,CAAA,GAAU+P,IAAA,MACZvP,CAAA,GAAO,EAC5C;AAAA;AAQM,SAASsP,GAAkB9P,CAAA;EAC9B,IAAIQ,CAAA,GAAO;EAiBX,OAhBIR,CAAA,IAAUA,CAAA,CAAO6O,UAAA,IAAc7O,CAAA,CAAO6O,UAAA,CAAWlO,MAAA,IACjDgF,CAAA,CAAM3F,CAAA,CAAO6O,UAAA,EAAY,UAAU7O,CAAA;IAAO,IAAAmB,CAAA;IACtC,IAAInB,CAAA,IAA0C,YAAlB,UAAfmB,CAAA,GAAAnB,CAAA,CAAMsP,OAAA,UAAS,MAAAnO,CAAA,YAAAA,CAAA,CAAAoO,WAAA,KACxB;MACI,IAAM9O,CAAA,GAAWiO,EAAA,CAAY1O,CAAA;MAC7BQ,CAAA,GAAO,GAAG6E,MAAA,CAAA7E,CAAA,OAAA6E,MAAA,CAAQ5E,CAAA,EAAWsP,IAAA,IAEzB/P,CAAA,CAAM6O,UAAA,IAAc7O,CAAA,CAAM6O,UAAA,CAAWlO,MAAA,KACrCH,CAAA,GAAO,GAAG6E,MAAA,CAAA7E,CAAA,EAAQ,KAAA6E,MAAA,CAAAyK,EAAA,CAAkB9P,CAAA,GAAS+P,IAAA,GALrD;IAAA,CAOE,QAAO/P,CAAA;MACL+E,OAAA,CAAQK,KAAA,CAAMpF,CAAA,CACjB;IAAA;EAER,IAEEQ,CACV;AAAA;ACnVD,IAIqBwP,EAAA;IAIjB,SAAAhQ,EAAYQ,CAAA;MAAkBC,CAAA,OAAAT,CAAA,GAC1B,KAAKiQ,MAAA,GAAS,IACd,KAAKC,OAAA,GAAU1P,CAClB;IAAA;IAAA,OAAAK,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAEDC,KAAA,WAAAA,CAAYf,CAAA,EAAWQ,CAAA,EAAWW,CAAA;QAC9B,KAAK,KAAK+O,OAAA,EACN,QAAO;QAGX,IAAMzP,CAAA,GAAY,KAAKwP,MAAA,CAAO,KAAKA,MAAA,CAAOtP,MAAA,GAAS;QACnD,IACIF,CAAA,IACAX,IAAA,CAAKqQ,GAAA,CAAInQ,CAAA,GAAIS,CAAA,CAAU0C,CAAA,IAAKrD,IAAA,CAAKqQ,GAAA,CAAI3P,CAAA,GAAIC,CAAA,CAAUd,CAAA,IArB/B,MAsBpBwB,CAAA,GAAYV,CAAA,CAAUqB,SAAA,GArBJ;UAyBlB,IAFA,KAAKmO,MAAA,CAAOpI,IAAA,CAAK;YAAE1E,CAAA,EAAAnD,CAAA;YAAGL,CAAA,EAAAa,CAAA;YAAGsB,SAAA,EAAAX;UAAA,IAtBN,MAwBf,KAAK8O,MAAA,CAAOtP,MAAA,EACZ,QAAO;QAAA,OAGX,KAAKsP,MAAA,GAAS,CAAC;UAAE9M,CAAA,EAAAnD,CAAA;UAAGL,CAAA,EAAAa,CAAA;UAAGsB,SAAA,EAAAX;QAAA;QAG3B,QAAO,CACV;MAAA;IAAA,KAAAnB,CAAA;EAAA;EClCCoQ,EAAA,GAAqB;EAGdC,EAAA,GAA+B;IACxCC,YAAA,EAAc,SAAAA,CAAA;MAAA,QAAM,CADoB;IAAA;IAGxClL,KAAA,EAAO,SAAAA,CAAUpF,CAAA;MACb4E,CAAA,CAAOQ,KAAA,CAAM,wBAAwBpF,CAAA,CAJD;IAAA;IAOxCuQ,GAAA,EAAK,SAAAA,CAAUvQ,CAAA;MACX;QAGI,KAFA,IAAMQ,CAAA,GAASR,CAAA,GAAO,KAChBmB,CAAA,GAAK+C,QAAA,CAASsM,MAAA,CAAOxB,KAAA,CAAM,MACxBvO,CAAA,GAAI,GAAGA,CAAA,GAAIU,CAAA,CAAGR,MAAA,EAAQF,CAAA,IAAK;UAEhC,KADA,IAAIY,CAAA,GAAIF,CAAA,CAAGV,CAAA,GACW,OAAfY,CAAA,CAAEL,MAAA,CAAO,KACZK,CAAA,GAAIA,CAAA,CAAEqH,SAAA,CAAU,GAAGrH,CAAA,CAAEV,MAAA;UAEzB,IAA0B,MAAtBU,CAAA,CAAEmD,OAAA,CAAQhE,CAAA,GACV,OAAO+I,kBAAA,CAAmBlI,CAAA,CAAEqH,SAAA,CAAUlI,CAAA,CAAOG,MAAA,EAAQU,CAAA,CAAEV,MAAA,EAE9D;QAAA;MACJ,CAAC,QAAOX,CAAA,GAAO;MAChB,OAAO,IArB6B;IAAA;IAwBxCyQ,KAAA,EAAO,SAAAA,CAAUzQ,CAAA;MACb,IAAIQ,CAAA;MACJ;QACIA,CAAA,GAASkQ,IAAA,CAAKD,KAAA,CAAMJ,EAAA,CAAYE,GAAA,CAAIvQ,CAAA,MAAU,EADlD;MAAA,CAEE,QAAOA,CAAA,GAER;MACD,OAAOQ,CA/B6B;IAAA;IAkCxCmQ,GAAA,EAAK,SAAAA,CAAU3Q,CAAA,EAAMQ,CAAA,EAAOW,CAAA,EAAMV,CAAA,EAAiBY,CAAA;MAC/C;QACI,IAAIR,CAAA,GAAU;UACVa,CAAA,GAAU;UACVqG,CAAA,GAAS;QAEb,IAAItH,CAAA,EAAiB;UACjB,IAAMuH,CAAA,GAAU9D,QAAA,CAASmJ,QAAA,CAASuD,QAAA,CAASlH,KAAA,CAAM0G,EAAA;YAC7CnI,CAAA,GAASD,CAAA,GAAUA,CAAA,CAAQ,KAAK;UAEpCnH,CAAA,GAAUoH,CAAA,GAAS,eAAeA,CAAA,GAAS,EAC9C;QAAA;QAED,IAAI9G,CAAA,EAAM;UACN,IAAM+G,CAAA,GAAO,IAAIlG,IAAA;UACjBkG,CAAA,CAAK2I,OAAA,CAAQ3I,CAAA,CAAK4I,OAAA,KAAmB,KAAP3P,CAAA,GAAY,KAAK,KAAK,MACpDO,CAAA,GAAU,eAAewG,CAAA,CAAK6I,WAAA,EACjC;QAAA;QAEG1P,CAAA,KACA0G,CAAA,GAAS;QAGb,IAAMiJ,CAAA,GACFhR,CAAA,GACA,MACAiR,kBAAA,CAAmBP,IAAA,CAAKQ,SAAA,CAAU1Q,CAAA,KAClCkB,CAAA,GACA,2BACAb,CAAA,GACAkH,CAAA;QAEJ,OADA7D,QAAA,CAASsM,MAAA,GAASQ,CAAA,EACXA,CA/BX;MAAA,CAgCE,QAAOhR,CAAA;QACL;MACH;IArEmC;IAwExCmR,MAAA,EAAQ,SAAAA,CAAUnR,CAAA,EAAMQ,CAAA;MACpB;QACI6P,EAAA,CAAYM,GAAA,CAAI3Q,CAAA,EAAM,KAAK,GAAGQ,CAAA,CADlC;MAAA,CAEE,QAAOR,CAAA;QACL;MACH;IACJ;EAAA;EAGDoR,EAAA,GAA0C;EAEjCC,EAAA,GAA8B;IACvCf,YAAA,EAAc,SAAAA,CAAA;MACV,IAAgC,SAA5Bc,EAAA,EACA,OAAOA,EAAA;MAGX,IAAIpR,CAAA,IAAY;MAChB,IAAsB,sBAAX6D,MAAA,EACP;QACI,IAAMrD,CAAA,GAAM;QAEZ6Q,EAAA,CAAWV,GAAA,CAAInQ,CAAA,EADL,QAEkB,YAAxB6Q,EAAA,CAAWd,GAAA,CAAI/P,CAAA,MACfR,CAAA,IAAY,IAEhBqR,EAAA,CAAWF,MAAA,CAAO3Q,CAAA,CAPtB;MAAA,CAQE,QAAOA,CAAA;QACLR,CAAA,IAAY,CACf;MAAA,OAEDA,CAAA,IAAY;MAOhB,OALKA,CAAA,IACD4E,CAAA,CAAOQ,KAAA,CAAM,2DAGjBgM,EAAA,GAA0BpR,CAAA,EACnBA,CA3B4B;IAAA;IA8BvCoF,KAAA,EAAO,SAAAA,CAAUpF,CAAA;MACb4E,CAAA,CAAOQ,KAAA,CAAM,yBAAyBpF,CAAA,CA/BH;IAAA;IAkCvCuQ,GAAA,EAAK,SAAAA,CAAUvQ,CAAA;MACX;QACI,OAAO6D,MAAA,CAAOyN,YAAA,CAAaC,OAAA,CAAQvR,CAAA,CADvC;MAAA,CAEE,QAAOA,CAAA;QACLqR,EAAA,CAAWjM,KAAA,CAAMpF,CAAA,CACpB;MAAA;MACD,OAAO,IAxC4B;IAAA;IA2CvCyQ,KAAA,EAAO,SAAAA,CAAUzQ,CAAA;MACb;QACI,OAAO0Q,IAAA,CAAKD,KAAA,CAAMY,EAAA,CAAWd,GAAA,CAAIvQ,CAAA,MAAU,EAD/C;MAAA,CAEE,QAAOA,CAAA,GAER;MACD,OAAO,IAjD4B;IAAA;IAoDvC2Q,GAAA,EAAK,SAAAA,CAAU3Q,CAAA,EAAMQ,CAAA;MACjB;QACIqD,MAAA,CAAOyN,YAAA,CAAaE,OAAA,CAAQxR,CAAA,EAAM0Q,IAAA,CAAKQ,SAAA,CAAU1Q,CAAA,EADrD;MAAA,CAEE,QAAOR,CAAA;QACLqR,EAAA,CAAWjM,KAAA,CAAMpF,CAAA,CACpB;MAAA;IAzDkC;IA4DvCmR,MAAA,EAAQ,SAAAA,CAAUnR,CAAA;MACd;QACI6D,MAAA,CAAOyN,YAAA,CAAaG,UAAA,CAAWzR,CAAA,CADnC;MAAA,CAEE,QAAOA,CAAA;QACLqR,EAAA,CAAWjM,KAAA,CAAMpF,CAAA,CACpB;MAAA;IACJ;EAAA;EAMQ0R,EAAA,GAAqClR,CAAA,CAAAA,CAAA,KAC3C6Q,EAAA,GAD2C;IAE9CZ,KAAA,EAAO,SAAAA,CAAUzQ,CAAA;MACb;QACI,IAAIQ,CAAA,GAAqB;QACzB;UAAA,CAEIA,CAAA,GAAS6P,EAAA,CAAYI,KAAA,CAAMzQ,CAAA,KAAS,IAC1B2R,WAAA,IACNtB,EAAA,CAAYM,GAAA,CAAI3Q,CAAA,EAAM;YAAE2R,WAAA,EAAanR,CAAA,CAAMmR;UAAA,EAElD;QAAA,CAAC,QAAO3R,CAAA,GAAO;QAChB,IAAMmB,CAAA,GAAQyE,CAAA,CAAQpF,CAAA,EAAQkQ,IAAA,CAAKD,KAAA,CAAMY,EAAA,CAAWd,GAAA,CAAIvQ,CAAA,KAAS;QAEjE,OADAqR,EAAA,CAAWV,GAAA,CAAI3Q,CAAA,EAAMmB,CAAA,GACdA,CAXX;MAAA,CAYE,QAAOnB,CAAA,GAER;MACD,OAAO,IAlBmC;IAAA;IAqB9C2Q,GAAA,EAAK,SAAAA,CAAU3Q,CAAA,EAAMQ,CAAA,EAAOW,CAAA,EAAMV,CAAA,EAAiBY,CAAA;MAC/C;QACIgQ,EAAA,CAAWV,GAAA,CAAI3Q,CAAA,EAAMQ,CAAA,GACjBA,CAAA,CAAMmR,WAAA,IACNtB,EAAA,CAAYM,GAAA,CAAI3Q,CAAA,EAAM;UAAE2R,WAAA,EAAanR,CAAA,CAAMmR;QAAA,GAAexQ,CAAA,EAAMV,CAAA,EAAiBY,CAAA,CAHzF;MAAA,CAKE,QAAOrB,CAAA;QACLqR,EAAA,CAAWjM,KAAA,CAAMpF,CAAA,CACpB;MAAA;IA7ByC;IAgC9CmR,MAAA,EAAQ,SAAAA,CAAUnR,CAAA,EAAMQ,CAAA;MACpB;QACIqD,MAAA,CAAOyN,YAAA,CAAaG,UAAA,CAAWzR,CAAA,GAC/BqQ,EAAA,CAAYc,MAAA,CAAOnR,CAAA,EAAMQ,CAAA,CAF7B;MAAA,CAGE,QAAOR,CAAA;QACLqR,EAAA,CAAWjM,KAAA,CAAMpF,CAAA,CACpB;MAAA;IACJ;EAAA;EAGC4R,EAAA,GAA4B;EAGrBC,EAAA,GAA+B;IACxCvB,YAAA,EAAc,SAAAA,CAAA;MACV,QAAO,CAF6B;IAAA;IAKxClL,KAAA,EAAO,SAAAA,CAAUpF,CAAA;MACb4E,CAAA,CAAOQ,KAAA,CAAM,0BAA0BpF,CAAA,CANH;IAAA;IASxCuQ,GAAA,EAAK,SAAAA,CAAUvQ,CAAA;MACX,OAAO4R,EAAA,CAAc5R,CAAA,KAAS,IAVM;IAAA;IAaxCyQ,KAAA,EAAO,SAAAA,CAAUzQ,CAAA;MACb,OAAO4R,EAAA,CAAc5R,CAAA,KAAS,IAdM;IAAA;IAiBxC2Q,GAAA,EAAK,SAAAA,CAAU3Q,CAAA,EAAMQ,CAAA;MACjBoR,EAAA,CAAc5R,CAAA,IAAQQ,CAlBc;IAAA;IAqBxC2Q,MAAA,EAAQ,SAAAA,CAAUnR,CAAA;MAAA,OACP4R,EAAA,CAAc5R,CAAA,CACxB;IAAA;EAAA;EAGD8R,EAAA,GAA0C;EAKjCC,EAAA,GAAgC;IACzCzB,YAAA,EAAc,SAAAA,CAAA;MACV,IAAgC,SAA5BwB,EAAA,EACA,OAAOA,EAAA;MAGX,IADAA,EAAA,IAA0B,GACJ,sBAAXjO,MAAA,EACP;QACI,IAAM7D,CAAA,GAAM;QAEZ+R,EAAA,CAAapB,GAAA,CAAI3Q,CAAA,EADP,QAEoB,YAA1B+R,EAAA,CAAaxB,GAAA,CAAIvQ,CAAA,MACjB8R,EAAA,IAA0B,IAE9BC,EAAA,CAAaZ,MAAA,CAAOnR,CAAA,CAPxB;MAAA,CAQE,QAAOA,CAAA;QACL8R,EAAA,IAA0B,CAC7B;MAAA,OAEDA,EAAA,IAA0B;MAE9B,OAAOA,EArB8B;IAAA;IAwBzC1M,KAAA,EAAO,SAAAA,CAAUpF,CAAA;MACTL,CAAA,CAAOC,KAAA,IACPgF,CAAA,CAAOQ,KAAA,CAAM,0BAA0BpF,CAAA,CA1BN;IAAA;IA8BzCuQ,GAAA,EAAK,SAAAA,CAAUvQ,CAAA;MACX;QACI,OAAO6D,MAAA,CAAOmO,cAAA,CAAeT,OAAA,CAAQvR,CAAA,CADzC;MAAA,CAEE,QAAOA,CAAA;QACL+R,EAAA,CAAa3M,KAAA,CAAMpF,CAAA,CACtB;MAAA;MACD,OAAO,IApC8B;IAAA;IAuCzCyQ,KAAA,EAAO,SAAAA,CAAUzQ,CAAA;MACb;QACI,OAAO0Q,IAAA,CAAKD,KAAA,CAAMsB,EAAA,CAAaxB,GAAA,CAAIvQ,CAAA,MAAU,IADjD;MAAA,CAEE,QAAOA,CAAA,GAER;MACD,OAAO,IA7C8B;IAAA;IAgDzC2Q,GAAA,EAAK,SAAAA,CAAU3Q,CAAA,EAAMQ,CAAA;MACjB;QACIqD,MAAA,CAAOmO,cAAA,CAAeR,OAAA,CAAQxR,CAAA,EAAM0Q,IAAA,CAAKQ,SAAA,CAAU1Q,CAAA,EADvD;MAAA,CAEE,QAAOR,CAAA;QACL+R,EAAA,CAAa3M,KAAA,CAAMpF,CAAA,CACtB;MAAA;IArDoC;IAwDzCmR,MAAA,EAAQ,SAAAA,CAAUnR,CAAA;MACd;QACI6D,MAAA,CAAOmO,cAAA,CAAeP,UAAA,CAAWzR,CAAA,CADrC;MAAA,CAEE,QAAOA,CAAA;QACL+R,EAAA,CAAa3M,KAAA,CAAMpF,CAAA,CACtB;MAAA;IACJ;EAAA;EClSQiS,EAAA,GAAyB;EACzBC,EAAA,GAAe;EAEfC,EAAA,GAAmB;EACnBC,EAAA,GAAmC;EACnCC,EAAA,GAAwC;EACxCC,EAAA,GAA4C;EAC5CC,EAAA,GAAiD;EACjDC,EAAA,GAAa;EACbC,EAAA,GAAwB;EACxBC,EAAA,GAAoC;EACpCC,EAAA,GAA+B;EAC/BC,EAAA,GAA8B;EAC9BC,EAAA,GAAU;EACVC,EAAA,GAAqB;EAE5BC,EAAA,GAAa;EAENC,EAAA,GAAsB,CAC/Bf,EAAA,EACAC,EAAA,EAlB4B,WAoB5BC,EAAA,EACAE,EAAA,EACAG,EAAA,EACAC,EAAA,EACAM,EAAA,EACAL,EAAA,EACAE,EAAA,EACAD,EAAA,EACAE,EAAA,EACAC,EAAA;EAGEG,EAAA,GAAyF,CAC3F,UACA,gBACA,uBACA,kBACA;EAOSC,EAAA,GAAb;IAaI,SAAAlT,EAAYQ,CAAA;MAAuBC,CAAA,OAAAT,CAAA;MAG/B,IAAImB,CAAA,GAAQ;MAERX,CAAA,CAAM2S,KAAA,KACNhS,CAAA,GAAQX,CAAA,CAAM2S,KAAA,CAAU1N,OAAA,CAAQ,OAAO,MAAMA,OAAA,CAAQ,OAAO,MAAMA,OAAA,CAAQ,MAAM,QAGpF,KAAK2N,KAAA,GAAQ,IACb,KAAKC,qBAAA,IAAwB,GAC7B,KAAKC,sBAAA,GAAyB9S,CAAA,CAAM8S,sBAAA,IAA8B,IAE9D9S,CAAA,CAAM+S,gBAAA,GACN,KAAK7D,IAAA,GAAO,QAAQlP,CAAA,CAAM+S,gBAAA,GAE1B,KAAK7D,IAAA,GAAO,QAAQvO,CAAA,GAAQ,aAMrB,MAFP8R,EAAA,CAAmCzO,OAAA,CAC/BhE,CAAA,CAAMgT,WAAA,CAAgBjE,WAAA,QAG1B3K,CAAA,CAAOU,QAAA,CAAS,8BAA8B9E,CAAA,CAAMgT,WAAA,GAAkB,6BACtEhT,CAAA,CAAMgT,WAAA,GAAkB;MAG5B,IAAMnS,CAAA,GAAeb,CAAA,CAAMgT,WAAA,CAAgBjE,WAAA;MACtB,mBAAjBlO,CAAA,IAAmCgQ,EAAA,CAAWf,YAAA,KAC9C,KAAKmD,OAAA,GAAUpC,EAAA,GACS,0BAAjBhQ,CAAA,IAA0CqQ,EAAA,CAAqBpB,YAAA,KACtE,KAAKmD,OAAA,GAAU/B,EAAA,GACS,qBAAjBrQ,CAAA,IAAqC0Q,EAAA,CAAazB,YAAA,KACzD,KAAKmD,OAAA,GAAU1B,EAAA,GAEf,KAAK0B,OAAA,GADmB,aAAjBpS,CAAA,GACQwQ,EAAA,GAEAxB,EAAA,EAGnB,KAAKqD,UAAA,GAAa,aAElB,KAAKC,IAAA,IACL,KAAKC,aAAA,CAAcpT,CAAA,GACnB,KAAKqT,IAAA,EACR;IAAA;IA3DL,OAAAhT,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EA6DI,SAAAA,CAAA;QACI,IAAMf,CAAA,GAAgB;QAYtB,OAVA2F,CAAA,CAAM,KAAKyN,KAAA,EAAO,UAAU5S,CAAA,EAAGC,CAAA;UAC3B,IAAIA,CAAA,KAAMgS,EAAA,IAAsC,aAAbtR,CAAA,CAAOX,CAAA,GAEtC,KADA,IAAMa,CAAA,GAAOkC,MAAA,CAAOuQ,IAAA,CAAKtT,CAAA,GAChBK,CAAA,GAAI,GAAGA,CAAA,GAAIQ,CAAA,CAAKV,MAAA,EAAQE,CAAA,IAC7Bb,CAAA,CAAc,YAAAqF,MAAA,CAAAhE,CAAA,CAAKR,CAAA,MAAQL,CAAA,CAAEa,CAAA,CAAKR,CAAA,QJyClDkH,CAAA,GIvCkDtH,CAAA,EJyC9CuH,CAAA,IAAQ,IACA,UAJZtG,CAAA,GItC6BsR,EAAA,IJ2ClBhL,CAAA,GAEPzD,CAAA,IAAiB7C,CAAA,CAAI8C,OAAA,KAAYD,CAAA,IACF,KAAxB7C,CAAA,CAAI8C,OAAA,CAAQuD,CAAA,KAEvBpC,CAAA,CAAMjE,CAAA,EAAK,UAAU1B,CAAA;YACjB,IAAIgI,CAAA,KAAUA,CAAA,GAAQhI,CAAA,KAAU+H,CAAA,GAC5B,OAAOpD,CAGd;UAAA,IACMqD,CAAA,OIrDKhI,CAAA,CAAES,CAAA,IAAKD,CAAA;UJoCC,IACpBkB,CAAA,EACAqG,CAAA,EAEIC,CItCC;QAAA,IACMhI,CACV;MAAA;IAAA,GA3EL;MAAAc,GAAA;MAAAC,KAAA,EA6EI,SAAAA,CAAA;QACI,KAAI,KAAKgT,QAAA,EAAT;UAIA,IAAM/T,CAAA,GAAQ,KAAKyT,OAAA,CAAQhD,KAAA,CAAM,KAAKf,IAAA;UAElC1P,CAAA,KACA,KAAKoT,KAAA,GAAQxN,CAAA,CAAQ,CAAD,GAAK5F,CAAA,EAL5B;QAAA;MAOJ;IAAA,GAvFL;MAAAc,GAAA;MAAAC,KAAA,EA8FI,SAAAA,CAAA;QACQ,KAAKgT,QAAA,IAGT,KAAKN,OAAA,CAAQ9C,GAAA,CAAI,KAAKjB,IAAA,EAAM,KAAK0D,KAAA,EAAO,KAAKY,WAAA,EAAa,KAAKC,eAAA,EAAiB,KAAKC,MAAA,CACxF;MAAA;IAAA,GAnGL;MAAApT,GAAA;MAAAC,KAAA,EAqGI,SAAAA,CAAA;QAEI,KAAK0S,OAAA,CAAQtC,MAAA,CAAO,KAAKzB,IAAA,GAAM,IAC/B,KAAK+D,OAAA,CAAQtC,MAAA,CAAO,KAAKzB,IAAA,GAAM,EAxGvC;MAAA;IAAA;MAAA5O,GAAA;MAAAC,KAAA,EA8GI,SAAAA,CAAA;QACI,KAAKoQ,MAAA,IACL,KAAKiC,KAAA,GAAQ,EAChB;MAAA;IAAA,GAjHL;MAAAtS,GAAA;MAAAC,KAAA,EAyHI,SAAAA,CAAcf,CAAA,EAAmBQ,CAAA,EAAoBW,CAAA;QAAwB,IAAAV,CAAA;QACzE,IAAI0F,CAAA,CAAUnG,CAAA,GAAQ;UAAA,KACW,MAAlBQ,CAAA,KACPA,CAAA,GAAgB,SAEpB,KAAKwT,WAAA,QAA8B,MAAT7S,CAAA,GAAuB,KAAKgT,cAAA,GAAiBhT,CAAA;UAEvE,IAAIE,CAAA,IAAa;UASjB,IAPAsE,CAAA,CAAM3F,CAAA,EAAO,UAACA,CAAA,EAAKmB,CAAA;YACVV,CAAA,CAAK2S,KAAA,CAAMzP,cAAA,CAAexC,CAAA,KAASV,CAAA,CAAK2S,KAAA,CAAMjS,CAAA,MAAUX,CAAA,KACzDC,CAAA,CAAK2S,KAAA,CAAMjS,CAAA,IAAQnB,CAAA,EACnBqB,CAAA,IAAa,EAEpB;UAAA,IAEGA,CAAA,EAEA,OADA,KAAKwS,IAAA,KACE,CAEd;QAAA;QACD,QAAO,CACV;MAAA;IAAA,GA/IL;MAAA/S,GAAA;MAAAC,KAAA,EAsJI,SAAAA,CAASf,CAAA,EAAmBQ,CAAA;QAAwB,IAAAW,CAAA;QAChD,IAAIgF,CAAA,CAAUnG,CAAA,GAAQ;UAClB,KAAKgU,WAAA,QAA8B,MAATxT,CAAA,GAAuB,KAAK2T,cAAA,GAAiB3T,CAAA;UAEvE,IAAIC,CAAA,IAAa;UASjB,IAPAkF,CAAA,CAAM3F,CAAA,EAAO,UAACQ,CAAA,EAAKa,CAAA;YACXrB,CAAA,CAAM2D,cAAA,CAAetC,CAAA,KAASF,CAAA,CAAKiS,KAAA,CAAM/R,CAAA,MAAUb,CAAA,KACnDW,CAAA,CAAKiS,KAAA,CAAM/R,CAAA,IAAQb,CAAA,EACnBC,CAAA,IAAa,EAEpB;UAAA,IAEGA,CAAA,EAEA,OADA,KAAKoT,IAAA,KACE,CAEd;QAAA;QACD,QAAO,CACV;MAAA;IAAA,GAzKL;MAAA/S,GAAA;MAAAC,KAAA,EA2KI,SAAAA,CAAWf,CAAA;QACHA,CAAA,IAAQ,KAAKoT,KAAA,YACN,KAAKA,KAAA,CAAMpT,CAAA,GAClB,KAAK6T,IAAA,GAEZ;MAAA;IAAA,GAhLL;MAAA/S,GAAA;MAAAC,KAAA,EAkLI,SAAAA,CAAA;QACS,KAAKsS,qBAAA,KACN,KAAKe,QAAA,CAAStJ,EAAA,CAAMC,cAAA,CAAe,KAAKuI,sBAAA,IACxC,KAAKD,qBAAA,IAAwB,EAEpC;MAAA;IAAA,GAvLL;MAAAvS,GAAA;MAAAC,KAAA,EAyLI,SAAAA,CAAA;QACI,KAAKqT,QAAA,CAAStJ,EAAA,CAAMM,UAAA,GACvB;MAAA;IAAA,GA3LL;MAAAtK,GAAA;MAAAC,KAAA,EA6LI,SAAAA,CAAA;QACI,KAAKqT,QAAA,CAAS;UACVC,SAAA,EAAW,KAAKjB,KAAA,CAALiB,SAAA,IAA2BvJ,EAAA,CAAMI,QAAA;UAC5CoJ,iBAAA,EAAmB,KAAKlB,KAAA,CAALkB,iBAAA,IAAmCxJ,EAAA,CAAM2B,eAAA;QAAA,EAEnE;MAAA;IAAA,GAlML;MAAA3L,GAAA;MAAAC,KAAA,EAoMI,SAAAA,CAAA;QACI,OAAOsG,EAAA,CAAwB;UAC3BgN,SAAA,EAAW,KAAAjB,KAAA,CAAAiB,SAAA;UACXC,iBAAA,EAAmB,KAAAlB,KAAA,CAAAkB;QAAA,EAvM/B;MAAA;IAAA;MAAAxT,GAAA;MAAAC,KAAA,EA+MI,SAAAA,CAAWf,CAAA;QAOP,OANA2F,CAAA,CAAM,KAAKyN,KAAA,EAAO,UAAU5S,CAAA,EAAKW,CAAA;UACvBA,CAAA,IAAQnB,CAAA,KACVA,CAAA,CAAMmB,CAAA,IAAQX,CAAA,CAErB;QAAA,IAEMR,CACV;MAAA;IAAA,GAvNL;MAAAc,GAAA;MAAAC,KAAA,EAyNI,SAAAA,CAAcf,CAAA;QACV,KAAKmU,cAAA,GAAiB,KAAKH,WAAA,GAAchU,CAAA,CAAMuU,iBAAA,EAC/C,KAAKC,YAAA,CAAaxU,CAAA,CAAMyU,mBAAA,GACxB,KAAKC,mBAAA,CAAoB1U,CAAA,CAAM2U,sBAAA,GAC/B,KAAKC,UAAA,CAAW5U,CAAA,CAAM6U,aAAA,CACzB;MAAA;IAAA,GA9NL;MAAA/T,GAAA;MAAAC,KAAA,EAgOI,SAAAA,CAAaf,CAAA;QACT,KAAK+T,QAAA,GAAW/T,CAAA,EACZ,KAAK+T,QAAA,GACL,KAAK5C,MAAA,KAEL,KAAK0C,IAAA,EAEZ;MAAA;IAAA,GAvOL;MAAA/S,GAAA;MAAAC,KAAA,EAyOI,SAAAA,CAAoBf,CAAA;QACZA,CAAA,KAAoB,KAAKiU,eAAA,KACzB,KAAKA,eAAA,GAAkBjU,CAAA,EACvB,KAAKmR,MAAA,IACL,KAAK0C,IAAA,GAEZ;MAAA;IAAA,GA/OL;MAAA/S,GAAA;MAAAC,KAAA,EAiPI,SAAAA,CAAA;QACI,SAAS,KAAKkT,eACjB;MAAA;IAAA,GAnPL;MAAAnT,GAAA;MAAAC,KAAA,EAqPI,SAAAA,CAAWf,CAAA;QACHA,CAAA,KAAW,KAAKkU,MAAA,KAChB,KAAKA,MAAA,GAASlU,CAAA,EACd,KAAKmR,MAAA,IACL,KAAK0C,IAAA,GAEZ;MAAA;IAAA,GA3PL;MAAA/S,GAAA;MAAAC,KAAA,EA6PI,SAAAA,CAAgBf,CAAA,EAAoBQ,CAAA;QAChC,IAAMW,CAAA,GAAS,KAAKiS,KAAA,CAAMjB,EAAA,KAAqB;QAC/ChR,CAAA,CAAOnB,CAAA,IAAcQ,CAAA,EACrB,KAAK4S,KAAA,CAAMjB,EAAA,IAAoBhR,CAAA,EAC/B,KAAK0S,IAAA,EACR;MAAA;IAAA,GAlQL;MAAA/S,GAAA;MAAAC,KAAA,EAoQI,SAAAA,CAAmBf,CAAA;QACf,IACMQ,CAAA,IADS,KAAK4S,KAAA,CAAMjB,EAAA,KAAqB,IACtBnS,CAAA;QAKzB,OAJK8E,CAAA,CAAatE,CAAA,aACP,KAAK4S,KAAA,CAAMjB,EAAA,EAAkBnS,CAAA,GACpC,KAAK6T,IAAA,KAEFrT,CACV;MAAA;IAAA,GA5QL;MAAAM,GAAA;MAAAC,KAAA,EA8QI,SAAAA,CAAA;QACI,OAAO,KAAKqS,KAAA,CAAML,EAAA,KAAe,WACpC;MAAA;IAAA,GAhRL;MAAAjS,GAAA;MAAAC,KAAA,EAkRI,SAAAA,CAAef,CAAA;QACX,KAAKoT,KAAA,CAAML,EAAA,IAAc/S,CAAA,EACzB,KAAK6T,IAAA,EACR;MAAA;IAAA,KArRL7T,CAAA;EAAA;ECzBM8U,EAAA,GAAc;IAChBC,kBAAA,EAAoB;IAEpBC,qBAAA,GAAuB;IAEvBC,wBAAA,EAA0B,SAAAA,CAAUjV,CAAA;MAChC,IAAMQ,CAAA,KAAyBR,CAAA,CAASkV,YAAA,CAAa9C,EAAA;QAC/CjR,CAAA,KAAwBnB,CAAA,CAASmV,UAAA,CAAW;MAClD,KAAKH,qBAAA,GAAwB7T,CAAA,KAAwBX,CARzC;IAAA;IAWhB4U,uBAAA,EAAyB,SAAAA,CAAUpV,CAAA;MAC/B,IAAIA,CAAA,CAAGqV,sBAAA,EACH,OAAOrV,CAAA,CAAGqV,sBAAA;MAEV,IAAI7U,CAAA,GAAsBR,CAAA;MAC1B;QACIQ,CAAA,GAAMA,CAAA,CAAI8U,eAAA;MAAA,SACL9U,CAAA,KAAQ2O,EAAA,CAAc3O,CAAA;MAC/B,OAAOA,CAnBC;IAAA;IAuBhB+U,gCAAA,EAAkC,SAAAA,CAAUvV,CAAA;MAExC,KADwB2O,EAAA,CAAqB3O,CAAA,GAEzC,OAAO;MAGX,IAAMQ,CAAA,GAAoB;MAW1B,OATAmF,CAAA,CAAM3F,CAAA,CAAKwV,UAAA,EAAY,UAAUxV,CAAA;QAC7B,IAAuD,MAAnDA,CAAA,CAAK0P,IAAA,CAAKlL,OAAA,CAAQ,8BAAoC;UACtD,IAAMrD,CAAA,GAAcnB,CAAA,CAAK0P,IAAA,CAAKjK,OAAA,CAAQ,8BAA8B;YAC9DhF,CAAA,GAAgBT,CAAA,CAAKe,KAAA;UACvBI,CAAA,IAAeV,CAAA,IAAiByO,EAAA,CAAmBzO,CAAA,MACnDD,CAAA,CAAMW,CAAA,IAAeV,CAAA,CAE5B;QAAA;MACJ,IACMD,CAxCK;IAAA;IA2ChBiV,yBAAA,EAA2B,SAAAA,CAAUzV,CAAA,EAAeQ,CAAA,EAAqBW,CAAA;MACrE,IAAMV,CAAA,GAAWT,CAAA,CAAKsP,OAAA,CAAQC,WAAA;QACxBlO,CAAA,GAAoB;UACtBqU,QAAA,EAAUjV;QAAA;MAEVgP,EAAA,CAA8BjL,OAAA,CAAQ/D,CAAA,KAAa,MAAMU,CAAA,KAC1B,QAA3BV,CAAA,CAAS8O,WAAA,MAAoD,aAA3B9O,CAAA,CAAS8O,WAAA,KAC3ClO,CAAA,CAAKsU,QAAA,GAAe9F,EAAA,CAA2B7P,CAAA,IAE/CqB,CAAA,CAAKsU,QAAA,GAAejH,EAAA,CAAY1O,CAAA;MAIxC,IAAMa,CAAA,GAAUyN,EAAA,CAAatO,CAAA;MACzBa,CAAA,CAAQF,MAAA,GAAS,MACjBU,CAAA,CAAKuU,OAAA,GAAc/U,CAAA,CAAQmO,KAAA,CAAM,KAAKC,MAAA,CAAO,UAAUjP,CAAA;QACnD,OAAa,OAANA,CACV;MAAA,KAEL2F,CAAA,CAAM3F,CAAA,CAAKwV,UAAA,EAAY,UAAUrU,CAAA;QJ6MlC,IAA4BV,CAAA;QI3MnBmO,EAAA,CAAmB5O,CAAA,MAAyD,MAAhD,CAAC,QAAQ,MAAM,SAASwE,OAAA,CAAQrD,CAAA,CAAKuO,IAAA,MAEhElP,CAAA,IAAc0O,EAAA,CAAmB/N,CAAA,CAAKJ,KAAA,MJ0MtB,oBADEN,CAAA,GIzMkDU,CAAA,CAAKuO,IAAA,KJ2MxC,iBAAnCjP,CAAA,CAAciI,SAAA,CAAU,GAAG,OAA0D,cAAlCjI,CAAA,CAAciI,SAAA,CAAU,GAAG,QI1M7ErH,CAAA,CAAM,WAAWF,CAAA,CAAKuO,IAAA,IAAQvO,CAAA,CAAKJ,KAAA,CAE1C;MAAA;MAKD,KAHA,IAAIW,CAAA,GAAW,GACXqG,CAAA,GAAY,GACZC,CAAA,GAA8BhI,CAAA,EAC1BgI,CAAA,GAAc,KAAKoN,uBAAA,CAAwBpN,CAAA,IAE/CtG,CAAA,IACIsG,CAAA,CAAYsH,OAAA,KAAYtP,CAAA,CAAKsP,OAAA,IAC7BvH,CAAA;MAMR,OAHA1G,CAAA,CAAKwU,SAAA,GAAgBnU,CAAA,EACrBL,CAAA,CAAKyU,WAAA,GAAkB/N,CAAA,EAEhB1G,CApFK;IAAA;IAuFhB0U,qBAAA,EAAuB,SAAAA,CAAU/V,CAAA;MAC7B,OAAO;QACHgW,WAAA,EAAahW,CAAA;QACbiW,WAAA,EAAa;MAAA,CA1FL;IAAA;IA8FhBC,2BAAA,EAA6B,SAAAA,CAAUlW,CAAA;MACnC,IAAMQ,CAAA,GAAuB;MAc7B,OAbAmF,CAAA,CAAMzB,QAAA,CAASuG,gBAAA,CAAiBzK,CAAA,CAAcmW,YAAA,GAAmB,UAAUnW,CAAA;QACvE,IAAImB,CAAA;QAEA,CAAC,SAAS,UAAUqD,OAAA,CAAQxE,CAAA,CAAYsP,OAAA,CAAQC,WAAA,OAAkB,IAClEpO,CAAA,GAAQnB,CAAA,CAAWe,KAAA,GACZf,CAAA,CAAW+O,WAAA,KAClB5N,CAAA,GAAQnB,CAAA,CAAW+O,WAAA,GAGnBG,EAAA,CAAmB/N,CAAA,KACnBX,CAAA,CAAWqH,IAAA,CAAK1G,CAAA,CAEvB;MAAA,IACMX,CAAA,CAAW6H,IAAA,CAAK,KA7GX;IAAA;IAiHhB+N,oBAAA,EAAsB,SAAAA,CAAUpW,CAAA;MAA0C,IAAAQ,CAAA;QAChEW,CAAA,GAAoB;MAW1B,OAVAwE,CAAA,CAAM,KAAK0Q,iBAAA,EAAmB,UAAC5V,CAAA;QAC3BkF,CAAA,CAAMlF,CAAA,CAAc6V,eAAA,EAAqB,UAACjV,CAAA;UAEtCsE,CAAA,CADsBzB,QAAA,CAASuG,gBAAA,CAAiBpJ,CAAA,GAC3B,UAACA,CAAA;YACd6E,CAAA,CAAUlG,CAAA,EAAmBqB,CAAA,KAAiBsN,EAAA,CAAqBtN,CAAA,MACnEF,CAAA,CAAMV,CAAA,CAAciP,IAAA,IAAYlP,CAAA,CAAK0V,2BAAA,CAA4BzV,CAAA,EAExE;UAAA,EACJ;QAAA,EACJ;MAAA,IACMU,CA7HK;IAAA;IAgIhBoV,eAAA,EAAiB,SAAAA,CAAUvW,CAAA;MAEvB,YAAwB,MAAbA,CAAA,CAAEwW,MAAA,GACDxW,CAAA,CAAEyW,UAAA,IAA0B,OAEhC,UAAJjW,CAAA,GAAKR,CAAA,CAAEwW,MAAA,UAAH,MAAAhW,CAAA,IAAAA,CAAA,CAA2BkW,UAAA,GACnB1W,CAAA,CAAE2W,YAAA,GAAe,MAAkB,OAEvC3W,CAAA,CAAEwW,MAAA,IAAsB;MAJ7B,IAAAhW,CApIK;IAAA;IA4IhBoW,aAAA,EAAe,SAAAA,CAAU5W,CAAA,EAAUQ,CAAA;MAA+D,IAQXW,CAAA;QARWV,CAAA;QAA5CY,CAAA,GAAA4D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAY;QAE1DpE,CAAA,GAAS,KAAK0V,eAAA,CAAgBvW,CAAA;MAAA,CAC9B8O,EAAA,CAAWjO,CAAA,MAEXA,CAAA,GAAUA,CAAA,CAAO6J,UAAA,IAAc,OAGjB,mBAAdrJ,CAAA,IAA2C,YAAXrB,CAAA,CAAEqK,IAAA,IAAoBrK,CAAA,YAAa6W,UAAA,KAC/D,UAAA1V,CAAA,QAAK2V,UAAA,UAAL,MAAA3V,CAAA,IAAAA,CAAA,CAAiB4V,WAAA,CAAY/W,CAAA,CAAEgX,OAAA,EAAShX,CAAA,CAAEiX,OAAA,EAAS,IAAIjV,IAAA,GAAO8O,OAAA,OAC9D,KAAK8F,aAAA,CAAc5W,CAAA,EAAGQ,CAAA,EAAU;MAIxC,IAAIK,CAAA,IJlFL,UACHb,CAAA,EACAQ,CAAA;QAEO,IADPW,CAAA,GAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,WAAmD;QAEnD,KAAKjF,CAAA,IAAMqP,EAAA,CAAMrP,CAAA,EAAI,YAAYmP,EAAA,CAAcnP,CAAA,GAC3C,QAAO;QAGX,IAAI,QAAAmB,CAAA,IAAAA,CAAA,CAAmB+V,aAAA,EAAe;UAClC,IAAMzW,CAAA,GAAMoD,MAAA,CAAOwJ,QAAA,CAASX,IAAA;YACtBrL,CAAA,GAAYF,CAAA,CAAkB+V,aAAA;UACpC,IAAI7V,CAAA,KAAcA,CAAA,CAAU8V,IAAA,CAAK,UAACnX,CAAA;YAAD,OAAWS,CAAA,CAAIiJ,KAAA,CAAM1J,CAAA,CAArB;UAAA,IAC7B,QAAO,CAEd;QAAA;QAED,IAAI,QAAAmB,CAAA,IAAAA,CAAA,CAAmBiW,mBAAA,EAAqB;UACxC,IAAMvW,CAAA,GAAYM,CAAA,CAAkBiW,mBAAA;UACpC,IAAIvW,CAAA,KAAcA,CAAA,CAAUsW,IAAA,CAAK,UAACnX,CAAA;YAAD,OAAeQ,CAAA,CAAM6J,IAAA,KAASrK,CAA9B;UAAA,IAC7B,QAAO,CAEd;QAAA;QAED,IAAI,QAAAmB,CAAA,IAAAA,CAAA,CAAmBkW,iBAAA,EAAmB;UACtC,IAAM3V,CAAA,GAAYP,CAAA,CAAkBkW,iBAAA;UACpC,IAAI3V,CAAA,KAAcA,CAAA,CAAUyV,IAAA,CAAK,UAAC3W,CAAA;YAAD,OAAiBR,CAAA,CAAGsP,OAAA,CAAQC,WAAA,OAAkB/O,CAA9C;UAAA,IAC7B,QAAO,CAEd;QAAA;QAED,IAAI,QAAAW,CAAA,IAAAA,CAAA,CAAmBmW,sBAAA,EAAwB;UAC3C,IAAMvP,CAAA,GAAY5G,CAAA,CAAkBmW,sBAAA;UACpC,IAAIvP,CAAA,KAAcA,CAAA,CAAUoP,IAAA,CAAK,UAAC3W,CAAA;YAAD,OAAcR,CAAA,CAAGuX,OAAA,CAAQ/W,CAAA,CAAzB;UAAA,IAC7B,QAAO,CAEd;QAAA;QAMD,KAJA,IAAIwH,CAAA,IAAwB,GACtBC,CAAA,GAA+B,CAACjI,CAAA,GAClCkI,CAAA,IAAgC,GAChC8I,CAAA,GAAiBhR,CAAA,EACdgR,CAAA,CAAMtG,UAAA,KAAe2E,EAAA,CAAM2B,CAAA,EAAO,UAErC,IAAIxB,EAAA,CAAmBwB,CAAA,CAAMtG,UAAA,GACzBzC,CAAA,CAAkBJ,IAAA,CAAMmJ,CAAA,CAAMtG,UAAA,CAAmBiC,IAAA,GACjDqE,CAAA,GAASA,CAAA,CAAMtG,UAAA,CAAmBiC,IAAA,MAFtC;UAMA,MADAzE,CAAA,GAAc8I,CAAA,CAAMtG,UAAA,KAA0B,IAC7B;UACjB,IAAI+E,EAAA,CAA8BjL,OAAA,CAAQ0D,CAAA,CAAWoH,OAAA,CAAQC,WAAA,OAAkB,GAC3EvH,CAAA,IAAwB,OACrB;YACH,IAAMwP,CAAA,GAAa3T,MAAA,CAAO4T,gBAAA,CAAiBvP,CAAA;YACvCsP,CAAA,IAAwD,cAA1CA,CAAA,CAAWE,gBAAA,CAAiB,cAC1C1P,CAAA,IAAwB,EAE/B;UAAA;UAEDC,CAAA,CAAkBJ,IAAA,CAAKK,CAAA,GACvB8I,CAAA,GAAQ9I,CAbP;QAAA;QAgBL,IAAMyP,CAAA,GAAa9T,MAAA,CAAO4T,gBAAA,CAAiBzX,CAAA;QAC3C,IAAI2X,CAAA,IAAwD,cAA1CA,CAAA,CAAWD,gBAAA,CAAiB,aAA0C,YAAflX,CAAA,CAAM6J,IAAA,EAC3E,QAAO;QAGX,IAAMuN,CAAA,GAAM5X,CAAA,CAAGsP,OAAA,CAAQC,WAAA;QACvB,QAAQqI,CAAA;UACJ,KAAK;YACD,QAAO;UACX,KAAK;YACD,OAAsB,aAAfpX,CAAA,CAAM6J,IAAA;UACjB,KAAK;UAEL,KAAK;UACL,KAAK;YACD,OAAsB,aAAf7J,CAAA,CAAM6J,IAAA,IAAoC,YAAf7J,CAAA,CAAM6J,IAAA;UAC5C;YACI,OAAIrC,CAAA,GAA6C,YAAfxH,CAAA,CAAM6J,IAAA,GAErB,YAAf7J,CAAA,CAAM6J,IAAA,KACLoF,EAAA,CAA8BjL,OAAA,CAAQoT,CAAA,KAAQ,KAA4C,WAAvC5X,CAAA,CAAGyO,YAAA,CAAa;QAAA;MAGnF,CILqB,CAAsB5N,CAAA,EAAQb,CAAA,EAAG,KAAK6X,MAAA,GAAS;QAGzD,KAFA,IAAMnW,CAAA,GAAoB,CAACb,CAAA,GACvBkH,CAAA,GAAQlH,CAAA,EACLkH,CAAA,CAAM2C,UAAA,KAAe2E,EAAA,CAAMtH,CAAA,EAAO,UACjCyH,EAAA,CAAmBzH,CAAA,CAAM2C,UAAA,KACzBhJ,CAAA,CAAkBmG,IAAA,CAAME,CAAA,CAAM2C,UAAA,CAAmBiC,IAAA,GACjD5E,CAAA,GAASA,CAAA,CAAM2C,UAAA,CAAmBiC,IAAA,KAGtCjL,CAAA,CAAkBmG,IAAA,CAAKE,CAAA,CAAM2C,UAAA,GAC7B3C,CAAA,GAAQA,CAAA,CAAM2C,UAAA;QAGlB,IAEI1C,CAAA;UAFEC,CAAA,GAA6B;UAC7BC,CAAA,GAA2C;UAE7C8I,CAAA,IAAoB;QA2CxB,IA1CArL,CAAA,CAAMjE,CAAA,EAAmB,UAAC1B,CAAA;UACtB,IAAMmB,CAAA,GAAkBwN,EAAA,CAAqB3O,CAAA;UAIZ,QAA7BA,CAAA,CAAGsP,OAAA,CAAQC,WAAA,OACXvH,CAAA,GAAOhI,CAAA,CAAGyO,YAAA,CAAa,SACvBzG,CAAA,GAAO7G,CAAA,IAAmB+N,EAAA,CAAmBlH,CAAA,KAASA,CAAA,GAKtD9B,CAAA,CADYoI,EAAA,CAAatO,CAAA,EAAIgP,KAAA,CAAM,MAChB,qBACnBgC,CAAA,IAAoB,IAGxB/I,CAAA,CAAaJ,IAAA,CACTpH,CAAA,CAAKgV,yBAAA,CACDzV,CAAA,EACAQ,CAAA,CAAS2U,UAAA,CAAW,gCACpB3U,CAAA,CAAS2U,UAAA,CAAW;UAI5B,IAAM9T,CAAA,GAAoBZ,CAAA,CAAK8U,gCAAA,CAAiCvV,CAAA;UAChE4F,CAAA,CAAQsC,CAAA,EAA8B7G,CAAA,CACzC;QAAA,IAEIb,CAAA,CAAS2U,UAAA,CAAW,qBAGgB,QAAjCtU,CAAA,CAAOyO,OAAA,CAAQC,WAAA,MAA0D,aAAjC1O,CAAA,CAAOyO,OAAA,CAAQC,WAAA,KACvDtH,CAAA,CAAa,GAAb0N,QAAA,GAA8B9F,EAAA,CAA2BhP,CAAA,IAEzDoH,CAAA,CAAa,GAAb0N,QAAA,GAA8BjH,EAAA,CAAY7N,CAAA,IAI9CmH,CAAA,KACAC,CAAA,CAAa,GAAb6P,UAAA,GAAgC9P,CAAA,GAGhCgJ,CAAA,EACA,QAAO;QAGX,IAAMwG,CAAA,GAAQ5R,CAAA,CACV,KAAKmQ,qBAAA,CAAsB/V,CAAA,CAAEqK,IAAA,GAC7B;UACI0N,SAAA,EAAW9P;QAAA,GAEf,KAAKmO,oBAAA,CAAqB1U,CAAA,GAC1BwG,CAAA;QAIJ,OADA1H,CAAA,CAASwX,OAAA,CAAQ3W,CAAA,EAAWmW,CAAA,IACrB,CACV;MAAA;IApOW;IAyOhBS,SAAA,EAAW,SAAAA,CAAUjY,CAAA;MACjB6D,MAAA,CAAOwJ,QAAA,CAASX,IAAA,GAAO1M,CA1OX;IAAA;IA6OhBkY,oBAAA,EAAsB,SAAAA,CAAUlY,CAAA;MAAyB,IAAAQ,CAAA;QAC/CW,CAAA,GAAU,SAAAgX,CAAChX,CAAA;UACbA,CAAA,GAAIA,CAAA,IAAK0C,MAAA,CAAOoG,KAAA,EAChBzJ,CAAA,CAAKoW,aAAA,CAAczV,CAAA,EAAGnB,CAAA;QAAA;MAE1B2J,EAAA,CAAgBzF,QAAA,EAAU,UAAU/C,CAAA,GAAS,IAAO,IACpDwI,EAAA,CAAgBzF,QAAA,EAAU,UAAU/C,CAAA,GAAS,IAAO,IACpDwI,EAAA,CAAgBzF,QAAA,EAAU,SAAS/C,CAAA,GAAS,IAAO,EApPvC;IAAA;IAuPhBkV,iBAAA,EAAmB;IACnBS,UAAA,EAAY;IACZe,MAAA,OAAQ;IAERO,IAAA,EAAM,SAAAA,CAAUpY,CAAA;MAAyB,IAAAQ,CAAA;MACC,oBAA3BR,CAAA,CAASqY,aAAA,KAChB,KAAKR,MAAA,GAAS7X,CAAA,CAASqY,aAAA,GAIvB,UAAJ7X,CAAA,GAAI,KAAKqX,MAAA,UAAL,MAAArX,CAAA,IAAAA,CAAA,CAAa0W,aAAA,KACb,KAAKW,MAAA,CAAOX,aAAA,GAAgB,KAAKW,MAAA,CAAOX,aAAA,CAAcoB,GAAA,CAAI,UAACtY,CAAA;QAAD,OAAS,IAAIqJ,MAAA,CAAOrJ,CAAA,CAApB;MAAA,KAG9D,KAAK8W,UAAA,GAAa,IAAI9G,EAAA,CAAUhQ,CAAA,CAASmV,UAAA,CAAW,aArQxC;IAAA;IAwQhBoD,mBAAA,EAAqB,SAAAA,CAAUvY,CAAA,EAA0BQ,CAAA;MACrD,KAAKyU,wBAAA,CAAyBzU,CAAA;MAC9B,IAAMW,CAAA,GAAQX,CAAA,CAAS2U,UAAA,CAAW;MAC9B,KAAKJ,kBAAA,CAAmBvQ,OAAA,CAAQrD,CAAA,KAAU,IAC1CyD,CAAA,CAAOC,GAAA,CAAI,gDAAgD1D,CAAA,GAAQ,QAInEX,CAAA,CAASgT,WAAA,IACThT,CAAA,CAASgT,WAAA,CAAYY,QAAA,CAChB1S,CAAA,KAAA0Q,EAAA,IAAqCpS,CAAA,CAAQwY,mBAAA,IAItD,KAAKzD,kBAAA,CAAmBlN,IAAA,CAAK1G,CAAA,GAGzBnB,CAAA,IACAA,CAAA,CAAQ6X,MAAA,IACR7X,CAAA,CAAQ6X,MAAA,CAARY,yBAAA,IACA,KAAKzD,qBAAA,IAGDhV,CAAA,CAAQ0Y,iBAAA,KACR,KAAKrC,iBAAA,GAAoBrW,CAAA,CAAQ0Y,iBAAA,GAErC,KAAKR,oBAAA,CAAqB1X,CAAA,KAE1BA,CAAA,CAAQ6X,aAAA,IAAoB,EApSpB;IAAA;IA6ShBM,iBAAA,EAAmB,SAAAA,CACf3Y,CAAA,EACAQ,CAAA,EACAW,CAAA;MAEA,KAAKnB,CAAA,EACD,QAAO;MAEXQ,CAAA,GAAcsE,CAAA,CAAatE,CAAA,IAA2B,KAAbA,CAAA,EACzCW,CAAA,GAAqB2D,CAAA,CAAa3D,CAAA,IAAyC,KAApBA,CAAA;MAEvD,KADA,IAAIV,CAAA,GAAc,GACTY,CAAA,GAAI,GAAGA,CAAA,GAAIrB,CAAA,CAAMW,MAAA,EAAQU,CAAA,IAC9BZ,CAAA,IAAeT,CAAA,CAAMoI,UAAA,CAAW/G,CAAA;MAEpC,OAAOZ,CAAA,GAAcD,CAAA,GAAaW,CA3TtB;IAAA;IA8ThByX,kBAAA,EAAoB,SAAAA,CAAA;MAChB,OAAO7S,CAAA,CAAY7B,QAAA,CAASuG,gBAAA,CAC/B;IAAA;EAAA;AAAA,CLvQiC,UAAUzK,CAAA;EAC5C,KAAK,IAAMQ,CAAA,IAAQR,CAAA,EACU,qBAAdA,CAAA,CAAIQ,CAAA,MACXR,CAAA,CAAIQ,CAAA,IAAQR,CAAA,CAAIQ,CAAA,EAAMqY,IAAA,CAAK7Y,CAAA,EAGtC;AAAA,CKoQD,CAAuB8U,EAAA,GL3DmB,UAAU9U,CAAA;EAChD,KAAK,IAAMQ,CAAA,IAAQR,CAAA,EACU,qBAAdA,CAAA,CAAIQ,CAAA,MACXR,CAAA,CAAIQ,CAAA,IAAQ2G,CAAA,CAAUnH,CAAA,CAAIQ,CAAA,GAGrC;AAAA,CKsDD,CAA2BsU,EAAA;ACvU3B,IAAMgE,EAAA,GAAkC;AAejC,SAASC,GAAM/Y,CAAA,EAAeQ,CAAA;EACjCwY,EAAA,EAAU,GAAMhZ,CAAA,EAAOQ,CAAA,CAC1B;AAAA;AAYM,SAASyY,GAAOjZ,CAAA,EAAeQ,CAAA;EAClCwY,EAAA,EAAU,GAAOhZ,CAAA,EAAOQ,CAAA,CAC3B;AAAA;AAUM,SAAS0Y,GAAWlZ,CAAA,EAAeQ,CAAA;EACtC,OAA4C,QAArC2Y,EAAA,CAAiBnZ,CAAA,EAAOQ,CAAA,CAClC;AAAA;AAWM,SAAS4Y,GAAYpZ,CAAA,EAAeQ,CAAA;EACvC,SAsEJ,UAA8BR,CAAA;IAC1B,IAAIA,CAAA,IAAWA,CAAA,CAAQqZ,UAAA,EAAY;MAC/B,IAAM7Y,CAAA,GAAOR,CAAA,IAAWA,CAAA,CAAQ6D,MAAA,IAAWD,CAAA;QACrCzC,CAAA,GAAMX,CAAA,CAAGuD,SAAA,IAAiB;QAC5BtD,CAAA,IAAW;MAaf,OAZAkF,CAAA,CACI,CACIxE,CAAA,CAAGmY,UAAA,EACFnY,CAAA,CAADoY,YAAA,EACC/Y,CAAA,CAAD8Y,UAAA,GAEJ,UAAUtZ,CAAA;QACFkG,CAAA,CAAU,EAAC,GAAM,GAAG,KAAK,QAAQlG,CAAA,MACjCS,CAAA,IAAW,EAElB;MAAA,IAEEA,CACV;IAAA;IACD,QAAO,CACV;EAAA,CA1FO,CAAqBD,CAAA,KAGmB,QAArC2Y,EAAA,CAAiBnZ,CAAA,EAAOQ,CAAA,CAClC;AAAA;AAYM,SAASgZ,GAAcxZ,CAAA,EAAeQ,CAAA;EAEzCiZ,EAAA,CADAjZ,CAAA,GAAUA,CAAA,IAAW,IACA2Q,MAAA,CAAOuI,EAAA,CAAe1Z,CAAA,EAAOQ,CAAA,KAAYA,CAAA,CAAQmZ,oBAAA,CACzE;AAAA;AAUD,SAASF,GAAYzZ,CAAA;EAEjB,OAAgC,oBADhCA,CAAA,GAAUA,CAAA,IAAW,IACT4Z,eAAA,GACDvI,EAAA,GAEqB,0BAA5BrR,CAAA,CAAQ4Z,eAAA,GACDlI,EAAA,GAEJrB,EACV;AAAA;AASD,SAASqJ,GAAe1Z,CAAA,EAAeQ,CAAA;EAEnC,SADAA,CAAA,GAAUA,CAAA,IAAW,IACLqZ,iBAAA,IAAqBf,EAAA,IAAmC9Y,CAC3E;AAAA;AASD,SAASmZ,GAAiBnZ,CAAA,EAAeQ,CAAA;EACrC,OAAOiZ,EAAA,CAAYjZ,CAAA,EAAS+P,GAAA,CAAImJ,EAAA,CAAe1Z,CAAA,EAAOQ,CAAA,EACzD;AAAA;AA4CD,SAASwY,GAAUhZ,CAAA,EAAmBQ,CAAA,EAAeW,CAAA;EAC5CmF,CAAA,CAAU9F,CAAA,KAAWA,CAAA,CAAMG,MAAA,IAOhC8Y,EAAA,CAFAtY,CAAA,GAAUA,CAAA,IAAW,IAEAwP,GAAA,CACjB+I,EAAA,CAAelZ,CAAA,EAAOW,CAAA,GACtBnB,CAAA,GAAW,IAAI,GACfwG,CAAA,CAAUrF,CAAA,CAAQ2Y,gBAAA,IAAoB3Y,CAAA,CAAQ2Y,gBAAA,GAAmB,MACjE3Y,CAAA,CAAQwY,oBAAA,EACRxY,CAAA,CAAQ4Y,YAAA,GAGR5Y,CAAA,CAAQ6W,OAAA,IAAWhY,CAAA,IAEnBmB,CAAA,CAAQ6W,OAAA,CAAQ7W,CAAA,CAAQ6Y,gBAAA,IAAoB,WAAW7Y,CAAA,CAAQ8Y,iBAAA,IAAqB,IAAI;IACpFC,cAAA,GAAgB;EAAA,MAjBpBnV,OAAA,CAAQK,KAAA,CAAM,WAAWpF,CAAA,GAAW,UAAU,YAAY,gCAoBjE;AAAA;AAEM,SAASma,GAAana,CAAA,EAAkBQ,CAAA;EAC3C,IAAIW,CAAA,IAAW;EAEf;IACI,IAAMV,CAAA,GAAQT,CAAA,CAAQmV,UAAA,CAAW;MAC3B9T,CAAA,GAAarB,CAAA,CAAQmV,UAAA,CAAW;MAChCtU,CAAA,GAAkBb,CAAA,CAAQmV,UAAA,CAAW;MACrCzT,CAAA,GAAoB1B,CAAA,CAAQmV,UAAA,CAAW,2CAAsC;MAC7EpN,CAAA,GAAM/H,CAAA,CAAQmV,UAAA,CAAW;IAE3B1U,CAAA,KAEAU,CAAA,GAAWiY,EAAA,CAAY3Y,CAAA,EAAO;MAC1B4Y,UAAA,EAAAhY,CAAA;MACAuY,eAAA,EAAA/Y,CAAA;MACAgZ,iBAAA,EAAAnY,CAAA;MACAmC,MAAA,EAAQkE;IAAA,GAbpB;EAAA,CAgBE,QAAO/H,CAAA;IACAQ,CAAA,IACDuE,OAAA,CAAQK,KAAA,CAAM,8DAA8DpF,CAAA,CAEnF;EAAA;EACD,OAAOmB,CACV;AAAA;AAWM,SAASiZ,GACZpa,CAAA,EACAQ,CAAA,EACAW,CAAA;EAEA,OAAO;IAAmB,KACtB,IAAMV,CAAA,GAAW0Z,EAAA,CAAana,CAAA,EAASmB,CAAA,GADjBE,CAAA,GAAA4D,SAAA,CAAAtE,MAAA,EAANE,CAAA,GAAM,IAAAuC,KAAA,CAAA/B,CAAA,GAAAK,CAAA,MAAAA,CAAA,GAAAL,CAAA,EAAAK,CAAA,IAANb,CAAA,CAAMa,CAAA,IAAAuD,SAAA,CAAAvD,CAAA;IAGtB,KAAKjB,CAAA,EAGD,OAAOD,CAAA,CAAO0E,KAAA,CAAM,MAAMrE,CAAA;IAG9B,IAAMkH,CAAA,GAAWlH,CAAA,CAAKA,CAAA,CAAKF,MAAA,GAAS;IACZ,qBAAboH,CAAA,IACPA,CAAA,CAAS;EAAA,CAKpB;AAAA;ACvQD,IAAMsS,EAAA,GAAa;EAObC,EAAA;IAMF,SAAAta,EAAYQ,CAAA;MAAkB,IAAAW,CAAA;MAAAV,CAAA,OAAAT,CAAA,GAC1B,KAAKua,QAAA,GAAW/Z,CAAA,EAqBhB,KAAKmQ,GAAA,GAAMyJ,EAAA,CAAe5Z,CAAA,EAAS,UAACR,CAAA,EAA2BQ,CAAA,EAAaC,CAAA;QACxE,IAAMY,CAAA,GAAOF,CAAA,CAAKqZ,UAAA,CAAWxa,CAAA,EAAMQ,CAAA;QAoBnC,OAjBAW,CAAA,CAAKoZ,QAAA,CAASE,2BAAA,CAA4BpZ,CAAA,CAAIqZ,IAAA,IAAY,KAEtDvU,CAAA,CAAUnG,CAAA,MACVS,CAAA,GAAWD,CAAA,GAGXW,CAAA,CAAKwZ,WAAA,CAAY,oBACjBxZ,CAAA,CAAKoZ,QAAA,CAASK,kBAAA,CAAmBC,oBAAA,IAIrCxZ,CAAA,CAAKgZ,EAAA,IAAczU,CAAA,CACf,IACAkF,EAAA,CAAMuD,iBAAA,IACNlN,CAAA,CAAKoZ,QAAA,CAASK,kBAAA,CAAmBE,iBAAA,IACjCzZ,CAAA,CAAKgZ,EAAA,IAEFlZ,CAAA,CAAK4Z,aAAA,CAAc1Z,CAAA,EAAMZ,CAAA,CACnC;MAAA,IAuBD,KAAKua,QAAA,GAAWZ,EAAA,CACZ5Z,CAAA,EACA,UAACR,CAAA,EAA2BQ,CAAA,EAAaC,CAAA;QACrC,IAAMY,CAAA,GAAOF,CAAA,CAAK8Z,eAAA,CAAgBjb,CAAA,EAAMQ,CAAA;QAIxC,OAHI2F,CAAA,CAAUnG,CAAA,MACVS,CAAA,GAAWD,CAAA,GAERW,CAAA,CAAK4Z,aAAA,CAAc1Z,CAAA,EAAMZ,CAAA,CACnC;MAAA,EAER;IAAA;IAAA,OAAAI,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAED,SAAAA,CAAA;QACI,OAAO,KAAKwZ,QAAA,CAAS9W,QAAA,KAAa,SACrC;MAAA;IAAA;MAAA3C,GAAA;MAAAC,KAAA,EAED,SAAAA,CAAcf,CAAA,EAAkBQ,CAAA;QAC5BR,CAAA,CAAIkb,MAAA,GAAa,KAAKP,WAAA,CAAY,UAClC3a,CAAA,CAAImb,YAAA,GAAmB,KAAKZ,QAAA,CAASa,eAAA;QACrC,IAAMja,CAAA,GAAY,KAAKoZ,QAAA,CAASrF,YAAA,CAAa;UACvCzU,CAAA,GAAU,KAAK8Z,QAAA,CAASrF,YAAA,CAAa;UACrC7T,CAAA,GAA4B,KAAKkZ,QAAA,CAASrF,YAAA,CAAa;QACzD/T,CAAA,KACAnB,CAAA,CAAIqb,UAAA,GAAiBla,CAAA,GAErBV,CAAA,KACAT,CAAA,CAAIsb,QAAA,GAAe7a,CAAA,GAEnBY,CAAA,KACArB,CAAA,CAAIub,0BAAA,GAAiCla,CAAA;QAGzC,IAAMR,CAAA,GAAoB6F,CAAA,CAAa1G,CAAA;UACjC0B,CAAA,GAAiB8F,EAAA,CACnB3G,CAAA,EACA,KAAK8Z,WAAA,CAAY;UAGf5S,CAAA,GAAeD,EAAA,CADH4I,IAAA,CAAKQ,SAAA,CAAUrQ,CAAA;QAUjC,OAPA,KAAK0Z,QAAA,CAASQ,aAAA,CACV,KAAKJ,WAAA,CAAY,cAAc,YAC/B;UAAEa,IAAA,EAAMzT;QAAA,GACR,IACA,KAAKwS,QAAA,CAASkB,iBAAA,CAAkBjb,CAAA,EAAUkB,CAAA,IAGvCA,CACV;MAAA;IAAA;MAAAZ,GAAA;MAEDC,KAAA,WAAAA,CAA2Cf,CAAA;QACvC,OAAO,KAAKua,QAAA,CAASpF,UAAA,CAAWnV,CAAA,CACnC;MAAA;IAAA;MAAAc,GAAA;MAEDC,KAAA,WAAAA,CAAsBf,CAAA;QAClB,OACa,mBAATA,CAAA,IACS,aAATA,CAAA,IACS,iBAATA,CAAA,IACS,eAATA,CAAA,IACS,iCAATA,CAAA;MAAA;IAAA;MAAAc,GAAA;MAAAC,KAAA,EAMR,SAAA2a,CAAmB1b,CAAA,EAA2BQ,CAAA;QAC1C,OAAO,KAAKmb,eAAA,CAAgBtB,EAAA,EAAYra,CAAA,EAAMQ,CAAA,CACjD;MAAA;IAAA;MAAAM,GAAA;MAAAC,KAAA,EAED,SAAAA,CAAwBf,CAAA,EAA2BQ,CAAA;QAC/C,OAAO,KAAKmb,eAAA,CAtJI,aAsJ6B3b,CAAA,EAAMQ,CAAA,CACtD;MAAA;IAAA;MAAAM,GAAA;MAEDC,KAAA,WAAAA,CAAwBf,CAAA,EAAkCQ,CAAA,EAA2BW,CAAA;QAAyB,IAAAV,CAAA;UACpGY,CAAA,GAAmB;UACnBR,CAAA,GAAoB;QAa1B,OAXIsF,CAAA,CAAU3F,CAAA,IACVmF,CAAA,CAAMnF,CAAA,EAAM,UAACR,CAAA,EAAGQ,CAAA;UACNC,CAAA,CAAamb,qBAAA,CAAsBpb,CAAA,MACrCK,CAAA,CAAML,CAAA,IAAKR,CAAA,CAElB;QAAA,KAEDa,CAAA,CAAML,CAAA,IAAQW,CAAA,EAGlBE,CAAA,CAAKrB,CAAA,IAAca,CAAA,EACZQ,CACV;MAAA;IAAA,KAAArB,CAAA;EAAA;EC5JC6b,EAAA,GAAmC;EACnCC,EAAA,GAAqC;EACrCC,EAAA,GAAoC;EAE7BC,EAAA,GAA2B,SAAAC,CAACjc,CAAA;IACrC,IADyFQ,CAAA;MACnFW,CAAA,GAAuD;MAD4BV,CAAA,GAAAyb,CAAA,CRuKtF,UAA2Blc,CAAA;QAK9B,KAJA,IAAMQ,CAAA,GAAW+C,MAAA,CAAOuQ,IAAA,CAAK9T,CAAA,GACzBmB,CAAA,GAAIX,CAAA,CAASG,MAAA,EACXF,CAAA,GAAW,IAAI2C,KAAA,CAAMjC,CAAA,GAEpBA,CAAA,KACHV,CAAA,CAASU,CAAA,IAAK,CAACX,CAAA,CAASW,CAAA,GAAInB,CAAA,CAAIQ,CAAA,CAASW,CAAA;QAE7C,OAAOV,CACV;MAAA,CQ9K8B,CAAST,CAAA,IAAgB,CAAjB;IAFsD;MAEzF,KAAyDS,CAAA,CAAAiB,CAAA,MAAAlB,CAAA,GAAAC,CAAA,CAAAU,CAAA,IAAAgb,IAAA;QAAA,IAAA9a,CAAA,GAAAsW,CAAA,CAAAnX,CAAA,CAAAO,KAAA;UAA7CF,CAAA,GAA6CQ,CAAA;UAAxCK,CAAA,GAAwCL,CAAA;QACjDK,CAAA,KACAP,CAAA,CAAmBN,CAAA,IAAOa,CAAA,CAEjC;MAAA;IANwF,SAAA1B,CAAA;MAAAS,CAAA,CAAAT,CAAA,CAAAA,CAAA;IAAA;MAAAS,CAAA,CAAAkX,CAAA;IAAA;IAOzF,OAAOxW,CACV;EAAA;EA2CYib,EAAA,GAAb;IAQI,SAAApc,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAC3B,KAAKqc,QAAA,GAAW7b,CAAA,EAChB,KAAK8b,iBAAA,IAAoB,GACzB,KAAKC,wBAAA,GAA2B,IAEhC,KAAKC,wBAAA,IAA2B,GAChC,KAAKC,0BAAA,IAA6B,CACrC;IAAA;IAfL,OAAA5b,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAiBI,SAAAA,CAAA;QACI,OAAOwC,MAAA,CAAOuQ,IAAA,CAAK,KAAK4I,eAAA,GAC3B;MAAA;IAAA,GAnBL;MAAA5b,GAAA;MAAAC,KAAA,EAqBI,SAAAA,CAAA;QACI,IAAMf,CAAA,GAAe,KAAKqc,QAAA,CAASnH,YAAA,CAAazC,EAAA;UAC1CjS,CAAA,GAAkB,KAAK6b,QAAA,CAASnH,YAAA,CAAa4G,EAAA;QACnD,KAAKtb,CAAA,EACD,OAAOR,CAAA,IAAgB;QAK3B,KAFA,IAAMmB,CAAA,GAAayE,CAAA,CAAQ,CAAD,GAAK5F,CAAA,GACzBS,CAAA,GAAiB8C,MAAA,CAAOuQ,IAAA,CAAKtT,CAAA,GAC1Ba,CAAA,GAAI,GAAGA,CAAA,GAAIZ,CAAA,CAAeE,MAAA,EAAQU,CAAA,KACI,MAAvCb,CAAA,CAAgBC,CAAA,CAAeY,CAAA,YACxBF,CAAA,CAAWV,CAAA,CAAeY,CAAA,KAEjCF,CAAA,CAAWV,CAAA,CAAeY,CAAA,KAAMb,CAAA,CAAgBC,CAAA,CAAeY,CAAA;QAWvE,OARK,KAAKib,iBAAA,KACNvX,OAAA,CAAQ4X,IAAA,CAAK,uCAAuC;UAChDC,YAAA,EAAA5c,CAAA;UACA6c,eAAA,EAAArc,CAAA;UACAsc,UAAA,EAAA3b;QAAA,IAEJ,KAAKmb,iBAAA,IAAoB,IAEtBnb,CACV;MAAA;IAAA,GA9CL;MAAAL,GAAA;MAAAC,KAAA,EAgDI,SAAAA,CAAA;QAEI,OADqB,KAAKsb,QAAA,CAASnH,YAAA,CAAa6G,EAAA,KACzB,EAC1B;MAAA;IAAA,GAnDL;MAAAjb,GAAA;MAAAC,KAAA,EA8DI,SAAAA,CAAA;QACS,KAAKyb,wBAAA,KACN,KAAKA,wBAAA,IAA2B,GAChC,KAAKO,iBAAA,GAEZ;MAAA;IAAA,GAnEL;MAAAjc,GAAA;MAAAC,KAAA,EAqEI,SAAAA,CAAuBf,CAAA;QACnB,KAAKgd,iBAAA,GAAoBhd,CAC5B;MAAA;IAAA,GAvEL;MAAAc,GAAA;MAAAC,KAAA,EAyEI,SAAAA,CAAmBf,CAAA;QACf,KAAKyc,0BAAA,GAA6Bzc,CACrC;MAAA;IAAA,GA3EL;MAAAc,GAAA;MAAAC,KAAA,EA6EI,SAAAA,CAAA;QACI,KAAKyb,wBAAA,IAA2B,CACnC;MAAA;IAAA,GA/EL;MAAA1b,GAAA;MAAAC,KAAA,EAiFI,SAAAA,CAAA;QAA0B,IAAAf,CAAA;QAClB,KAAKwc,wBAAA,KAA6B,KAAKC,0BAAA,IACvCQ,UAAA,CAAW;UAAA,CACFjd,CAAA,CAAKyc,0BAAA,IAA8Bzc,CAAA,CAAKwc,wBAAA,KACzCxc,CAAA,CAAKwc,wBAAA,IAA2B,GAChCxc,CAAA,CAAKkd,0BAAA,GAHH;QAAA,GAKP,EAEV;MAAA;IAAA,GA1FL;MAAApc,GAAA;MAAAC,KAAA,EA4FI,SAAAA,CAAA;QAAmC,IAAAf,CAAA;QAC/B,KAAKmd,kBAAA,EAAmB;QACxB,IAAM3c,CAAA,GAAQ,KAAK6b,QAAA,CAASlH,UAAA,CAAW;UACjChU,CAAA,GAAmB,KAAKkb,QAAA,CAASnH,YAAA,CAAavC,EAAA;UAC9ClS,CAAA,GAAkB,KAAK4b,QAAA,CAASnH,YAAA,CAAatC,EAAA;UAU7CvR,CAAA,GAAeyG,EAAA,CATH4I,IAAA,CAAKQ,SAAA,CAAU;YAC7BiC,KAAA,EAAO3S,CAAA;YACPmR,WAAA,EAAa,KAAK0K,QAAA,CAASjB,eAAA;YAC3BgC,MAAA,EAAQ,KAAKf,QAAA,CAASgB,SAAA;YACtBL,iBAAA,EAAmB,KAAKA,iBAAA;YACxBM,iBAAA,EAAmBnc,CAAA;YACnBoc,gBAAA,EAAkB9c;UAAA;QAItB,KAAK4b,QAAA,CAAStB,aAAA,CACV,KAAKsB,QAAA,CAASlH,UAAA,CAAW,cAAc,gBACvC;UAAEqG,IAAA,EAAMna;QAAA,GACR;UAAEmc,MAAA,EAAQ;QAAA,GACV,KAAKnB,QAAA,CAASZ,iBAAA,CAAkB,UAACjb,CAAA;UAG7BR,CAAA,CAAKgd,iBAAA,QAAoB,GACzBhd,CAAA,CAAKyd,oBAAA,CAAqBjd,CAAA,GAG1BR,CAAA,CAAKmd,kBAAA,EAAmB,IACxBnd,CAAA,CAAK+c,iBAAA,EART;QAAA,GAWP;MAAA;IAAA,GA1HL;MAAAjc,GAAA;MAAAC,KAAA,EAsII,SAAAA,CAAef,CAAA;QAAmF,IAAtEQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAoC;QAC5D,IAAK,KAAKyY,QAAA,MAAyC,MAA3B,KAAKA,QAAA,GAAW/c,MAAA,EAAxC;UAIA,IAAMQ,CAAA,GAAY,KAAKub,eAAA,GAAkB1c,CAAA;YACnCS,CAAA,GAAqB,GAAA4E,MAAA,CAAAlE,CAAA;YACrBE,CAAA,GAA6C,KAAKgb,QAAA,CAASnH,YAAA,CAAapC,EAAA,KAAuB;UAcrG,QAZItS,CAAA,CAAQmd,UAAA,IAAgB,gBAAgBnd,CAAA,IAClCR,CAAA,IAAOqB,CAAA,IAAsBA,CAAA,CAAiBrB,CAAA,EAAK4P,QAAA,CAASnP,CAAA,MAC1D2C,KAAA,CAAMsB,OAAA,CAAQrD,CAAA,CAAiBrB,CAAA,KAC/BqB,CAAA,CAAiBrB,CAAA,EAAK6H,IAAA,CAAKpH,CAAA,IAE3BY,CAAA,CAAiBrB,CAAA,IAAO,CAACS,CAAA,GAE7B,KAAK4b,QAAA,CAAS7I,WAAA,CAAYY,QAAA,CAAY1S,CAAA,KAAAoR,EAAA,EAAqBzR,CAAA,IAE3D,KAAKgb,QAAA,CAASrE,OAAA,CAAQ,wBAAwB;YAAE4F,aAAA,EAAe5d,CAAA;YAAK6d,sBAAA,EAAwB1c;UAAA,KAG7FA,CAjBN;QAAA;QAFG4D,OAAA,CAAQ4X,IAAA,CAAK,6BAA6B3c,CAAA,GAAM,gDAoBvD;MAAA;IAAA,GA5JL;MAAAc,GAAA;MAAAC,KAAA,EA8JI,SAAAA,CAAsBf,CAAA;QAElB,OADiB,KAAK8d,eAAA,GACN9d,CAAA,CACnB;MAAA;IAAA,GAjKL;MAAAc,GAAA;MAAAC,KAAA,EA6KI,SAAAA,CAAiBf,CAAA;QAA0E,IAA7DQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAoC;QAC9D,IAAK,KAAKyY,QAAA,MAAyC,MAA3B,KAAKA,QAAA,GAAW/c,MAAA,EAIxC,SAAS,KAAKod,cAAA,CAAe/d,CAAA,EAAKQ,CAAA;QAH9BuE,OAAA,CAAQ4X,IAAA,CAAK,+BAA+B3c,CAAA,GAAM,gDAIzD;MAAA;IAAA,GAnLL;MAAAc,GAAA;MAAAC,KAAA,EAqLI,SAAAA,CAAuBf,CAAA;QACnB,KAAKuc,wBAAA,CAAyB1U,IAAA,CAAK7H,CAAA,CACtC;MAAA;IAAA,GAvLL;MAAAc,GAAA;MAAAC,KAAA,EAyLI,SAAAA,CAA0Bf,CAAA;QACtB,KAAKuc,wBAAA,GAA2B,KAAKA,wBAAA,CAAyBtN,MAAA,CAAO,UAACzO,CAAA;UAAD,OAAOA,CAAA,KAAMR,CAAb;QAAA,EACxE;MAAA;IAAA,GA3LL;MAAAc,GAAA;MAAAC,KAAA,EA6LI,SAAAA,CAAqBf,CAAA;QACjB,KAAKqc,QAAA,CAAS2B,oBAAA,IAAuB;QACrC,IAAM7c,CAAA,GAAe,KAAKub,eAAA;UACpBjc,CAAA,GAAsB,KAAKqd,eAAA;QAAA,CAzOK,UAC1C9d,CAAA,EACAmB,CAAA;UAGC,IAFDV,CAAA,GAAAwE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAiD;YACjD5D,CAAA,GAAA4D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAgD;YAE1CpE,CAAA,GAAQb,CAAA,CAAQie,YAAA;YAChBlW,CAAA,GAAe/H,CAAA,CAAQke,mBAAA;UAC7B,IAAIrd,CAAA,EAEA,IAAIuC,KAAA,CAAMsB,OAAA,CAAQ7D,CAAA,GAAQ;YAAA,IAAAmH,CAAA;cAChBC,CAAA,GAAkD;YACxD,IAAIpH,CAAA,EACA,KAAK,IAAIqH,CAAA,GAAI,GAAGA,CAAA,GAAIrH,CAAA,CAAMF,MAAA,EAAQuH,CAAA,IAC9BD,CAAA,CAAuBpH,CAAA,CAAMqH,CAAA,MAAM;YAG3C/G,CAAA,IACIA,CAAA,CAAYiT,QAAA,EACP1S,CAAA,CAAAsG,CAAA,OAAA6T,EAAA,EAAmChb,CAAA,GACnCa,CAAA,CAAAsG,CAAA,EAAAyK,EAAA,EAAwBxK,CAAA,GAHjCD,CAAA,EAKH;UAAA,OAAM;YAAA,IAAAgJ,CAAA;cAECwG,CAAA,GAAkB3W,CAAA;cAClB8W,CAAA,GAAyB5P,CAAA;YACzB/H,CAAA,CAASme,yBAAA,KAET3G,CAAA,GAAuBhX,CAAA,CAAAA,CAAA,KAAAC,CAAA,GAAiB+W,CAAA,GACxCG,CAAA,GAA8BnX,CAAA,CAAAA,CAAA,KAAAa,CAAA,GAAwBsW,CAAA,IAE1DxW,CAAA,IACIA,CAAA,CAAYiT,QAAA,EACP1S,CAAA,CAAAsP,CAAA,OAAA6K,EAAA,EAAmCtY,MAAA,CAAOuQ,IAAA,CAAKkI,EAAA,CAAyBxE,CAAA,KACxE9V,CAAA,CAAAsP,CAAA,EAAAyB,EAAA,EAAwB+E,CAAA,IAAmB,CAFhD,IAGK9V,CAAA,CAAAsP,CAAA,EAAA+K,EAAA,EAAoCpE,CAAA,IAA0B,KAJvE3G,CAAA,EAMH;UAAA;QAER,CAmMO,CAA+BhR,CAAA,EAAU,KAAKqc,QAAA,CAAS7I,WAAA,EAAarS,CAAA,EAAcV,CAAA,GAClF,KAAK2d,0BAAA,EACR;MAAA;IAAA,GAnML;MAAAtd,GAAA;MAAAC,KAAA,EAgNI,SAAAA,CAASf,CAAA;QAGL,IAFA,KAAKsc,iBAAA,IAAoB,IAEX,MAAVtc,CAAA,EACA,KAAKqc,QAAA,CAAS7I,WAAA,CAAY6K,UAAA,CAAWvC,EAAA,OAClC,IAAI1Y,KAAA,CAAMsB,OAAA,CAAQ1E,CAAA,GAAQ;UAE7B,KADA,IAAMQ,CAAA,GAA6C,IAC1CW,CAAA,GAAI,GAAGA,CAAA,GAAInB,CAAA,CAAMW,MAAA,EAAQQ,CAAA,IAC9BX,CAAA,CAASR,CAAA,CAAMmB,CAAA,MAAM;UAEzB,KAAKkb,QAAA,CAAS7I,WAAA,CAAYY,QAAA,CAAY1S,CAAA,KAAAoa,EAAA,EAAqCtb,CAAA,EAC9E;QAAA,OACG,KAAK6b,QAAA,CAAS7I,WAAA,CAAYY,QAAA,CAAY1S,CAAA,KAAAoa,EAAA,EAAqC9b,CAAA,EAElF;MAAA;IAAA,GA9NL;MAAAc,GAAA;MAAAC,KAAA,EA2OI,SAAAA,CAAef,CAAA;QAA4C,IAAAQ,CAAA;QAEvD,IADA,KAAK8d,sBAAA,CAAuBte,CAAA,GACxB,KAAKqc,QAAA,CAAS2B,oBAAA,EAAsB;UACpC,IAAgC7c,CAAA,QAAKod,gCAAA;YAA7B9d,CAAA,GAAAU,CAAA,CAAAqd,KAAA;YAAOnd,CAAA,GAAAF,CAAA,CAAAsd,YAAA;UACfze,CAAA,CAASS,CAAA,EAAOY,CAAA,CACnB;QAAA;QACD,OAAO;UAAA,OAAMb,CAAA,CAAKke,yBAAA,CAA0B1e,CAAA;QAAA,CAC/C;MAAA;IAAA,GAlPL;MAAAc,GAAA;MAAAC,KAAA,EAoPI,SAAAA,CAAmCf,CAAA,EAAamB,CAAA;QAA2B,IAAAV,CAAA;UACjEY,CAAA,GAAoBK,CAAA,4BAAA2D,MAAA,CACErF,CAAA,GAAQmB,CAAA;QAEpC,KAAKkb,QAAA,CAASrE,OAAA,CAAQ,8BAA8B;UAChD4F,aAAA,EAAe5d,CAAA;UACf2e,mBAAA,EAAqBxd,CAAA;UACrBuZ,IAAA,EAAMrZ;QAAA,IAEV,KAAKoZ,2BAAA,CAA4BpZ,CAAA,GAAsB;QAEvD,IAAMR,CAAA,GAAAL,CAAA,CAAAA,CAAA,KAAgB,KAAKkc,eAAA,KAAoB,IAAAhb,CAAA,KAAA1B,CAAA,EAAMmB,CAAA;QACrD,KAAKkb,QAAA,CAAS7I,WAAA,CAAYY,QAAA,EACrB1S,CAAA,CAAAjB,CAAA,OAAAob,EAAA,EAAmCtY,MAAA,CAAOuQ,IAAA,CAAKkI,EAAA,CAAyBnb,CAAA,KACxEa,CAAA,CAAAjB,CAAA,EAAAgS,EAAA,EAAwB5R,CAAA,GAF7BJ,CAAA,IAIA,KAAK2d,0BAAA,EACR;MAAA;IAAA,GArQL;MAAAtd,GAAA;MAAAC,KAAA,EAuQI,SAAAA,CAAuBf,CAAA;QAAkE,IAAAQ,CAAA;UAA5BW,CAAA,GAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;UACnDxE,CAAA,GAAiC,KAAK4b,QAAA,CAASnH,YAAA,CAAaxC,EAAA;QAElE,IAAKjS,CAAA,KAAkCU,CAAA,EAcnC,OAAOnB,CAAA,CAASS,CAAA;QAbhB,KAAK4b,QAAA,CAAStB,aAAA,CAAd,GAAA1V,MAAA,CACO,KAAKgX,QAAA,CAASlH,UAAA,CAAW,aAAgD,sCAAA9P,MAAA,MAAKgX,QAAA,CAASlH,UAAA,CACtF,WAEJ,IACA;UAAEqI,MAAA,EAAQ;QAAA,GACV,UAACrc,CAAA;UACG,IAAMV,CAAA,GAAuBU,CAAA,CAAwCyd,mBAAA;UAErE,OADApe,CAAA,CAAK6b,QAAA,CAAS7I,WAAA,CAAYY,QAAA,CAA1B1S,CAAA,KAAsCgR,EAAA,EAAoCjS,CAAA,IACnET,CAAA,CAASS,CAAA;QAAA,EAM/B;MAAA;IAAA,GA1RL;MAAAK,GAAA;MAAAC,KAAA,EA4RI,SAAAA,CAAA;QACI,IAAMf,CAAA,GAAQ,KAAK0d,QAAA;UACbld,CAAA,GAAe,KAAKkc,eAAA;QAW1B,OAAO;UACH8B,KAAA,EATgBxe,CAAA,CAAMiP,MAAA,CAAO,UAACjP,CAAA;YAAD,OAAUQ,CAAA,CAAaR,CAAA,CAAvB;UAAA;UAU7Bye,YAAA,EATuBlb,MAAA,CAAOuQ,IAAA,CAAKtT,CAAA,EAClCyO,MAAA,CAAO,UAACjP,CAAA;YAAD,OAAgBQ,CAAA,CAAaR,CAAA,CADd;UAAA,GAEtB6e,MAAA,CAAO,UAAC7e,CAAA,EAAuCmB,CAAA;YAE5C,OADAnB,CAAA,CAAImB,CAAA,IAAOX,CAAA,CAAaW,CAAA,GACjBnB,CAJY;UAAA,GAKpB,CALoB;QAAA,CAW9B;MAAA;IAAA,GA7SL;MAAAc,GAAA;MAAAC,KAAA,EA+SI,SAAAA,CAAA;QACI,IAAgCf,CAAA,QAAKue,gCAAA;UAA7B/d,CAAA,GAAAR,CAAA,CAAAwe,KAAA;UAAOrd,CAAA,GAAAnB,CAAA,CAAAye,YAAA;QACf,KAAKlC,wBAAA,CAAyBjY,OAAA,CAAQ,UAACtE,CAAA;UAAD,OAAaA,CAAA,CAAQQ,CAAA,EAAOW,CAAA;QAAA,EACrE;MAAA;IAAA,GAlTL;MAAAL,GAAA;MAAAC,KAAA,EAyTI,SAAAA,CAA4Bf,CAAA;QAAyD,IAAjCmB,CAAA,KAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,QAAAA,SAAA;UAE1CxE,CAAA,GAAqB,KAAK4b,QAAA,CAASnH,YAAA,CAAavC,EAAA,KAAiC;QAEvF,KAAK0J,QAAA,CAASjI,QAAA,CAAd1S,CAAA,KACKiR,EAAA,EACMnS,CAAA,CAAAA,CAAA,KAAAC,CAAA,GACAT,CAAA,KAIPmB,CAAA,IACA,KAAKkb,QAAA,CAASyC,kBAAA,EAErB;MAAA;IAAA,GAvUL;MAAAhe,GAAA;MAAAC,KAAA,EAyUI,SAAAA,CAAA;QACI,KAAKsb,QAAA,CAASgC,UAAA,CAAW1L,EAAA,CAC5B;MAAA;IAAA,GA3UL;MAAA7R,GAAA;MAAAC,KAAA,EAqVI,SAAAA,CAA2Bf,CAAA;QAA6E,IAAjCmB,CAAA,KAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,QAAAA,SAAA;UAE7DxE,CAAA,GAAqB,KAAK4b,QAAA,CAASnH,YAAA,CAAatC,EAAA,KAAgC;QAEvC,MAA3CrP,MAAA,CAAOuQ,IAAA,CAAKrT,CAAA,EAAoBE,MAAA,IAChC4C,MAAA,CAAOuQ,IAAA,CAAKrT,CAAA,EAAoB6D,OAAA,CAAQ,UAACnD,CAAA;UACrCV,CAAA,CAAmBU,CAAA,IAAnBX,CAAA,CAAAA,CAAA,KACOC,CAAA,CAAmBU,CAAA,IACnBnB,CAAA,CAAWmB,CAAA,WAEXnB,CAAA,CAAWmB,CAAA;QAAA,IAI1B,KAAKkb,QAAA,CAASjI,QAAA,CAAd1S,CAAA,KACKkR,EAAA,EACMpS,CAAA,CAAAA,CAAA,KAAAC,CAAA,GACAT,CAAA,KAIPmB,CAAA,IACA,KAAKkb,QAAA,CAASyC,kBAAA,EAErB;MAAA;IAAA,GA7WL;MAAAhe,GAAA;MAAAC,KAAA,EA+WI,SAAAA,CAA6Bf,CAAA;QACzB,IAAIA,CAAA,EAAY;UACZ,IAAMmB,CAAA,GAAqB,KAAKkb,QAAA,CAASnH,YAAA,CAAatC,EAAA,KAAgC;UACtF,KAAKyJ,QAAA,CAASjI,QAAA,CACT1S,CAAA,KAAAkR,EAAA,EAAApS,CAAA,CAAAA,CAAA,KAAmCW,CAAA,GADxC,IAAAO,CAAA,KAC6D1B,CAAA,EAAa,CAD1E,KAGH;QAAA,OACG,KAAKqc,QAAA,CAASgC,UAAA,CAAWzL,EAAA,CAEhC;MAAA;IAAA,KAxXL5S,CAAA;EAAA;ECzEa+e,EAAA,GACT;EAESC,EAAA,GAA2B;EAC3BC,EAAA,GAAkB;EAElBC,EAAA,GAAoB;AAqC1B,IAAMC,EAAA,GAA0B;AChBvC,IA+CKC,EAAA;EA/CCC,EAAA,GAAgB;AAAA,WA+CjBrf,CAAA;EAAAA,CAAA,CAAAA,CAAA,CAAAsf,QAAA,oBAAAtf,CAAA,CAAAA,CAAA,CAAAuf,SAAA,qBAAAvf,CAAA,CAAAA,CAAA,CAAAwf,gBAAA,4BAAAxf,CAAA,CAAAA,CAAA,CAAAyf,MAAA,kBAAAzf,CAAA,CAAAA,CAAA,CAAA0f,cAAA,0BAAA1f,CAAA,CAAAA,CAAA,CAAA2f,KAAA,iBAAA3f,CAAA,CAAAA,CAAA,CAAA4f,SAAA,qBAAA5f,CAAA,CAAAA,CAAA,CAAA6f,gBAAA,4BAAA7f,CAAA,CAAAA,CAAA,CAAA8f,cAAA,0BAAA9f,CAAA,CAAAA,CAAA,CAAA+f,cAAA,0BAAA/f,CAAA,CAAAA,CAAA,CAAAggB,IAAA,iBAAAhgB,CAAA,CAAAA,CAAA,CAAAigB,GAAA,gBAAAjgB,CAAA,CAAAA,CAAA,CAAAkgB,IAAA,iBAAAlgB,CAAA,CAAAA,CAAA,CAAAmgB,gBAAA,6BAAAngB,CAAA,CAAAA,CAAA,CAAAogB,SAAA,sBAAApgB,CAAA,CAAAA,CAAA,CAAAqgB,iBAAA;AAAA,EAAAjB,EAAA,KAAAA,EAAA;AAmBL,IAAMkB,EAAA,GAAiB,CACnBlB,EAAA,CAAkBG,SAAA,EAClBH,EAAA,CAAkBI,gBAAA,EAClBJ,EAAA,CAAkBK,MAAA,EAClBL,EAAA,CAAkBM,cAAA,EAClBN,EAAA,CAAkBO,KAAA,EAClBP,EAAA,CAAkBQ,SAAA,EAClBR,EAAA,CAAkBS,gBAAA,EAClBT,EAAA,CAAkBc,IAAA;EAGTK,EAAA,GAAb;IAeI,SAAAvgB,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAAA0B,CAAA,CAHC,+BAAAM,IAAA,CAAKC,GAAA,KAGNP,CAAA,kBAFtB,IAGL,KAAK2a,QAAA,GAAW7b,CAAA,EAChB,KAAKggB,cAAA,IAAiB,GACtB,KAAKC,SAAA,GAAY,IACjB,KAAKC,IAAA,IAAO,GACZ,KAAKC,QAAA,GAAWtB,EAAA,EAChB,KAAKuB,SAAA,QAAY,GACjB,KAAKC,QAAA,GAAW,MAChB,KAAKC,SAAA,GAAY,MACjB,KAAKC,cAAA,IAAiB,CACzB;IAAA;IAzBL,OAAAlgB,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EA2BI,SAAAA,CAAA;QACQ,KAAKigB,kBAAA,KACL,KAAKC,wCAAA,KAEL,KAAKC,aAAA,EAEZ;MAAA;IAAA,GAjCL;MAAApgB,GAAA;MAAAC,KAAA,EAmCI,SAAAA,CAAA;QACI,OAAO,KAAKyf,cACf;MAAA;IAAA,GArCL;MAAA1f,GAAA;MAAAC,KAAA,EAuCI,SAAAA,CAAA;QACQ,KAAKyf,cAAA,IAAkB,KAAKI,SAAA,KAC5B,KAAKA,SAAA,IACL,KAAKA,SAAA,QAAY,GACjB,KAAKJ,cAAA,IAAiB,EAE7B;MAAA;IAAA,GA7CL;MAAA1f,GAAA;MAAAC,KAAA,EA+CI,SAAAA,CAAA;QACI,IAAMf,CAAA,KAAwB,KAAKqc,QAAA,CAASnH,YAAA,CAAa7C,EAAA;UACnD7R,CAAA,IAAuB,KAAK6b,QAAA,CAASlH,UAAA,CAAW;QACtD,OAAOnV,CAAA,IAAuBQ,CACjC;MAAA;IAAA,GAnDL;MAAAM,GAAA;MAAAC,KAAA,EAqDI,SAAAA,CAAA;QACI,IAAMf,CAAA,KAAwB,KAAKqc,QAAA,CAASnH,YAAA,CAAa5C,EAAA;UACnD9R,CAAA,GAAsB,KAAK6b,QAAA,CAASlH,UAAA,CAAW;QACrD,OAAO,QAAA3U,CAAA,GAAAA,CAAA,GAAuBR,CACjC;MAAA;IAAA,GAzDL;MAAAc,GAAA;MAAAC,KAAA,EA2DI,SAAAA,CAAA;QAAsB,IAAAf,CAAA;UACZQ,CAAA,GAA+B,KAAK6b,QAAA,CAASnH,YAAA,CAAa3C,EAAA;QAEhE,QADqC,UAAAvS,CAAA,QAAKqc,QAAA,CAASlH,UAAA,CAAW,8BAAzB,MAAAnV,CAAA,YAAAA,CAAA,CAA+CmhB,eAAA,KAC7C3gB,CAAA,IAAgC,IAC1E;MAAA;IAAA,GA/DL;MAAAM,GAAA;MAAAC,KAAA,EAiEI,SAAAA,CAAoBf,CAAA;QAA0B,IAAAQ,CAAA,EAAAW,CAAA,EAEXV,CAAA,EAAAY,CAAA,EAAAR,CAAA,EAOUkH,CAAA;QAAA,CARzC,KAAKgZ,cAAA,IAAiB,GAClB,KAAK1E,QAAA,CAAS7I,WAAA,KACd,KAAK6I,QAAA,CAAS7I,WAAA,CAAYY,QAAA,EAA1B1S,CAAA,CAAAb,CAAA,OACKwR,EAAA,IAA0CrS,CAAA,CAAQohB,gBAAA,GADvD1f,CAAA,CAAAb,CAAA,EAEKyR,EAAA,EAFL,UAAA7R,CAAA,GAEiDT,CAAA,CAASohB,gBAAA,UAF1D,MAAA3gB,CAAA,YAEiDA,CAAA,CAA2B4gB,0BAAA,GAF5E3f,CAAA,CAAAb,CAAA,EAGK0R,EAAA,EAHL,UAAAlR,CAAA,GAGsDrB,CAAA,CAASohB,gBAAA,UAH/D,MAAA/f,CAAA,YAGsDA,CAAA,CAA2B8f,eAAA,GAHjFtgB,CAAA;QAMA,UAAJL,CAAA,GAAIR,CAAA,CAASohB,gBAAA,UAAT,MAAA5gB,CAAA,IAAAA,CAAA,CAA2BmgB,QAAA,KAC3B,KAAKA,QAAA,GAAL,UAAgB5Y,CAAA,GAAA/H,CAAA,CAASohB,gBAAA,UAAzB,MAAArZ,CAAA,YAAgBA,CAAA,CAA2B4Y,QAAA;QAG3C,UAAJxf,CAAA,GAAInB,CAAA,CAASohB,gBAAA,UAAT,MAAAjgB,CAAA,IAAAA,CAAA,CAA2BggB,eAAA,KAC3B,KAAKA,eAAA,GAAkBnhB,CAAA,CAASohB,gBAAA,CAAiBD,eAAA,GAErD,KAAKG,uBAAA,EACR;MAAA;IAAA,GAlFL;MAAAxgB,GAAA;MAAAC,KAAA,EAoFI,SAAAA,CAAA;QAA2C,IAAAf,CAAA;QAGnC,KAAK+gB,cAAA,KACL,KAAKL,IAAA,IAAO,GACZ,KAAKD,SAAA,CAAUnc,OAAA,CAAQ,UAAC9D,CAAA;UAAD,OAAgBR,CAAA,CAAKuhB,gBAAA,CAAiB/gB,CAAA;QAAA,KAEjE,KAAKghB,aAAA,EACR;MAAA;IAAA,GA5FL;MAAA1gB,GAAA;MAAAC,KAAA,EA8FI,SAAAA,CAAA;QAAgB,IAAAf,CAAA;QAQZ,SAA6B,MAAlBuD,MAAA,CAAOke,MAAA,KAKd,KAAKjB,cAAA,KAAkB,KAAKnE,QAAA,CAASlH,UAAA,CAAW,8BAApD;UAIA,KAAKqL,cAAA,IAAiB,GAEtB,KAAKnE,QAAA,CAASqF,cAAA,CAAeC,6BAAA;UAE7B,IAAMnhB,CAAA,GAA4C,SAA/B,KAAKohB,mBAAA,KAAiC,mBAAmB;UAKxE,KAAKvF,QAAA,CAASwF,yBAAA,KAA8B,KAAKD,mBAAA,KACjD1X,EAAA,CACI,KAAKmS,QAAA,CAASlH,UAAA,CAAW,cAAzB,WAAA9P,MAAA,CAAkD7E,CAAA,EAAlD,OAAA6E,MAAA,CAAkE1F,CAAA,CAAOE,WAAA,GACzE,UAACsB,CAAA;YACG,IAAIA,CAAA,EACA,OAAOyD,CAAA,CAAOQ,KAAA,mBAAAC,MAAA,CAAwB7E,CAAA,GAAcW,CAAA;YAGxDnB,CAAA,CAAK8hB,eAAA,EACR;UAAA,KAGL,KAAKA,eAAA,EAvBR;QAAA;MAyBJ;IAAA,GAtIL;MAAAhhB,GAAA;MAAAC,KAAA,EAwII,SAAAA,CAAoBf,CAAA;QAAsB,IAAAQ,CAAA;QACtC,OD5OuC,MC4OhCR,CAAA,CAAMqK,IAAA,KAA4F,MAAhDiW,EAAA,CAAe9b,OAAA,CAAf,UAAuBhE,CAAA,GAAAR,CAAA,CAAMwb,IAAA,UAA7B,MAAAhb,CAAA,YAAuBA,CAAA,CAAYuhB,MAAA,CAC/F;MAAA;IAAA,GA1IL;MAAAjhB,GAAA;MAAAC,KAAA,EA4II,SAAAA,CAA2Bf,CAAA;QAKvB,IAAMQ,CAAA,GAAoB,KAAKwhB,mBAAA,CAAoBhiB,CAAA;QAkBnD,IAhBKQ,CAAA,IAAsB,KAAKyhB,MAAA,IAExBjiB,CAAA,CAAM8B,SAAA,GAAY,KAAKogB,qBAAA,GAhOW,QAiOlC,KAAKD,MAAA,IAAS,IAIlBzhB,CAAA,KACA,KAAK0hB,qBAAA,GAAwBliB,CAAA,CAAM8B,SAAA,EAC/B,KAAKmgB,MAAA,KAEL,KAAKA,MAAA,IAAS,GACd,KAAKE,oBAAA,OAIT,KAAKF,MAAA,EAAT;UAKA,IAAA9gB,CAAA,GAAgC,KAAKkb,QAAA,CAASqF,cAAA,CAAeC,6BAAA,EACxDnhB,CAAA,EACDR,CAAA,CAAM8B,SAAA;YAFFrB,CAAA,GAAAU,CAAA,CAAA0f,QAAA;YAAUxf,CAAA,GAAAF,CAAA,CAAA2f,SAAA;UAAA,CAMuD,MAArE,CAAC9B,EAAA,EAA0BC,EAAA,EAAiBza,OAAA,CAAQxE,CAAA,CAAMqK,IAAA,KACzD,KAAKwW,QAAA,KAAapgB,CAAA,IAAY,KAAKqgB,SAAA,KAAczf,CAAA,IAElD,KAAK8gB,oBAAA,IAET,KAAKtB,QAAA,GAAWpgB,CAAA,EAChB,KAAKqgB,SAAA,GAAYzf,CAxC4B;QAAA;MAyChD;IAAA,GArLL;MAAAP,GAAA;MAAAC,KAAA,EAuLI,SAAAA,CAAA;QACI,KAAK,KAAKyf,cAAA,EACN,QAAO;QAEX;UAAI,IAAAxgB,CAAA;UAEA,iBADKA,CAAA,QAAAoiB,WAAA,gBAAApiB,CAAA,IAAAA,CAAA,CAAaqiB,gBAAA,KACX,CAFX;QAAA,CAGE,QAAOriB,CAAA;UAGL,OADA4E,CAAA,CAAOQ,KAAA,CAAM,+BAA+BpF,CAAA,IACrC,CACV;QAAA;MACJ;IAAA,GAnML;MAAAc,GAAA;MAAAC,KAAA,EAqMI,SAAAA,CAAA;QAAkB,IAAAf,CAAA;UAERmB,CAAA,GAAwD;YAG1DmhB,UAAA,EAAY;YACZC,aAAA,OAAe;YACfC,WAAA,EAAa;YACbC,aAAA,EAAe;YACfC,gBAAA,OAAkB;YAClBC,UAAA,OAAY;YACZC,aAAA,GAAe;YACfC,gBAAA,EAAkB,CAVwC;YAW1DC,WAAA,OAAa;YACbC,cAAA,EAAgB,CAZ0C;YAa1DC,YAAA,GAAc;YACdC,gBAAA,GAAkB;YAClBC,wBAAA,GAA0B;UAAA;QAM9B,KAAKd,WAAA,GAAcve,MAAA,CAAOsf,KAAA,GAAQtf,MAAA,CAAOsf,KAAA,CAAMC,MAAA,GAASvf,MAAA,CAAOue,WAAA;QAI/D,KADA,IAAM3hB,CAAA,GAA8B,KAAK4b,QAAA,CAASlH,UAAA,CAAW,sBAClC9T,CAAA,MAAAR,CAAA,GAAA0C,MAAA,CAAO8f,OAAA,CAAQ5iB,CAAA,IAA+B,KAAKY,CAAA,GAAAR,CAAA,CAAAF,MAAA,EAAAU,CAAA;UAAzE,IAAAK,CAAA,GAAAiW,CAAA,CAAA9W,CAAA,CAAAQ,CAAA;YAAO0G,CAAA,GAAPrG,CAAA;YAAYsG,CAAA,GAAZtG,CAAA;UACGqG,CAAA,IAAO5G,CAAA,KAGPA,CAAA,CAAwB4G,CAAA,IAAOC,CAAA,CAEtC;QAAA;QAEI,KAAKoa,WAAA,IAOV,KAAKxB,SAAA,GAAY,KAAKwB,WAAA,CAAL5hB,CAAA;UACbkgB,IAAA,EAAM,SAAAA,CAAClgB,CAAA;YACHR,CAAA,CAAKsjB,WAAA,CAAY9iB,CAAA,CAFR;UAAA;UAIb+iB,OAAA,EACK1f,MAAA,CAAe2f,kBAAA,IAAsB,KAAKC,0BAAA,KACrC,CAAE5f,MAAA,CAAe2f,kBAAA,CAAmBE,sBAAA,MACpC;QAAA,GACPviB,CAAA,IAKP,KAAKkb,QAAA,CAASsH,eAAA,CAAgB,UAACnjB,CAAA;UAE3B;YACmC,IAAAW,CAAA;YAA/B,IAAkB,gBAAdX,CAAA,EACA,UAAAW,CAAA,GAAAnB,CAAA,CAAKoiB,WAAA,UAAL,MAAAjhB,CAAA,IAAAA,CAAA,CAAkByiB,cAAA,CAAe,aAAa;cAAElX,IAAA,EAAM7I,MAAA,CAAOwJ,QAAA,CAASX;YAAA,EAF9E;UAAA,CAIE,QAAO1M,CAAA;YACL4E,CAAA,CAAOQ,KAAA,CAAM,4CAA4CpF,CAAA,CAC5D;UAAA;QACJ,IAGD,KAAKkiB,qBAAA,GAAwBlgB,IAAA,CAAKC,GAAA,IAClC,KAAKggB,MAAA,IAAS,KAhCVrd,CAAA,CAAOQ,KAAA,CACH,uGAgCX;MAAA;IAAA,GA1QL;MAAAtE,GAAA;MAAAC,KAAA,EA4QI,SAAAA,CAAYf,CAAA;QAOR,IANAA,CAAA,GDpUD,UAAkCA,CAAA;UAIrC,IACIA,CAAA,IACiB,aAAjBmB,CAAA,CAAOnB,CAAA,KACPA,CAAA,CAAMqK,IAAA,KAAS6U,EAAA,IACO,aAAtB/d,CAAA,CAAOnB,CAAA,CAAMwb,IAAA,KACbxb,CAAA,CAAMwb,IAAA,CAAKqI,MAAA,KAAW1E,EAAA,EACxB;YAEMnf,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQnjB,MAAA,GAVP,OAWpBX,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,GAAU9jB,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQ7iB,KAAA,CAAM,GAX1C,KAYpBjB,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQjc,IAAA,CAAK;YAGpC,KADA,IAAMrH,CAAA,GAAiB,IACdC,CAAA,GAAI,GAAGA,CAAA,GAAIT,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQnjB,MAAA,EAAQF,CAAA,IAE/CT,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQrjB,CAAA,KAC3BT,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQrjB,CAAA,EAAGE,MAAA,GAnBlB,MAqBZH,CAAA,CAAeqH,IAAA,CAAK7H,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQrjB,CAAA,EAAGQ,KAAA,CAAM,GArB5C,OAqBkE,oBAE9ET,CAAA,CAAeqH,IAAA,CAAK7H,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,CAAQrjB,CAAA;YAIvD,OADAT,CAAA,CAAMwb,IAAA,CAAKsI,OAAA,CAAQA,OAAA,GAAUtjB,CAAA,EACtBR,CACV;UAAA;UACD,OAAOA,CACV;QAAA,CCqSe,CDrWT,UAA4CA,CAAA;UAC/C,IAAIA,CAAA,IAAwB,aAAhBmB,CAAA,CAAOnB,CAAA,GAAmB;YAClC,IAAIQ,CAAA,GAAkBkQ,IAAA,CAAKQ,SAAA,CAAUlR,CAAA;YAKrC,IAAIQ,CAAA,CAAgBG,MAAA,GAAS,KAAS;cAKlC,IALkCF,CAAA;gBAAAY,CAAA,GAAA6a,CAAA,CAMlB1b,CAAA,CAAgBujB,QAAA,CADX;cALa;gBAOlC,KAA6B1iB,CAAA,CAAAK,CAAA,MAAAjB,CAAA,GAAAY,CAAA,CAAAF,CAAA,IAAAgb,IAAA;kBAAA,IAAlBtb,CAAA,GAAkBJ,CAAA,CAAAM,KAAA;kBAErBP,CAAA,GAD6C,aAA7CK,CAAA,CAAM,GAAGmjB,iBAAA,GAAoB/iB,KAAA,CAAM,GAAG,KACpBT,CAAA,CAAgBiF,OAAA,CAAQ5E,CAAA,CAAM,IAAIke,EAAA,IAElCve,CAAA,CAAgBiF,OAAA,CAAQ5E,CAAA,CAAM,IAAI,GAE3D;gBAAA;cAbiC,SAAAb,CAAA;gBAAAqB,CAAA,CAAArB,CAAA,CAAAA,CAAA;cAAA;gBAAAqB,CAAA,CAAAsW,CAAA;cAAA;YAcrC;YACD,OAAOjH,IAAA,CAAKD,KAAA,CAAMjQ,CAAA,CACrB;UAAA;UACD,OAAOR,CACV;QAAA,CC6UW,CAAmCA,CAAA,IAGvC,KAAKikB,0BAAA,CAA2BjkB,CAAA,IAE5B,KAAKiiB,MAAA,EAAT;UAKA,IAAMzhB,CAAA,GAAa;YACf0jB,cAAA,EAAgBlkB,CAAA;YAChBmkB,WAAA,EAAa,KAAKrD,SAAA;YAClBsD,UAAA,EAAY,KAAKvD;UAAA;UAGrB,KAAKxE,QAAA,CAASgI,eAAA,CAAgBC,IAAA,CAAK,iBACnC,KAAKjI,QAAA,CAASgI,eAAA,CAAgBC,IAAA,CAAqB,gBAAAjf,MAAA,CAAArF,CAAA,CAAMqK,IAAA,IAErD,KAAKqW,IAAA,GACL,KAAKa,gBAAA,CAAiB/gB,CAAA,IAEtB,KAAKigB,SAAA,CAAU5Y,IAAA,CAAKrH,CAAA,CAdvB;QAAA;MAgBJ;IAAA,GAtSL;MAAAM,GAAA;MAAAC,KAAA,EAwSI,SAAAA,CAAiBf,CAAA;QAEb,KAAKqc,QAAA,CAASrE,OAAA,CAAQ,aAAahY,CAAA,EAAY;UAC3CukB,SAAA,EAAW;UACX/G,MAAA,EAAQ;UACRmD,QAAA,EAAU,KAAKA,QAAA;UACf6D,WAAA,GAAa;UACbC,SAAA,EAAW;UACXC,QAAA,EAAU;YACNC,mBAAA,EAAqB3kB,CAAA,CAAWkkB,cAAA,CAAe7Z,IAAA,KAAS2U;UAAA;QAAA,EAGnE;MAAA;IAAA,KApTLhf,CAAA;EAAA;ECtGM4kB,EAAA,GAAwD;IAE1DC,SAAA,EAAW;IACXC,UAAA,EAAY;IACZpV,IAAA,EAAM;IAGNqV,SAAA,EAAW;IACXC,aAAA,EAAe;IACfC,WAAA,EAAa;IACbC,WAAA,EAAa;IACbC,UAAA,EAAY;IACZC,iBAAA,EAAmB;IACnBC,eAAA,EAAiB;IACjBC,YAAA,EAAc;IACdC,qBAAA,EAAuB;IACvBC,UAAA,EAAY;IACZC,YAAA,EAAc;IACdC,aAAA,EAAe;IACfC,WAAA,EAAa;IACbC,eAAA,EAAiB;IACjBC,eAAA,EAAiB;IACjBC,aAAA,EAAe;IACfC,eAAA,EAAiB;IACjBC,oBAAA,EAAsB;IACtBC,cAAA,EAAgB;IAChBC,YAAA,EAAc;IAGdC,OAAA,EAAS;IACTC,UAAA,EAAY;IACZC,QAAA,EAAU;IACVC,IAAA,EAAM;IACN3W,EAAA,EAAI;IACJ4W,GAAA,EAAK;IAGLC,WAAA,EAAa;IACbC,qBAAA,EAAuB;IACvBC,cAAA,EAAgB;IAChBC,YAAA,EAAc;IACdC,cAAA,EAAgB;IAChBC,aAAA,EAAe;IACfC,cAAA,EAAgB;IAChBC,cAAA,EAAgB;IAChBC,gBAAA,EAAkB;IAGlBC,QAAA,EAAU;IACVnlB,SAAA,EAAW;EAAA;EAWTolB,EAAA,GAAyB,CAE3B,eAGA,cACA,SACA;EAKEC,EAAA,GAA0B,CAAC,OAFM;EAI1BC,EAAA,GAAb;IAQI,SAAApnB,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAAA0B,CAAA,gCAFR,IAGnB,KAAK2a,QAAA,GAAW7b,CACnB;IAAA;IAVL,OAAAK,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAYI,SAAAA,CAAA;QACQ,KAAKsmB,SAAA,KACL,KAAKC,cAAA,KAEL,KAAKC,aAAA,EAEZ;MAAA;IAAA,GAlBL;MAAAzmB,GAAA;MAAAC,KAAA,EAoBI,SAAAA,CAAA;QAAiB,IAAAf,CAAA;UAAAQ,CAAA;UAAAW,CAAA;QACb,KAAI,KAAKqmB,QAAA,EAIT,SAAyD,OAArD,UAAAxnB,CAAA,GAAA6D,MAAA,gBAAA7D,CAAA,IAA6B,UAA7BQ,CAAA,GAAAR,CAAA,CAAQynB,mBAAA,UAAqB,MAAAjnB,CAAA,QAA7B,IAA6BA,CAAA,CAAAknB,mBAAA;UAOjC,KXsjBGtjB,CAAA,CAAawL,QAAA,CAASvC,QAAA,CAASuD,QAAA,KWtjBZ,KAAK+W,oBAAA,EAK3B;YAGI,KAAKH,QAAA,GAAW,IAAIC,mBAAA,CAAoB,UAACznB,CAAA;cACrCA,CAAA,CAAK4nB,UAAA,GAAatjB,OAAA,CAAQ,UAACtE,CAAA;gBACvBmB,CAAA,CAAK0mB,wBAAA,CAAyB7nB,CAAA;cAAA;YAAA;YAMtC,IAAMS,CAAA,GAAagnB,mBAAA,CAAoBC,mBAAA,CAAoBzY,MAAA,CAAO,UAACjP,CAAA;cAAD,OAAOknB,EAAA,CAAuBtX,QAAA,CAAS5P,CAAA,CAAvC;YAAA;YAElES,CAAA,CAAW6D,OAAA,CAAQ,UAACtE,CAAA;cAAc,IAAAQ,CAAA;cACf,UAAfA,CAAA,GAAAW,CAAA,CAAKqmB,QAAA,UAAU,MAAAhnB,CAAA,IAAAA,CAAA,CAAAsnB,OAAA,CAAQ;gBAAEzd,IAAA,EAAMrK,CAAA;gBAAW+nB,QAAA,GAAU;cAAA;YAAA,EAd5D;UAAA,CAgBE,QAAO/nB,CAAA;YACL+E,OAAA,CAAQK,KAAA,CAAM,gDAAgDpF,CAAA,GAC9D,KAAKunB,aAAA,EACR;UAAA,OAvBG3iB,CAAA,CAAOC,GAAA,CAAI;QAAA,OAPXD,CAAA,CAAOC,GAAA,CACH,yGA8BX;MAAA;IAAA,GAzDL;MAAA/D,GAAA;MAAAC,KAAA,EA2DI,SAAAA,CAAA;QACQ,KAAKymB,QAAA,KACL,KAAKA,QAAA,CAASQ,UAAA,IACd,KAAKR,QAAA,QAAW,EAEvB;MAAA;IAAA,GAhEL;MAAA1mB,GAAA;MAAAC,KAAA,EAkEI,SAAAA,CAAA;QACI,SAAS,KAAKymB,QACjB;MAAA;IAAA,GApEL;MAAA1mB,GAAA;MAAAC,KAAA,EAsEI,SAAAA,CAAA;QAAY,IAAAf,CAAA,EAAAQ,CAAA;QACR,iBAAOR,CAAA,GAAmD,UAAnDQ,CAAA,QAAK6b,QAAA,CAASlH,UAAA,CAAW,gCAA0B,MAAA3U,CAAA,GAAAA,CAAA,QAAKynB,aAAA,UAA/D,MAAAjoB,CAAA,IAAAA,CACH;MAAA;IAAA,GAxEL;MAAAc,GAAA;MAAAC,KAAA,EA0EI,SAAAA,CAAoBf,CAAA;QAChB,KAAKioB,aAAA,GAAgBjoB,CAAA,CAASkoB,kBAAA,KAAsB,GAChD,KAAKb,SAAA,MACL,KAAKC,cAAA,EAEZ;MAAA;IAAA,GA/EL;MAAAxmB,GAAA;MAAAC,KAAA,EAiFI,SAAAA,CAAyBf,CAAA;QAGrB,IAAiE,MAA7DA,CAAA,CAAM0P,IAAA,CAAKlL,OAAA,CAAQ,KAAK6X,QAAA,CAASlH,UAAA,CAAW,cAAoB;UAChE,IAAM3U,CAAA,GAAOR,CAAA,CAAM0P,IAAA,CAAKjK,OAAA,CAAQ,KAAK4W,QAAA,CAASlH,UAAA,CAAW,aAAa;UAEtE,IAAIgS,EAAA,CAAwBgB,IAAA,CAAK,UAACnoB,CAAA;YAAD,OAA2B,MAApBQ,CAAA,CAAKgE,OAAA,CAAQxE,CAAA,CAApB;UAAA,IAC7B;QAPsC;QAa9C,IAAImB,CAAA,GAAoD;YACpDolB,GAAA,EAAKvmB,CAAA,CAAM0P;UAAA;UAGTjP,CAAA,GAA8B,KAAK4b,QAAA,CAASlH,UAAA,CAAW;QAM7D,IAJI1U,CAAA,CAA4B2nB,oBAAA,KAC5BjnB,CAAA,GAAiBV,CAAA,CAA4B2nB,oBAAA,CAAqBjnB,CAAA,IAGjEA,CAAA,EAAL;UAIA,IAAME,CAAA,GAAYrB,CAAA,CAAMqoB,MAAA;UACxBhnB,CAAA,CAAUqO,IAAA,GAAOvO,CAAA,CAAeolB,GAAA;UAChC,IAAM1lB,CAAA,GAAqC;YAKrCkH,CAAA,GAAajI,IAAA,CAAKI,KAAA,CAAM8B,IAAA,CAAKC,GAAA,KAAQqmB,WAAA,CAAYrmB,GAAA;UAKvD,KAAK,IAAM+F,CAAA,IAJXnH,CAAA,CAAW+jB,EAAA,CAA0BE,UAAA,IAAkB/c,CAAA,EAGvDlH,CAAA,CAAW+jB,EAAA,CAA0B9iB,SAAA,IAAiBhC,IAAA,CAAKI,KAAA,CAAM6H,CAAA,GAAa/H,CAAA,CAAM+kB,SAAA,GAClEH,EAAA,OACS,MAAnBvjB,CAAA,CAAU2G,CAAA,MACVnH,CAAA,CAAW+jB,EAAA,CAA2B5c,CAAA,KAAQ3G,CAAA,CAAU2G,CAAA;UAMhE,IAFA,KAAKugB,uBAAA,CAAwB1nB,CAAA,GAEzB2nB,EAAA,CAAoBxoB,CAAA,GAAQ;YAAA,IAAAiI,CAAA;cAAAC,CAAA,GAAAgU,CAAA,CACPlc,CAAA,CAAMyoB,YAAA,IAAgB;YADf;cAC5B,KAA+CvgB,CAAA,CAAAxG,CAAA,MAAAuG,CAAA,GAAAC,CAAA,CAAA/G,CAAA,IAAAgb,IAAA;gBAAA,IAAAnL,CAAA;kBAApCwG,CAAA,GAAoCvP,CAAA,CAAAlH,KAAA;gBAC3C,KAAKwnB,uBAAA,EAAA7mB,CAAA,CAAAsP,CAAA,OACA4T,EAAA,CAA0BE,UAAA,EAAiB/c,CAAA,GADhDrG,CAAA,CAAAsP,CAAA,EAEK4T,EAAA,CAA0B9iB,SAAA,EAAgBhC,IAAA,CAAKI,KAAA,CAAM6H,CAAA,GAAa/H,CAAA,CAAM+kB,SAAA,IAAArjB,CAAA,CAAAsP,CAAA,EACxE4T,EAAA,CAA0BlV,IAAA,EAAW8H,CAAA,CAAO9H,IAAA,GAC5ChO,CAAA,CAAAsP,CAAA,EAAA4T,EAAA,CAA0BqC,QAAA,EAAezP,CAAA,CAAOyP,QAAA,GAJrDvlB,CAAA,CAAAsP,CAAA,EAUK4T,EAAA,CAA0BC,SAAA,EAAgB,iBAV/C7T,CAAA,EAYH;cAAA;YAd2B,SAAAhR,CAAA;cAAAkI,CAAA,CAAAlI,CAAA,CAAAA,CAAA;YAAA;cAAAkI,CAAA,CAAAyP,CAAA;YAAA;UAe/B;QArCA;MAsCJ;IAAA,GAhJL;MAAA7W,GAAA;MAAAC,KAAA,EAqJI,SAAAA,CAAgCf,CAAA;QAAoC,IAAAQ,CAAA;UAC1DW,CAAA,GAAYnB,CAAA,CAAW4kB,EAAA,CAA0B9iB,SAAA;QAEvD,UAAAtB,CAAA,QAAK6b,QAAA,CAAS+E,gBAAA,UAAd,MAAA5gB,CAAA,IAAAA,CAAA,CAAgC8iB,WAAA,CAAY;UACxCjZ,IAAA,EAAM;UACNmR,IAAA,EAAM;YACFqI,MAAA,EAAQ;YACRC,OAAA,EAAS9jB;UAAA;UAEb8B,SAAA,EAAAX;QAAA,EAUP;MAAA;IAAA,KAxKLnB,CAAA;EAAA;EAgLMwoB,EAAA,GAAsB,SAAAE,CAAC1oB,CAAA;IAAD,OACJ,iBAApBA,CAAA,CAAM6kB,SAAA,IAAkD,eAApB7kB,CAAA,CAAM6kB,SADlB;EAAA;ECxPf8D,EAAA,GAAb;IAGI,SAAA3oB,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAC3B,KAAKqc,QAAA,GAAW7b,CAAA,EAEhB,KAAK6b,QAAA,CAAS2B,oBAAA,GAAuB,KAAK3B,QAAA,CAASuM,4BAAA,EACtD;IAAA;IAPL,OAAA/nB,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EASI,SAAAA,CAAA;QAAa,IAAAf,CAAA;UAYHQ,CAAA,GAAesH,EAAA,CARH4I,IAAA,CAAKQ,SAAA,CAAU;YAC7BiC,KAAA,EAAO,KAAKkJ,QAAA,CAASlH,UAAA,CAAW;YAChCxD,WAAA,EAAa,KAAK0K,QAAA,CAASjB,eAAA;YAC3BgC,MAAA,EAAQ,KAAKf,QAAA,CAASgB,SAAA;YACtBC,iBAAA,EAAmB,KAAKjB,QAAA,CAASnH,YAAA,CAAavC,EAAA;YAC9C4K,gBAAA,EAAkB,KAAKlB,QAAA,CAASnH,YAAA,CAAatC,EAAA;UAAA;QAIjD,KAAKyJ,QAAA,CAAStB,aAAA,CACP,GAAA1V,MAAA,MAAKgX,QAAA,CAASlH,UAAA,CAAW,aAC5B;UAAEqG,IAAA,EAAMhb,CAAA;UAAcqoB,OAAA,GAAS;QAAA,GAC/B;UAAErL,MAAA,EAAQ;QAAA,GACV,UAAChd,CAAA;UAAD,OAAcR,CAAA,CAAK8oB,mBAAA,CAAoBtoB,CAAA;QAAA,EAE9C;MAAA;IAAA,GA5BL;MAAAM,GAAA;MAAAC,KAAA,EA8BI,SAAAA,CAAoBf,CAAA;QAAgC,IAAAQ,CAAA;UAAAW,CAAA;UAAAV,CAAA;UAAAY,CAAA;QAChD,IAAyB,OAArB,QAAArB,CAAA,YAAAA,CAAA,CAAU+oB,MAAA,GAAd;UAKA,IADA,KAAK1M,QAAA,CAAS2B,oBAAA,IAAuB,IAC/B9Z,QAAA,KAAYA,QAAA,CAAS0G,IAAA,EAKvB,OAJA7F,OAAA,CAAQF,GAAA,CAAI,qEACZoY,UAAA,CAAW;YACP5b,CAAA,CAAKynB,mBAAA,CAAoB9oB,CAAA,CADnB;UAAA,GAEP;UAaP,IATA,KAAKqc,QAAA,CAAS2M,OAAA,CAAQzQ,mBAAA,CAAoBvY,CAAA,GACV,UAAhCQ,CAAA,QAAK6b,QAAA,CAAS+E,gBAAA,UAAkB,MAAA5gB,CAAA,IAAAA,CAAA,CAAA+X,mBAAA,CAAoBvY,CAAA,GACpD8U,EAAA,CAAYyD,mBAAA,CAAoBvY,CAAA,EAAU,KAAKqc,QAAA,GACjB,UAA9Blb,CAAA,QAAKkb,QAAA,CAAS4M,cAAA,UAAgB,MAAA9nB,CAAA,IAAAA,CAAA,CAAAoX,mBAAA,CAAoBvY,CAAA,GACd,UAApCS,CAAA,QAAK4b,QAAA,CAAS6M,oBAAA,UAAsB,MAAAzoB,CAAA,IAAAA,CAAA,CAAA8X,mBAAA,CAAoBvY,CAAA,GAExD,KAAKqc,QAAA,CAAS4B,YAAA,CAAaR,oBAAA,CAAqBzd,CAAA,GAEhD,KAAKqc,QAAA,CAAL8M,WAAA,GAA+B,IAC3BnpB,CAAA,CAAQopB,oBAAA,KAA6B,KAAK/M,QAAA,CAASlH,UAAA,CAAW,wBAAwB;YACtF,IADsFtU,CAAA;cAChFa,CAAA,GAAqD;cACtCqG,CAAA,GAAAmU,CAAA,CAAAlc,CAAA,CAAQopB,oBAAA;YAFyD;cAEtF,KAAuDrhB,CAAA,CAAArG,CAAA,MAAAb,CAAA,GAAAkH,CAAA,CAAA5G,CAAA,IAAAgb,IAAA;gBACnDza,CAAA,CADmDb,CAAA,CAAAE,KAAA,KAC7B,CACzB;cAAA;YAJqF,SAAAf,CAAA;cAAA+H,CAAA,CAAA/H,CAAA,CAAAA,CAAA;YAAA;cAAA+H,CAAA,CAAA4P,CAAA;YAAA;YAKtF,KAAK0E,QAAA,CAAL8M,WAAA,GAA+BznB,CAClC;UAAA;UAED,IAAI1B,CAAA,CAAQqpB,QAAA,EACR,IAAI,KAAKhN,QAAA,CAASlH,UAAA,CAAW,qBAAqB;YAC9C,IAD8CnN,CAAA;cACxCC,CAAA,GAAU,KAAKoU,QAAA,CAASlH,UAAA,CAAW;cACfjN,CAAA,GAAAgU,CAAA,CAAAlc,CAAA,CAAQqpB,QAAA;YAFY;cAAA,IAAArY,CAAA,YAAAsY,CAAA;gBAAA,IAAAtpB,CAAA,GAAAgI,CAAA,CAAAjH,KAAA;kBAEjCP,CAAA,GAAAR,CAAA,CAAA2P,EAAA;kBAAIxO,CAAA,GAAAnB,CAAA,CAAAumB,GAAA;kBACP9lB,CAAA,GAAY,CACdwH,CAAA,EACgC,QAAhCA,CAAA,CAAQA,CAAA,CAAQtH,MAAA,GAAS,MAAyB,QAAXQ,CAAA,CAAI,KAAaA,CAAA,CAAIuH,SAAA,CAAU,KAAKvH,CAAA,EAC7EkH,IAAA,CAAK;gBAELxE,MAAA,CAAkC,mBAAAwB,MAAA,CAAA7E,CAAA,KAAQa,CAAA,CAAKgb,QAAA,EAEjDnS,EAAA,CAAWzJ,CAAA,EAAW,UAACT,CAAA;kBACfA,CAAA,IACA+E,OAAA,CAAQK,KAAA,CAA6D,uDAAAC,MAAA,CAAA7E,CAAA,GAAMR,CAAA,CAElF;gBAAA,EAdyC;cAAA;cAE9C,KAAgDkI,CAAA,CAAAxG,CAAA,MAAAsG,CAAA,GAAAE,CAAA,CAAA/G,CAAA,IAAAgb,IAAA,GAAAnL,CAAA,EAFF;YAAA,SAAAhR,CAAA;cAAAkI,CAAA,CAAAlI,CAAA,CAAAA,CAAA;YAAA;cAAAkI,CAAA,CAAAyP,CAAA;YAAA;UAAlD,OAgBW3X,CAAA,CAAQqpB,QAAA,CAAa1oB,MAAA,GAAS,KACrCoE,OAAA,CAAQK,KAAA,CAAM,mFA7CrB;QAAA,OAFGL,OAAA,CAAQK,KAAA,CAAM,8CAkDrB;MAAA;IAAA,KAlFLpF,CAAA;EAAA;ECNaupB,EAAA,GAAwB,CAAC,2BAA2B;EAAAC,EAAA;ECKpDC,EAAA,GAAb;IAEI,SAAAzpB,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAC3B,KAAKqc,QAAA,GAAW7b,CACnB;IAAA;IAJL,OAAAK,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAMI,SAAAA,CAAoBf,CAAA;QAChB,IAAMmB,CAAA,GACFnB,CAAA,CAAQ0pB,aAAA,IACR1pB,CAAA,CAAQ2pB,YAAA,KACP3pB,CAAA,CAAQ4pB,cAAA,GAAqB;UAAEA,cAAA,EAAgB5pB,CAAA,CAAQ4pB;QAAA,IAAuB,CAF/E;QAIA5pB,CAAA,CAAQ6pB,eAAA,IACR1oB,CAAA,CAAayoB,cAAA,IAC0C,MAAvDzoB,CAAA,CAAayoB,cAAA,CAAmBplB,OAAA,CAAQ,cAExC,KAAKslB,WAAA,CAAAtpB,CAAA,KACEW,CAAA,EAGd;MAAA;IAAA,GApBL;MAAAL,GAAA;MAAAC,KAAA,EA2BI,SAAAA,CAAA;QAIW,IAHPf,CAAA,GAGOiF,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAHIpB,MAAA,CAAOwJ,QAAA;UAClB7M,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,WAAoC;UACpC9D,CAAA,GACO8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MADGpB,MAAA,CAAOkmB,OAAA;QAEjB;UAEI,KAAKvpB,CAAA,EAAc;YACf;cACIqD,MAAA,CAAOyN,YAAA,CAAaE,OAAA,CAAQ,QAAQ,SACpC3N,MAAA,CAAOyN,YAAA,CAAaG,UAAA,CAAW,OAFnC;YAAA,CAGE,QAAOzR,CAAA;cACL,QAAO,CALI;YAAA;YASfQ,CAAA,GAAeqD,MAAA,CAAOyN,YACzB;UAAA;UAED,IAGI7Q,CAAA;YAHEY,CAAA,GAAYmI,EAAA,CAAcxJ,CAAA,CAASgqB,IAAA,EAAM,gBAAgBxgB,EAAA,CAAcxJ,CAAA,CAASgqB,IAAA,EAAM;YACtFnpB,CAAA,GAAQQ,CAAA,GAAYqP,IAAA,CAAKD,KAAA,CAAMlH,kBAAA,CAAmBlI,CAAA,KAAc;UA6BtE,OA5BqBR,CAAA,IAA6B,mBAApBA,CAAA,CAAKopB,MAAA,KAK/BxpB,CAAA,GAAgBI,CAAA,EACFkhB,MAAA,GAAS,OAEnBthB,CAAA,IAAiB8C,MAAA,CAAOuQ,IAAA,CAAKrT,CAAA,EAAeE,MAAA,GAAS,MACjDE,CAAA,CAAKqpB,WAAA,GAELlqB,CAAA,CAASgqB,IAAA,GAAOnpB,CAAA,CAAKqpB,WAAA,GACd/oB,CAAA,GACPA,CAAA,CAAQgpB,YAAA,CAAa,IAAIjmB,QAAA,CAASkmB,KAAA,EAAOpqB,CAAA,CAASwN,QAAA,GAAWxN,CAAA,CAASmL,MAAA,IAEtEnL,CAAA,CAASgqB,IAAA,GAAO,SAKxBvpB,CAAA,GAAgBiQ,IAAA,CAAKD,KAAA,CAAMjQ,CAAA,CAAa+Q,OAAA,CAAQ,4BAA4B,OAC9DwQ,MAAA,GAAS,uBAIhBthB,CAAA,CAAc4pB,UAAA,MAGrB5pB,CAAA,CAAa0S,KAAA,IAAa,KAAKkJ,QAAA,CAASlH,UAAA,CAAW,aAAa1U,CAAA,CAAa0S,KAAA,MAC7E,KAAK2W,WAAA,CAAYrpB,CAAA,IACV,EA9Cf;QAAA,CAkDE,QAAOT,CAAA;UACL,QAAO,CACV;QAAA;MACJ;IAAA,GArFL;MAAAc,GAAA;MAAAC,KAAA,EAuFI,SAAAA,CAAYf,CAAA;QAAiC,IAAAmB,CAAA;QACzC,IAAK0C,MAAA,CAADymB,qBAAA,EACA,QAAO;QAGTzmB,MAAA,CAADymB,qBAAA,IAA2C;QAI5C,IAAM7pB,CAAA,GAAO,KAAK4b,QAAA,CAASlH,UAAA,CAAW;UAChC9T,CAAA,GAAmE,MAAjCvB,IAAA,CAAKI,KAAA,CAAM8B,IAAA,CAAKC,GAAA,KAAQ;UAC1DpB,CAAA,GAAU,GAAAwE,MAAA,CAAM5E,CAAA,EAAN4E,MAAA,CACZ5E,CAAA,CAAK8pB,QAAA,CAAS,OAAO,KAAK,KADd,0BAAAllB,MAAA,CAEShE,CAAA;UACnBK,CAAA,IACD6nB,EAAA,CAAsB3Z,QAAA,CAAS,KAAKyM,QAAA,CAASlH,UAAA,CAAW,gBACzD,KAAKkH,QAAA,CAASlH,UAAA,CAAW;UAEvBpN,CAAA,GAAavH,CAAA,CAAAA,CAAA;YACf2S,KAAA,EAAO,KAAKkJ,QAAA,CAASlH,UAAA,CAAW;UAAA,GAC7BnV,CAAA,GAFY;YAGfwqB,MAAA,EAAQ/pB;UAAA,GACJiB,CAAA,GAAwB;YAAE+oB,UAAA,GAAY;UAAA,IAAU,CAJrC;QAO8B1iB,CAAA,CAAzCga,MAAA;QAAR,IAA6B/Z,CAAA,GAA7BE,CAAA,CAAiDH,CAAA,EAAjDyhB,EAAA;QAgBA,OAfA3lB,MAAA,CAAOyN,YAAA,CAAaE,OAAA,CAAQ,yBAAyBd,IAAA,CAAKQ,SAAA,CAAUlJ,CAAA,IAEpEkC,EAAA,CAAWrJ,CAAA,EAAY,UAACb,CAAA;UAChBA,CAAA,GACA4E,CAAA,CAAOQ,KAAA,CAAM,0BAA0BpF,CAAA,KAGxC6D,MAAA,CAAD6mB,eAAA,IAAuC7mB,MAAA,CAAD8mB,cAAA,EAAmC5iB,CAAA,EAAe5G,CAAA,CAAKkb,QAAA;QAAA,IAInG1S,EAAA,CAAgB9F,MAAA,EAAQ,mBAAmB;UACrCA,MAAA,CAADymB,qBAAA,IAA2C,GAC5CnpB,CAAA,CAAK2oB,WAAA,CAAY/hB,CAAA,CACpB;QAAA,KACM,CACV;MAAA;IAAA,GAjIL;MAAAjH,GAAA;MAAAC,KAAA,EAoII,SAAAA,CAAYf,CAAA;QACR,OAAO,KAAK8pB,WAAA,CAAY9pB,CAAA,CAC3B;MAAA;IAAA,GAtIL;MAAAc,GAAA;MAAAC,KAAA,EAyII,SAAAA,CAAA;QAIW,IAHPf,CAAA,GAGOiF,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAHIpB,MAAA,CAAOwJ,QAAA;UAClB7M,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,WAAoC;UACpC9D,CAAA,GACO8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MADGpB,MAAA,CAAOkmB,OAAA;QAEjB,OAAO,KAAKa,gBAAA,CAAiB5qB,CAAA,EAAUQ,CAAA,EAAcW,CAAA,CACxD;MAAA;IAAA,KA/ILnB,CAAA;EAAA;ECLa6qB,EAAA,GAAb;IAOI,SAAiC7qB,EAAA;MAAA,IAArBQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAe;MAAMxE,CAAA,OAAAT,CAAA,GAC7B,KAAK8qB,SAAA,IAAY,GACjB,KAAKC,YAAA,GAAe,IACpB,KAAKC,kBAAA,GAAqB,GAC1B,KAAKC,OAAA,QAAU,GACf,KAAKC,aAAA,GAAgB1qB,CACxB;IAAA;IAbL,OAAAK,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAeI,SAAAA,CAAgBf,CAAA;QACZ,KAAKkrB,aAAA,GAAgBlrB,CAAA,EAEjB,KAAK8qB,SAAA,IACL,KAAKK,IAAA,EAnBjB;MAAA;IAAA;MAAArqB,GAAA;MAAAC,KAAA,EA4BI,SAAAA,CAAA,GAEC;IAAA,GA9BL;MAAAD,GAAA;MAAAC,KAAA,EAgCI,SAAAA,CAAA,GAEC;IAAA,GAlCL;MAAAD,GAAA;MAAAC,KAAA,EAoCI,SAAAA,CAAA;QACI,OAAO,IAAIiB,IAAA,GAAO8O,OAAA,EACrB;MAAA;IAAA,KAtCL9Q,CAAA;EAAA;ECKaorB,EAAA,GAAb,UAAAprB,CAAA;IAAA+H,CAAA,CAAA1G,CAAA,EAAkCwpB,EAAA;IAAlC,IAAA1pB,CAAA,GAAAqW,CAAA,CAAAnW,CAAA;IAII,SACIA,EAAArB,CAAA,EACAQ,CAAA;MAEF,IAAAK,CAAA;QADEa,CAAA,GAAAuD,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAe;MACjB,OAAAxE,CAAA,OAAAY,CAAA,IACER,CAAA,GAAAM,CAAA,CAAAuE,IAAA,OAAMhE,CAAA,GACD2pB,iBAAA,GAAoB7qB,CAAA,EACzBK,CAAA,CAAKyqB,cAAA,GAAiBtrB,CAAA,EAHxBa,CAID;IAAA;IAZL,OAAAA,CAAA,CAAAQ,CAAA;MAAAP,GAAA;MAAAC,KAAA,EAcI,SAAAA,CAAQf,CAAA,EAAaQ,CAAA,EAAkBW,CAAA;QACnC,KAAKmqB,cAAA,CAAehH,IAAA,CAAK,kBAEzB,KAAKyG,YAAA,CAAaljB,IAAA,CAAK;UAAE0e,GAAA,EAAAvmB,CAAA;UAAKwb,IAAA,EAAAhb,CAAA;UAAM+qB,OAAA,EAAApqB;QAAA,IAE/B,KAAK2pB,SAAA,KACN,KAAKA,SAAA,IAAY,GACjB,KAAKK,IAAA,GAEZ;MAAA;IAAA,GAvBL;MAAArqB,GAAA;MAAAC,KAAA,EAyBI,SAAAA,CAAA;QAAa,IAAAf,CAAA;QACTwrB,YAAA,CAAa,KAAKP,OAAA,GAClB,KAAKA,OAAA,GAAUhO,UAAA,CAAW;UACtB,IAAIjd,CAAA,CAAK+qB,YAAA,CAAapqB,MAAA,GAAS,GAAG;YAC9B,IAAMH,CAAA,GAAWR,CAAA,CAAKyrB,WAAA;cADQtqB,CAAA,YAAAmoB,CAEnBnoB,CAAA;gBACP,IAA+BV,CAAA,GAAAD,CAAA,CAASW,CAAA;kBAAhCE,CAAA,GAAAZ,CAAA,CAAA8lB,GAAA;kBAAK1lB,CAAA,GAAAJ,CAAA,CAAA+a,IAAA;kBAAM9Z,CAAA,GAAAjB,CAAA,CAAA8qB,OAAA;gBACnB5lB,CAAA,CAAM9E,CAAA,EAAM,UAACL,CAAA,EAAGW,CAAA;kBACZN,CAAA,CAAKM,CAAA,EAALuqB,MAAA,GAA0B5rB,IAAA,CAAKqQ,GAAA,CAAItP,CAAA,CAAKM,CAAA,EAALW,SAAA,GAA6B9B,CAAA,CAAK8Q,OAAA,YAC9DjQ,CAAA,CAAKM,CAAA,EAALW,SACV;gBAAA,IACD9B,CAAA,CAAKqrB,iBAAA,CAAkBhqB,CAAA,EAAKR,CAAA,EAAMa,CAAA,GAElC1B,CAAA,CAAKsrB,cAAA,CAAehH,IAAA,CAAK,mBACzBtkB,CAAA,CAAKsrB,cAAA,CAAehH,IAAA,mBAAAjf,MAAA,CAAuBhE,CAAA,CAAIJ,KAAA,CAAMI,CAAA,CAAIV,MAAA,GAAS,MAClEX,CAAA,CAAKsrB,cAAA,CAAehH,IAAA,CAAK,gBAAgBzjB,CAAA,CAAKF,MAAA,GAC9CX,CAAA,CAAKsrB,cAAA,CAAehH,IAAA,CAAqB,gBAAAjf,MAAA,CAAAhE,CAAA,CAAIJ,KAAA,CAAMI,CAAA,CAAIV,MAAA,GAAS,KAAME,CAAA,CAAKF,MAAA,CAbjD;cAAA;YAE9B,KAAK,IAAMF,CAAA,IAAOD,CAAA,EAAUW,CAAA,CAAjBV,CAAA;YAaXT,CAAA,CAAK+qB,YAAA,CAAapqB,MAAA,GAAS,GAC3BX,CAAA,CAAKgrB,kBAAA,GAAqB,CAC7B;UAAA,OACGhrB,CAAA,CAAKgrB,kBAAA;UAWLhrB,CAAA,CAAKgrB,kBAAA,GAAqB,MAC1BhrB,CAAA,CAAK8qB,SAAA,IAAY,GACjB9qB,CAAA,CAAKgrB,kBAAA,GAAqB,IAE1BhrB,CAAA,CAAK8qB,SAAA,IACL9qB,CAAA,CAAKmrB,IAAA;QAAA,GAEV,KAAKD,aAAA,CACX;MAAA;IAAA,GAjEL;MAAApqB,GAAA;MAAAC,KAAA,EAmEI,SAAAA,CAAA;QACI,IAAMf,CAAA,GAAW,KAAKyrB,WAAA;QACtB,KAAK,IAAMjrB,CAAA,IAAOR,CAAA,EAAU;UACxB,IAAsBmB,CAAA,GAAAnB,CAAA,CAASQ,CAAA;YAAvBC,CAAA,GAAAU,CAAA,CAAAolB,GAAA;YAAKllB,CAAA,GAAAF,CAAA,CAAAqa,IAAA;UAEb,KAAK8P,cAAA,CAAehH,IAAA,CAAK,0BACzB,KAAKgH,cAAA,CAAehH,IAAA,CAApB,yBAAAjf,MAAA,CAAkD5E,CAAA,CAAIQ,KAAA,CAAMR,CAAA,CAAIE,MAAA,GAAS,MACzE,KAAK2qB,cAAA,CAAehH,IAAA,CAAK,gBAAgBjjB,CAAA,CAAKV,MAAA,GAC9C,KAAK2qB,cAAA,CAAehH,IAAA,CAAqB,gBAAAjf,MAAA,CAAA5E,CAAA,CAAIQ,KAAA,CAAMR,CAAA,CAAIE,MAAA,GAAS,KAAMU,CAAA,CAAKV,MAAA,CAC9E;QAAA;MACJ;IAAA,GA7EL;MAAAG,GAAA;MAAAC,KAAA,EA+EI,SAAAA,CAAA;QAAe,IAAAf,CAAA;QACXwrB,YAAA,CAAa,KAAKP,OAAA;QAClB,IAAM9pB,CAAA,GAAW,KAAK4pB,YAAA,CAAapqB,MAAA,GAAS,IAAI,KAAK8qB,WAAA,KAAgB;QACrE,KAAKV,YAAA,CAAapqB,MAAA,GAAS;QAC3B,IAAMF,CAAA,GAAgB8C,MAAA,CAAOooB,MAAA,CAAOxqB,CAAA;QAI7B,GAAAkE,MAAA,CAAAuS,CAAA,CAAAnX,CAAA,CAAcwO,MAAA,CAAO,UAACjP,CAAA;UAAD,OAA+B,MAAxBA,CAAA,CAAEumB,GAAA,CAAI/hB,OAAA,CAAQ,KAA1C;QAAA,KACAoT,CAAA,CAAAnX,CAAA,CAAcwO,MAAA,CAAO,UAACjP,CAAA;UAAD,OAA+B,MAAxBA,CAAA,CAAEumB,GAAA,CAAI/hB,OAAA,CAAQ,KAA1C;QAAA,KAEQ8T,GAAA,CAAI,UAA4BnX,CAAA;UAAA,IAAzBV,CAAA,GAAAU,CAAA,CAAAolB,GAAA;YAAKllB,CAAA,GAAAF,CAAA,CAAAqa,IAAA;YAAM3a,CAAA,GAAAM,CAAA,CAAAoqB,OAAA;UAC7BvrB,CAAA,CAAKqrB,iBAAA,CAAkB5qB,CAAA,EAAKY,CAAA,EAAAb,CAAA,CAAAA,CAAA,KAAWK,CAAA,GAAvC;YAAgD0jB,SAAA,EAAW;UAAA;QAAA,EAElE;MAAA;IAAA,GA7FL;MAAAzjB,GAAA;MAAAC,KAAA,EA+FI,SAAAA,CAAA;QACI,IAAMf,CAAA,GAA8C;QAoBpD,OAnBA2F,CAAA,CAAM,KAAKolB,YAAA,EAAc,UAACvqB,CAAA;UACtB,IAAQW,CAAA,GAAuBX,CAAA,CAAvB+lB,GAAA;YAAK9lB,CAAA,GAAkBD,CAAA,CAAlBgb,IAAA;YAAMna,CAAA,GAAYb,CAAA,CAAZ+qB,OAAA;YACb1qB,CAAA,IAAOQ,CAAA,GAAUA,CAAA,CAAQojB,SAAA,GAAY,SAAStjB,CAAA;UAAA,KAC9B,MAAlBnB,CAAA,CAASa,CAAA,MACTb,CAAA,CAASa,CAAA,IAAO;YAAE2a,IAAA,EAAM;YAAI+K,GAAA,EAAAplB,CAAA;YAAKoqB,OAAA,EAAAlqB;UAAA,IAKjCA,CAAA,IACArB,CAAA,CAASa,CAAA,EAAK0qB,OAAA,IACdvrB,CAAA,CAASa,CAAA,EAAK0qB,OAAA,CAAQ7G,QAAA,KACpB1kB,CAAA,CAASa,CAAA,EAAK0qB,OAAA,CAAQ7G,QAAA,CAAvBC,mBAAA,KAEC3kB,CAAA,CAASa,CAAA,EAAK0qB,OAAA,CAAQ7G,QAAA,CAAvBC,mBAAA,GACGtjB,CAAA,CAAQqjB,QAAA,CAARC,mBAAA,GAER3kB,CAAA,CAASa,CAAA,EAAK2a,IAAA,CAAK3T,IAAA,CAAKpH,CAAA,CAC3B;QAAA,IACMT,CACV;MAAA;IAAA,KArHLqB,CAAA;EAAA;ECLauqB,EAAA,GAAb;IAII,SAAA5rB,EAAYQ,CAAA;MAAkBC,CAAA,OAAAT,CAAA,GAC1B,KAAKkQ,OAAA,GAAU1P,CAAA,EACf,KAAKqrB,OAAA,GAAU,EAClB;IAAA;IAPL,OAAAhrB,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EASI,SAAAA,CAAKf,CAAA;QAA2B,IAAdQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAK;QACf,KAAKiL,OAAA,KACLlQ,CAAA,GAAG,QAAAqF,MAAA,CAAWrF,CAAA,GACd,KAAK6rB,OAAA,CAAQ7rB,CAAA,KAAQ,KAAK6rB,OAAA,CAAQ7rB,CAAA,KAAQ,KAAKQ,CAAA,CAEtD;MAAA;IAAA,GAdL;MAAAM,GAAA;MAAAC,KAAA,EAgBI,SAAAA,CAAKf,CAAA;QACG,KAAKkQ,OAAA,KACLlQ,CAAA,GAAG,QAAAqF,MAAA,CAAWrF,CAAA,GACd,KAAK6rB,OAAA,CAAQ7rB,CAAA,KAAQ,KAAK6rB,OAAA,CAAQ7rB,CAAA,KAAQ,KAAK,EAEtD;MAAA;IAAA,KArBLA,CAAA;EAAA;ECoBI8rB,EAAA,GAAKvqB,UAAA;EAAYwqB,EAAA,GAAMC,WAAA;EAAaC,EAAA,GAAMrpB,WAAA;EAE1CspB,EAAA,GAAO,IAAIJ,EAAA,CAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAgB,GAAG,GAAoB;EAG1IK,EAAA,GAAO,IAAIL,EAAA,CAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAiB,GAAG;EAEjIM,EAAA,GAAO,IAAIN,EAAA,CAAG,CAAC,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG;EAE7EO,EAAA,GAAO,SAAAC,CAAUtsB,CAAA,EAAIQ,CAAA;IAErB,KADA,IAAIW,CAAA,GAAI,IAAI4qB,EAAA,CAAI,KACPtrB,CAAA,GAAI,GAAGA,CAAA,GAAI,MAAMA,CAAA,EACtBU,CAAA,CAAEV,CAAA,IAAKD,CAAA,IAAS,KAAKR,CAAA,CAAGS,CAAA,GAAI;IAGhC,IAAIY,CAAA,GAAI,IAAI4qB,EAAA,CAAI9qB,CAAA,CAAE;IAClB,KAASV,CAAA,GAAI,GAAGA,CAAA,GAAI,MAAMA,CAAA,EACtB,KAAK,IAAII,CAAA,GAAIM,CAAA,CAAEV,CAAA,GAAII,CAAA,GAAIM,CAAA,CAAEV,CAAA,GAAI,MAAMI,CAAA,EAC/BQ,CAAA,CAAER,CAAA,IAAOA,CAAA,GAAIM,CAAA,CAAEV,CAAA,KAAO,IAAKA,CAAA;IAGnC,OAAO,CAACU,CAAA,EAAGE,CAAA,CACd;EAAA;EACGkrB,EAAA,GAAKF,EAAA,CAAKH,EAAA,EAAM;EAAIM,EAAA,GAAKD,EAAA,CAAG;EAAIE,EAAA,GAAQF,EAAA,CAAG;AAE/CC,EAAA,CAAG,MAAM,KAAKC,EAAA,CAAM,OAAO;AAI3B,KAHA,IAAoCC,EAAA,GAA3BL,EAAA,CAAKF,EAAA,EAAM,GAA2B,IAE3CQ,EAAA,GAAM,IAAIZ,EAAA,CAAI,QACTa,EAAA,GAAI,GAAGA,EAAA,GAAI,SAASA,EAAA,EAAG;EAE5B,IAAIC,EAAA,IAAU,QAAJD,EAAA,MAAgB,KAAW,QAAJA,EAAA,KAAe;EAEhDC,EAAA,IAAU,SADVA,EAAA,IAAU,QAAJA,EAAA,MAAgB,KAAW,QAAJA,EAAA,KAAe,QACtB,KAAW,OAAJA,EAAA,KAAe,GAC5CF,EAAA,CAAIC,EAAA,MAAY,QAAJC,EAAA,MAAgB,KAAW,MAAJA,EAAA,KAAe,OAAQ,CAC7D;AAAA;AAID,IAAIC,EAAA,GAAQ,SAAAC,CAAU/sB,CAAA,EAAIQ,CAAA,EAAIW,CAAA;IAO1B,KANA,IAAIV,CAAA,GAAIT,CAAA,CAAGW,MAAA,EAEPU,CAAA,GAAI,GAEJR,CAAA,GAAI,IAAIkrB,EAAA,CAAIvrB,CAAA,GAETa,CAAA,GAAIZ,CAAA,IAAKY,CAAA,IACVR,CAAA,CAAEb,CAAA,CAAGqB,CAAA,IAAK;IAEhB,IAIIK,CAAA;MAJAqG,CAAA,GAAK,IAAIgkB,EAAA,CAAIvrB,CAAA;IACjB,KAAKa,CAAA,GAAI,GAAGA,CAAA,GAAIb,CAAA,IAAMa,CAAA,EAClB0G,CAAA,CAAG1G,CAAA,IAAM0G,CAAA,CAAG1G,CAAA,GAAI,KAAKR,CAAA,CAAEQ,CAAA,GAAI,MAAO;IAGtC,IAAIF,CAAA,EAAG;MAEHO,CAAA,GAAK,IAAIqqB,EAAA,CAAI,KAAKvrB,CAAA;MAElB,IAAIwH,CAAA,GAAM,KAAKxH,CAAA;MACf,KAAKa,CAAA,GAAI,GAAGA,CAAA,GAAIZ,CAAA,IAAKY,CAAA,EAEjB,IAAIrB,CAAA,CAAGqB,CAAA,GAQH,KANA,IAAI4G,CAAA,GAAM5G,CAAA,IAAK,IAAKrB,CAAA,CAAGqB,CAAA,GAEnB6G,CAAA,GAAM1H,CAAA,GAAKR,CAAA,CAAGqB,CAAA,GAEd2P,CAAA,GAAIjJ,CAAA,CAAG/H,CAAA,CAAGqB,CAAA,IAAK,QAAQ6G,CAAA,EAElBsP,CAAA,GAAIxG,CAAA,IAAM,KAAK9I,CAAA,IAAO,GAAI8I,CAAA,IAAKwG,CAAA,IAAKxG,CAAA,EAEzCtP,CAAA,CAAGirB,EAAA,CAAI3b,CAAA,MAAOhJ,CAAA,IAAOC,CAIpC;IAAA,OAGG,KADAvG,CAAA,GAAK,IAAIqqB,EAAA,CAAItrB,CAAA,GACRY,CAAA,GAAI,GAAGA,CAAA,GAAIZ,CAAA,IAAKY,CAAA,EACjBK,CAAA,CAAGL,CAAA,IAAKsrB,EAAA,CAAI5kB,CAAA,CAAG/H,CAAA,CAAGqB,CAAA,IAAK,UAAW,KAAKrB,CAAA,CAAGqB,CAAA;IAElD,OAAOK,CACV;EAAA;EAEGsrB,EAAA,GAAM,IAAIlB,EAAA,CAAG;AACjB,KAASc,EAAA,GAAI,GAAGA,EAAA,GAAI,OAAOA,EAAA,EACvBI,EAAA,CAAIJ,EAAA,IAAK;AACb,KAASA,EAAA,GAAI,KAAKA,EAAA,GAAI,OAAOA,EAAA,EACzBI,EAAA,CAAIJ,EAAA,IAAK;AACb,KAASA,EAAA,GAAI,KAAKA,EAAA,GAAI,OAAOA,EAAA,EACzBI,EAAA,CAAIJ,EAAA,IAAK;AACb,KAASA,EAAA,GAAI,KAAKA,EAAA,GAAI,OAAOA,EAAA,EACzBI,EAAA,CAAIJ,EAAA,IAAK;AAEb,IAAIK,EAAA,GAAM,IAAInB,EAAA,CAAG;AACjB,KAASc,EAAA,GAAI,GAAGA,EAAA,GAAI,MAAMA,EAAA,EACtBK,EAAA,CAAIL,EAAA,IAAK;AAET,ICiCQM,EAAA;EAqMAC,EAAA;EAeAC,EAAA;EDrPRC,EAAA,GAAoBP,EAAA,CAAKE,EAAA,EAAK,GAAG;EAEjCM,EAAA,GAAoBR,EAAA,CAAKG,EAAA,EAAK,GAAG;EAqBjCM,EAAA,GAAO,SAAAC,CAAUxtB,CAAA;IAAK,QAASA,CAAA,GAAI,KAAM,MAAU,IAAJA,CAAA,IAAS,EAAK;EAAA;EAG7DytB,EAAA,GAAM,SAAAC,CAAU1tB,CAAA,EAAGQ,CAAA,EAAGW,CAAA;IAAA,CACb,QAALX,CAAA,IAAaA,CAAA,GAAI,OACjBA,CAAA,GAAI,KACC,QAALW,CAAA,IAAaA,CAAA,GAAInB,CAAA,CAAEW,MAAA,MACnBQ,CAAA,GAAInB,CAAA,CAAEW,MAAA;IAEV,IAAIF,CAAA,GAAI,KAAKT,CAAA,YAAa+rB,EAAA,GAAMA,EAAA,GAAM/rB,CAAA,YAAaisB,EAAA,GAAMA,EAAA,GAAMH,EAAA,EAAI3qB,CAAA,GAAIX,CAAA;IAEvE,OADAC,CAAA,CAAEkQ,GAAA,CAAI3Q,CAAA,CAAE2tB,QAAA,CAASntB,CAAA,EAAGW,CAAA,IACbV,CACV;EAAA;EA4KGmtB,EAAA,GAAQ,SAAAC,CAAU7tB,CAAA,EAAGQ,CAAA,EAAGW,CAAA;IACxBA,CAAA,KAAU,IAAJX,CAAA;IACN,IAAIC,CAAA,GAAKD,CAAA,GAAI,KAAM;IACnBR,CAAA,CAAES,CAAA,KAAMU,CAAA,EACRnB,CAAA,CAAES,CAAA,GAAI,MAAMU,CAAA,KAAM,CACrB;EAAA;EAEG2sB,EAAA,GAAU,SAAAC,CAAU/tB,CAAA,EAAGQ,CAAA,EAAGW,CAAA;IAC1BA,CAAA,KAAU,IAAJX,CAAA;IACN,IAAIC,CAAA,GAAKD,CAAA,GAAI,KAAM;IACnBR,CAAA,CAAES,CAAA,KAAMU,CAAA,EACRnB,CAAA,CAAES,CAAA,GAAI,MAAMU,CAAA,KAAM,GAClBnB,CAAA,CAAES,CAAA,GAAI,MAAMU,CAAA,KAAM,EACrB;EAAA;EAEG6sB,EAAA,GAAQ,SAAAC,CAAUjuB,CAAA,EAAGQ,CAAA;IAGrB,KADA,IAAIW,CAAA,GAAI,IACCV,CAAA,GAAI,GAAGA,CAAA,GAAIT,CAAA,CAAEW,MAAA,IAAUF,CAAA,EACxBT,CAAA,CAAES,CAAA,KACFU,CAAA,CAAE0G,IAAA,CAAK;MAAEnG,CAAA,EAAGjB,CAAA;MAAGkX,CAAA,EAAG3X,CAAA,CAAES,CAAA;IAAA;IAE5B,IAAIY,CAAA,GAAIF,CAAA,CAAER,MAAA;MACNE,CAAA,GAAKM,CAAA,CAAEF,KAAA;IACX,KAAKI,CAAA,EACD,OAAO,CAAC,IAAIyqB,EAAA,CAAG,IAAI;IACvB,IAAS,KAALzqB,CAAA,EAAQ;MACR,IAAIK,CAAA,GAAI,IAAIoqB,EAAA,CAAG3qB,CAAA,CAAE,GAAGO,CAAA,GAAI;MAExB,OADAA,CAAA,CAAEP,CAAA,CAAE,GAAGO,CAAA,IAAK,GACL,CAACA,CAAA,EAAG,EACd;IAAA;IACDP,CAAA,CAAE+sB,IAAA,CAAK,UAAUluB,CAAA,EAAGQ,CAAA;MAAK,OAAOR,CAAA,CAAE2X,CAAA,GAAInX,CAAA,CAAEmX,CAAI;IAAA,IAG5CxW,CAAA,CAAE0G,IAAA,CAAK;MAAEnG,CAAA,GAAI;MAAGiW,CAAA,EAAG;IAAA;IACnB,IAAI5P,CAAA,GAAI5G,CAAA,CAAE;MAAI6G,CAAA,GAAI7G,CAAA,CAAE;MAAI8G,CAAA,GAAK;MAAGC,CAAA,GAAK;MAAG8I,CAAA,GAAK;IAO7C,KANA7P,CAAA,CAAE,KAAK;MAAEO,CAAA,GAAI;MAAGiW,CAAA,EAAG5P,CAAA,CAAE4P,CAAA,GAAI3P,CAAA,CAAE2P,CAAA;MAAGzP,CAAA,EAAGH,CAAA;MAAGtH,CAAA,EAAGuH;IAAA,GAMhCE,CAAA,IAAM7G,CAAA,GAAI,IACb0G,CAAA,GAAI5G,CAAA,CAAEA,CAAA,CAAE8G,CAAA,EAAI0P,CAAA,GAAIxW,CAAA,CAAE6P,CAAA,EAAI2G,CAAA,GAAI1P,CAAA,KAAO+I,CAAA,KACjChJ,CAAA,GAAI7G,CAAA,CAAE8G,CAAA,IAAMC,CAAA,IAAM/G,CAAA,CAAE8G,CAAA,EAAI0P,CAAA,GAAIxW,CAAA,CAAE6P,CAAA,EAAI2G,CAAA,GAAI1P,CAAA,KAAO+I,CAAA,KAC7C7P,CAAA,CAAE+G,CAAA,MAAQ;MAAExG,CAAA,GAAI;MAAGiW,CAAA,EAAG5P,CAAA,CAAE4P,CAAA,GAAI3P,CAAA,CAAE2P,CAAA;MAAGzP,CAAA,EAAGH,CAAA;MAAGtH,CAAA,EAAGuH;IAAA;IAE9C,IAAIwP,CAAA,GAAS3W,CAAA,CAAG,GAAGa,CAAA;IACnB,KAASjB,CAAA,GAAI,GAAGA,CAAA,GAAIY,CAAA,IAAKZ,CAAA,EACjBI,CAAA,CAAGJ,CAAA,EAAGiB,CAAA,GAAI8V,CAAA,KACVA,CAAA,GAAS3W,CAAA,CAAGJ,CAAA,EAAGiB,CAAA;IAGvB,IAAIiW,CAAA,GAAK,IAAIoU,EAAA,CAAIvU,CAAA,GAAS;MAEtBI,CAAA,GAAMuW,EAAA,CAAGhtB,CAAA,CAAE+G,CAAA,GAAK,IAAIyP,CAAA,EAAI;IAC5B,IAAIC,CAAA,GAAMpX,CAAA,EAAI;MAINC,CAAA,GAAI;MAAR,IAAW2tB,CAAA,GAAK;QAEZC,CAAA,GAAMzW,CAAA,GAAMpX,CAAA;QAAI0b,CAAA,GAAM,KAAKmS,CAAA;MAE/B,KADAxtB,CAAA,CAAGqtB,IAAA,CAAK,UAAUluB,CAAA,EAAGQ,CAAA;QAAK,OAAOmX,CAAA,CAAGnX,CAAA,CAAEkB,CAAA,IAAKiW,CAAA,CAAG3X,CAAA,CAAE0B,CAAA,KAAM1B,CAAA,CAAE2X,CAAA,GAAInX,CAAA,CAAEmX,CAAA;MAAA,IACvDlX,CAAA,GAAIY,CAAA,IAAKZ,CAAA,EAAG;QACf,IAAId,CAAA,GAAOkB,CAAA,CAAGJ,CAAA,EAAGiB,CAAA;QACjB,MAAIiW,CAAA,CAAGhY,CAAA,IAAQa,CAAA,GAKX;QAJA4tB,CAAA,IAAMlS,CAAA,IAAO,KAAMtE,CAAA,GAAMD,CAAA,CAAGhY,CAAA,IAC5BgY,CAAA,CAAGhY,CAAA,IAAQa,CAIlB;MAAA;MAED,KADA4tB,CAAA,MAAQC,CAAA,EACDD,CAAA,GAAK,IAAG;QACX,IAAI9tB,CAAA,GAAOO,CAAA,CAAGJ,CAAA,EAAGiB,CAAA;QACbiW,CAAA,CAAGrX,CAAA,IAAQE,CAAA,GACX4tB,CAAA,IAAM,KAAM5tB,CAAA,GAAKmX,CAAA,CAAGrX,CAAA,MAAU,MAE5BG,CACT;MAAA;MACD,OAAOA,CAAA,IAAK,KAAK2tB,CAAA,IAAM3tB,CAAA,EAAG;QACtB,IAAIF,CAAA,GAAOM,CAAA,CAAGJ,CAAA,EAAGiB,CAAA;QACbiW,CAAA,CAAGpX,CAAA,KAASC,CAAA,OACVmX,CAAA,CAAGpX,CAAA,KACH6tB,CAAA,CAET;MAAA;MACDxW,CAAA,GAAMpX,CACT;IAAA;IACD,OAAO,CAAC,IAAIsrB,EAAA,CAAGnU,CAAA,GAAKC,CAAA,CACvB;EAAA;EAEGuW,EAAA,GAAK,SAALnuB,EAAeQ,CAAA,EAAGW,CAAA,EAAGV,CAAA;IACrB,QAAe,KAARD,CAAA,CAAEkB,CAAA,GACH5B,IAAA,CAAKwuB,GAAA,CAAItuB,CAAA,CAAGQ,CAAA,CAAE0H,CAAA,EAAG/G,CAAA,EAAGV,CAAA,GAAI,IAAIT,CAAA,CAAGQ,CAAA,CAAEC,CAAA,EAAGU,CAAA,EAAGV,CAAA,GAAI,MAC1CU,CAAA,CAAEX,CAAA,CAAEkB,CAAA,IAAKjB,CACnB;EAAA;EAEG8tB,EAAA,GAAK,SAAAC,CAAUxuB,CAAA;IAGf,KAFA,IAAIQ,CAAA,GAAIR,CAAA,CAAEW,MAAA,EAEHH,CAAA,KAAMR,CAAA,GAAIQ,CAAA;IAMjB,KAJA,IAAIW,CAAA,GAAK,IAAI4qB,EAAA,GAAMvrB,CAAA,GAEfC,CAAA,GAAM,GAAGY,CAAA,GAAMrB,CAAA,CAAE,IAAIa,CAAA,GAAM,GAC3Ba,CAAA,GAAI,SAAAD,CAAUzB,CAAA;QAAKmB,CAAA,CAAGV,CAAA,MAAST,CAAA;MAAA,GAC1B+H,CAAA,GAAI,GAAGA,CAAA,IAAKvH,CAAA,IAAKuH,CAAA,EACtB,IAAI/H,CAAA,CAAE+H,CAAA,KAAM1G,CAAA,IAAO0G,CAAA,IAAKvH,CAAA,IAClBK,CAAA,MACD;MACD,KAAKQ,CAAA,IAAOR,CAAA,GAAM,GAAG;QACjB,OAAOA,CAAA,GAAM,KAAKA,CAAA,IAAO,KACrBa,CAAA,CAAE;QACFb,CAAA,GAAM,MACNa,CAAA,CAAEb,CAAA,GAAM,KAAOA,CAAA,GAAM,MAAO,IAAK,QAAUA,CAAA,GAAM,KAAM,IAAK,QAC5DA,CAAA,GAAM,EAEb;MAAA,OACI,IAAIA,CAAA,GAAM,GAAG;QAEd,KADAa,CAAA,CAAEL,CAAA,KAAQR,CAAA,EACHA,CAAA,GAAM,GAAGA,CAAA,IAAO,GACnBa,CAAA,CAAE;QACFb,CAAA,GAAM,MACNa,CAAA,CAAIb,CAAA,GAAM,KAAM,IAAK,OAAOA,CAAA,GAAM,EACzC;MAAA;MACD,OAAOA,CAAA,KACHa,CAAA,CAAEL,CAAA;MACNR,CAAA,GAAM,GACNQ,CAAA,GAAMrB,CAAA,CAAE+H,CAAA,CACX;IAAA;IAEL,OAAO,CAAC5G,CAAA,CAAGwsB,QAAA,CAAS,GAAGltB,CAAA,GAAMD,CAAA,CAChC;EAAA;EAEGiuB,EAAA,GAAO,SAAAC,CAAU1uB,CAAA,EAAIQ,CAAA;IAErB,KADA,IAAIW,CAAA,GAAI,GACCV,CAAA,GAAI,GAAGA,CAAA,GAAID,CAAA,CAAGG,MAAA,IAAUF,CAAA,EAC7BU,CAAA,IAAKnB,CAAA,CAAGS,CAAA,IAAKD,CAAA,CAAGC,CAAA;IACpB,OAAOU,CACV;EAAA;EAGGwtB,EAAA,GAAQ,SAAAC,CAAU5uB,CAAA,EAAKQ,CAAA,EAAKW,CAAA;IAE5B,IAAIV,CAAA,GAAIU,CAAA,CAAIR,MAAA;MACRU,CAAA,GAAIksB,EAAA,CAAK/sB,CAAA,GAAM;IACnBR,CAAA,CAAIqB,CAAA,IAAS,MAAJZ,CAAA,EACTT,CAAA,CAAIqB,CAAA,GAAI,KAAKZ,CAAA,KAAM,GACnBT,CAAA,CAAIqB,CAAA,GAAI,KAAc,MAATrB,CAAA,CAAIqB,CAAA,GACjBrB,CAAA,CAAIqB,CAAA,GAAI,KAAkB,MAAbrB,CAAA,CAAIqB,CAAA,GAAI;IACrB,KAAK,IAAIR,CAAA,GAAI,GAAGA,CAAA,GAAIJ,CAAA,IAAKI,CAAA,EACrBb,CAAA,CAAIqB,CAAA,GAAIR,CAAA,GAAI,KAAKM,CAAA,CAAIN,CAAA;IACzB,OAAqB,KAAbQ,CAAA,GAAI,IAAIZ,CAAA,CACnB;EAAA;EAEGouB,EAAA,GAAO,SAAAC,CAAU9uB,CAAA,EAAKQ,CAAA,EAAKW,CAAA,EAAOV,CAAA,EAAMY,CAAA,EAAIR,CAAA,EAAIa,CAAA,EAAIqG,CAAA,EAAIC,CAAA,EAAIC,CAAA,EAAIC,CAAA;IAChE0lB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,IAAK/G,CAAA,KACdE,CAAA,CAAG;IAML,KALA,IAAI2P,CAAA,GAAKgd,EAAA,CAAM3sB,CAAA,EAAI,KAAKmW,CAAA,GAAMxG,CAAA,CAAG,IAAI2G,CAAA,GAAM3G,CAAA,CAAG,IAC1C4G,CAAA,GAAKoW,EAAA,CAAMntB,CAAA,EAAI,KAAKutB,CAAA,GAAMxW,CAAA,CAAG,IAAIyW,CAAA,GAAMzW,CAAA,CAAG,IAC1CsE,CAAA,GAAKqS,EAAA,CAAG/W,CAAA,GAAM7X,CAAA,GAAOuc,CAAA,CAAG,IAAI5b,CAAA,GAAM4b,CAAA,CAAG,IACrC3b,CAAA,GAAKguB,EAAA,CAAGH,CAAA,GAAM3sB,CAAA,GAAOlB,CAAA,CAAG,IAAIgC,CAAA,GAAMhC,CAAA,CAAG,IACrCoC,CAAA,GAAS,IAAIopB,EAAA,CAAI,KACZpqB,CAAA,GAAI,GAAGA,CAAA,GAAIhC,CAAA,CAAKgB,MAAA,IAAUgB,CAAA,EAC/BgB,CAAA,CAAiB,KAAVhD,CAAA,CAAKgC,CAAA;IAChB,KAASA,CAAA,GAAI,GAAGA,CAAA,GAAIF,CAAA,CAAKd,MAAA,IAAUgB,CAAA,EAC/BgB,CAAA,CAAiB,KAAVlB,CAAA,CAAKE,CAAA;IAGhB,KAFA,IAAIqB,CAAA,GAAKgrB,EAAA,CAAMrrB,CAAA,EAAQ,IAAIQ,CAAA,GAAMH,CAAA,CAAG,IAAIM,CAAA,GAAON,CAAA,CAAG,IAC9CQ,CAAA,GAAO,IACJA,CAAA,GAAO,MAAML,CAAA,CAAIipB,EAAA,CAAK5oB,CAAA,GAAO,OAAOA,CAAA;IAE3C,IAKIE,CAAA;MAAIE,CAAA;MAAIE,CAAA;MAAIG,CAAA;MALZE,CAAA,GAAQ8D,CAAA,GAAK,KAAM;MACnB7D,CAAA,GAAQqqB,EAAA,CAAKptB,CAAA,EAAI2rB,EAAA,IAAOyB,EAAA,CAAK5tB,CAAA,EAAIosB,EAAA,IAAOvrB,CAAA;MACxC2C,CAAA,GAAQoqB,EAAA,CAAKptB,CAAA,EAAImW,CAAA,IAAOiX,EAAA,CAAK5tB,CAAA,EAAIutB,CAAA,IAAO1sB,CAAA,GAAK,KAAK,IAAI8B,CAAA,GAAOirB,EAAA,CAAK9rB,CAAA,EAAQQ,CAAA,KAAQ,IAAIR,CAAA,CAAO,MAAM,IAAIA,CAAA,CAAO,MAAM,IAAIA,CAAA,CAAO;IACnI,IAAIwB,CAAA,IAAQC,CAAA,IAASD,CAAA,IAAQE,CAAA,EACzB,OAAOsqB,EAAA,CAAMnuB,CAAA,EAAK0H,CAAA,EAAGlI,CAAA,CAAI2tB,QAAA,CAAS3lB,CAAA,EAAIA,CAAA,GAAKC,CAAA;IAG/C,IADA2lB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,EAAG,KAAK7D,CAAA,GAAQD,CAAA,IAAS8D,CAAA,IAAK,GACrC7D,CAAA,GAAQD,CAAA,EAAO;MACfV,CAAA,GAAKopB,EAAA,CAAKtV,CAAA,EAAKG,CAAA,EAAK,IAAI/T,CAAA,GAAK4T,CAAA,EAAK1T,CAAA,GAAKgpB,EAAA,CAAKsB,CAAA,EAAKC,CAAA,EAAK,IAAIpqB,CAAA,GAAKmqB,CAAA;MAC/D,IAAI7pB,CAAA,GAAMuoB,EAAA,CAAK3pB,CAAA,EAAKG,CAAA,EAAM;MAC1BsqB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,EAAG5H,CAAA,GAAM,MACpBstB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,GAAI,GAAG3F,CAAA,GAAM,IACxBqrB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,GAAI,IAAI1E,CAAA,GAAO,IAC1B0E,CAAA,IAAK;MACL,KAASvG,CAAA,GAAI,GAAGA,CAAA,GAAI6B,CAAA,IAAQ7B,CAAA,EACxBisB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,GAAI,IAAIvG,CAAA,EAAGwB,CAAA,CAAIipB,EAAA,CAAKzqB,CAAA;MACnCuG,CAAA,IAAK,IAAI1E,CAAA;MAET,KADA,IAAIiB,CAAA,GAAO,CAAC9E,CAAA,EAAM8B,CAAA,GACTkD,CAAA,GAAK,GAAGA,CAAA,GAAK,KAAKA,CAAA,EACvB;QAAA,IAAIC,CAAA,GAAOH,CAAA,CAAKE,CAAA;QAChB,KAAShD,CAAA,GAAI,GAAGA,CAAA,GAAIiD,CAAA,CAAKjE,MAAA,IAAUgB,CAAA,EAAG;UAClC,IAAI4D,CAAA,GAAgB,KAAVX,CAAA,CAAKjD,CAAA;UACfisB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,EAAG3D,CAAA,CAAIgB,CAAA,IAAO2C,CAAA,IAAK/E,CAAA,CAAIoC,CAAA,GAC9BA,CAAA,GAAM,OACNqoB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,EAAItD,CAAA,CAAKjD,CAAA,MAAO,IAAK,MAAMuG,CAAA,IAAKtD,CAAA,CAAKjD,CAAA,MAAO,GAC9D;QAAA;MAND;IAQP,OAEG+B,CAAA,GAAK2pB,EAAA,EAAKzpB,CAAA,GAAKopB,EAAA,EAAKlpB,CAAA,GAAKwpB,EAAA,EAAKrpB,CAAA,GAAKgpB,EAAA;IAEvC,KAAStrB,CAAA,GAAI,GAAGA,CAAA,GAAIoG,CAAA,IAAMpG,CAAA,EACtB,IAAIlB,CAAA,CAAKkB,CAAA,IAAK,KAAK;MACX4D,CAAA,GAAO9E,CAAA,CAAKkB,CAAA,MAAO,KAAM;MAC7BmsB,EAAA,CAAQttB,CAAA,EAAK0H,CAAA,EAAGxE,CAAA,CAAG6B,CAAA,GAAM,OAAO2C,CAAA,IAAKtE,CAAA,CAAG2B,CAAA,GAAM,MAC1CA,CAAA,GAAM,MACNqoB,EAAA,CAAMptB,CAAA,EAAK0H,CAAA,EAAIzH,CAAA,CAAKkB,CAAA,MAAO,KAAM,KAAKuG,CAAA,IAAKgkB,EAAA,CAAK3mB,CAAA;MACpD,IAAIJ,CAAA,GAAgB,KAAV1E,CAAA,CAAKkB,CAAA;MACfmsB,EAAA,CAAQttB,CAAA,EAAK0H,CAAA,EAAGpE,CAAA,CAAGqB,CAAA,IAAO+C,CAAA,IAAKjE,CAAA,CAAGkB,CAAA,GAC9BA,CAAA,GAAM,MACN2oB,EAAA,CAAQttB,CAAA,EAAK0H,CAAA,EAAIzH,CAAA,CAAKkB,CAAA,MAAO,IAAK,OAAOuG,CAAA,IAAKikB,EAAA,CAAKhnB,CAAA,EAC1D;IAAA,OAEG2oB,EAAA,CAAQttB,CAAA,EAAK0H,CAAA,EAAGxE,CAAA,CAAGjD,CAAA,CAAKkB,CAAA,KAAMuG,CAAA,IAAKtE,CAAA,CAAGnD,CAAA,CAAKkB,CAAA;IAInD,OADAmsB,EAAA,CAAQttB,CAAA,EAAK0H,CAAA,EAAGxE,CAAA,CAAG,OACZwE,CAAA,GAAItE,CAAA,CAAG,IACjB;EAAA;EAEGmrB,EAAA,GAAoB,IAAI9C,EAAA,CAAI,CAAC,OAAO,QAAQ,QAAQ,QAAQ,QAAQ,SAAS,SAAS,SAAS;EAE/F+C,EAAA,GAAmB,IAAIlD,EAAA,CAAG;EA2H1BmD,EAAA,GAAsB;IAEtB,KADA,IAAIjvB,CAAA,GAAI,IAAIisB,EAAA,CAAI,MACPzrB,CAAA,GAAI,GAAGA,CAAA,GAAI,OAAOA,CAAA,EAAG;MAE1B,KADA,IAAIW,CAAA,GAAIX,CAAA,EAAGC,CAAA,GAAI,KACNA,CAAA,GACLU,CAAA,IAAU,IAAJA,CAAA,IAAU,cAAeA,CAAA,KAAM;MACzCnB,CAAA,CAAEQ,CAAA,IAAKW,CACV;IAAA;IACD,OAAOnB,CACV;EAAA,CATyB;EAWtBkvB,EAAA,GAAM,SAAAC,CAAA;IACN,IAAInvB,CAAA,GAAI;IACR,OAAO;MACHwX,CAAA,EAAG,SAAAA,CAAUhX,CAAA;QAGT,KADA,IAAIW,CAAA,GAAKnB,CAAA,EACAS,CAAA,GAAI,GAAGA,CAAA,GAAID,CAAA,CAAEG,MAAA,IAAUF,CAAA,EAC5BU,CAAA,GAAK8tB,EAAA,CAAW,MAAL9tB,CAAA,GAAYX,CAAA,CAAEC,CAAA,KAAOU,CAAA,KAAO;QAC3CnB,CAAA,GAAImB,CANL;MAAA;MAQH6P,CAAA,EAAG,SAAAA,CAAA;QAAc,OAAW,aAAJhR,CAAiB;MAAA;IAAA,CAEhD;EAAA;EAsBGovB,EAAA,GAAO,SAAAC,CAAUrvB,CAAA,EAAKQ,CAAA,EAAKW,CAAA,EAAKV,CAAA,EAAMY,CAAA;IACtC,OAvKO,UAAUrB,CAAA,EAAKQ,CAAA,EAAKW,CAAA,EAAMV,CAAA,EAAKY,CAAA,EAAMR,CAAA;MAC5C,IAAIa,CAAA,GAAI1B,CAAA,CAAIW,MAAA;QACRoH,CAAA,GAAI,IAAI+jB,EAAA,CAAGrrB,CAAA,GAAMiB,CAAA,GAAI,KAAK,IAAI5B,IAAA,CAAKI,KAAA,CAAMwB,CAAA,GAAI,QAASL,CAAA;QAEtD2G,CAAA,GAAID,CAAA,CAAE4lB,QAAA,CAASltB,CAAA,EAAKsH,CAAA,CAAEpH,MAAA,GAASU,CAAA;QAC/B4G,CAAA,GAAM;MACV,KAAKzH,CAAA,IAAOkB,CAAA,GAAI,GACZ,KAAK,IAAIwG,CAAA,GAAI,GAAGA,CAAA,IAAKxG,CAAA,EAAGwG,CAAA,IAAK,OAAO;QAEhC,IAAI8I,CAAA,GAAI9I,CAAA,GAAI;QACR8I,CAAA,GAAItP,CAAA,GAEJuG,CAAA,GAAM0mB,EAAA,CAAM3mB,CAAA,EAAGC,CAAA,EAAKjI,CAAA,CAAI2tB,QAAA,CAASzlB,CAAA,EAAG8I,CAAA,MAIpChJ,CAAA,CAAEE,CAAA,IAAKrH,CAAA,EACPoH,CAAA,GAAM0mB,EAAA,CAAM3mB,CAAA,EAAGC,CAAA,EAAKjI,CAAA,CAAI2tB,QAAA,CAASzlB,CAAA,EAAGxG,CAAA,GAE3C;MAAA,OAEA;QAeD,KAdA,IAAI8V,CAAA,GAAMuX,EAAA,CAAIvuB,CAAA,GAAM,IAChBmX,CAAA,GAAIH,CAAA,KAAQ,IAAII,CAAA,GAAU,OAANJ,CAAA,EACpB4W,CAAA,IAAS,KAAKjtB,CAAA,IAAQ,GAEtBktB,CAAA,GAAO,IAAItC,EAAA,CAAI,QAAQ7P,CAAA,GAAO,IAAI6P,EAAA,CAAIqC,CAAA,GAAQ,IAC9CzuB,CAAA,GAAQG,IAAA,CAAKG,IAAA,CAAKkB,CAAA,GAAO,IAAIb,CAAA,GAAQ,IAAIX,CAAA,EACzCY,CAAA,GAAM,SAAA+uB,CAAU9uB,CAAA;YAAK,QAAQR,CAAA,CAAIQ,CAAA,IAAMR,CAAA,CAAIQ,CAAA,GAAI,MAAMb,CAAA,GAAUK,CAAA,CAAIQ,CAAA,GAAI,MAAMF,CAAA,IAAU8tB,CAAQ;UAAA,GAG/F3sB,CAAA,GAAO,IAAIwqB,EAAA,CAAI,OAEf1pB,CAAA,GAAK,IAAIwpB,EAAA,CAAI,MAAMppB,CAAA,GAAK,IAAIopB,EAAA,CAAI,KAEhCpqB,CAAA,GAAO,GAAGqB,CAAA,GAAK,GAAUG,CAAA,IAAP+E,CAAA,GAAI,GAAQ,IAAG5E,CAAA,GAAK,GAAGE,CAAA,GAAK,GAC3C0E,CAAA,GAAIxG,CAAA,IAAKwG,CAAA,EAAG;UAEf,IAAIxE,CAAA,GAAKnD,CAAA,CAAI2H,CAAA;YAETtE,CAAA,GAAW,QAAJsE,CAAA;YAEPpE,CAAA,GAAQoY,CAAA,CAAKxY,CAAA;UAKjB,IAJA2qB,CAAA,CAAKzqB,CAAA,IAAQE,CAAA,EACboY,CAAA,CAAKxY,CAAA,IAAME,CAAA,EAGPN,CAAA,IAAM4E,CAAA,EAAG;YAET,IAAIjE,CAAA,GAAMvC,CAAA,GAAIwG,CAAA;YACd,KAAKvG,CAAA,GAAO,OAAQwB,CAAA,GAAK,UAAUc,CAAA,GAAM,KAAK;cAC1CgE,CAAA,GAAM4mB,EAAA,CAAK7uB,CAAA,EAAKgI,CAAA,EAAG,GAAGvG,CAAA,EAAMc,CAAA,EAAII,CAAA,EAAIK,CAAA,EAAIG,CAAA,EAAIK,CAAA,EAAI0E,CAAA,GAAI1E,CAAA,EAAIyE,CAAA,GACxD9E,CAAA,GAAKxB,CAAA,GAAOqB,CAAA,GAAK,GAAGQ,CAAA,GAAK0E,CAAA;cACzB,KAAK,IAAI/D,CAAA,GAAI,GAAGA,CAAA,GAAI,OAAOA,CAAA,EACvB5B,CAAA,CAAG4B,CAAA,IAAK;cACZ,KAASA,CAAA,GAAI,GAAGA,CAAA,GAAI,MAAMA,CAAA,EACtBxB,CAAA,CAAGwB,CAAA,IAAK,CATP;YAAA;YAYT,IAAIC,CAAA,GAAI;cAAGC,CAAA,GAAI;cAAGE,CAAA,GAAOqT,CAAA;cAAGnT,CAAA,GAAOb,CAAA,GAAOE,CAAA,GAAS;YACnD,IAAIG,CAAA,GAAM,KAAKP,CAAA,IAAMnD,CAAA,CAAI2H,CAAA,GAAIzD,CAAA,GAMzB,KALA,IAAIE,CAAA,GAAO7E,IAAA,CAAKyvB,GAAA,CAAI5X,CAAA,EAAG1T,CAAA,IAAO,GAC1BW,CAAA,GAAO9E,IAAA,CAAKyvB,GAAA,CAAI,OAAOrnB,CAAA,GAGvB3C,CAAA,GAAKzF,IAAA,CAAKyvB,GAAA,CAAI,KAAKtrB,CAAA,GAChBQ,CAAA,IAAOG,CAAA,MAAUL,CAAA,IAAQX,CAAA,IAAQE,CAAA,GAAO;cAC3C,IAAI9D,CAAA,CAAIkI,CAAA,GAAI9D,CAAA,KAAMpE,CAAA,CAAIkI,CAAA,GAAI9D,CAAA,GAAIK,CAAA,GAAM;gBAEhC,KADA,IAAIU,CAAA,GAAK,GACFA,CAAA,GAAKI,CAAA,IAAMvF,CAAA,CAAIkI,CAAA,GAAI/C,CAAA,KAAOnF,CAAA,CAAIkI,CAAA,GAAI/C,CAAA,GAAKV,CAAA,KAAQU,CAAA;gBAEtD,IAAIA,CAAA,GAAKf,CAAA,EAAG;kBAGR,IAFAA,CAAA,GAAIe,CAAA,EAAId,CAAA,GAAII,CAAA,EAERU,CAAA,GAAKR,CAAA,EACL;kBAIJ,IAAIgB,CAAA,GAAM7F,IAAA,CAAKyvB,GAAA,CAAI9qB,CAAA,EAAKU,CAAA,GAAK;oBACzBS,CAAA,GAAK;kBACT,KAASzB,CAAA,GAAI,GAAGA,CAAA,GAAIwB,CAAA,IAAOxB,CAAA,EAAG;oBAC1B,IAAI2B,CAAA,GAAMoC,CAAA,GAAIzD,CAAA,GAAMN,CAAA,GAAI,QAAS;sBAE7B4B,CAAA,GAAMD,CAAA,GADAuoB,CAAA,CAAKvoB,CAAA,IACM,QAAS;oBAC1BC,CAAA,GAAKH,CAAA,KACLA,CAAA,GAAKG,CAAA,EAAIjC,CAAA,GAAQgC,CAAA,CACxB;kBAAA;gBACJ;cAtBsC;cA0B3CrB,CAAA,KADAb,CAAA,GAAOE,CAAA,KAAOA,CAAA,GAAQuqB,CAAA,CAAKzqB,CAAA,KACJ,QAAS,KACnC;YAAA;YAGL,IAAIS,CAAA,EAAG;cAGH5C,CAAA,CAAK0B,CAAA,MAAQ,YAAaspB,EAAA,CAAMroB,CAAA,KAAM,KAAMsoB,EAAA,CAAMroB,CAAA;cAClD,IAAI6B,CAAA,GAAiB,KAAXumB,EAAA,CAAMroB,CAAA;gBAAS+B,CAAA,GAAiB,KAAXumB,EAAA,CAAMroB,CAAA;cACrCrB,CAAA,IAAMkpB,EAAA,CAAKhmB,CAAA,IAAOimB,EAAA,CAAKhmB,CAAA,KACrB5D,CAAA,CAAG,MAAM2D,CAAA,KACTvD,CAAA,CAAGwD,CAAA,GACL7C,CAAA,GAAK4E,CAAA,GAAI9D,CAAA,IACPzC,CACL;YAAA,OAEGF,CAAA,CAAK0B,CAAA,MAAQnD,CAAA,CAAIkI,CAAA,KACf3F,CAAA,CAAGvC,CAAA,CAAIkI,CAAA,EAEhB;UAAA;QACJ;QACDD,CAAA,GAAM4mB,EAAA,CAAK7uB,CAAA,EAAKgI,CAAA,EAAGnH,CAAA,EAAKY,CAAA,EAAMc,CAAA,EAAII,CAAA,EAAIK,CAAA,EAAIG,CAAA,EAAIK,CAAA,EAAI0E,CAAA,GAAI1E,CAAA,EAAIyE,CAAA,GAErDpH,CAAA,KACDoH,CAAA,GAAM0mB,EAAA,CAAM3mB,CAAA,EAAGC,CAAA,EAAK+mB,EAAA,EAC3B;MAAA;MACD,OAAOvB,EAAA,CAAI1lB,CAAA,EAAG,GAAGtH,CAAA,GAAM8sB,EAAA,CAAKtlB,CAAA,IAAO5G,CAAA,CACtC;IAAA,CAgDU,CAAKrB,CAAA,EAAkB,QAAbQ,CAAA,CAAIgvB,KAAA,GAAgB,IAAIhvB,CAAA,CAAIgvB,KAAA,EAAkB,QAAXhvB,CAAA,CAAIivB,GAAA,GAAc3vB,IAAA,CAAKG,IAAA,CAAuD,MAAlDH,IAAA,CAAKwuB,GAAA,CAAI,GAAGxuB,IAAA,CAAKyvB,GAAA,CAAI,IAAIzvB,IAAA,CAAK+E,GAAA,CAAI7E,CAAA,CAAIW,MAAA,OAAoB,KAAKH,CAAA,CAAIivB,GAAA,EAAMtuB,CAAA,EAAKV,CAAA,GAAOY,CAAA,CACxK;EAAA;EA8HGquB,EAAA,GAAS,SAAAC,CAAU3vB,CAAA,EAAGQ,CAAA,EAAGW,CAAA;IACzB,OAAOA,CAAA,IAAKX,CAAA,EACRR,CAAA,CAAEQ,CAAA,IAAKW,CAAA,EAAGA,CAAA,MAAO,CACxB;EAAA;EAEGyuB,EAAA,GAAM,SAAAC,CAAU7vB,CAAA,EAAGQ,CAAA;IACnB,IAAIW,CAAA,GAAKX,CAAA,CAAEsvB,QAAA;IAIX,IAHA9vB,CAAA,CAAE,KAAK,IAAIA,CAAA,CAAE,KAAK,KAAKA,CAAA,CAAE,KAAK,GAAGA,CAAA,CAAE,KAAKQ,CAAA,CAAEgvB,KAAA,GAAQ,IAAI,IAAe,KAAXhvB,CAAA,CAAEgvB,KAAA,GAAa,IAAI,GAAGxvB,CAAA,CAAE,KAAK,GACxE,KAAXQ,CAAA,CAAEuvB,KAAA,IACFL,EAAA,CAAO1vB,CAAA,EAAG,GAAGF,IAAA,CAAKI,KAAA,CAAM,IAAI8B,IAAA,CAAKxB,CAAA,CAAEuvB,KAAA,IAAS/tB,IAAA,CAAKC,GAAA,MAAS,OAC1Dd,CAAA,EAAI;MACJnB,CAAA,CAAE,KAAK;MACP,KAAK,IAAIS,CAAA,GAAI,GAAGA,CAAA,IAAKU,CAAA,CAAGR,MAAA,IAAUF,CAAA,EAC9BT,CAAA,CAAES,CAAA,GAAI,MAAMU,CAAA,CAAGiH,UAAA,CAAW3H,CAAA,CACjC;IAAA;EACJ;EAoBGuvB,EAAA,GAAO,SAAAC,CAAUjwB,CAAA;IAAK,OAAO,MAAOA,CAAA,CAAE8vB,QAAA,IAAa9vB,CAAA,CAAE8vB,QAAA,CAASnvB,MAAA,GAAS,KAAO,EAAK;EAAA;AAsOhF,SAASuvB,GAASlwB,CAAA,EAAMQ,CAAA;EAAA,KACd,MAATA,CAAA,KAAmBA,CAAA,GAAO;EAC9B,IAAIW,CAAA,GAAI+tB,EAAA;IAAOzuB,CAAA,GAAIT,CAAA,CAAKW,MAAA;EACxBQ,CAAA,CAAEqW,CAAA,CAAExX,CAAA;EACJ,IAAIqB,CAAA,GAAI+tB,EAAA,CAAKpvB,CAAA,EAAMQ,CAAA,EAAMwvB,EAAA,CAAKxvB,CAAA,GAAO;IAAIK,CAAA,GAAIQ,CAAA,CAAEV,MAAA;EAC/C,OAAOivB,EAAA,CAAIvuB,CAAA,EAAGb,CAAA,GAAOkvB,EAAA,CAAOruB,CAAA,EAAGR,CAAA,GAAI,GAAGM,CAAA,CAAE6P,CAAA,KAAM0e,EAAA,CAAOruB,CAAA,EAAGR,CAAA,GAAI,GAAGJ,CAAA,GAAIY,CACtE;AAAA;AA2VM,SAAS8uB,GAAQnwB,CAAA,EAAKQ,CAAA;EACzB,IAAIW,CAAA,GAAInB,CAAA,CAAIW,MAAA;EACZ,KAAKH,CAAA,IAAgC,sBAAf4vB,WAAA,EAClB,OAAO,IAAIA,WAAA,GAAcC,MAAA,CAAOrwB,CAAA;EAIpC,KAHA,IAAIS,CAAA,GAAK,IAAIqrB,EAAA,CAAG9rB,CAAA,CAAIW,MAAA,IAAUX,CAAA,CAAIW,MAAA,KAAW,KACzCU,CAAA,GAAK,GACLR,CAAA,GAAI,SAAAY,CAAUzB,CAAA;MAAKS,CAAA,CAAGY,CAAA,MAAQrB,CAAA;IAAA,GACzB0B,CAAA,GAAI,GAAGA,CAAA,GAAIP,CAAA,IAAKO,CAAA,EAAG;IACxB,IAAIL,CAAA,GAAK,IAAIZ,CAAA,CAAGE,MAAA,EAAQ;MACpB,IAAIoH,CAAA,GAAI,IAAI+jB,EAAA,CAAGzqB,CAAA,GAAK,KAAMF,CAAA,GAAIO,CAAA,IAAM;MACpCqG,CAAA,CAAE4I,GAAA,CAAIlQ,CAAA,GACNA,CAAA,GAAKsH,CACR;IAAA;IACD,IAAIC,CAAA,GAAIhI,CAAA,CAAIoI,UAAA,CAAW1G,CAAA;IACnBsG,CAAA,GAAI,OAAOxH,CAAA,GACXK,CAAA,CAAEmH,CAAA,IACGA,CAAA,GAAI,QACTnH,CAAA,CAAE,MAAOmH,CAAA,KAAM,IAAKnH,CAAA,CAAE,MAAW,KAAJmH,CAAA,KACxBA,CAAA,GAAI,SAASA,CAAA,GAAI,SAElBnH,CAAA,CAAE,OADNmH,CAAA,GAAI,SAAa,UAAJA,CAAA,IAAyC,OAAtBhI,CAAA,CAAIoI,UAAA,GAAa1G,CAAA,OAC9B,KAAMb,CAAA,CAAE,MAAQmH,CAAA,KAAM,KAAM,KAAMnH,CAAA,CAAE,MAAQmH,CAAA,KAAM,IAAK,KAAMnH,CAAA,CAAE,MAAW,KAAJmH,CAAA,MAEzFnH,CAAA,CAAE,MAAOmH,CAAA,KAAM,KAAMnH,CAAA,CAAE,MAAQmH,CAAA,KAAM,IAAK,KAAMnH,CAAA,CAAE,MAAW,KAAJmH,CAAA,EAChE;EAAA;EACD,OAAOylB,EAAA,CAAIhtB,CAAA,EAAI,GAAGY,CAAA,CACrB;AAAA;AAAA,WC1zCWrB,CAAA;EAAAA,CAAA,CAAAswB,MAAA,cAAAtwB,CAAA,CAAAuwB,MAAA;AAAA,EAAArD,EAAA,KAAAA,EAAA,mBAqMAltB,CAAA;EAAAA,CAAA,CAAAwwB,OAAA,cAAAxwB,CAAA,CAAAywB,MAAA,aAAAzwB,CAAA,CAAA0wB,KAAA,YAAA1wB,CAAA,CAAA2wB,UAAA;AAAA,EAAAxD,EAAA,KAAAA,EAAA,mBAeAntB,CAAA;EAAAA,CAAA,CAAA4wB,IAAA,WAAA5wB,CAAA,CAAA6wB,oBAAA,sBAAA7wB,CAAA,CAAA8wB,mBAAA,qBAAA9wB,CAAA,CAAA+wB,GAAA,UAAA/wB,CAAA,CAAAgxB,MAAA,aAAAhxB,CAAA,CAAAixB,IAAA;AAAA,EAAA7D,EAAA,KAAAA,EAAA;ACvWL,IAAM8D,EAAA,GAAiB,SAAAC,CAC1BnxB,CAAA,EACAQ,CAAA,EACAW,CAAA;IAEA,IAAMV,CAAA,GAAOD,CAAA,IAAgB;IAC7BC,CAAA,CAAI2wB,EAAA,GAASjwB,CAAA,CAAgBiwB,EAAA,GAAS,IAAI,GAC1C3wB,CAAA,CAAI2tB,CAAA,GAAQ,IAAIpsB,IAAA,GAAO8O,OAAA,GAAUrN,QAAA,IACjChD,CAAA,CAAI4wB,GAAA,GAAU1xB,CAAA,CAAOE,WAAA;IAErB,IAAMwB,CAAA,GAASrB,CAAA,CAAIgP,KAAA,CAAM;IACzB,IAAI3N,CAAA,CAAOV,MAAA,GAAS,GAAG;MACnB,IADmBE,CAAA;QAAAa,CAAA,GAAAwa,CAAA,CACJ7a,CAAA,CAAO,GAAG2N,KAAA,CAAM;MADZ;QAEnB,KAAwBtN,CAAA,CAAAA,CAAA,MAAAb,CAAA,GAAAa,CAAA,CAAAP,CAAA,IAAAgb,IAAA;UAAA,IACdpU,CAAA,GADclH,CAAA,CAAAE,KAAA,CACNiO,KAAA,CAAM,KAAK;UACrBvO,CAAA,CAAKsH,CAAA,YACEtH,CAAA,CAAKsH,CAAA,CAEnB;QAAA;MAPkB,SAAA/H,CAAA;QAAA0B,CAAA,CAAA1B,CAAA,CAAAA,CAAA;MAAA;QAAA0B,CAAA,CAAAiW,CAAA;MAAA;IAQtB;IAED,IAAM3P,CAAA,GAAehI,CAAA,CAAIwE,OAAA,CAAQ,QAAQ,IAAI,MAAM;IACnD,OAAOxE,CAAA,GAAMgI,CAAA,GpB4gBc,UAAUhI,CAAA;MAA4D,IAC7FQ,CAAA;QACAW,CAAA;QAFgEV,CAAA,GAAAwE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAgB;QAG9E5D,CAAA,GAAoB;MAQ1B,OANAsE,CAAA,CAAM3F,CAAA,EAAU,UAAUA,CAAA,EAAKS,CAAA;QAC3BD,CAAA,GAAUyQ,kBAAA,CAAmBjR,CAAA,CAAIyD,QAAA,KACjCtC,CAAA,GAAU8P,kBAAA,CAAmBxQ,CAAA,GAC7BY,CAAA,CAAQA,CAAA,CAAQV,MAAA,IAAUQ,CAAA,GAAU,MAAMX,CAC7C;MAAA,IAEMa,CAAA,CAAQgH,IAAA,CAAK5H,CAAA,CACvB;IAAA,CoBxhB+B,CAAgBA,CAAA,CAC/C;EAAA;EAEY6wB,EAAA,GAAiB,SAAjBtxB,EAAkBQ,CAAA,EAA6BW,CAAA;IACxD,IAAIA,CAAA,CAAQowB,IAAA,IAAQ/wB,CAAA,CAAKuC,MAAA,EACrB,OAAO,IAAIyuB,IAAA,CAAK,CAAChxB,CAAA,CAAKuC,MAAA,GAAS;MAAEsH,IAAA,EAAM;IAAA;IAG3C,IAAIlJ,CAAA,CAAQswB,UAAA,IAActwB,CAAA,CAAQowB,IAAA,EAAM;MACpC,IAAM9wB,CAAA,GAAOT,CAAA,CAAeQ,CAAA,EAAM;QAAEgd,MAAA,EAAQ;MAAA;MAC5C,OAAO,IAAIgU,IAAA,CAAK,CAAC/wB,CAAA,GAAO;QAAE4J,IAAA,EAAM;MAAA,EACnC;IAAA;IAED,IAAuB,WAAnBlJ,CAAA,CAAQqc,MAAA,EACR,OAAO;IAGX,IAAInc,CAAA,EACkBR,CAAA;IAYtB,OATIQ,CAAA,GAFA+B,KAAA,CAAMsB,OAAA,CAAQlE,CAAA,MADIK,CAAA,GACkBL,CAAA,EADoD,0BAAtC+C,MAAA,CAAOF,SAAA,CAAUI,QAAA,CAASiC,IAAA,CAAK7E,CAAA,KAGrE,UAAUoQ,kBAAA,CAAmBzQ,CAAA,IAE7B,UAAUyQ,kBAAA,CAAmBzQ,CAAA,CAAKgb,IAAA,GAG9C,iBAAiBhb,CAAA,IAAQA,CAAA,CAAK2oB,WAAA,KAC9B9nB,CAAA,IAAa,kBAAkBb,CAAA,CAAK2oB,WAAA,GAGjC9nB,CACV;EAAA;EAEYqwB,EAAA,GAAM,SAAAC,CAWF3xB,CAAA;IAAA,IAVbQ,CAAA,GAAAR,CAAA,CAAAumB,GAAA;MACAplB,CAAA,GAAAnB,CAAA,CAAAwb,IAAA;MACA/a,CAAA,GAAAT,CAAA,CAAA4xB,OAAA;MACAvwB,CAAA,GAAArB,CAAA,CAAAurB,OAAA;MACA1qB,CAAA,GAAAb,CAAA,CAAAsrB,cAAA;MACA5pB,CAAA,GAAA1B,CAAA,CAAA6xB,QAAA;MACA9pB,CAAA,GAAA/H,CAAA,CAAA8xB,qBAAA;MACA9pB,CAAA,GAAAhI,CAAA,CAAA+xB,UAAA;MACA9pB,CAAA,GAAAjI,CAAA,CAAAgyB,UAAA;MAEa9pB,CAAA,GAAAlI,CAAA,CADbiyB,OAAA;MAAAjhB,CAAA,cAAA9I,CAAA,GAAU,MACGA,CAAA;MACPsP,CAAA,GAAM,IAAI0a,cAAA;IAChB1a,CAAA,CAAI2a,IAAA,CAAK9wB,CAAA,CAAQmc,MAAA,IAAU,OAAOhd,CAAA,GAAK;IAEvC,IAAMmX,CAAA,GAAO2Z,EAAA,CAAenwB,CAAA,EAAME,CAAA;IAElCR,CAAA,CAAeyjB,IAAA,CAAK,kBACpBzjB,CAAA,CAAeyjB,IAAA,CAAK,2BAEpB3e,CAAA,CAAMlF,CAAA,EAAS,UAAUT,CAAA,EAAaQ,CAAA;MAClCgX,CAAA,CAAI4a,gBAAA,CAAiB5xB,CAAA,EAAYR,CAAA,CACpC;IAAA,IAEsB,WAAnBqB,CAAA,CAAQmc,MAAA,IAAsBnc,CAAA,CAAQkwB,IAAA,IACtC/Z,CAAA,CAAI4a,gBAAA,CAAiB,gBAAgB,sCAGzC5a,CAAA,CAAIya,OAAA,GAAUjhB,CAAA,EAGdwG,CAAA,CAAI6a,eAAA,IAAkB,GACtB7a,CAAA,CAAI8a,kBAAA,GAAqB;MACrB,IAAuB,MAAnB9a,CAAA,CAAI+a,UAAA,EAMJ,IALA1xB,CAAA,CAAeyjB,IAAA,CAAf,iBACAzjB,CAAA,CAAeyjB,IAAA,CAAqB,gBAAAjf,MAAA,CAAAmS,CAAA,CAAIuR,MAAA,IACxCloB,CAAA,CAAe2xB,IAAA,CAAK,2BAGD,QAAfhb,CAAA,CAAIuR,MAAA;QACJ,IAAIrnB,CAAA,EAAU;UACV,IAAI1B,CAAA;UACJ;YACIA,CAAA,GAAW0Q,IAAA,CAAKD,KAAA,CAAM+G,CAAA,CAAIib,YAAA,CAD9B;UAAA,CAEE,QAAOzyB,CAAA;YAEL,YADA4E,CAAA,CAAOQ,KAAA,CAAMpF,CAAA,CAEhB;UAAA;UACD0B,CAAA,CAAS1B,CAAA,CACZ;QAAA;MAAA,OAEyB,qBAAfiI,CAAA,IACPA,CAAA,CAAWuP,CAAA,GAIX,CAAC,KAAK,KAAK,KAAK,KAAKhT,OAAA,CAAQgT,CAAA,CAAIuR,MAAA,IAAU,KAC3C/gB,CAAA,CAAW0qB,OAAA,CAAQ;QACfnM,GAAA,EAAA/lB,CAAA;QACAgb,IAAA,EAAAra,CAAA;QACAoqB,OAAA,EAAAlqB,CAAA;QACAuwB,OAAA,EAAAnxB,CAAA;QACAqxB,qBAAA,GAAwB/pB,CAAA,IAAyB,KAAK;QACtD8pB,QAAA,EAAAnwB;MAAA,IAIJA,CAAA,IACAA,CAAA,CAAS;QAAEqnB,MAAA,EAAQ;MAAA;IAAA,GAKnCvR,CAAA,CAAImb,IAAA,CAAKhb,CAAA,CACZ;EAAA;EC/HKib,EAAA,GAAgB;AAqBtB,IAAaC,EAAA,GAAb,UAAA7yB,CAAA;IAAA+H,CAAA,CAAA1G,CAAA,EAAgCwpB,EAAA;IAAhC,IAAA1pB,CAAA,GAAAqW,CAAA,CAAAnW,CAAA;IAOI,SAAYA,EAAArB,CAAA,EAAgCQ,CAAA;MAAqD,IAAAK,CAAA;MAAA,OAAAJ,CAAA,OAAAY,CAAA,IAC7FR,CAAA,GAAAM,CAAA,CAAAuE,IAAA,QACK4lB,cAAA,GAAiBtrB,CAAA,EACtBa,CAAA,CAAKiqB,SAAA,IAAY,GACjBjqB,CAAA,CAAKiyB,KAAA,GAAQ,IACbjyB,CAAA,CAAKkyB,WAAA,IAAc,GACnBlyB,CAAA,CAAKmxB,UAAA,GAAaxxB,CAAA,EAEI,sBAAXqD,MAAA,IAA0B,YAAYA,MAAA,CAAOE,SAAA,KACpDlD,CAAA,CAAKkyB,WAAA,GAAclvB,MAAA,CAAOE,SAAA,CAAUivB,MAAA,EACpCnvB,MAAA,CAAOmG,gBAAA,CAAiB,UAAU;QAC9BnJ,CAAA,CAAKoyB,qBAAA;MAAA,IAETpvB,MAAA,CAAOmG,gBAAA,CAAiB,WAAW;QAC/BnJ,CAAA,CAAKkyB,WAAA,IAAc;MAAA,KAdkElyB,CAiBhG;IAAA;IAxBL,OAAAA,CAAA,CAAAQ,CAAA;MAAAP,GAAA;MAAAC,KAAA,EA0BI,SAAAA,CAAQf,CAAA;QACJ,IAAMQ,CAAA,GAAwBR,CAAA,CAAY8xB,qBAAA,IAAyB;QACnE,MAAItxB,CAAA,IAAyB,KAA7B;UAGA,IAAMW,CAAA,GAxCP,UAA4BnB,CAAA;cAC/B,IAAMQ,CAAA,GAAiB,MAAAV,IAAA,CAAA0B,GAAA,CAAO,GAAKxB,CAAA;gBAC7BmB,CAAA,GAAaX,CAAA,GAAiB;gBAC9BC,CAAA,GAAoBX,IAAA,CAAKyvB,GAAA,CAAIqD,EAAA,EAAepyB,CAAA;gBAE5Ca,CAAA,IADiBvB,IAAA,CAAKuC,MAAA,KAAW,OACN5B,CAAA,GAAoBU,CAAA;cACrD,OAAOrB,IAAA,CAAKG,IAAA,CAAKQ,CAAA,GAAoBY,CAAA,CACxC;YAAA,CAiC6B,CAAmBb,CAAA;YACnCC,CAAA,GAAU,IAAIuB,IAAA,CAAKA,IAAA,CAAKC,GAAA,KAAQd,CAAA;UAEtC,KAAK2xB,KAAA,CAAMjrB,IAAA,CAAK;YAAEqrB,OAAA,EAAAzyB,CAAA;YAAS0yB,WAAA,EAAAnzB;UAAA,IAC3B+E,OAAA,CAAQ4X,IAAA,CAAR,wCAAAtX,MAAA,CAAqDlE,CAAA,IAChD,KAAK2pB,SAAA,KACN,KAAKA,SAAA,IAAY,GACjB,KAAKK,IAAA,GARR;QAAA;MAUJ;IAAA,GAxCL;MAAArqB,GAAA;MAAAC,KAAA,EA0CI,SAAAA,CAAA;QAAa,IAAAf,CAAA;QACT,KAAKirB,OAAA,IAAWO,YAAA,CAAa,KAAKP,OAAA,GAClC,KAAKA,OAAA,GAAUhO,UAAA,CAAW;UAClBjd,CAAA,CAAK+yB,WAAA,IAAe/yB,CAAA,CAAK8yB,KAAA,CAAMnyB,MAAA,GAAS,KACxCX,CAAA,CAAKozB,KAAA,IAETpzB,CAAA,CAAKmrB,IAAA;QAAA,GACN,KAAKD,aAAA,CACX;MAAA;IAAA,GAlDL;MAAApqB,GAAA;MAAAC,KAAA,EAoDI,SAAAA,CAAA;QAEI,IAAMf,CAAA,GAAM,IAAIgC,IAAA,CAAKA,IAAA,CAAKC,GAAA;UACpBzB,CAAA,GAAU,KAAKsyB,KAAA,CAAM7jB,MAAA,CAAO,UAAAzO,CAAA;YAAA,OAAAA,CAAA,CAAG0yB,OAAA,GAAwBlzB,CAA3B;UAAA;QAClC,IAAIQ,CAAA,CAAQG,MAAA,GAAS,GAAG;UACpB,KAAKmyB,KAAA,GAAQ,KAAKA,KAAA,CAAM7jB,MAAA,CAAO,UAAAzO,CAAA;YAAA,OAAAA,CAAA,CAAG0yB,OAAA,IAAyBlzB,CAA5B;UAAA;UADX,IAAAmB,CAAA;YAAAV,CAAA,GAAAyb,CAAA,CAEU1b,CAAA;UAFV;YAEpB,KAAuCC,CAAA,CAAAiB,CAAA,MAAAP,CAAA,GAAAV,CAAA,CAAAU,CAAA,IAAAgb,IAAA;cAAA,IAA1B9a,CAAA,GAAAF,CAAA,CAAAJ,KAAA,CAAAoyB,WAAA;cACT,KAAKE,kBAAA,CAAmBhyB,CAAA,CAC3B;YAAA;UAJmB,SAAArB,CAAA;YAAAS,CAAA,CAAAT,CAAA,CAAAA,CAAA;UAAA;YAAAS,CAAA,CAAAkX,CAAA;UAAA;QAKvB;MACJ;IAAA,GA9DL;MAAA7W,GAAA;MAAAC,KAAA,EAgEI,SAAAA,CAAA;QACQ,KAAKkqB,OAAA,KACLO,YAAA,CAAa,KAAKP,OAAA,GAClB,KAAKA,OAAA,QAAU;QAHR,IAAAjrB,CAAA;UAAAmB,CAAA,GAAA+a,CAAA,CAKmB,KAAK4W,KAAA;QALxB;UAKX,KAA0C3xB,CAAA,CAAAO,CAAA,MAAA1B,CAAA,GAAAmB,CAAA,CAAAA,CAAA,IAAAgb,IAAA;YAAA,IAA7B1b,CAAA,GAAAT,CAAA,CAAAe,KAAA,CAAAoyB,WAAA;cACD9xB,CAAA,GAAuBZ,CAAA,CAAvB8lB,GAAA;cAAK1lB,CAAA,GAAkBJ,CAAA,CAAlB+a,IAAA;cAAM9Z,CAAA,GAAYjB,CAAA,CAAZ8qB,OAAA;YACnB;cAGI1nB,MAAA,CAAOE,SAAA,CAAU0tB,UAAA,CAAWpwB,CAAA,EAAKiwB,EAAA,CAAezwB,CAAA,EAADL,CAAA,CAAAA,CAAA,KAAYkB,CAAA,GAAZ;gBAAqB+vB,UAAA,GAAY;cAAA,IAHpF;YAAA,CAIE,QAAOzxB,CAAA;cAGDL,CAAA,CAAOC,KAAA,IACPmF,OAAA,CAAQK,KAAA,CAAMpF,CAAA,CAErB;YAAA;UACJ;QAlBU,SAAAA,CAAA;UAAAmB,CAAA,CAAAnB,CAAA,CAAAA,CAAA;QAAA;UAAAmB,CAAA,CAAAwW,CAAA;QAAA;QAmBX,KAAKmb,KAAA,GAAQ,EAChB;MAAA;IAAA,GApFL;MAAAhyB,GAAA;MAAAC,KAAA,EAsFI,SAAAA,CAA8Gf,CAAA;QAAA,IAAzFQ,CAAA,GAAAR,CAAA,CAAAumB,GAAA;UAAKplB,CAAA,GAAAnB,CAAA,CAAAwb,IAAA;UAAM/a,CAAA,GAAAT,CAAA,CAAAurB,OAAA;UAASlqB,CAAA,GAAArB,CAAA,CAAA4xB,OAAA;UAAS/wB,CAAA,GAAAb,CAAA,CAAA6xB,QAAA;UAAUnwB,CAAA,GAAA1B,CAAA,CAAA8xB,qBAAA;QACxDJ,EAAA,CAAI;UACAnL,GAAA,EAAA/lB,CAAA;UACAgb,IAAA,EAAMra,CAAA,IAAQ,CAFd;UAGAoqB,OAAA,EAAS9qB,CAAA,IAAW,CAHpB;UAIAmxB,OAAA,EAASvwB,CAAA,IAAW,CAJpB;UAKAywB,qBAAA,EAAuBpwB,CAAA,IAAyB;UAChDmwB,QAAA,EAAAhxB,CAAA;UACAyqB,cAAA,EAAgB,KAAKA,cAAA;UACrByG,UAAA,EAAY;UACZC,UAAA,EAAY,KAAKA;QAAA,EAExB;MAAA;IAAA,GAlGL;MAAAlxB,GAAA;MAAAC,KAAA,EAoGI,SAAAA,CAAA;QACI,KAAKgyB,WAAA,IAAc,GACnB,KAAKK,KAAA,EACR;MAAA;IAAA,KAvGL/xB,CAAA;EAAA;ECtBMiyB,EAAA,GAA2B;EAC3BC,EAAA,GAA2B;EAC3BC,EAAA,GAAuB;EAEhBC,EAAA,GAAb;IAWI,SAAYzzB,EAAAQ,CAAA,EAAgCW,CAAA;MAAiCV,CAAA,OAAAT,CAAA,GACzE,KAAK6X,MAAA,GAASrX,CAAA,EACd,KAAKgT,WAAA,GAAcrS,CAAA,EACnB,KAAKuyB,SAAA,QAAY,GACjB,KAAKC,UAAA,QAAa,GAClB,KAAKC,sBAAA,GAAyB,MAC9B,KAAKC,yBAAA,GAA4B;MAEjC,IAAMxyB,CAAA,GAAkBb,CAAA,CAAM+S,gBAAA,IAAwB/S,CAAA,CAAM2S,KAAA;QACxDtS,CAAA,GAAiBL,CAAA,CAAMszB,4BAAA,IAAoCR,EAAA;MAsB/D,IApB8B,mBAAnBzyB,CAAA,IACPkE,OAAA,CAAQ4X,IAAA,CAAK,uFACb9b,CAAA,GAAiByyB,EAAA,IACVzyB,CAAA,GAAiByyB,EAAA,GACxBvuB,OAAA,CAAQ4X,IAAA,CACJ,0GAEG9b,CAAA,GAAiB0yB,EAAA,IACxBxuB,OAAA,CAAQ4X,IAAA,CACJ,qGAIR,KAAKoX,iBAAA,GACwF,MAAzFj0B,IAAA,CAAKyvB,GAAA,CAAIzvB,IAAA,CAAKwuB,GAAA,CAAIztB,CAAA,EAAgB0yB,EAAA,GAA2BD,EAAA,GACjE,KAAKU,sBAAA,GAAyB,QAAQ3yB,CAAA,GAAkB,cACxD,KAAK4yB,kCAAA,GAAqC,QAAQ5yB,CAAA,GAAkB,0BAIhE,KAAK6yB,qBAAA,IAAyB;QAC9B,IAAMxyB,CAAA,GAAeqQ,EAAA,CAAatB,KAAA,CAAM,KAAKujB,sBAAA;UAEvCjsB,CAAA,GAAsBgK,EAAA,CAAatB,KAAA,CAAM,KAAKwjB,kCAAA;QAChDvyB,CAAA,KAAiBqG,CAAA,GAEjB,KAAK2rB,SAAA,GAAYhyB,CAAA,GAGjBqQ,EAAA,CAAaZ,MAAA,CAAO,KAAK6iB,sBAAA,GAG7BjiB,EAAA,CAAapB,GAAA,CAAI,KAAKsjB,kCAAA,GAAoC,EAC7D;MAAA;MAED,KAAKE,qBAAA,EACR;IAAA;IA1DL,OAAAtzB,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EA4DI,SAAAA,CAAA;QAEI,OAAmC,aAA5B,KAAK8W,MAAA,CAAOrE,WAAA,KAA6B,KAAKA,WAAA,CAAYO,QAAA,IAAYhC,EAAA,CAAazB,YAAA,EA9DlG;MAAA;IAAA;MAAAxP,GAAA;MAAAC,KAAA,EAqEI,SAAAA,CAAqBf,CAAA;QACbA,CAAA,KAAa,KAAK0zB,SAAA,KAClB,KAAKA,SAAA,GAAY1zB,CAAA,EACb,KAAKk0B,qBAAA,MACLniB,EAAA,CAAapB,GAAA,CAAI,KAAKqjB,sBAAA,EAAwBh0B,CAAA,EAGzD;MAAA;IAAA,GA5EL;MAAAc,GAAA;MAAAC,KAAA,EA8EI,SAAAA,CAAA;QACI,OAAI,KAAK2yB,SAAA,GACE,KAAKA,SAAA,GAEZ,KAAKQ,qBAAA,KACEniB,EAAA,CAAatB,KAAA,CAAM,KAAKujB,sBAAA,IAG5B,IAtFf;MAAA;IAAA;MAAAlzB,GAAA;MAAAC,KAAA,EA2FI,SAAAA,CACIf,CAAA,EACAQ,CAAA,EACAW,CAAA;QAGInB,CAAA,KAAc,KAAK2zB,UAAA,IACnBnzB,CAAA,KAA6B,KAAKqzB,yBAAA,IAClC1yB,CAAA,KAA0B,KAAKyyB,sBAAA,KAE/B,KAAKA,sBAAA,GAAyBzyB,CAAA,EAC9B,KAAK0yB,yBAAA,GAA4BrzB,CAAA,EACjC,KAAKmzB,UAAA,GAAa3zB,CAAA,EAClB,KAAKwT,WAAA,CAAYY,QAAA,CAAjB1S,CAAA,KACK8Q,EAAA,EAAa,CAAChS,CAAA,EAA0BR,CAAA,EAAWmB,CAAA,IAG/D;MAAA;IAAA,GA5GL;MAAAL,GAAA;MAAAC,KAAA,EA8GI,SAAAA,CAAA;QACI,IAAI,KAAK4yB,UAAA,IAAc,KAAKE,yBAAA,IAA6B,KAAKD,sBAAA,EAC1D,OAAO,CAAC,KAAKC,yBAAA,EAA2B,KAAKF,UAAA,EAAY,KAAKC,sBAAA;QAElE,IAAM5zB,CAAA,GAAY,KAAKwT,WAAA,CAAYJ,KAAA,CAAMZ,EAAA;QAOzC,OALIpP,KAAA,CAAMsB,OAAA,CAAQ1E,CAAA,KAAmC,MAArBA,CAAA,CAAUW,MAAA,IAEtCX,CAAA,CAAU6H,IAAA,CAAK7H,CAAA,CAAU,KAGtBA,CAAA,IAAa,CAAC,GAAG,MAAM,EAzHtC;MAAA;IAAA;MAAAc,GAAA;MAAAC,KAAA,EA8HI,SAAAA,CAAA;QACI,KAAKqzB,aAAA,CAAc,MAAM,MAAM,KAClC;MAAA;IAAA,GAhIL;MAAAtzB,GAAA;MAAAC,KAAA,EAwII,SAAAA,CAAA;QAAsC,IAAAf,CAAA;QAClC6D,MAAA,CAAOmG,gBAAA,CAAiB,gBAAgB;UAChChK,CAAA,CAAKk0B,qBAAA,MACLniB,EAAA,CAAaZ,MAAA,CAAOnR,CAAA,CAAKi0B,kCAAA;QAAA,EAGpC;MAAA;IAAA,GA9IL;MAAAnzB,GAAA;MAAAC,KAAA,EAgKI,SAAAA,CAAA;QAAkF,IAApDf,CAAA,GAAAiF,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;UACpBzE,CAAA,IAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MADkE,SACxC,IAAIjD,IAAA,GAAO8O,OAAA;UAG3C3P,CAAA,GAAAwW,CAAA,CAAiD,KAAK0c,aAAA,IAAtD;UAAK5zB,CAAA,GAALU,CAAA;UAAoBE,CAAA,GAApBF,CAAA;UAA+BN,CAAA,GAA/BM,CAAA;UACIO,CAAA,GAAW,KAAK4yB,YAAA;UAEdvsB,CAAA,GACFlH,CAAA,IAAkBA,CAAA,GAAiB,KAAKf,IAAA,CAAKqQ,GAAA,CAAI3P,CAAA,GAAYK,CAAA,IAAkB2yB,EAAA;QAAA,CAG9EnyB,CAAA,KACCrB,CAAA,IAAYF,IAAA,CAAKqQ,GAAA,CAAI3P,CAAA,GAAYC,CAAA,IAAiB,KAAKszB,iBAAA,IACzDhsB,CAAA,IAEA1G,CAAA,GAAYsH,EAAA,IACZjH,CAAA,GAAWiH,EAAA,IACX9H,CAAA,GAAiBL,CAAA,IACTkB,CAAA,KACRA,CAAA,GAAWiH,EAAA;QAGf,IAAMX,CAAA,GAAiC,MAAlBvH,CAAA,KAAwBT,CAAA,IAAY+H,CAAA,GAA2BvH,CAAA,GAAYC,CAAA;UAC1FwH,CAAA,GAA2C,MAAnBpH,CAAA,GAAuB,IAAImB,IAAA,GAAO8O,OAAA,KAAYjQ,CAAA;QAK5E,OAHA,KAAK0zB,YAAA,CAAa7yB,CAAA,GAClB,KAAK0yB,aAAA,CAAc/yB,CAAA,EAAW2G,CAAA,EAAcC,CAAA,GAErC;UACH6Y,SAAA,EAAAzf,CAAA;UACAwf,QAAA,EAAAnf,CAAA;UACA8yB,qBAAA,EAAAvsB;QAAA,CAEP;MAAA;IAAA,KAjMLjI,CAAA;EAAA;EC0Cay0B,EAAA,GAQT5zB,CAAA,UAAAb,EAAYQ,CAAA,EAAmBW,CAAA,EAAuBE,CAAA,EAAoBR,CAAA;IAAiBJ,CAAA,OAAAT,CAAA,GAEvF,KAAK0P,IAAA,GAAO,cACZ,KAAKglB,SAAA,GAAY,UAAU10B,CAAA;MACvBA,CAAA,CAAwB,UAACA,CAAA;QAAwB,IAAAS,CAAA,EAAAiB,CAAA,EAAAqG,CAAA,EAAAC,CAAA,EAAAC,CAAA;QAC7C,IAAoB,YAAhBjI,CAAA,CAAMwvB,KAAA,KAAsBhvB,CAAA,CAASm0B,QAAA,EAAU,OAAO30B,CAAA;QACrDA,CAAA,CAAM40B,IAAA,KAAM50B,CAAA,CAAM40B,IAAA,GAAO;QAE9B,IAAM1sB,CAAA,GAAO1H,CAAA,CAASqX,MAAA,CAAOgd,OAAA,IAAWr0B,CAAA,CAASqX,MAAA,CAAOid,QAAA;QACxD90B,CAAA,CAAM40B,IAAA,CAAK,wBAAwB1sB,CAAA,GAAO,aAAa1H,CAAA,CAAS4a,eAAA,IAC5D5a,CAAA,CAASu0B,uBAAA,OACT/0B,CAAA,CAAM40B,IAAA,CAAK,2BAA2Bp0B,CAAA,CAASw0B,sBAAA,CAAuB;UAAEC,aAAA,GAAe;QAAA;QAG3F,IAAMjkB,CAAA,IAAa,UAAAvQ,CAAA,GAAAT,CAAA,CAAMk1B,SAAA,UAAN,MAAAz0B,CAAA,YAAAA,CAAA,CAAiBkrB,MAAA,KAAU;UAExCnU,CAAA,GAAoD;YAEtD2d,kBAAA,EAAkB,UAAAzzB,CAAA,GAAEsP,CAAA,CAAW,YAAb,MAAAtP,CAAA,YAAEA,CAAA,CAAeX,KAAA;YACnCq0B,eAAA,EAAe,UAAArtB,CAAA,GAAEiJ,CAAA,CAAW,YAAb,MAAAjJ,CAAA,YAAEA,CAAA,CAAesC,IAAA;YAChCgrB,oBAAA,EAAsBntB,CAAA,GAAO,aAAa1H,CAAA,CAAS4a,eAAA;YAEnDka,gBAAA,EAAkBt1B,CAAA,CAAMu1B,QAAA;YACxBC,iBAAA,EAAmBx1B,CAAA,CAAMk1B,SAAA;YACzBO,yBAAA,EAAyB,UAAAztB,CAAA,GAAEgJ,CAAA,CAAW,YAAb,MAAAhJ,CAAA,YAAEA,CAAA,CAAejH,KAAA;YAC1C20B,sBAAA,EAAsB,UAAAztB,CAAA,GAAE+I,CAAA,CAAW,YAAb,MAAA/I,CAAA,YAAEA,CAAA,CAAeoC,IAAA;YACvCsrB,YAAA,EAAc31B,CAAA,CAAM40B;UAAA;QAYxB,OATIzzB,CAAA,IAAgBE,CAAA,KAChBmW,CAAA,CAAIoe,WAAA,IACC/0B,CAAA,IAAU,sCACXM,CAAA,GACA,sBACAE,CAAA,GACA,YACArB,CAAA,CAAMu1B,QAAA,GACd/0B,CAAA,CAASwX,OAAA,CAAQ,cAAcR,CAAA,GACxBxX,CACV;MAAA;IAAA,CAER;EAAA;ECtDQ61B,EAAA,GAA2B,SAAAC,CAAC91B,CAAA;IAChC+1B,OAAA,IAAYA,OAAA,CAAQC,OAAA,IACrBjxB,OAAA,CAAQ4X,IAAA,CAAK;IAGjB,IAAMnc,CAAA,GAAc,SAAAy1B,CAACz1B,CAAA,EAA2BW,CAAA;MACvCX,CAAA,CAAIyJ,KAAA,CAAMisB,MAAA,IAAU11B,CAAA,CAAIyJ,KAAA,CAAMksB,WAAA,KAAgBn2B,CAAA,CAAQob,eAAA,MAEvDpb,CAAA,CAAQo2B,KAAA,IAER51B,CAAA,CAAIyJ,KAAA,CAAMisB,MAAA,IAAU11B,CAAA,CAAIyJ,KAAA,CAAMisB,MAAA,KAAWl2B,CAAA,CAAQob,eAAA,OACjDpb,CAAA,CAAQoU,QAAA,CAAS;QACbzC,WAAA,EAAanR,CAAA,CAAIyJ,KAAA,CAAMisB;MAAA,IAE3Bl2B,CAAA,CAAQ8e,kBAAA;MAGZ,IAAMre,CAAA,GAAuBT,CAAA,CAAQq2B,2BAAA,CAA4Bl1B,CAAA,EAAWX,CAAA,CAAIyJ,KAAA,CAAM2C,UAAA;MAEtF,OADApM,CAAA,CAAIyJ,KAAA,CAAM2C,UAAA,GAAarJ,MAAA,CAAOke,MAAA,CAAO,IAAIhhB,CAAA,EAAsBD,CAAA,CAAIyJ,KAAA,CAAM2C,UAAA,GAClEpM,CAAA;IAAA;IAGX,OAAO;MACHkP,IAAA,EAAM;MACNrF,IAAA,EAAM;MACNisB,OAAA,EAAS;MACTC,QAAA,EAAU,SAAAA,CAAA;QAAA,QAAM,CAJb;MAAA;MAOH5iB,IAAA,EAAM,SAAAA,CAAA;QAAA,OAAMoiB,OAAA,CAAQC,OAAA,EAPjB;MAAA;MAQHQ,KAAA,EAAO,SAAAA,CAACx2B,CAAA;QAAD,OAASQ,CAAA,CAAYR,CAAA,EAAKA,CAAA,CAAIiK,KAAA,CAAMA,KAAA,CARxC;MAAA;MASHwsB,IAAA,EAAM,SAAAA,CAACz2B,CAAA;QAAD,OAASQ,CAAA,CAAYR,CAAA,EAAK,YAT7B;MAAA;MAUH02B,QAAA,EAAU,SAAAA,CAAC12B,CAAA;QAAD,OAASQ,CAAA,CAAYR,CAAA,EAAK,YAVjC;MAAA;MAWH6I,MAAA,EAAQ,SAAAA,CAAC7I,CAAA;QAAD,OAASQ,CAAA,CAAYR,CAAA,EAAK,UAA1B;MAAA;IAAA,CAEf;EAAA;EC/EY22B,EAAA,GAAb;IAAA,SAAA32B,EAAA;MAAAS,CAAA,OAAAT,CAAA,GAAA0B,CAAA,8BAGyB,EAHzB;IAAA;IAAA,OAAAb,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAKI,SAAAA,CAAA;QAGQ,KAAK61B,kBAAA,KACL,KAAKC,WAAA,GAAcluB,EAAA,KAEvB,KAAKiuB,kBAAA,IAAqB,CAC7B;MAAA;IAAA,GAZL;MAAA91B,GAAA;MAAAC,KAAA,EAcI,SAAAA,CAAA;QAKI,OAJK,KAAK81B,WAAA,KACN,KAAKA,WAAA,GAAcluB,EAAA,KAGhB,KAAKkuB,WACf;MAAA;IAAA,KApBL72B,CAAA;EAAA;ACFO,SAAS82B,GAAQ92B,CAAA;EACpB,OAAwB,sBAAV+2B,KAAA,IAAyBC,EAAA,CAAah3B,CAAA,EAAW+2B,KAAA,CAClE;AAAA;AAMM,SAASC,GAAah3B,CAAA,EAAoBQ,CAAA;EAC7C;IACI,OAAOR,CAAA,YAAqBQ,CADhC;EAAA,CAEE,QAAOR,CAAA;IACL,QAAO,CACV;EAAA;AACJ;AAEM,SAASi3B,GACZj3B,CAAA;EAEA,OAAqB,SAAdA,CAAA,IAA4C,aAArBmB,CAAA,CAAOnB,CAAA,KAA+C,qBAAdA,CACzE;AAAA;AAqBM,SAASk3B,GAAUl3B,CAAA,EAAoBQ,CAAA;EAC1C,OAAO+C,MAAA,CAAOF,SAAA,CAAUI,QAAA,CAASiC,IAAA,CAAK1F,CAAA,MAA0B,WAAAqF,MAAA,CAAA7E,CAAA,EAAhE,IACH;AAAA;AAMM,SAAS22B,GAAWn3B,CAAA;EACvB,OAAOk3B,EAAA,CAAUl3B,CAAA,EAAW,WAC/B;AAAA;ACvBD,IAAMo3B,EAAA,GAAuB;EACvBC,EAAA,GAAyB;EAEzBC,EAAA,GAAmB;AA0BzB,SAASC,GAAYv3B,CAAA,EAAkBQ,CAAA,EAAcW,CAAA,EAAiBV,CAAA;EAClE,IAAMY,CAAA,GAAoB;IACtByuB,QAAA,EAAA9vB,CAAA;IACAw3B,QAAA,EAAUh3B,CAAA;IACVi3B,MAAA,GAAQ;EAAA;EAWZ,YARe,MAAXt2B,CAAA,KACAE,CAAA,CAAMq2B,MAAA,GAASv2B,CAAA,QAGL,MAAVV,CAAA,KACAY,CAAA,CAAMs2B,KAAA,GAAQl3B,CAAA,GAGXY,CACV;AAAA;AAOD,IAAMu2B,EAAA,GACF;EACEC,EAAA,GAAkB;EAkClBC,EAAA,GACF;EACEC,EAAA,GAAiB;EA+BjBC,EAAA,GAAa;AA6FZ,IAAMC,EAAA,GA7CN;IAAuE,SAAAj4B,CAAA,GAAAiF,SAAA,CAAAtE,MAAA,EAAzCQ,CAAA,GAAyC,IAAAiC,KAAA,CAAApD,CAAA,GAAAS,CAAA,MAAAA,CAAA,GAAAT,CAAA,EAAAS,CAAA,IAAzCU,CAAA,CAAyCV,CAAA,IAAAwE,SAAA,CAAAxE,CAAA;IAC1E,IAAMY,CAAA,GAAgBF,CAAA,CAAQ+sB,IAAA,CAAK,UAACluB,CAAA,EAAGQ,CAAA;MAAJ,OAAUR,CAAA,CAAE,KAAKQ,CAAA,CAAE,EAAnB;IAAA,GAAuB8X,GAAA,CAAI,UAACtY,CAAA;MAAD,OAAOA,CAAA,CAAE,EAAT;IAAA;IAE9D,OAAO,UAACA,CAAA;MAIJ,KAJmD,IAAhCmB,CAAA,GAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAY,GACzBxE,CAAA,GAAuB,IACvBI,CAAA,GAAQb,CAAA,CAAMgP,KAAA,CAAM,OAEjBtN,CAAA,GAAIP,CAAA,EAAWO,CAAA,GAAIb,CAAA,CAAMF,MAAA,EAAQe,CAAA,IAAK;QAC3C,IAAMqG,CAAA,GAAOlH,CAAA,CAAMa,CAAA;QAKnB,MAAIqG,CAAA,CAAKpH,MAAA,GAAS,OAAlB;UAMA,IAAMqH,CAAA,GAAcovB,EAAA,CAAqBnxB,IAAA,CAAK8B,CAAA,IAAQA,CAAA,CAAKtC,OAAA,CAAQ2xB,EAAA,EAAsB,QAAQrvB,CAAA;UAIjG,KAAIC,CAAA,CAAY0B,KAAA,CAAM,eAAtB;YAhB2C,IAAAzB,CAAA;cAAAC,CAAA,GAAAgU,CAAA,CAoBtB7a,CAAA;YApBsB;cAoB3C,KAAoC6G,CAAA,CAAAxG,CAAA,MAAAuG,CAAA,GAAAC,CAAA,CAAA/G,CAAA,IAAAgb,IAAA;gBAAA,IAC1BnL,CAAA,IAAQ,GADkB/I,CAAA,CAAAlH,KAAA,EACXiH,CAAA;gBAErB,IAAIgJ,CAAA,EAAO;kBACPvQ,CAAA,CAAOoH,IAAA,CAAKmJ,CAAA;kBACZ;gBACH;cACJ;YA3B0C,SAAAhR,CAAA;cAAAkI,CAAA,CAAAlI,CAAA,CAAAA,CAAA;YAAA;cAAAkI,CAAA,CAAAyP,CAAA;YAAA;YA6B3C,IAAIlX,CAAA,CAAOE,MAAA,IAAU02B,EAAA,EACjB;UAZH;QAlB0C;MAgC9C;MAED,OAzDD,UAAiBr3B,CAAA;QACpB,KAAKA,CAAA,CAAMW,MAAA,EACP,OAAO;QAGX,IAAMQ,CAAA,GAAanB,CAAA,CAAMiB,KAAA,CAAM,GAAGo2B,EAAA;QAIlC,OAFAl2B,CAAA,CAAW+2B,OAAA,IAEJ/2B,CAAA,CAAWmX,GAAA,CAAI,UAACtY,CAAA;UAAD,OAAAQ,CAAA,CAAAA,CAAA,KACfR,CAAA,GADe;YAElB8vB,QAAA,EAAU9vB,CAAA,CAAM8vB,QAAA,IAAY3uB,CAAA,CAAWA,CAAA,CAAWR,MAAA,GAAS,GAAGmvB,QAAA;YAC9D0H,QAAA,EAAUx3B,CAAA,CAAMw3B,QAAA,IAAY;UAAA,EAHV;QAAA,EAKzB;MAAA,CA2Cc,CAAQ/2B,CAAA;IAAA,CAEtB;EAAA,EAEiCyE,KAAA,SA/DK,CApEe,CA5E9B,IAiDU,UAAClF,CAAA;IAC/B,IAAMQ,CAAA,GAAQo3B,EAAA,CAAYtuB,IAAA,CAAKtJ,CAAA;IAE/B,IAAIQ,CAAA,EAAO;MAGP,IAFeA,CAAA,CAAM,MAAmC,MAA7BA,CAAA,CAAM,GAAGgE,OAAA,CAAQ,SAEhC;QACR,IAAMrD,CAAA,GAAW02B,EAAA,CAAgBvuB,IAAA,CAAK9I,CAAA,CAAM;QAExCW,CAAA,KAEAX,CAAA,CAAM,KAAKW,CAAA,CAAS,IACpBX,CAAA,CAAM,KAAKW,CAAA,CAAS,IACpBX,CAAA,CAAM,KAAKW,CAAA,CAAS,GAVrB;MAAA;MAgBP,IAAAV,CAAA,GAAAkX,CAAA,CAAyBwgB,EAAA,CAA8B33B,CAAA,CAAM,MAAM82B,EAAA,EAAkB92B,CAAA,CAAM,KAA3F;QAAOa,CAAA,GAAPZ,CAAA;MAEA,OAAO82B,EAAA,CAFP92B,CAAA,KAE6BY,CAAA,EAAMb,CAAA,CAAM,MAAMA,CAAA,CAAM,UAAK,GAAWA,CAAA,CAAM,MAAMA,CAAA,CAAM,UAAK,EAC/F;IAAA;EAGJ,IAsCoD,CA9G9B,IAmFU,UAACR,CAAA;IAC9B,IAAMQ,CAAA,GAAQs3B,EAAA,CAAWxuB,IAAA,CAAKtJ,CAAA;IAE9B,IAAIQ,CAAA,EAAO;MAEP,IADeA,CAAA,CAAM,MAAMA,CAAA,CAAM,GAAGgE,OAAA,CAAQ,cAAc,GAC9C;QACR,IAAMrD,CAAA,GAAW42B,EAAA,CAAezuB,IAAA,CAAK9I,CAAA,CAAM;QAEvCW,CAAA,KAEAX,CAAA,CAAM,KAAKA,CAAA,CAAM,MAAM,QACvBA,CAAA,CAAM,KAAKW,CAAA,CAAS,IACpBX,CAAA,CAAM,KAAKW,CAAA,CAAS,IACpBX,CAAA,CAAM,KAAK,GAElB;MAAA;MAED,IAAIC,CAAA,GAAWD,CAAA,CAAM;QACjBa,CAAA,GAAOb,CAAA,CAAM,MAAM82B,EAAA;QAfhBz2B,CAAA,GAAA8W,CAAA,CAgBawgB,EAAA,CAA8B92B,CAAA,EAAMZ,CAAA,GAhBjD;MAkBP,OAFEY,CAAA,GAhBKR,CAAA,KAkBA02B,EAAA,CAFC92B,CAAA,GAhBDI,CAAA,KAkBsBQ,CAAA,EAAMb,CAAA,CAAM,MAAMA,CAAA,CAAM,UAAK,GAAWA,CAAA,CAAM,MAAMA,CAAA,CAAM,UAAK,EAC/F;IAAA;EAGJ,IAcoD,CA3H9B,IAmHU,UAACR,CAAA;IAC9B,IAAMQ,CAAA,GAAQw3B,EAAA,CAAW1uB,IAAA,CAAKtJ,CAAA;IAE9B,OAAOQ,CAAA,GACD+2B,EAAA,CAAY/2B,CAAA,CAAM,IAAIA,CAAA,CAAM,MAAM82B,EAAA,GAAmB92B,CAAA,CAAM,IAAIA,CAAA,CAAM,MAAMA,CAAA,CAAM,UAAK,UACtF,CACT;EAAA;EA2GK23B,EAAA,GAAgC,SAAAC,CAACp4B,CAAA,EAAcQ,CAAA;IACjD,IAAMW,CAAA,IAA0D,MAAtCnB,CAAA,CAAKwE,OAAA,CAAQ;MACjC/D,CAAA,IAAiE,MAA1CT,CAAA,CAAKwE,OAAA,CAAQ;IAE1C,OAAOrD,CAAA,IAAqBV,CAAA,GACtB,EAC2B,MAAvBT,CAAA,CAAKwE,OAAA,CAAQ,OAAcxE,CAAA,CAAKgP,KAAA,CAAM,KAAK,KAAKsoB,EAAA,EAChDn2B,CAAA,GAAwC,oBAAAkE,MAAA,CAAA7E,CAAA,IAAqC,wBAAA6E,MAAA,CAAA7E,CAAA,KAEjF,CAACR,CAAA,EAAMQ,CAAA,CAChB;EAAA;EClQK63B,EAAA,GACF;EAuBEC,EAAA,GAAsB;AAgBrB,SAASC,GAAiBv4B,CAAA;EAI7B,IAAMQ,CAAA,GAAaR,CAAA,CAAGw4B,UAAA,IAAcx4B,CAAA,CAAGy4B,KAAA,IAAS;IAE1Ct3B,CAAA,GApBV,UAAoBnB,CAAA;MAChB,IAAIA,CAAA,EAAI;QACJ,IAA8B,mBAAnBA,CAAA,CAAG04B,WAAA,EACV,OAAO14B,CAAA,CAAG04B,WAAA;QAGd,IAAIJ,EAAA,CAAoBryB,IAAA,CAAKjG,CAAA,CAAG24B,OAAA,GAC5B,OAAO,CAEd;MAAA;MAED,OAAO,CACV;IAAA,CAQmB,CAAW34B,CAAA;EAE3B;IACI,OAAOi4B,EAAA,CAAmBz3B,CAAA,EAAYW,CAAA,CAD1C;EAAA,CAEE,QAAOnB,CAAA,GAER;EAED,OAAO,EACV;AAAA;AAED,SAAS44B,GAAyB54B,CAAA;EAC9B,IAAMQ,CAAA,GAAS+3B,EAAA,CAAiBv4B,CAAA;EAEhC,OAAO;IACHo1B,eAAA,EAAiBp1B,CAAA,CAAM0P,IAAA;IACvBylB,kBAAA,EAAoBn1B,CAAA,CAAM24B,OAAA;IAC1BE,0BAAA,EAA4BnoB,IAAA,CAAKQ,SAAA,CAAU1Q,CAAA;EAAA,CAElD;AAAA;AAcD,SAASs4B,GAA+B94B,CAAA;EAA4D,IAAxBQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAY;IAC9E9D,CAAA,GAAOoC,MAAA,CAAOuQ,IAAA,CAAK9T,CAAA;EAGzB,IAFAmB,CAAA,CAAK+sB,IAAA,KAEA/sB,CAAA,CAAKR,MAAA,EACN,OAAO;EAGX,KAAK,IAAIF,CAAA,GAAIU,CAAA,CAAKR,MAAA,EAAQF,CAAA,GAAI,GAAGA,CAAA,IAAK;IAClC,IAAMY,CAAA,GAAaF,CAAA,CAAKF,KAAA,CAAM,GAAGR,CAAA,EAAG4H,IAAA,CAAK;IACzC,MAAIhH,CAAA,CAAWV,MAAA,GAASH,CAAA,GAGxB,OAAIC,CAAA,KAAMU,CAAA,CAAKR,MAAA,IAGRU,CAAA,CAAWV,MAAA,IAAUH,CAAA,GAFjBa,CAAA,GAEJ,GAAAgE,MAAA,CAAiDhE,CAAA,CAAWJ,KAAA,CAAM,GAAGT,CAAA,GAA5E,MACH;EAAA;EAED,OAAO,EACV;AAAA;AASM,SAASu4B,GAA0F/4B,CAAA;EAAA,IAAAmB,CAAA,GAAAwW,CAAA,CAAA3X,CAAA;IAAvES,CAAA,GAAuEU,CAAA;IAAhEE,CAAA,GAAgEF,CAAA;IAAxDN,CAAA,GAAwDM,CAAA;IAAhDO,CAAA,GAAgDP,CAAA;IAAzC4G,CAAA,GAAyC5G,CAAA;IAElG6G,CAAA,GAGA;EAEJ,SAAc,MAAVD,CAAA,IAAwC,mBAAVtH,CAAA,EAAoB;IAClD,IAAIwH,CAAA,GAAO;MACPC,CAAA,GAAUzH,CAAA;MACRuQ,CAAA,GAASvQ,CAAA,CAAMiJ,KAAA,CAAM2uB,EAAA;IACvBrnB,CAAA,KACA/I,CAAA,GAAO+I,CAAA,CAAO,IACd9I,CAAA,GAAU8I,CAAA,CAAO,KAErBhJ,CAAA,GAAkB;MACdotB,eAAA,EAAiBntB,CAAA;MACjBktB,kBAAA,EAAoBjtB;IAAA,CAE3B;EAAA;EAED,IAAMsP,CAAA,GAAYzP,CAAA,IAAStH,CAAA;EAE3B,IAAI02B,EAAA,CAAW3f,CAAA,KFtGZ,UAAwBxX,CAAA;IAC3B,OAAOk3B,EAAA,CAAUl3B,CAAA,EAAW,eAC/B;EAAA,CEoGgC,CAAewX,CAAA,GAAY;IAIpD,IAAMI,CAAA,GAAeJ,CAAA;IAErB,IFpHD,UAA0BxX,CAAA;MAC7B,OAAO,WAAYA,CACtB;IAAA,CEkHW,CAAiBwX,CAAA,GACjBxP,CAAA,GAAkB4wB,EAAA,CAAyBphB,CAAA,OACxC;MACH,IAAM4W,CAAA,GAAOxW,CAAA,CAAalI,IAAA,KAASynB,EAAA,CAAWvf,CAAA,IAAgB,aAAa;QACrEyW,CAAA,GAAUzW,CAAA,CAAa+gB,OAAA,GAAb,GAAAtzB,MAAA,CAA0B+oB,CAAA,EAA1B,MAAA/oB,MAAA,CAAmCuS,CAAA,CAAa+gB,OAAA,IAAYvK,CAAA;MAC5EpmB,CAAA,GA3EZ,UAAmChI,CAAA;QAC/B,OAAO;UACHo1B,eAAA,EAAiB;UACjBD,kBAAA,EAAoBn1B;QAAA,CAE3B;MAAA,CAsE6B,CAA0BquB,CAAA,GAC5CrmB,CAAA,CAAgBotB,eAAA,GAAkB+B,EAAA,CAAWvf,CAAA,IAAgB,aAAa,gBAC1E5P,CAAA,CAAgBmtB,kBAAA,GAAqBntB,CAAA,CAAgBmtB,kBAAA,IAAsB9G,CAC9E;IAAA;IACG,UAAUzW,CAAA,KACV5P,CAAA,CAAegxB,4BAAA,GAAsC,GAAA3zB,MAAA,CAAAuS,CAAA,CAAaqhB,IAAA,EAhB1E;EAAA,OAkBO,IFpIJ,UAAsBj5B,CAAA;IACzB,OAAOk3B,EAAA,CAAUl3B,CAAA,EAAO,aAC3B;EAAA,CEkIc,CAAawX,CAAA,KAA6BA,CAAA,CAAyBpS,KAAA,EAC1E4C,CAAA,GAAkB4wB,EAAA,CAA0BphB,CAAA,CAAyBpS,KAAA,OAClE,IFjJJ,UAAiBpF,CAAA;IACpB,QAAQuD,MAAA,CAAOF,SAAA,CAAUI,QAAA,CAASiC,IAAA,CAAK1F,CAAA;MACnC,KAAK;MACL,KAAK;MACL,KAAK;QACD,QAAO;MACX;QACI,OAAOg3B,EAAA,CAAah3B,CAAA,EAAW+B,KAAA;IAAA;EAE1C,CEwIc,CAAQyV,CAAA,GACfxP,CAAA,GAAkB4wB,EAAA,CAAyBphB,CAAA,OACxC,IFrKJ,UAAuBxX,CAAA;IAC1B,OAAOk3B,EAAA,CAAUl3B,CAAA,EAAW,SAC/B;EAAA,CEmKc,CAAcwX,CAAA,KAAcsf,EAAA,CAAQtf,CAAA,GAAY;IAGvDxP,CAAA,GAvDR,UAAmChI,CAAA;MAC/B,OAAO;QACHo1B,eAAA,EAAiB0B,EAAA,CAAQ92B,CAAA,IAAaA,CAAA,CAAUk5B,WAAA,CAAYxpB,IAAA,GAAO;QACnEylB,kBAAA,eAAA9vB,MAAA,CAAiC,aAAf,yBAAkDyzB,EAAA,CAA+B94B,CAAA;MAAA,CAE1G;IAAA,CAkDyB,CADMwX,CAAA,GAExBxP,CAAA,CAAgBmxB,uBAAA,IAA0B,CAC7C;EAAA,OAEGnxB,CAAA,CAAgBotB,eAAA,GAAkBptB,CAAA,CAAgBotB,eAAA,IAAmB,SACrEptB,CAAA,CAAgBmtB,kBAAA,GAAqBntB,CAAA,CAAgBmtB,kBAAA,IAAsB3d,CAAA,EAC3ExP,CAAA,CAAgBmxB,uBAAA,IAA0B;EAG9C,OAAA34B,CAAA,CAAAA,CAAA,CAAAA,CAAA,CAAAA,CAAA,KACOwH,CAAA,GADP;IAGIotB,eAAA,EAAiBptB,CAAA,CAAgBotB,eAAA,IAAmB;IACpDD,kBAAA,EAAoBntB,CAAA,CAAgBmtB,kBAAA,IAAsB;EAAA,GACtD9zB,CAAA,GACE;IACI+3B,iBAAA,EAAmB/3B;EAAA,IAEvB,KACFR,CAAA,GAAS;IAAEw4B,iBAAA,EAAmBx4B;EAAA,IAAW,KACzCa,CAAA,GAAQ;IAAE43B,gBAAA,EAAkB53B;EAAA,IAAU,CAX9C,EAaH;AAAA;AC5LD,ICiEK63B,EAAA;EAKDC,EAAA;EAGAC,EAAA;EDvESC,EAAA,GAAb;IAQI,SAAA15B,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAAA0B,CAAA,sCAL+C,IAK/CA,CAAA,mDAJyE,IAIzEA,CAAA,yBAFI,KAG/B,KAAK2a,QAAA,GAAW7b,CACnB;IAAA;IAVL,OAAAK,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAYI,SAAAA,CAAA;QACI,IAAI,KAAKsb,QAAA,CAASlH,UAAA,CAAW,UAAU;UAAA,SAAAnV,CAAA,EAAAQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,EADvBQ,CAAA,GACuB,IAAAiC,KAAA,CAAA5C,CAAA,GAAAC,CAAA,MAAAA,CAAA,GAAAD,CAAA,EAAAC,CAAA,IADvBU,CAAA,CACuBV,CAAA,IAAAwE,SAAA,CAAAxE,CAAA;UAAA,CACnCT,CAAA,GAAA+E,OAAA,EAAQF,GAAA,CAAIK,KAAA,CAAAlF,CAAA,6CAAAqF,MAAA,CAA6ClE,CAAA,EAC5D;QAAA;MACJ;IAAA,GAhBL;MAAAL,GAAA;MAAAC,KAAA,EAkBI,SAAAA,CAAA;QAAiB,IAAAf,CAAA;QACb,IAAK,KAAKqnB,SAAA,OAAN,UAAArnB,CAAA,GAAsB4D,CAAA,CAAO4G,OAAA,UAA7B,MAAAxK,CAAA,KAAqBA,CAAA,CAAyB25B,wBAAA,GAIlD;UACI,KAAKC,sBAAA,GAAyBh2B,CAAA,CAAO4G,OAAA,EAErC5G,CAAA,CAAO4G,OAAA,GAAU;YAAqE,SAAAxK,CAAA,GAAAiF,SAAA,CAAAtE,MAAA,EAA/BH,CAAA,GAA+B,IAAA4C,KAAA,CAAApD,CAAA,GAAAmB,CAAA,MAAAA,CAAA,GAAAnB,CAAA,EAAAmB,CAAA,IAA/BX,CAAA,CAA+BW,CAAA,IAAA8D,SAAA,CAAA9D,CAAA;YAGlF,OAFA,KAAK04B,gBAAA,CAAiBr5B,CAAA,KAElB,KAAKo5B,sBAAA,IAEE,KAAKA,sBAAA,CAAuB10B,KAAA,CAAM,MAAM1E,CAAA,CAItD;UAAA,EAACqY,IAAA,CAAK,OACLjV,CAAA,CAAO4G,OAAA,CAAgBmvB,wBAAA,IAA2B,GAEpD,KAAKG,mCAAA,GAAsCl2B,CAAA,CAAOm2B,oBAAA,EAElDn2B,CAAA,CAAOm2B,oBAAA,GAAuB;YAGnB,SAAA/5B,CAAA,GAAAiF,SAAA,CAAAtE,MAAA,EADJQ,CAAA,GACI,IAAAiC,KAAA,CAAApD,CAAA,GAAAS,CAAA,MAAAA,CAAA,GAAAT,CAAA,EAAAS,CAAA,IADJU,CAAA,CACIV,CAAA,IAAAwE,SAAA,CAAAxE,CAAA;YACP,IAAMY,CAAA,GDgJf,UAA4FrB,CAAA;cAAA,IAAnDmB,CAAA,GAAmDwW,CAAA,CAAA3X,CAAA;gBAE3FS,CAAA,GAAiBU,CAAA;cACrB;gBAGQ,YAAYA,CAAA,GACZV,CAAA,GAAQU,CAAA,CAAG64B,MAAA,GAON,YAAY74B,CAAA,IAAM,YAAaA,CAAA,CAAW84B,MAAA,KAC/Cx5B,CAAA,GAASU,CAAA,CAAW84B,MAAA,CAAOD,MAAA,CAZnC;cAAA,CAcE,QAAOh6B,CAAA,GAjBsF;cAsB/F,IAAIqB,CAAA,GAGA;cAUJ,QARIA,CAAA,GADA41B,EAAA,CAAYx2B,CAAA,IACM;gBACd00B,kBAAA,EAAwE,oDAAA9vB,MAAA,CAAAmD,MAAA,CAAO/H,CAAA;cAAA,IAGjEs4B,EAAA,CAAkB,CAACt4B,CAAA,IAEzBy5B,kBAAA,IAAqB,GAErC15B,CAAA,CAAAA,CAAA,KACOa,CAAA,GADP;gBAGI+zB,eAAA,EAAkB/zB,CAAA,CAAgB+zB,eAAA,GAAkB;gBACpDD,kBAAA,EAAqB9zB,CAAA,CAAgB8zB,kBAAA,GACjC9zB,CAAA,CAAgB8zB,kBAAA,IAAuBh0B,CAAA,CAAW64B,MAAA,IAAUxxB,MAAA,CAAO/H,CAAA;cAAA,EAE9E;YAAA,CC1LwD,CAA+BU,CAAA;YAGxE,OAFA,KAAKg5B,kBAAA,CAAmB94B,CAAA,IAEpB,KAAKy4B,mCAAA,IAEE,KAAKA,mCAAA,CAAoC50B,KAAA,CAAMtB,CAAA,EAAQzC,CAAA,CAIrE;UAAA,EAAC0X,IAAA,CAAK,OACLjV,CAAA,CAAOm2B,oBAAA,CAA6BJ,wBAAA,IAA2B,CA/BrE;QAAA,CAgCE,QAAO35B,CAAA;UACL+E,OAAA,CAAQK,KAAA,CAAM,iDAAiDpF,CAAA,GAC/D,KAAKo6B,aAAA,EACR;QAAA;MACJ;IAAA,GA3DL;MAAAt5B,GAAA;MAAAC,KAAA,EA6DI,SAAAA,CAAA;QAAgB,IAAAf,CAAA,EAAAQ,CAAA;QAAA,KACwB,MAAhC,KAAKo5B,sBAAA,KACLh2B,CAAA,CAAO4G,OAAA,GAAU,KAAKovB,sBAAA,EACtB,KAAKA,sBAAA,GAAyB,OAElC,UAAA55B,CAAA,GAAQ4D,CAAA,CAAO4G,OAAA,UAAf,MAAAxK,CAAA,WAAOA,CAAA,CAAyB25B,wBAAA,OAEiB,MAA7C,KAAKG,mCAAA,KACLl2B,CAAA,CAAOm2B,oBAAA,GAAuB,KAAKD,mCAAA,EACnC,KAAKA,mCAAA,GAAsC,OAE/C,UAAAt5B,CAAA,GAAQoD,CAAA,CAAOm2B,oBAAA,UAAf,MAAAv5B,CAAA,WAAOA,CAAA,CAAsCm5B,wBAChD;MAAA;IAAA,GAzEL;MAAA74B,GAAA;MAAAC,KAAA,EA2EI,SAAAA,CAAA;QAAc,IAAAf,CAAA;QACV,SAAS,UAAAA,CAAA,GAAC4D,CAAA,CAAO4G,OAAA,UAAR,MAAAxK,CAAA,KAAAA,CAAA,CAAyB25B,wBAAA,CACrC;MAAA;IAAA,GA7EL;MAAA74B,GAAA;MAAAC,KAAA,EA+EI,SAAAA,CAAA;QAAY,IAAAf,CAAA;QACR,iBAAOA,CAAA,QAAKioB,aAAA,UAAZ,MAAAjoB,CAAA,IAAAA,CACH;MAAA;IAAA,GAjFL;MAAAc,GAAA;MAAAC,KAAA,EAmFI,SAAAA,CAAoBf,CAAA;QAChB,IAAMQ,CAAA,GAAgCR,CAAA,CAASq6B,qBAAA;QAE/C,IADA,KAAKpS,aAAA,KAAkBznB,CAAA,KAAiC,IAEnDy2B,EAAA,CAAYz2B,CAAA,KACb,sBAAsBA,CAAA,IACtB4C,KAAA,CAAMsB,OAAA,CAAQlE,CAAA,CAA8B85B,gBAAA,GAC9C;UACE,IAAMn5B,CAAA,GAAYX,CAAA,CAA8B85B,gBAAA;UAEhD,KAAKC,cAAA,GAAiBp5B,CAAA,CAAUmX,GAAA,CAAI,UAACtY,CAAA;YACjC,OAAO,IAAIqJ,MAAA,CAAOrJ,CAAA,CACrB;UAAA,EACJ;QAAA;QAEG,KAAKqnB,SAAA,MACL,KAAKmT,cAAA,IACL,KAAKC,QAAA,CAAS,gEAAgEj6B,CAAA,KAE9E,KAAKi6B,QAAA,CACD,qEACAj6B,CAAA,CAGX;MAAA;IAAA,GA3GL;MAAAM,GAAA;MAAAC,KAAA,EA6GI,SAAAA,CAAiBf,CAAA,EAAsBmB,CAAA;QACnC,IAAMV,CAAA,GAAkBs4B,EAAA,CAAkB/4B,CAAA;QAE1C,IAAI,KAAKu6B,cAAA,CAAepjB,IAAA,CAAK,UAACnX,CAAA;UAAD,OAAWA,CAAA,CAAMiG,IAAA,CAAKxF,CAAA,CAAgB00B,kBAAA,IAAsB,GAA5D;QAAA,IACzB,KAAKsF,QAAA,CAAS,6CAA6Ch6B,CAAA,OAD/D;UAKA,IAAMY,CAAA,GAAgBb,CAAA,CAAAA,CAAA,KAAQW,CAAA,GAAeV,CAAA;YAEvCI,CAAA,GAAc,KAAKwb,QAAA,CAASlH,UAAA,CAAW,cAAc,KAAKkH,QAAA,CAASlH,UAAA,CAAW;UACpF1U,CAAA,CAAgB40B,oBAAA,GAAuBx0B,CAAA,GAAc,aAAa,KAAKwb,QAAA,CAASjB,eAAA,IAEhF,KAAK+e,kBAAA,CAAmB94B,CAAA,CAPvB;QAAA;MAQJ;IAAA,GA3HL;MAAAP,GAAA;MAAAC,KAAA,EAgII,SAAAA,CAAmBf,CAAA;QACf,KAAKqc,QAAA,CAASrE,OAAA,CAAQ,cAAchY,CAAA,EAAY;UAC5CukB,SAAA,EAAW;UACX/G,MAAA,EAAQ;UACRmD,QAAA,EAtIyB;UAuIzB6D,WAAA,GAAa;UACbC,SAAA,EAAW;QAAA,EAElB;MAAA;IAAA,KAxILzkB,CAAA;EAAA;EEJa06B,EAAA,GAAb;IAGI,SAAA16B,EAAYQ,CAAA;MAAmBC,CAAA,OAAAT,CAAA,GAC3B,KAAKqc,QAAA,GAAW7b,CACnB;IAAA;IALL,OAAAK,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EAOI,SAAAA,CAAWf,CAAA;QAA+C,IAAAQ,CAAA;UAArBW,CAAA,GAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;UAC3BxE,CAAA,GAAkB,KAAK4b,QAAA,CAASnH,YAAA,CAAarC,EAAA;QACnD,IAAKpS,CAAA,KAAmBU,CAAA,EAYpB,OAAOnB,CAAA,CAASS,CAAA;QAXhB,KAAK4b,QAAA,CAAStB,aAAA,CAAd,GAAA1V,MAAA,CACO,KAAKgX,QAAA,CAASlH,UAAA,CAAW,aAAkC,wBAAA9P,MAAA,MAAKgX,QAAA,CAASlH,UAAA,CAAW,WACvF,IACA;UAAEqI,MAAA,EAAQ;QAAA,GACV,UAACrc,CAAA;UACG,IAAMV,CAAA,GAAUU,CAAA,CAASw5B,OAAA;UAEzB,OADAn6B,CAAA,CAAK6b,QAAA,CAAS7I,WAAA,CAAYY,QAAA,CAA1B1S,CAAA,KAAsCmR,EAAA,EAAUpS,CAAA,IACzCT,CAAA,CAASS,CAAA;QAAA,EAM/B;MAAA;IAAA,GAvBL;MAAAK,GAAA;MAAAC,KAAA,EAyBI,SAAAA,CAAyBf,CAAA;QAA+C,IAAAQ,CAAA;UAArBW,CAAA,GAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;QAC/C,KAAK21B,UAAA,CAAW,UAACz5B,CAAA;UACb,IAeMV,CAAA,GAfgBU,CAAA,CAAQ8N,MAAA,CAAO,UAACjP,CAAA;YAClC,UAAUA,CAAA,CAAO66B,UAAA,IAAe76B,CAAA,CAAO86B,QAAA,CAC1C;UAAA,GAC6C7rB,MAAA,CAAO,UAACjP,CAAA;YAAW,IAAAQ,CAAA,EAAAW,CAAA;YAC7D,KAAKnB,CAAA,CAAO+6B,UAAA,EACR,QAAO;YAEX,IAAMt6B,CAAA,GAAW,UAAAD,CAAA,GAAAR,CAAA,CAAO+6B,UAAA,UAAP,MAAAv6B,CAAA,KAAAA,CAAA,CAAmB+lB,GAAA,IAC9B1iB,MAAA,CAAOwJ,QAAA,CAASX,IAAA,CAAKlI,OAAA,CAAQxE,CAAA,CAAO+6B,UAAA,CAAWxU,GAAA,KAAQ;cAEvDllB,CAAA,GAAgB,UAAAF,CAAA,GAAAnB,CAAA,CAAO+6B,UAAA,UAAP,MAAA55B,CAAA,KAAAA,CAAA,CAAmB65B,QAAA,IACnC92B,QAAA,CAAS+2B,aAAA,CAAcj7B,CAAA,CAAO+6B,UAAA,CAAWC,QAAA;YAE/C,OAAOv6B,CAAA,IAAYY,CACtB;UAAA,GACuD4N,MAAA,CAAO,UAACjP,CAAA;YAC5D,KAAKA,CAAA,CAAOk7B,eAAA,KAAoBl7B,CAAA,CAAOm7B,kBAAA,EACnC,QAAO;YAEX,IAAMh6B,CAAA,IAAkBnB,CAAA,CAAOk7B,eAAA,IACzB16B,CAAA,CAAK6b,QAAA,CAAS4B,YAAA,CAAamd,gBAAA,CAAiBp7B,CAAA,CAAOk7B,eAAA;cAEnDz6B,CAAA,IAAqBT,CAAA,CAAOm7B,kBAAA,IAC5B36B,CAAA,CAAK6b,QAAA,CAAS4B,YAAA,CAAamd,gBAAA,CAAiBp7B,CAAA,CAAOm7B,kBAAA;YAEzD,OAAOh6B,CAAA,IAAmBV,CAC7B;UAAA;UAED,OAAOT,CAAA,CAASS,CAAA,CA7BpB;QAAA,GA8BGU,CAAA,CACN;MAAA;IAAA,KAzDLnB,CAAA;EAAA;AAAA,WDmEKA,CAAA;EAAAA,CAAA,CAAAA,CAAA,CAAAq7B,WAAA,uBAAAr7B,CAAA,CAAAA,CAAA,CAAAs7B,YAAA;AAAA,EAAA/B,EAAA,KAAAA,EAAA;AAaL,IAAMgC,EAAA,GAAS,SAAAC,CAAA;EACTC,EAAA,GAAc;EAEdC,EAAA,GAAwB;EAOxBC,EAAA,GAAU/3B,CAAA,CAAOsuB,cAAA,IAAkB,qBAAqB,IAAIA,cAAA;EAK9D0J,EAAA,IAAoBD,EAAA,KAA0C,MAA/Bx3B,CAAA,CAAUK,OAAA,CAAQ,YAAoD,MAAlCL,CAAA,CAAUK,OAAA,CAAQ;EAEnFq3B,EAAA,GAAgB,SAAAC,CAAA;IAAA,IAAA97B,CAAA,EAAAQ,CAAA,EAAAW,CAAA;IAAA,OAAsB;MACxC2zB,QAAA,EAAU;MACViH,UAAA,EAAY;MACZC,aAAA,EAAe;MACfnH,OAAA,EAAS;MACT1hB,KAAA,EAAO;MACP8oB,WAAA,GAAa;MACbC,SAAA,GAAW;MACXvnB,sBAAA,GAAoF,OAA5D,QAAA1Q,CAAA,cAAAjE,CAAA,GAAAiE,CAAA,CAAUoJ,QAAA,UAAV,MAAArN,CAAA,IAA8B,UAA9BQ,CAAA,GAAAR,CAAA,CAAoB4Q,QAAA,UAAU,MAAApQ,CAAA,QAA9B,IAA8BA,CAAA,CAAAgE,OAAA,CAAQ;MAC9DgP,WAAA,EAAa;MACbD,gBAAA,EAAkB;MAClB4oB,WAAA,EAAa;MACbC,MAAA,EAAQb,EAAA;MACRc,YAAA,GAAc;MACd/oB,sBAAA,EAAwB;MACxBgpB,aAAA,GAAe;MACfr2B,IAAA,GAAM;MACN4iB,OAAA,GAAS;MACT0T,gBAAA,GAAkB;MAClBC,iBAAA,GAAmB;MACnBC,KAAA,GAAO;MACPloB,iBAAA,EAAmB;MACnBmoB,OAAA,GAAS;MACTC,yBAAA,GAA2B;MAC3BloB,mBAAA,GAAqB;MACrBmoB,cAAA,GAAgB;MAChBC,4BAAA,OAA8B;MAC9BhoB,aAAA,EAA8C,cAA/B,QAAAjR,CAAA,IAAkB,UAAlBzC,CAAA,GAAAyC,CAAA,CAAQyJ,QAAA,UAAU,MAAAlM,CAAA,QAAlB,IAAkBA,CAAA,CAAA27B,QAAA;MACjC1L,EAAA,GAAI;MACJ2L,4BAAA,GAA8B;MAC9BC,8BAAA,GAAgC;MAChCC,kCAAA,EAAoC;MACpCC,+BAAA,EAAiC;MACjCC,gBAAA,GAAkB;MAClBC,kBAAA,EAAoB;MACpBC,WAAA,GAAa;MACbC,mBAAA,EAAqB;MACrBC,WAAA,EAAa,CArC2B;MAsCxCC,cAAA,EAAgB;MAChBC,qBAAA,GAAuB;MACvBC,gBAAA,GAAkB;MAClBC,4BAAA,EAA8B;MAC9BC,iBAAA,EAAmB,CA1CqB;MA2CxCC,2BAAA,GAA6B;MAC7BC,aAAA,GAAe;MACfC,uBAAA,GAAyB;MACzBC,gCAAA,GAAkC;MAClCC,YAAA,EAAc,SAAAA,CAACj+B,CAAA;QACX,IAAMQ,CAAA,GAAQ,sBAAsBR,CAAA,CAAI+oB,MAAA,GAAS,MAAM/oB,CAAA,CAAIk+B,UAAA;QAC3Dn5B,OAAA,CAAQK,KAAA,CAAM5E,CAAA,CAjDsB;MAAA;MAmDxC29B,aAAA,EAAe,SAAAA,CAACn+B,CAAA;QAAD,OAAUA,CAnDe;MAAA;MAqDxCo+B,UAAA,EAAY7C,EAAA;MACZ8C,gBAAA,GAAkB;MAClBC,mBAAA,OAAqB;MACrB5uB,IAAA,EAAM;MACN6uB,WAAA,EAAa;MACbC,SAAA,EAAW,CA1D6B;MA2DxCC,mBAAA,GAAqB;MACrB3K,4BAAA,EAA8B;IAAA,CA5DZ;EAAA;EAuEhB4K,EAAA,GAAe,SAAAC,CACjB3+B,CAAA,EACAQ,CAAA,EACAW,CAAA,EACAV,CAAA;IAEA,IAAIY,CAAA;MACER,CAAA,GACFM,CAAA,KAASu6B,EAAA,IAA0BjC,EAAA,GAAkCt4B,CAAA,GAAOs4B,EAAA,CAAet4B,CAAA,SAAQ,IAA/Cs4B,EAAA;MAClD/3B,CAAA,GAAmB;QACrBk9B,YAAA,GAAc;QACdC,QAAA,GAAU;MAAA;MAER92B,CAAA,GAAiB,SAAA+2B,CAAC9+B,CAAA;QAAD,OAAiD,UAACQ,CAAA;UAChEkB,CAAA,CAAiB1B,CAAA,MAClB0B,CAAA,CAAiB1B,CAAA,KAAgB,GAC7B0B,CAAA,CAAiBk9B,YAAA,IAAgBl9B,CAAA,CAAiBm9B,QAAA,KAClD,QAAAp+B,CAAA,IAAAA,CAAA,CAAiBD,CAAA;QAAA;MAAA;IAK7B,IAAIK,CAAA,IAAU24B,EAAA,KAAcD,EAAA,CAAS8B,WAAA,EACjCh6B,CAAA,GAAWR,CAAA,MACR;MACH,IAAIA,CAAA,KAAWiF,CAAA,CAASjF,CAAA,GAKpB,YAJAkE,OAAA,CAAQK,KAAA,CAAM,kCAAkCjE,CAAA;MAMpDE,CAAA,GAAW,IAAI09B,EAClB,CADkB,CAClB;IAAA;IAeD,IAbA19B,CAAA,CAAS29B,KAAA,CAAMh/B,CAAA,EAAOQ,CAAA,EAAQW,CAAA,EAAM4G,CAAA,CAAe,kBACnD1G,CAAA,CAAS2nB,OAAA,CAAQ4B,gBAAA,IAEjBvpB,CAAA,CAAS+f,gBAAA,GAAmB,IAAIb,EAAA,CAAiBlf,CAAA,GACjDA,CAAA,CAAS+f,gBAAA,CAAiBE,uBAAA,IAE1BjgB,CAAA,CAAS4nB,cAAA,GAAiB,IAAI7B,EAAA,CAAuB/lB,CAAA,GACrDA,CAAA,CAAS4nB,cAAA,CAAegW,uBAAA,IAExB59B,CAAA,CAAS6nB,oBAAA,GAAuB,IAAIwQ,EAAA,CAAkBr4B,CAAA,GAEtDA,CAAA,CAASgX,aAAA,GAAgBhX,CAAA,CAAS8T,UAAA,CAAW,gBAC7CL,EAAA,CAAYG,wBAAA,CAAyB5T,CAAA,GACjCyT,EAAA,CAAYE,qBAAA,EAAuB;MACnC3T,CAAA,CAASgX,aAAA,GAAgBhX,CAAA,CAAS8T,UAAA,CAAW;MAGxCL,EAAA,CAAY6D,iBAAA,CAAkBtX,CAAA,CAAS8T,UAAA,CAAW,UAFnC,KACQ,OAIhBL,EAAA,CAAY8D,kBAAA,KAIpB9D,EAAA,CAAYsD,IAAA,CAAK/W,CAAA,KAHjBA,CAAA,CAASgX,aAAA,IAAgB,GACzBzT,CAAA,CAAOC,GAAA,CAAI,kFAJXxD,CAAA,CAASgX,aAAA,IAAgB,GACzBzT,CAAA,CAAOC,GAAA,CAAI,+DAjDZ;IAAA;IAwEP,OAZAlF,CAAA,CAAOC,KAAA,GAAQD,CAAA,CAAOC,KAAA,IAASyB,CAAA,CAAS8T,UAAA,CAAW,eAI7B,MAAXtU,CAAA,IAA0BiF,CAAA,CAASjF,CAAA,MAG1CQ,CAAA,CAAS69B,cAAA,CAAex5B,IAAA,CAAKrE,CAAA,CAAS89B,MAAA,EAASt+B,CAAA,CAAes+B,MAAA,GAC9D99B,CAAA,CAAS69B,cAAA,CAAer+B,CAAA,IAG5BkH,CAAA,CAAe,WAAf,CAA2B1G,CAAA,GACpBA,CACV;EAAA;EAMY09B,EAAA,GAAb;IAgCI,SAAc/+B,EAAA;MAAA,IAAAQ,CAAA;MAAAC,CAAA,OAAAT,CAAA,GACV,KAAK6X,MAAA,GAASgkB,EAAA,IACd,KAAK1S,WAAA,GAAc,IACnB,KAAKnL,oBAAA,IAAuB,GAC5B,KAAKohB,iBAAA,GAAoB3K,EAAA,EACzB,KAAK4K,kBAAA,GAAqB;QAAA,OAAMxJ,EAAA,CAAyBr1B,CAAA;MAAA,GACzD,KAAK8+B,cAAA,GAAiB,IACtB,KAAKC,eAAA,GAAkB,IACvB,KAAK5K,QAAA,IAAW,GAChB,KAAK9S,yBAAA,QAA4B,GACjC,KAAKxJ,aAAA,QAAgB,GACrB,KAAKmnB,IAAA,GAAO,gBACZ,KAAKL,MAAA,GAAS,IAAI7kB,EAAA,CAAc,OAChC,KAAK2D,YAAA,GAAe,IAAI7B,EAAA,CAAoB,OAC5C,KAAK4M,OAAA,GAAU,IAAIS,EAAA,CAAQ,OAC3B,KAAKgW,iBAAA,GAAoB,IAAI9I,EAAA,IAC7B,KAAKgE,OAAA,GAAU,IAAID,EAAA,CAAe,OAGlC,KAAKrW,eAAA,QAAkB,GACvB,KAAKqb,aAAA,QAAgB,GACrB,KAAKC,WAAA,QAAc,GACnB,KAAKnsB,WAAA,QAAc,GACnB,KAAKoH,kBAAA,QAAqB,GAC1B,KAAK8G,cAAA,QAAiB,CAxD9B;IAAA;IAAA,OAAA7gB,CAAA,CAAAb,CAAA;MAAAc,GAAA;MAAAC,KAAA,EA6EI,SAAAA,CAAKf,CAAA,EAAeQ,CAAA,EAAiCW,CAAA;QACjD,IAAI2D,CAAA,CAAa3D,CAAA,GACb4D,OAAA,CAAQK,KAAA,CAAM,kEADlB;UAIA,IAAIjE,CAAA,KAASu6B,EAAA,EAAb;YAKA,IAAMj7B,CAAA,GAAoBi+B,EAAA,CAAa1+B,CAAA,EAAOQ,CAAA,EAAQW,CAAA,EAAM,UAACnB,CAAA;cACzDy5B,EAAA,CAAet4B,CAAA,IAAQnB,CAAA,EACvBA,CAAA,CAAS4/B,OAAA,EACZ;YAAA;YAGD,OAFAnG,EAAA,CAAet4B,CAAA,IAAQV,CAAA,EAEhBA,CARN;UAAA;UAFGsE,OAAA,CAAQK,KAAA,CAAM,6FAFjB;QAAA;MAjFT;IAAA;MAAAtE,GAAA;MAAAC,KAAA,EA6GI,SAAAA,CACIf,CAAA;QAII,IAAAmB,CAAA;UAAAV,CAAA;UAAAY,CAAA;UAHJR,CAAA,GAAAoE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAAiC;UACjCvD,CAAA,GAEIuD,SAAA,CAAAtE,MAAA,OAAAsE,SAAA;UADJ8C,CAAA,GACI9C,SAAA,CAAAtE,MAAA,OAAAsE,SAAA;QACJ,KAAK0vB,QAAA,IAAW,GAChB,KAAK9c,MAAA,GAAS,IACd,KAAKgoB,iBAAA,GAAoB;QAOzB,IA0BkD73B,CAAA;UA1B5CC,CAAA,GAAmB;YAAE63B,eAAA,GAAiB;YAAOjB,QAAA,GAAU;UAAA;UACvD32B,CAAA,GAAqB,SAAA63B,CAAC//B,CAAA;YAAD,OAAiD;cAInEiI,CAAA,CAAiBjI,CAAA,MAClBiI,CAAA,CAAiBjI,CAAA,KAAgB,GAC7BiI,CAAA,CAAiB63B,eAAA,IAAmB73B,CAAA,CAAiB42B,QAAA,KACrD,QAAA92B,CAAA,IAAAA,CAAA,CAAe1G,CAAA;YAAA;UAAA;QAAA,CAK3B,KAAK2+B,UAAA,CACDp6B,CAAA,CAAQ,CAAD,GAAKi2B,EAAA,IAAiBh7B,CAAA,EAAQ;UACjC6O,IAAA,EAAMhO,CAAA;UACNyR,KAAA,EAAOnT,CAAA;UACPu+B,WAAA,GAAc78B,CAAA,KAASg6B,EAAA,GAAwBh6B,CAAA,GAAOg6B,EAAA,GAAwB,MAAMh6B,CAAA,IAAQ;QAAA,KAIpG,KAAK89B,IAAA,GAAO,gBAKR,QAAA57B,CAAA,cAAAzC,CAAA,GAAAyC,CAAA,CAAQuf,KAAA,gBAAAhiB,CAAA,IAAAA,CAAA,CAAOiiB,MAAA,IAAU,QAAAxf,CAAA,IAAAA,CAAA,CAAQwe,WAAA,MAGjC,KAAKP,yBAAA,GAA4B,QAAAje,CAAA,cAAAoE,CAAA,GAAApE,CAAA,CAAQuf,KAAA,UAAR,MAAAnb,CAAA,YAAAA,CAAA,CAAesuB,OAAA;QAmCpD,IAhCA,KAAKjS,eAAA,GAAkB,IAAIuH,EAAA,CAAe,KAAKzW,UAAA,CAAW,sBAC1D,KAAKuqB,aAAA,GAAgB,IAAItU,EAAA,CAAa,KAAK/G,eAAA,EAAiB,KAAK4b,oBAAA,CAAqBpnB,IAAA,CAAK,QAC3F,KAAK8mB,WAAA,GAAc,IAAI9M,EAAA,CAAW,KAAKxO,eAAA,EAAiB,KAAKlP,UAAA,CAAW,kBACxE,KAAKmqB,cAAA,GAAiB,IACtB,KAAKC,eAAA,GAAkB,IAEvB,KAAK/rB,WAAA,GAAc,IAAIN,EAAA,CAAmB,KAAK2E,MAAA,GAC/C,KAAK6J,cAAA,GAAiB,IAAI+R,EAAA,CAAiB,KAAK5b,MAAA,EAAQ,KAAKrE,WAAA,GAC7D,KAAKoH,kBAAA,GAC2B,qBAA5B,KAAK/C,MAAA,CAAOrE,WAAA,GACN,KAAKA,WAAA,GACL,IAAIN,EAAA,CAAJ1S,CAAA,CAAAA,CAAA,KAA4B,KAAKqX,MAAA,GAAjC;UAAyCrE,WAAA,EAAa;QAAA,KAEhE,KAAK0sB,UAAA,IAEDr/B,CAAA,CAAOs/B,OAAA,IAEP,KAAKtoB,MAAA,CAAOsmB,aAAA,GAAgB;UAAA,OAAMt9B,CAAA,CAAOs/B,OAAA,CAAQC,IAAA,GAAOjK,WAAA,EAA5B;QAAA,GAGxBt1B,CAAA,CAAOs/B,OAAA,CAAQC,IAAA,GAAOzwB,EAAA,OACtB,KAAKyE,QAAA,CAAS;UACVzC,WAAA,EAAa9Q,CAAA,CAAOs/B,OAAA,CAAQC,IAAA,GAAOzwB,EAAA;QAAA,IAEvC,KAAK6D,WAAA,CAAY6sB,cAAA,CAAe,gBAGpCx/B,CAAA,CAAOs/B,OAAA,CAAQ/rB,QAAA,CAAS,KAAKirB,kBAAA,IAAsBiB,IAAA,CAAKp4B,CAAA,CAAmB,uBAE3EA,CAAA,CAAmB,kBAAnB,SAGiC,iBAAjCzH,CAAA,GAAAI,CAAA,CAAO29B,SAAA,gBAAA/9B,CAAA,YAAAA,CAAA,CAAW8/B,UAAA,GAA0B;UAAA,IAAAvvB,CAAA;YAAAwG,CAAA;YACtCG,CAAA,GAAO,KAAKxC,UAAA,CAAW,gBAAhB,CAAiCxM,EAAA;YACxCiP,CAAA,GAAW,UAAA5G,CAAA,GAAAnQ,CAAA,CAAO29B,SAAA,UAAP,MAAAxtB,CAAA,IAAAA,CAAA,CAAkBwvB,cAAA,GAAiB7oB,CAAA,GAAO9W,CAAA,CAAO29B,SAAA,CAAU+B,UAAA;UAC5E,KAAK/sB,WAAA,CAAY6sB,cAAA,CAAiC,UAAlB7oB,CAAA,GAAA3W,CAAA,CAAO29B,SAAA,UAAW,MAAAhnB,CAAA,IAAAA,CAAA,CAAAgpB,cAAA,GAAiB,eAAe,cAClF,KAAKpsB,QAAA,CAAS;YACVzC,WAAA,EAAa9Q,CAAA,CAAO29B,SAAA,CAAU+B,UAAA;YAC9BllB,UAAA,EAAYzD;UAAA,EAEnB;QAAA;QAED,IAAI,KAAKgR,4BAAA,IAAgC;UAAA,IAAAwF,CAAA;YAAAC,CAAA;YAC/BnS,CAAA,GAAc3Y,MAAA,CAAOuQ,IAAA,EAAK,UAAAsa,CAAA,GAAAvtB,CAAA,CAAO29B,SAAA,UAAP,MAAApQ,CAAA,YAAAA,CAAA,CAAkBnQ,YAAA,KAAgB,IAC7DhP,MAAA,CAAO,UAACjP,CAAA;cAAD,IAAAQ,CAAA,EAAAW,CAAA;cAAA,SAAW,UAAAX,CAAA,GAACK,CAAA,CAAO29B,SAAA,UAAR,MAAAh+B,CAAA,IAAC,UAADW,CAAA,GAACX,CAAA,CAAkByd,YAAA,UAAlB,MAAA9c,CAAA,KAAAA,CAAA,CAAiCnB,CAAA,EADrC;YAAA,GAEf6e,MAAA,CACG,UAAC7e,CAAA,EAAuCQ,CAAA;cAAxC,IAAAW,CAAA,EAAAV,CAAA;cAAA,OACKT,CAAA,CAAIQ,CAAA,KAAO,UAAAW,CAAA,GAAAN,CAAA,CAAO29B,SAAA,UAAP,MAAAr9B,CAAA,IAAiC,UAAjCV,CAAA,GAAAU,CAAA,CAAkB8c,YAAA,UAAe,MAAAxd,CAAA,QAAjC,IAAiCA,CAAA,CAAAD,CAAA,OAAQ,GAAQR,CAJrD;YAAA,GAMZ,CANY;YAQdL,CAAA,GAAsB4D,MAAA,CAAOuQ,IAAA,EAAK,UAAAua,CAAA,GAAAxtB,CAAA,CAAO29B,SAAA,UAAP,MAAAnQ,CAAA,YAAAA,CAAA,CAAkBnQ,mBAAA,KAAuB,IAC5EjP,MAAA,CAAO,UAACjP,CAAA;cAAD,OAASkc,CAAA,CAAYlc,CAAA,CADL;YAAA,GAEvB6e,MAAA,CAAO,UAAC7e,CAAA,EAA+BQ,CAAA;cAAQ,IAAAW,CAAA,EAAAV,CAAA,EACMY,CAAA,EAAAK,CAAA;cAA9C,UAAAP,CAAA,GAAAN,CAAA,CAAO29B,SAAA,UAAP,MAAAr9B,CAAA,cAAAV,CAAA,GAAAU,CAAA,CAAkB+c,mBAAA,UAAlB,MAAAzd,CAAA,IAAAA,CAAA,CAAwCD,CAAA,MACxCR,CAAA,CAAIQ,CAAA,IAAJ,UAAAa,CAAA,GAAWR,CAAA,CAAO29B,SAAA,UAAlB,MAAAn9B,CAAA,IAAW,UAAXK,CAAA,GAAWL,CAAA,CAAkB6c,mBAAA,UAAlB,MAAAxc,CAAA,QAAX,IAAWA,CAAA,CAAwClB,CAAA;cAEvD,OAAOR,CANa;YAAA,GAOrB,CAPqB;UAS5B,KAAKie,YAAA,CAAaR,oBAAA,CAAqB;YAAEQ,YAAA,EAAc/B,CAAA;YAAagC,mBAAA,EAAAve;UAAA,EACvE;QAAA;QAED,KAAK,KAAKyb,eAAA,IAAmB;UAIzB,IAAM9a,CAAA,GAAO,KAAK6U,UAAA,CAAW,gBAAhB,CAAiCxM,EAAA;UAC9C,KAAK83B,aAAA,CACD;YACI9uB,WAAA,EAAarR,CAAA;YACb+a,UAAA,EAAY/a;UAAA,GAEhB,KAGJ,KAAKkT,WAAA,CAAY6sB,cAAA,CAAe,YAtHhC;QAAA;QA0HJz8B,CAAA,CAAOoG,gBAAA,IACHpG,CAAA,CAAOoG,gBAAA,CAAiB,gBAAgB02B,IAAA,GAAO,aAAa,UAAU,KAAKC,cAAA,CAAe9nB,IAAA,CAAK,QAInG3Q,CAAA,CAAmB,WAAnB,EAjPR;MAAA;IAAA;MAAApH,GAAA;MAAAC,KAAA,EAsPI,SAAAA,CAAA;QAII,KAAKkd,YAAA,CAAad,kBAAA,EAAmB;QAErC;UACI,KAAKhI,UAAA,CAAW,SAAhB,CAA0B,KAD9B;QAAA,CAEE,QAAOnV,CAAA;UACL+E,OAAA,CAAQK,KAAA,CAAM,4BAA4BpF,CAAA,CAC7C;QAAA;QAED,KAAK4gC,wBAAA,IAID,KAAKzrB,UAAA,CAAW,uBAChB,KAAK6C,OAAA,CAAQ,aAAa,IAAI;UAAEkC,cAAA,GAAgB;QAAA,IAM/C,KAAK/E,UAAA,CAAW,8BACjB,IAAIwT,EAAA,CAAO,MAAMjjB,IAAA,IAGrB,KAAKuY,YAAA,CAAa4iB,iBAAA,IAClB,KAAK5iB,YAAA,CAAad,kBAAA,EAAmB,EACxC;MAAA;IAAA,GAnRL;MAAArc,GAAA;MAAAC,KAAA,EAqRI,SAAAA,CAAA;QACS,KAAK+/B,uBAAA,MACF,KAAK3rB,UAAA,CAAW,uBAChB,KAAKuqB,aAAA,CAAcvU,IAAA,EAG9B;MAAA;IAAA,GA3RL;MAAArqB,GAAA;MAAAC,KAAA,EA6RI,SAAAA,CAAA;QAAoB,IAAAf,CAAA;QACX,KAAK8gC,uBAAA,MACN37B,CAAA,CAAW,KAAKo6B,eAAA,EAAiB,UAAC/+B,CAAA;UAC9BR,CAAA,CAAK+a,aAAA,CAAD7V,KAAA,CAAAlF,CAAA,EAAA4X,CAAA,CAAkBpX,CAAA,EACzB;QAAA,IAGL,KAAK++B,eAAA,GAAkB,IAEvB,KAAKqB,wBAAA,EACR;MAAA;IAAA,GAvSL;MAAA9/B,GAAA;MAAAC,KAAA,EAmTI,SAAAA,CAAkBf,CAAA,EAA4BQ,CAAA;QAC1C,IAAIsE,CAAA,CAAa9E,CAAA,GACb,OAAO;QAGX,IAAI27B,EAAA,EACA,OAAO,UAAUx6B,CAAA;UACbnB,CAAA,CAASmB,CAAA,EAAUX,CAAA;QAAA;QAMvB,IAAMW,CAAA,GAAM,KAAKq+B,IAAA;UACX/+B,CAAA,GAAgB,KAAKX,IAAA,CAAKI,KAAA,CAAsB,MAAhBJ,IAAA,CAAKuC,MAAA;UACrChB,CAAA,GAAkB,KAAK8T,UAAA,CAAW,iBAAiB,MAAM1U,CAAA,GAAgB;QAK/E,OAJAU,CAAA,CAAIV,CAAA,IAAiB,UAAUY,CAAA;UAAA,OACpBF,CAAA,CAAIV,CAAA,GACXT,CAAA,CAASqB,CAAA,EAAUb,CAAA;QAAA,GAEhBa,CAEd;MAAA;IAAA,GAzUL;MAAAP,GAAA;MAAAC,KAAA,EA2UI,SAAAA,CAAA;QACS,KAAKoU,UAAA,CAAW,uBAOjB,KAAKA,UAAA,CAAW,uBAAuB,KAAKA,UAAA,CAAW,wBACvD,KAAK6C,OAAA,CAAQ,eAEb,KAAK7C,UAAA,CAAW,wBAChB,KAAKuqB,aAAA,CAAcqB,mBAAA,IACnB,KAAK/oB,OAAA,CAAQ,oBAAoB,KAAKqM,eAAA,CAAgBwH,OAAA,IAE1D,KAAK6T,aAAA,CAAcsB,MAAA,IACnB,KAAKrB,WAAA,CAAYqB,MAAA,MAdT,KAAK7rB,UAAA,CAAW,uBAAuB,KAAKA,UAAA,CAAW,wBACvD,KAAK6C,OAAA,CAAQ,cAAc,MAAM;UAAEuM,SAAA,EAAW;QAAA,EAczD;MAAA;IAAA,GA5VL;MAAAzjB,GAAA;MAAAC,KAAA,EA8VI,SAAAA,CAAqBf,CAAA,EAAaQ,CAAA,EAA2BW,CAAA;QACzD,IAAMV,CAAA,GAAWiQ,IAAA,CAAKQ,SAAA,CAAU1Q,CAAA;QAChC,KAAKygC,gCAAA,CAAiCjhC,CAAA,EAAKS,CAAA,EAAUU,CAAA,IAAWs6B,EAAA,EAAaF,EAAA,CAChF;MAAA;IAAA,GAjWL;MAAAz6B,GAAA;MAAAC,KAAA,EAmWI,SAAAA,CACIf,CAAA,EACAmB,CAAA,EACAV,CAAA,EACAY,CAAA;QAEA,IAAyBR,CAAA,GE7lB1B,UACHb,CAAA,EACAmB,CAAA,EACAV,CAAA;YAEA,OAAIT,CAAA,KAAgBktB,EAAA,CAAYoD,MAAA,GAErB,CACHJ,EAAA,CAASC,EAAA,CAAQhvB,CAAA,GAAW;cAAE4uB,KAAA,EAAO;YAAA,IAAAvvB,CAAA,CAAAA,CAAA,KAChCC,CAAA,GAFF;cAEW8wB,IAAA,GAAM;cAAM2P,YAAA,EAAc;gBAAE/X,WAAA,EAAa+D,EAAA,CAAYoD;cAAA;YAAA,MAGhE,CAAC;cAAE9U,IAAA,EAAM1T,EAAA,CAAc3G,CAAA;YAAA,GAAaV,CAAA,CAElD;UAAA,CF+kBgC,CAA+B,KAAK0oB,WAAA,CEpmB1C+D,EAAA,CAAYoD,MAAA,IACxBpD,EAAA,CAAYoD,MAAA,GAEZpD,EAAA,CAAYqD,MAAA,EFimBwDpvB,CAAA,EAAUV,CAAA;UAArFiB,CAAA,GAAAiW,CAAA,CAAA9W,CAAA;UAAOkH,CAAA,GAAPrG,CAAA;UAAasG,CAAA,GAAbtG,CAAA;QACA,KAAKqZ,aAAA,CAAc/a,CAAA,EAAK+H,CAAA,EAAMC,CAAA,EAAU3G,CAAA,CAC3C;MAAA;IAAA,GA3WL;MAAAP,GAAA;MAAAC,KAAA,EA6WI,SAAAA,CAAcf,CAAA,EAAamB,CAAA,EAA2BV,CAAA,EAAqBY,CAAA;QACvE,IAAIu6B,EAAA,EACA,KAAK2D,eAAA,CAAgB13B,IAAA,CAAK,CAAC7H,CAAA,EAAKmB,CAAA,EAAMV,CAAA,EAASY,CAAA,QADnD;UAKA,IAAMR,CAAA,GAAkB;YACpB2c,MAAA,EAAQ,KAAKrI,UAAA,CAAW;YACxBoP,SAAA,EAAW,KAAKpP,UAAA,CAAW;YAC3B0T,OAAA,EAAS,KAAK1T,UAAA,CAAW;UAAA;UAG7B1U,CAAA,GAAUmF,CAAA,CAAQ/E,CAAA,EAAiBJ,CAAA,IAAW,CAA7B,IACZk7B,EAAA,KACDl7B,CAAA,CAAQ+c,MAAA,GAAS;UAGrB,IAAM9b,CAAA,GAAgB,gBAAgBkC,CAAA,CAAOG,SAAA,IAAmC,iBAAtBtD,CAAA,CAAQ8jB,SAAA;UAKlE,IAJAvkB,CAAA,GAAMkxB,EAAA,CAAelxB,CAAA,EAAKS,CAAA,CAAQygC,YAAA,IAAgB,IAAI;YAClD9P,EAAA,EAAI,KAAKjc,UAAA,CAAW;UAAA,IAGpBzT,CAAA,EAKA;YACIkC,CAAA,CAAOG,SAAA,CAAU0tB,UAAA,CAAWzxB,CAAA,EAAKsxB,EAAA,CAAenwB,CAAA,EAADX,CAAA,CAAAA,CAAA,KAAYC,CAAA,GAAZ;cAAqBgxB,UAAA,GAAY;YAAA,IADpF;UAAA,CAEE,QAAOzxB,CAAA;YACD,KAAKmV,UAAA,CAAW,YAChBpQ,OAAA,CAAQK,KAAA,CAAMpF,CAAA,CAErB;UAAA,OACE,IAAI27B,EAAA,EACP;YACIjK,EAAA,CAAI;cACAnL,GAAA,EAAKvmB,CAAA;cACLwb,IAAA,EAAMra,CAAA;cACNywB,OAAA,EAAS,KAAKzc,UAAA,CAAW;cACzBoW,OAAA,EAAS9qB,CAAA;cACT6qB,cAAA,EAAgB,KAAKjH,eAAA;cACrBwN,QAAA,EAAAxwB,CAAA;cACAywB,qBAAA,EAAuB;cACvBC,UAAA,EAAY,KAAK4N,WAAA;cACjB3N,UAAA,EAAY,KAAK7c,UAAA,CAAW;YAAA,EAVpC;UAAA,CAYE,QAAOnV,CAAA;YACL+E,OAAA,CAAQK,KAAA,CAAMpF,CAAA,CACjB;UAAA,OACE;YAAA,IAAA+H,CAAA;cACGC,CAAA,GAAS/D,CAAA,CAASmG,aAAA,CAAc;YACtCpC,CAAA,CAAOqC,IAAA,GAAO,mBACdrC,CAAA,CAAOm5B,KAAA,IAAQ,GACfn5B,CAAA,CAAOo5B,KAAA,IAAQ,GACfp5B,CAAA,CAAOsC,GAAA,GAAMtK,CAAA;YACb,IAAMiI,CAAA,GAAIhE,CAAA,CAASo9B,oBAAA,CAAqB,UAAU;YAClD,UAAAt5B,CAAA,GAAAE,CAAA,CAAEyC,UAAA,UAAF,MAAA3C,CAAA,IAAAA,CAAA,CAAc4C,YAAA,CAAa3C,CAAA,EAAQC,CAAA,CACtC;UAAA;QAtDA;MAuDJ;IAAA,GAxaL;MAAAnH,GAAA;MAAAC,KAAA,EAsbI,SAAAA,CAAef,CAAA;QAAiC,IACxCQ,CAAA;UADwCW,CAAA;UAEtCV,CAAA,GAAkC;UAClCY,CAAA,GAAkC;UAClCR,CAAA,GAAsC;QAC5CsE,CAAA,CAAWnF,CAAA,EAAO,UAACA,CAAA;UACXA,CAAA,KACAQ,CAAA,GAAUR,CAAA,CAAK,IACX8F,CAAA,CAAStF,CAAA,IACTK,CAAA,CAAgBgH,IAAA,CAAK7H,CAAA,IACE,qBAATA,CAAA,GACZA,CAAA,CAAa0F,IAAA,CAAKvE,CAAA,IACb2E,CAAA,CAAS9F,CAAA,KAAqB,YAAZQ,CAAA,GACzBC,CAAA,CAAYoH,IAAA,CAAK7H,CAAA,IAEjB8F,CAAA,CAAS9F,CAAA,MACuB,MAAhCQ,CAAA,CAAQgE,OAAA,CAAQ,cACkB,qBAA1BrD,CAAA,CAAaX,CAAA,IAErBK,CAAA,CAAgBgH,IAAA,CAAK7H,CAAA,IAErBqB,CAAA,CAAYwG,IAAA,CAAK7H,CAAA,EAG5B;QAAA;QAED,IAAM0B,CAAA,GAAU,SAAA4/B,CAAUthC,CAAA,EAA2BQ,CAAA;UACjD2E,CAAA,CACInF,CAAA,EACA,UAAUA,CAAA;YACN,IAAI8F,CAAA,CAAS9F,CAAA,CAAK,KAAK;cAEnB,IAAImB,CAAA,GAASX,CAAA;cACbmF,CAAA,CAAM3F,CAAA,EAAM,UAAUA,CAAA;gBAClBmB,CAAA,GAASA,CAAA,CAAOnB,CAAA,CAAK,IAAIkF,KAAA,CAAM/D,CAAA,EAAQnB,CAAA,CAAKiB,KAAA,CAAM,GACrD;cAAA,EACJ;YAAA,OAGG,KAAKjB,CAAA,CAAK,IAAIkF,KAAA,CAAM,MAAMlF,CAAA,CAAKiB,KAAA,CAAM,GAZvC;UAAA,GAeNT,CAAA;QAAA;QAIRkB,CAAA,CAAQjB,CAAA,EAAa,OACrBiB,CAAA,CAAQL,CAAA,EAAa,OACrBK,CAAA,CAAQb,CAAA,EAAiB,KAC5B;MAAA;IAAA,GAveL;MAAAC,GAAA;MAAAC,KAAA,EAyeI,SAAAA,CAAA;QAAwC,IAAAf,CAAA,EAAAQ,CAAA;QACpC,kBACKR,CAAA,QAAK6X,MAAA,CAAO2mB,SAAA,gBAAAx+B,CAAA,YAAAA,CAAA,CAAWie,YAAA,KAAgB1a,MAAA,CAAOuQ,IAAA,CAAP,UAAAtT,CAAA,GAAY,KAAKqX,MAAA,CAAO2mB,SAAA,UAAxB,MAAAh+B,CAAA,YAAYA,CAAA,CAAuByd,YAAA,EAActd,MAAA,GAAS,MAClG,CAEP;MAAA;IAAA,GA9eL;MAAAG,GAAA;MAAAC,KAAA,EA4fI,SAAAA,CAAKf,CAAA;QACD,KAAKk/B,cAAA,CAAe,CAACl/B,CAAA,EACxB;MAAA;IAAA,GA9fL;MAAAc,GAAA;MAAAC,KAAA,EA0gBI,SAAAA,CAAiBf,CAAA,EAAkBQ,CAAA;QAA+B,IAAAW,CAAA;QACnC,UAA3BA,CAAA,QAAK+nB,oBAAA,UAAsB,MAAA/nB,CAAA,IAAAA,CAAA,CAAA04B,gBAAA,CACvB,CAAC75B,CAAA,CAAU0P,IAAA,OAAM,QAAW,QAAW,GAAW1P,CAAA,GAClDQ,CAAA,CAEP;MAAA;IAAA,GA/gBL;MAAAM,GAAA;MAAAC,KAAA,EAmiBI,SAAAA,CACIf,CAAA,EACAQ,CAAA;QAEoB,IADpBW,CAAA,GAAA8D,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,MAAAA,SAAA,MAA0Bw2B,EAAA;QAI1B,IAAK,KAAK9G,QAAA,KAINxa,EAAA,CAAa,OAAM,IAAvB;UAIA,KAAKkK,eAAA,CAAgBC,IAAA,CAAK,YACP,gBAAftkB,CAAA,IACA,KAAKqkB,eAAA,CAAgBC,IAAA,CAAK;UAI9B,IAAM7jB,CAAA,IADNU,CAAA,GAAUA,CAAA,IAAWs6B,EAAA,EACIlX,SAAA;UAMzB,IALI9jB,CAAA,KACAU,CAAA,CAAQojB,SAAA,GAAY9jB,CAAA,GAIpBqE,CAAA,CAAa9E,CAAA,KAAqC,mBAAfA,CAAA,EACnC+E,OAAA,CAAQK,KAAA,CAAM,kDAIlB,KAAI6D,EAAA,CAAa9E,CAAA,GAAjB;YAKA,KAAKyW,kBAAA,CAAmB2mB,qBAAA,IAEpB,KAAKpsB,UAAA,CAAW,mBAChB,KAAKyF,kBAAA,CAAmB4mB,sBAAA,IAExB,KAAKrsB,UAAA,CAAW,oBAChB,KAAKyF,kBAAA,CAAmBC,oBAAA;YAG5B,IAAIxZ,CAAA,GAAsB;cACtBogC,IAAA,EAAM94B,EAAA,CAAM;cACZsB,KAAA,EAAOjK,CAAA;cACP4M,UAAA,EAAY,KAAKypB,2BAAA,CAA4Br2B,CAAA,EAAYQ,CAAA,IAAc;YAAA;YAGxD,gBAAfR,CAAA,KACAqB,CAAA,CAAIqZ,IAAA,GAAWvZ,CAAA,CAAOuZ,IAAA,EACtBrZ,CAAA,CAAIqgC,SAAA,GAAgBvgC,CAAA,CAAOugC,SAAA,IAG/BrgC,CAAA,GAAOmG,EAAA,CACHnG,CAAA,EACAF,CAAA,CAAQqjB,WAAA,GAAc,OAAO,KAAKrP,UAAA,CAAW,kCAE5CrT,SAAA,GAAYX,CAAA,CAAQW,SAAA,IAAa,IAAIE,IAAA,IAEtC,KAAKmT,UAAA,CAAW,YAChBvQ,CAAA,CAAOC,GAAA,CAAI,mBAAmBxD,CAAA;YAElC,IAAMR,CAAA,GAAW6P,IAAA,CAAKQ,SAAA,CAAU7P,CAAA;cAE1BK,CAAA,GAAM,KAAKyT,UAAA,CAAW,eAAehU,CAAA,CAAQwf,QAAA,IAAY;cAEzD5Y,CAAA,GAAoB5G,CAAA,KAAYs6B,EAAA;YActC,QAXI,KAAKtmB,UAAA,CAAW,uBACdpN,CAAA,KAAqB5G,CAAA,CAAQsjB,SAAA,IAC9BtjB,CAAA,CAAQ+Y,cAAA,GAIT,KAAK+mB,gCAAA,CAAiCv/B,CAAA,EAAKb,CAAA,EAAUM,CAAA,IAFrD,KAAKu+B,aAAA,CAAchN,OAAA,CAAQhxB,CAAA,EAAKL,CAAA,EAAMF,CAAA,GAK1C,KAAKwgC,mBAAA,CAAoB3hC,CAAA,EAAYqB,CAAA,GAE9BA,CAhFa;UAAA;QASnB;MAwEJ;IAAA,GAxnBL;MAAAP,GAAA;MAAAC,KAAA,EA0nBI,SAAAA,CAAgBf,CAAA;QACZ,KAAKs/B,cAAA,CAAez3B,IAAA,CAAK7H,CAAA,CAC5B;MAAA;IAAA,GA5nBL;MAAAc,GAAA;MAAAC,KAAA,EA8nBI,SAAAA,CAAoBf,CAAA,EAAmBQ,CAAA;QACnC,KAAKqX,MAAA,CAAOumB,UAAA,CAAWp+B,CAAA,EAAWQ,CAAA,GAClCmF,CAAA,CAAM,KAAK25B,cAAA,EAAgB,UAAC9+B,CAAA;UAAD,OAAcA,CAAA,CAASR,CAAA,CAAvB;QAAA,EAC9B;MAAA;IAAA,GAjoBL;MAAAc,GAAA;MAAAC,KAAA,EAmoBI,SAAAA,CAA4Bf,CAAA,EAAoBmB,CAAA;QAA0C,IAAAV,CAAA;UAEhFY,CAAA,GAAkB,KAAKmS,WAAA,CAAYouB,kBAAA,CAAmB5hC,CAAA;UACxDa,CAAA,GAAkBL,CAAA,KAAAW,CAAA;QAGtB,IAFAN,CAAA,CAAUsS,KAAA,GAAY,KAAKgC,UAAA,CAAW,UAEnB,gBAAfnV,CAAA,EAA4B;UAC5B,IAAM0B,CAAA,GAAgBlB,CAAA,CAAAA,CAAA,KAAQ,KAAKgT,WAAA,CAAY5G,UAAA,KAAiB,KAAKgO,kBAAA,CAAmBhO,UAAA;UAExF,OADA/L,CAAA,CAAU8Q,WAAA,GAAkBjQ,CAAA,CAAiBiQ,WAAA,EACtC9Q,CACV;QAAA;QAED,IAAMkH,CAAA,GAAiB+C,EAAA,CAAM8B,UAAA;QAE7B,IAAI,KAAK8U,cAAA,EAAgB;UACrB,IAAA1Z,CAAA,GAAgC,KAAK0Z,cAAA,CAAeC,6BAAA;YAA5C1Z,CAAA,GAAAD,CAAA,CAAA8Y,SAAA;YAAW5Y,CAAA,GAAAF,CAAA,CAAA6Y,QAAA;UACnBhgB,CAAA,CAAUsjB,WAAA,GAAkBlc,CAAA,EAC5BpH,CAAA,CAAUujB,UAAA,GAAiBlc,CAC9B;QAAA;QASD,IAPI,UAAJzH,CAAA,GAAI,KAAKwoB,cAAA,UAAL,MAAAxoB,CAAA,IAAAA,CAAA,CAAqB4mB,SAAA,KACF,gBAAfrnB,CAAA,IACA,KAAKy/B,iBAAA,CAAkBoC,UAAA,IAE3BhhC,CAAA,GAAa+E,CAAA,CAAQ/E,CAAA,EAAY;UAAEihC,YAAA,EAAc,KAAKrC,iBAAA,CAAkBsC,aAAA;QAAA,KAGzD,yBAAf/hC,CAAA,EAAqC;UACrC,IAAMgR,CAAA,GAAmB,KAAKwC,WAAA,CAAY5G,UAAA;UAI1C,OAFA/L,CAAA,CAAU8Q,WAAA,GAAkBX,CAAA,CAAiBW,WAAA,EAC7C9Q,CAAA,CAAUuM,YAAA,GAAmBrF,CAAA,CAAeqF,YAAA,EACrCvM,CAhC2E;QAAA;QAoCtF,SAA+B,MAApBQ,CAAA,EAAiC;UACxC,IAAMmW,CAAA,GAAiB,IAAIxV,IAAA,GAAO8O,OAAA,KAAYzP,CAAA;UAC9CR,CAAA,CAAUmhC,SAAA,GAAgBh2B,UAAA,EAAYwL,CAAA,GAAiB,KAAMyqB,OAAA,CAAQ,GAtCa;QAAA;QA8CtFphC,CAAA,GAAa+E,CAAA,CACT,IACAkF,EAAA,CAAM8B,UAAA,IACN,KAAK4G,WAAA,CAAY5G,UAAA,IACjB,KAAKgO,kBAAA,CAAmBhO,UAAA,IACxB/L,CAAA;QAGJ,IAAM8W,CAAA,GAAqB,KAAKxC,UAAA,CAAW;QACvCrP,CAAA,CAAS6R,CAAA,IACThS,CAAA,CAAMgS,CAAA,EAAoB,UAAU3X,CAAA;UAAA,OACzBa,CAAA,CAAWb,CAAA,CACrB;QAAA,KAED+E,OAAA,CAAQK,KAAA,CAAM,kDAAkDuS,CAAA;QAGpE,IAAMC,CAAA,GAAsB,KAAKzC,UAAA,CAAW;QAK5C,OAJIyC,CAAA,KACA/W,CAAA,GAAa+W,CAAA,CAAoB/W,CAAA,EAAYb,CAAA,IAG1Ca,CACV;MAAA;IAAA,GAxsBL;MAAAC,GAAA;MAAAC,KAAA,EAguBI,SAAAA,CAASf,CAAA,EAAwBQ,CAAA;QAC7B,KAAKgT,WAAA,CAAYY,QAAA,CAASpU,CAAA,EAAYQ,CAAA,CACzC;MAAA;IAAA,GAluBL;MAAAM,GAAA;MAAAC,KAAA,EA2vBI,SAAAA,CAAcf,CAAA,EAAwBQ,CAAA,EAA0BW,CAAA;QAC5D,KAAKqS,WAAA,CAAYitB,aAAA,CAAczgC,CAAA,EAAYQ,CAAA,EAAeW,CAAA,CAC7D;MAAA;IAAA,GA7vBL;MAAAL,GAAA;MAAAC,KAAA,EAsxBI,SAAAA,CAAqBf,CAAA;QACjB,KAAK4a,kBAAA,CAAmBxG,QAAA,CAASpU,CAAA,CACpC;MAAA;IAAA,GAxxBL;MAAAc,GAAA;MAAAC,KAAA,EA+xBI,SAAAA,CAAWf,CAAA;QACP,KAAKwT,WAAA,CAAY6K,UAAA,CAAWre,CAAA,CAC/B;MAAA;IAAA,GAjyBL;MAAAc,GAAA;MAAAC,KAAA,EAwyBI,SAAAA,CAAuBf,CAAA;QACnB,KAAK4a,kBAAA,CAAmByD,UAAA,CAAWre,CAAA,CACtC;MAAA;IAAA,GA1yBL;MAAAc,GAAA;MAAAC,KAAA,EA4yBI,SAAAA,CAAiBf,CAAA,EAAcQ,CAAA;QAC3B,KAAK4T,QAAA,CAAL1S,CAAA,KAAiB1B,CAAA,EAAOQ,CAAA,EAC3B;MAAA;IAAA,GA9yBL;MAAAM,GAAA;MAAAC,KAAA,EA0zBI,SAAAA,CAAef,CAAA,EAAaQ,CAAA;QACxB,OAAO,KAAKyd,YAAA,CAAaF,cAAA,CAAe/d,CAAA,EAAKQ,CAAA,CAChD;MAAA;IAAA,GA5zBL;MAAAM,GAAA;MAAAC,KAAA,EA00BI,SAAAA,CAAsBf,CAAA;QAClB,IAAMQ,CAAA,GAAU,KAAKyd,YAAA,CAAaikB,qBAAA,CAAsBliC,CAAA;QACxD;UACI,OAAO0Q,IAAA,CAAKD,KAAA,CAAMjQ,CAAA,CADtB;QAAA,CAEE,QAAMR,CAAA;UACJ,OAAOQ,CACV;QAAA;MACJ;IAAA,GAj1BL;MAAAM,GAAA;MAAAC,KAAA,EA61BI,SAAAA,CAAiBf,CAAA,EAAaQ,CAAA;QAC1B,OAAO,KAAKyd,YAAA,CAAamd,gBAAA,CAAiBp7B,CAAA,EAAKQ,CAAA,CAClD;MAAA;IAAA,GA/1BL;MAAAM,GAAA;MAAAC,KAAA,EAi2BI,SAAAA,CAAA;QACI,KAAKkd,YAAA,CAAaa,kBAAA,EACrB;MAAA;IAAA,GAn2BL;MAAAhe,GAAA;MAAAC,KAAA,EAs2BI,SAAAA,CAAmCf,CAAA,EAAaQ,CAAA;QAC5C,KAAKyd,YAAA,CAAakkB,kCAAA,CAAmCniC,CAAA,EAAKQ,CAAA,CAC7D;MAAA;IAAA,GAx2BL;MAAAM,GAAA;MAAAC,KAAA,EA22BI,SAAAA,CAAuBf,CAAA;QAAkE,IAA5BQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;QACzD,OAAO,KAAKgZ,YAAA,CAAamkB,sBAAA,CAAuBpiC,CAAA,EAAUQ,CAAA,CAC7D;MAAA;IAAA,GA72BL;MAAAM,GAAA;MAAAC,KAAA,EA23BI,SAAAA,CAAef,CAAA;QACX,OAAO,KAAKie,YAAA,CAAaokB,cAAA,CAAeriC,CAAA,CAC3C;MAAA;IAAA,GA73BL;MAAAc,GAAA;MAAAC,KAAA,EAg4BI,SAAAA,CAAWf,CAAA;QAAqD,IAA3BQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;QACjC,KAAK01B,OAAA,CAAQC,UAAA,CAAW56B,CAAA,EAAUQ,CAAA,CACrC;MAAA;IAAA,GAl4BL;MAAAM,GAAA;MAAAC,KAAA,EAq4BI,SAAAA,CAAyBf,CAAA;QAAqD,IAA3BQ,CAAA,GAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,OAAAA,SAAA;QAC/C,KAAK01B,OAAA,CAAQ2H,wBAAA,CAAyBtiC,CAAA,EAAUQ,CAAA,CACnD;MAAA;IAAA,GAv4BL;MAAAM,GAAA;MAAAC,KAAA,EAu7BI,SAAAA,CAASf,CAAA,EAA0BQ,CAAA,EAAkCW,CAAA;QAEjE,IAAKnB,CAAA,EAAL;UAKA,KAAKqkB,eAAA,CAAgBC,IAAA,CAAK;UAE1B,IAAM7jB,CAAA,GAAuB,KAAK2a,eAAA;UAGlC,IAFA,KAAKhH,QAAA,CAAS;YAAEkH,QAAA,EAAUtb;UAAA,KAErB,KAAKkV,YAAA,CAAa,eAAe;YAGlC,IAAM7T,CAAA,GAAYZ,CAAA;YAClB,KAAKggC,aAAA,CACD;cACIllB,0BAAA,GAA4B;cAC5BF,UAAA,EAAYha;YAAA,GAEhB,GArBqG;UAAA;UA0BzGrB,CAAA,KAAoBS,CAAA,IAAwBT,CAAA,KAAoB,KAAKkV,YAAA,CAAahD,EAAA,MAClF,KAAKmM,UAAA,CAAWnM,EAAA,GAChB,KAAKkC,QAAA,CAAS;YAAEzC,WAAA,EAAa3R;UAAA;UAGjC,IAAMa,CAAA,GAAyD,gBAAtC,KAAK2S,WAAA,CAAY+uB,cAAA;UAItCviC,CAAA,KAAoBS,CAAA,IAAwBI,CAAA,IAC5C,KAAK2S,WAAA,CAAY6sB,cAAA,CAAe,eAChC,KAAKroB,OAAA,CACD,aACA;YACIrG,WAAA,EAAa3R,CAAA;YACbgd,iBAAA,EAAmBvc;UAAA,GAEvB;YAAEia,IAAA,EAAMla,CAAA,IAAuB,CAA/B;YAAmCkhC,SAAA,EAAWvgC,CAAA,IAA2B;UAAA,IAI7E,KAAK8c,YAAA,CAAaukB,sBAAA,CAAuB/hC,CAAA,MAErCD,CAAA,IACA,KAAK2+B,MAAA,CAAOxuB,GAAA,CAAInQ,CAAA,GAEhBW,CAAA,IACA,KAAKg+B,MAAA,CAAOnkB,QAAA,CAAS7Z,CAAA,IAMzBnB,CAAA,KAAoBS,CAAA,KACpB,KAAKqe,kBAAA,IAEL,KAAKT,UAAA,CAAWvL,EAAA,EAzDnB;QAAA,OAFG/N,OAAA,CAAQK,KAAA,CAAM,sDA6DrB;MAAA;IAAA,GAv/BL;MAAAtE,GAAA;MAAAC,KAAA,EAkgCI,SAAAA,CAAMf,CAAA,EAAmBmB,CAAA,EAAkBV,CAAA;QACvC,IAAKT,CAAA,IAAcmB,CAAA,EAAnB;UAKA,KAAKkjB,eAAA,CAAgBC,IAAA,CAAK;UAE1B,IAAMjjB,CAAA,GAAiB,KAAKgc,SAAA;UAGxBhc,CAAA,CAAerB,CAAA,MAAemB,CAAA,IAC9B,KAAKshC,4BAAA,CAA6BziC,CAAA,GAGtC,KAAKoU,QAAA,CAAS;YAAEsuB,OAAA,EAAcliC,CAAA,CAAAA,CAAA,KAAAa,CAAA,GAAiB,IAAAK,CAAA,KAAA1B,CAAA,EAAYmB,CAAA;UAAA,IAEvDV,CAAA,KACA,KAAKuX,OAAA,CAAQ,kBAAkB;YAC3B2qB,WAAA,EAAa3iC,CAAA;YACb4iC,UAAA,EAAYzhC,CAAA;YACZ0hC,UAAA,EAAYpiC;UAAA,IAEhB,KAAKqiC,0BAAA,CAALphC,CAAA,KAAmC1B,CAAA,EAAYS,CAAA,KAK/CY,CAAA,CAAerB,CAAA,MAAemB,CAAA,IAAaV,CAAA,IAC3C,KAAKqe,kBAAA,EAzBR;QAAA,OAFG/Z,OAAA,CAAQK,KAAA,CAAM,oDA6BrB;MAAA;IAAA,GAjiCL;MAAAtE,GAAA;MAAAC,KAAA,EAsiCI,SAAAA,CAAA;QACI,KAAKqT,QAAA,CAAS;UAAEsuB,OAAA,EAAS;QAAA,IACzB,KAAKD,4BAAA,IAGL,KAAK3jB,kBAAA,EACR;MAAA;IAAA,GA5iCL;MAAAhe,GAAA;MAAAC,KAAA,EAmjCI,SAAAA,CAA4Bf,CAAA;QAAyD,IAAjCQ,CAAA,KAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,QAAAA,SAAA;QAChD,KAAKgZ,YAAA,CAAaxD,2BAAA,CAA4Bza,CAAA,EAAYQ,CAAA,CAC7D;MAAA;IAAA,GArjCL;MAAAM,GAAA;MAAAC,KAAA,EAujCI,SAAAA,CAAA;QACI,KAAKkd,YAAA,CAAa8kB,6BAAA,EACrB;MAAA;IAAA,GAzjCL;MAAAjiC,GAAA;MAAAC,KAAA,EAmkCI,SAAAA,CAA2Bf,CAAA;QAA6E,IAAjCQ,CAAA,KAAAyE,SAAA,CAAAtE,MAAA,mBAAAsE,SAAA,QAAAA,SAAA;QACnE,KAAKgZ,YAAA,CAAa6kB,0BAAA,CAA2B9iC,CAAA,EAAYQ,CAAA,CAC5D;MAAA;IAAA,GArkCL;MAAAM,GAAA;MAAAC,KAAA,EAukCI,SAAAA,CAA6Bf,CAAA;QACzB,KAAKie,YAAA,CAAawkB,4BAAA,CAA6BziC,CAAA,CAClD;MAAA;IAAA,GAzkCL;MAAAc,GAAA;MAAAC,KAAA,EA+kCI,SAAAA,CAAMf,CAAA;QACF,IAAMQ,CAAA,GAAY,KAAK0U,YAAA,CAAa;QACpC,KAAK1B,WAAA,CAAYwvB,KAAA,IACjB,KAAKpoB,kBAAA,CAAmBooB,KAAA,IACxB,KAAKxvB,WAAA,CAAY6sB,cAAA,CAAe,cAChC,KAAK3e,cAAA,CAAeuhB,cAAA;QACpB,IAAM9hC,CAAA,GAAO,KAAKgU,UAAA,CAAW,gBAAhB,CAAiCxM,EAAA;QAC9C,KAAK83B,aAAA,CACD;UACI9uB,WAAA,EAAaxQ,CAAA;UACbka,UAAA,EAAYrb,CAAA,GAAkBmB,CAAA,GAAOX;QAAA,GAEzC,GAEP;MAAA;IAAA,GA7lCL;MAAAM,GAAA;MAAAC,KAAA,EA+mCI,SAAAA,CAAA;QACI,OAAO,KAAKmU,YAAA,CAAa,cAC5B;MAAA;IAAA,GAjnCL;MAAApU,GAAA;MAAAC,KAAA,EAmnCI,SAAAA,CAAA;QACI,OAAO,KAAKmU,YAAA,CAAa,cAAc,EAC1C;MAAA;IAAA,GArnCL;MAAApU,GAAA;MAAAC,KAAA,EA8nCI,SAAAA,CAAA;QACI,OAAO,KAAK2gB,cAAA,CAAeC,6BAAA,EAA8B,GAAMb,SAClE;MAAA;IAAA,GAhoCL;MAAAhgB,GAAA;MAAAC,KAAA,EAyoCI,SAAAA,CAAuBf,CAAA;QACnB,IAAMQ,CAAA,GAAO,KAAKqX,MAAA,CAAOgd,OAAA,IAAW,KAAKhd,MAAA,CAAOid,QAAA;UAChD3zB,CAAA,GAA6C,KAAKugB,cAAA,CAAeC,6BAAA,EAA8B;UAAvFlhB,CAAA,GAAAU,CAAA,CAAA2f,SAAA;UAAWzf,CAAA,GAAAF,CAAA,CAAAqzB,qBAAA;UACf3zB,CAAA,GAAML,CAAA,GAAO,aAAaC,CAAA;QAC9B,IAAI,QAAAT,CAAA,IAAAA,CAAA,CAASi1B,aAAA,IAAiB5zB,CAAA,EAAuB;UAAA,IAAAK,CAAA;YAC3CqG,CAAA,aAAYrG,CAAA,GAAA1B,CAAA,CAAQkjC,iBAAA,gBAAAxhC,CAAA,GAAAA,CAAA,GAAqB;UAC/C,KAAKL,CAAA,EACD,OAAOR,CAAA;UAEX,IAAMmH,CAAA,GAAqBlI,IAAA,CAAKwuB,GAAA,CAC5BxuB,IAAA,CAAKI,KAAA,EAAO,IAAI8B,IAAA,GAAO8O,OAAA,KAAYzP,CAAA,IAAyB,OAAQ0G,CAAA,EACpE;UAEJlH,CAAA,IAAG,MAAAwE,MAAA,CAAU2C,CAAA,CAChB;QAAA;QAED,OAAOnH,CACV;MAAA;IAAA,GA1pCL;MAAAC,GAAA;MAAAC,KAAA,EAirCI,SAAAA,CAAMf,CAAA,EAAeQ,CAAA;QAIjB,OAAIR,CAAA,KAAU,KAAKkV,YAAA,CAAajD,EAAA,KAC5BrN,CAAA,CAAOU,QAAA,CAAS,qEACR,MAGRR,CAAA,CAAatE,CAAA,MACbA,CAAA,GAAW,KAAK4a,eAAA,KAEhBpb,CAAA,KAAUQ,CAAA,IACV,KAAK2iC,gBAAA,CAAiBjxB,EAAA,EAAclS,CAAA,GAC7B,KAAKgY,OAAA,CAAQ,iBAAiB;UAAEorB,KAAA,EAAOpjC,CAAA;UAAO2R,WAAA,EAAanR;QAAA,OAElEuE,OAAA,CAAQK,KAAA,CAAM,2DACd,KAAKsxB,QAAA,CAAS12B,CAAA,IACN,GAEf;MAAA;IAAA,GArsCL;MAAAc,GAAA;MAAAC,KAAA,EA40CI,SAAAA,CAAWf,CAAA;QACP,IAAMmB,CAAA,GAASX,CAAA,KAAQ,KAAKqX,MAAA;QACxB1R,CAAA,CAAUnG,CAAA,MACV4F,CAAA,CAAQ,KAAKiS,MAAA,EAAQ7X,CAAA,GAEhB,KAAKmV,UAAA,CAAW,wBACjB,KAAK0C,MAAA,CAAOtE,gBAAA,GAAmB,KAAKsE,MAAA,CAAOskB,WAAA,GAE1C,KAAKhnB,UAAA,CAAW,2BACjB,KAAK0C,MAAA,CAAOpD,mBAAA,GAAsB,KAAKoD,MAAA,CAAO+kB,cAAA,GAG9C,KAAKppB,WAAA,IACL,KAAKA,WAAA,CAAYI,aAAA,CAAc,KAAKiE,MAAA,GAEpC,KAAK+C,kBAAA,IACL,KAAKA,kBAAA,CAAmBhH,aAAA,CAAc,KAAKiE,MAAA,GAE3CxG,EAAA,CAAWf,YAAA,MAAiD,WAA/Be,EAAA,CAAWd,GAAA,CAAI,gBAC5C,KAAKsH,MAAA,CAAO4kB,KAAA,IAAQ,IAEpB,KAAKtnB,UAAA,CAAW,aAChBxV,CAAA,CAAOC,KAAA,IAAQ,IAGf,KAAKwhB,gBAAA,SAAgE,MAArCphB,CAAA,CAAO28B,yBAAA,IACnCx7B,CAAA,CAAUw7B,yBAAA,KAA8B38B,CAAA,CAAO28B,yBAAA,KAC3C38B,CAAA,CAAO28B,yBAAA,GACP,KAAKvb,gBAAA,CAAiBF,aAAA,KAEtB,KAAKE,gBAAA,CAAiBE,uBAAA,IAKzC;MAAA;IAAA,GA/2CL;MAAAxgB,GAAA;MAAAC,KAAA,EAq3CI,SAAAA,CAAA;QACI,KAAKi/B,UAAA,CAAW;UAAErD,yBAAA,GAA2B;QAAA,EAChD;MAAA;IAAA,GAv3CL;MAAA77B,GAAA;MAAAC,KAAA,EA63CI,SAAAA,CAAA;QACI,KAAKi/B,UAAA,CAAW;UAAErD,yBAAA,GAA2B;QAAA,EAChD;MAAA;IAAA,GA/3CL;MAAA77B,GAAA;MAAAC,KAAA,EAq4CI,SAAAA,CAAA;QAAmC,IAAAf,CAAA;QAC/B,mBAAAA,CAAA,GAAS,KAAKohB,gBAAA,gBAAAphB,CAAA,KAALA,CAAA,CAAuBqjC,OAAA,GACnC;MAAA;IAAA,GAv4CL;MAAAviC,GAAA;MAAAC,KAAA,EA84CI,SAAAA,CAAYf,CAAA;QACR,OAAO,KAAKgpB,OAAA,CAAQc,WAAA,CAAY9pB,CAAA,CACnC;MAAA;IAAA,GAh5CL;MAAAc,GAAA;MAAAC,KAAA,EAq5CI,SAAAA,CAA0Cf,CAAA;QAAgC,IAAAQ,CAAA;QACtE,OAAO,UAAPA,CAAA,GAAO,KAAKqX,MAAA,UAAL,MAAArX,CAAA,YAAAA,CAAA,CAAcR,CAAA,CACxB;MAAA;IAAA,GAv5CL;MAAAc,GAAA;MAAAC,KAAA,EA26CI,SAAAA,CAAaf,CAAA;QACT,OAAO,KAAKwT,WAAA,CAALJ,KAAA,CAA0BpT,CAAA,CACpC;MAAA;IAAA,GA76CL;MAAAc,GAAA;MAAAC,KAAA,EAk8CI,SAAAA,CAAmBf,CAAA;QACf,OAAO,KAAK4a,kBAAA,CAALxH,KAAA,CAAiCpT,CAAA,CAC3C;MAAA;IAAA,GAp8CL;MAAAc,GAAA;MAAAC,KAAA,EAs8CI,SAAAA,CAAA;QAAmB,IAAAf,CAAA;UACXQ,CAAA,aAAAR,CAAA,GAAO,KAAKmV,UAAA,CAAW,uBAAAnV,CAAA,GAAAA,CAAA,GAAW07B,EAAA;QAItC,OAHIl7B,CAAA,KAASk7B,EAAA,KACTl7B,CAAA,GAAOk7B,EAAA,GAAwB,MAAMl7B,CAAA,GAElCA,CA38Cf;MAAA;IAAA;MAAAM,GAAA;MAAAC,KAAA,EA+8CI,SAAAA,CAAA;QACgG,mBAA1D,KAAKoU,UAAA,CAAW,yCAGjB9D,EAAA,CAAWf,YAAA,QACnC,KAAKgzB,sBAAA,MAA4B,KAAKA,sBAAA,CAAuB;UAAEC,gBAAA,EAAkB;QAAA,MAClF,KAAKC,gBAAA,CAAiB;UAAEC,kBAAA,GAAoB;QAAA,KAE3C,KAAK3C,uBAAA,MAA6B,KAAKA,uBAAA,CAAwB;UAAEyC,gBAAA,EAAkB;QAAA,MACpF,KAAKG,iBAAA,CAAkB;UAAEC,iBAAA,GAAmB;QAAA,IAEhD,KAAKC,0BAAA,CAA2B;UAC5BL,gBAAA,EAAkB;UAClBE,kBAAA,GAAoB;QAAA,KAKxB,KAAK3C,uBAAA,KACL,KAAK+C,wBAAA,CAAyB;UAAEF,iBAAA,GAAmB;QAAA,KAMlD,KAAKL,sBAAA,OACL,KAAKnuB,UAAA,CAAW,oCAAmC9E,EAAA,CAAYE,GAAA,CAAI,iBAEpEF,EAAA,CAAYc,MAAA,CAAO,cACnB,KAAKuyB,iBAAA,CAAkB;UACnBC,iBAAA,EAAmB,KAAKxuB,UAAA,CAAW;QAAA,GAG9C;MAAA;IAAA,GAh/CL;MAAArU,GAAA;MAAAC,KAAA,EAw/CI,SAAAA,CAAyBf,CAAA;QACrB,IAAIQ,CAAA;QACJ,IAAIR,CAAA,IAAWA,CAAA,CAAO2jC,iBAAA,EAClBnjC,CAAA,IAAW,OACR;UAAA,KAAIR,CAAA,KAAWA,CAAA,CAAOyjC,kBAAA,EAGzB;UAFAjjC,CAAA,IAAW,CAGd;QAAA;QAEI,KAAK2U,UAAA,CAAW,0BAA0B,KAAK3B,WAAA,CAAYO,QAAA,KAAavT,CAAA,IACzE,KAAKgT,WAAA,CAAYgB,YAAA,CAAahU,CAAA,GAE7B,KAAK2U,UAAA,CAAW,0BAA0B,KAAKyF,kBAAA,CAAmB7G,QAAA,KAAavT,CAAA,IAChF,KAAKoa,kBAAA,CAAmBpG,YAAA,CAAahU,CAAA,CAtgDjD;MAAA;IAAA;MAAAM,GAAA;MAAAC,KAAA,EA2gDI,SAAAA,CACIf,CAAA,EACAQ,CAAA;QAmBA,OAjBAA,CAAA,GAAUoF,CAAA,CACN;UACIoS,OAAA,EAAS,KAAKA,OAAA,CAAQa,IAAA,CAAK;UAC3B0qB,gBAAA,EAAkB,KAAKpuB,UAAA,CAAW;UAClC2uB,aAAA,EAAe,KAAK3uB,UAAA,CAAW;UAC/BZ,iBAAA,EAAmB,KAAKY,UAAA,CAAW;UACnCR,sBAAA,EAAwB,KAAKQ,UAAA,CAAW;UACxCN,aAAA,EAAe,KAAKM,UAAA,CAAW;QAAA,GAEnC3U,CAAA,IAAW,KAIV6Q,EAAA,CAAWf,YAAA,MAAkD,mBAAhC9P,CAAA,CAAO+iC,gBAAA,KACrC/iC,CAAA,CAAO+iC,gBAAA,GAAuB,WAG3BvjC,CAAA,CAAK,KAAKmV,UAAA,CAAW,UAAU;UAClC6C,OAAA,EAASxX,CAAA,CAAOwX,OAAA;UAChBgC,gBAAA,EAAkBxZ,CAAA,CAAOujC,kBAAA;UACzB9pB,iBAAA,EAAmBzZ,CAAA,CAAOwjC,kBAAA;UAC1BpqB,eAAA,EAAiBpZ,CAAA,CAAO+iC,gBAAA;UACxB1pB,iBAAA,EAAmBrZ,CAAA,CAAOsjC,aAAA;UAC1BhqB,gBAAA,EAAkBtZ,CAAA,CAAO+T,iBAAA;UACzBoF,oBAAA,EAAsBnZ,CAAA,CAAOmU,sBAAA;UAC7BoF,YAAA,EAAcvZ,CAAA,CAAOqU;QAAA,EAE5B;MAAA;IAAA,GA1iDL;MAAA/T,GAAA;MAAAC,KAAA,EAykDI,SAAAA,CAAiBf,CAAA;QACbA,CAAA,GAAU4F,CAAA,CACN;UACI69B,kBAAA,GAAoB;QAAA,GAExBzjC,CAAA,IAAW,KAGf,KAAKikC,eAAA,CAAgBlrB,EAAA,EAAO/Y,CAAA,GAC5B,KAAK6jC,wBAAA,CAAyB7jC,CAAA,CACjC;MAAA;IAAA,GAnlDL;MAAAc,GAAA;MAAAC,KAAA,EA2mDI,SAAAA,CAAkBf,CAAA;QACd,IAAMQ,CAAA,GAAWoF,CAAA,CACb;UACI+9B,iBAAA,GAAmB;QAAA,GAEvB3jC,CAAA,IAAW;QAGf,KAAKikC,eAAA,CAAgBhrB,EAAA,EAAQzY,CAAA,GAC7B,KAAKqjC,wBAAA,CAAyBrjC,CAAA,CACjC;MAAA;IAAA,GArnDL;MAAAM,GAAA;MAAAC,KAAA,EAooDI,SAAAA,CAAuBf,CAAA;QACnB,OAAO,KAAKikC,eAAA,CAAgB/qB,EAAA,EAAYlZ,CAAA,CAC3C;MAAA;IAAA,GAtoDL;MAAAc,GAAA;MAAAC,KAAA,EAqpDI,SAAAA,CAAwBf,CAAA;QACpB,OAAO,KAAKikC,eAAA,CAAgB7qB,EAAA,EAAapZ,CAAA,CAC5C;MAAA;IAAA,GAvpDL;MAAAc,GAAA;MAAAC,KAAA,EAgrDI,SAAAA,CAA2Bf,CAAA;QACvB,IAAMQ,CAAA,GAA8CoF,CAAA,CAChD;UACI69B,kBAAA,GAAoB;QAAA,GAExB,QAAAzjC,CAAA,GAAAA,CAAA,GAAW;QAEf,KAAKikC,eAAA,CAAgBzqB,EAAA,EAAehZ,CAAA,GACpC,KAAKqjC,wBAAA,CAAyBrjC,CAAA,CACjC;MAAA;IAAA,GAzrDL;MAAAM,GAAA;MAAAC,KAAA,EA2rDI,SAAAA,CAAMf,CAAA;QAAA,CACY,MAAVA,CAAA,IACA4D,CAAA,CAAOmB,OAAA,CAAQF,GAAA,CAAI,gCACnByM,YAAA,IAAgBA,YAAA,CAAaG,UAAA,CAAW,aACxC,KAAKuuB,UAAA,CAAW;UAAEvD,KAAA,GAAO;QAAA,OAEzB74B,CAAA,CAAOmB,OAAA,CAAQF,GAAA,CACX,sIAEJyM,YAAA,IAAgBA,YAAA,CAAaE,OAAA,CAAQ,YAAY,SACjD,KAAKwuB,UAAA,CAAW;UAAEvD,KAAA,GAAO;QAAA,GAEhC;MAAA;IAAA,KAvsDLz8B,CAAA;EAAA;AAAA,C9BiC+B,UAAUA,CAAA,EAAiBQ,CAAA;EACtD,KAAK,IAAIW,CAAA,GAAI,GAAGA,CAAA,GAAIX,CAAA,CAAUG,MAAA,EAAQQ,CAAA,IAClCnB,CAAA,CAAMqD,SAAA,CAAU7C,CAAA,CAAUW,CAAA,KAAMgG,CAAA,CAAUnH,CAAA,CAAMqD,SAAA,CAAU7C,CAAA,CAAUW,CAAA,GAE3E;AAAA,C8BqqDD,CAAgB49B,EAAA,EAAS,CAAC;AAE1B,IAAMmF,EAAA,GAAqC;EAUrCC,EAAA,GAAwB,SAAAC,CAAA;IAG1B3K,EAAA,CAAcrhB,IAAA,GAAW,UAAUpY,CAAA,EAAgBQ,CAAA,EAAiCW,CAAA;MAChF,IAAIA,CAAA,EAaA,OAXKs4B,EAAA,CAAet4B,CAAA,MAChBs4B,EAAA,CAAet4B,CAAA,IAAQ+iC,EAAA,CAAU/iC,CAAA,IAAQu9B,EAAA,CACrC1+B,CAAA,IAAS,IACTQ,CAAA,IAAU,IACVW,CAAA,EACA,UAACnB,CAAA;QACGy5B,EAAA,CAAet4B,CAAA,IAAQ+iC,EAAA,CAAU/iC,CAAA,IAAQnB,CAAA,EACzCA,CAAA,CAAS4/B,OAAA,EACZ;MAAA,KAGFnG,EAAA,CAAet4B,CAAA;MAEtB,IAAIV,CAAA,GAAoBg5B,EAAA;MAmBxB,OAjBIyK,EAAA,CAAUxI,EAAA,IAEVj7B,CAAA,GAAWyjC,EAAA,CAAUxI,EAAA,IACd17B,CAAA,KAEPS,CAAA,GAAWi+B,EAAA,CAAa1+B,CAAA,EAAOQ,CAAA,IAAU,IAAIk7B,EAAA,EAAuB,UAAC17B,CAAA;QACjEkkC,EAAA,CAAUxI,EAAA,IAAyB17B,CAAA,EACnCA,CAAA,CAAS4/B,OAAA,EACZ;MAAA,IACDsE,EAAA,CAAUxI,EAAA,IAAyBj7B,CAAA,GAGrCg5B,EAAA,GAAyBh5B,CAAA,EACvB+4B,EAAA,KAAcD,EAAA,CAAS+B,YAAA,KACrB13B,CAAA,CAAe83B,EAAA,IAAyBjC,EAAA,GA1CtD9zB,CAAA,CAAMu+B,EAAA,EAAW,UAAUlkC,CAAA,EAAUQ,CAAA;QAC7BA,CAAA,KAASk7B,EAAA,KACTjC,EAAA,CAAej5B,CAAA,IAAQR,CAAA,CAE9B;MAAA,IAyCcS,CAAA;IAAA,CAGlB;EAAA;EAEK4jC,EAAA,GAAyB,SAAAC,CAAA;IAE3B,SAAStkC,EAAA;MAEAA,CAAA,CAA2Bmc,IAAA,KAG9Bnc,CAAA,CAA2Bmc,IAAA,IAAO,GAEpCyf,EAAA,IAAmB,GAEnBj2B,CAAA,CAAMu+B,EAAA,EAAW,UAAUlkC,CAAA;QACvBA,CAAA,CAAKukC,WAAA,EACR;MAAA,GACJ;IAAA;IAEGtgC,CAAA,CAAS+F,gBAAA,KACmB,eAAxB/F,CAAA,CAASsuB,UAAA,GAKTvyB,CAAA,KAEAiE,CAAA,CAAS+F,gBAAA,CAAiB,oBAAoBhK,CAAA,GAAoB,KAK1E2J,EAAA,CAAgB/F,CAAA,EAAQ,QAAQ5D,CAAA,GAAoB,EACvD;EAAA;AG5hEY,IAAAwkC,EAAA,IH8jEThL,EAAA,GAAYD,EAAA,CAAS8B,WAAA,EACnB5B,EAAA,GAAyB,IAAIsF,EAAA,IAE/BoF,EAAA,IACE1K,EAAA,CAAcrhB,IAAA,IAChBisB,EAAA,IAEO5K,EAAA;AAAA,SAAAvM,EAAA,IAAAuX,WAAA,EAAA1F,EAAA,IAAA2F,OAAA,EAAAtX,EAAA,IAAAuX,kBAAA,EAAAxX,EAAA,IAAAyX,UAAA,EAAAJ,EAAA,IAAAK,OAAA,EAAAL,EAAA,IAAAM,OAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}